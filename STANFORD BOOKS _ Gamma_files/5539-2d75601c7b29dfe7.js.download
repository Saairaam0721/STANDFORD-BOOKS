(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5539],{1511:(e,t,i)=>{"use strict";i.d(t,{BC:()=>g6,UN:()=>gW,vn:()=>jd,mi:()=>t5.mi});var n,s=i(6029),r=i(40452),o=i(26385),l=i(48810),a=i(49611),d=i(26420),c=i(21938),u=i(99492),x=i(48621),h=i(54839),m=i(19564),p=i(77650),g=i(95669),j=i.n(g),f=i(82203),v=i.n(f),b=i(55729),y=i(74158),C=i(9131),w=i(68469),k=i(82592),E=i(82328),S=i(88055),I=i(47956),A=i(36936),T=i(91938),R=i(68301),_=i(51567),O=i(29608),D=i(70006),P=i(38055),z=i(83747);let M=new z.b;var L=i(12514),N=i(94740),F=i(59272),V=i(24302),G=i(18078),W=i(25311),B=i(23293),U=i(53996),H=i(16936),K=i(83004),q=i(47412),Y=i(46673),J=i(84208),X=i(85697),$=i(5061),Z=i(85011),Q=i(95889),ee=i(91792),et=i(82927),ei=i(23460),en=i(92124);let es=e=>{let{selector:t}=e,[i,n]=(0,b.useState)(null),s=t?document.querySelector(t):null,r=(0,b.useCallback)(()=>{if(!t)return void n(null);if(s){s.scrollIntoView({behavior:"auto",block:"center"});let e=s.getBoundingClientRect();n({top:e.top,bottom:e.bottom,left:e.left,right:e.right,width:e.width,height:e.height})}else n(null)},[t,s]),o=(0,en.wb)(r,500);return(0,b.useEffect)(()=>(r(),window.addEventListener("resize",o),window.addEventListener("scroll",o),()=>{window.removeEventListener("resize",o),window.removeEventListener("scroll",o)}),[o,r]),{rectAttrs:i}},er=e=>({backgroundColor:e?"elevation.3":"white",borderColor:e?"gray.600":"gray.200",color:e?"white":"gray.700"});var eo=i(70967);i(31312);let el=e=>{let{selector:t,onClickTargetElement:i,rectAttrs:n,lockScroll:r=!1}=e,o=(0,b.useCallback)(e=>{let i=t&&document.querySelector(t);i&&(null==i?void 0:i.parentElement)&&(e?i.parentElement.style.opacity="1":i.parentElement.style.opacity="unset")},[t]);(0,b.useEffect)(()=>{let e=()=>{null==i||i(),o(!1)},n=t&&document.querySelector(t);return n&&n.addEventListener("mousedown",e),()=>{n&&n.removeEventListener("mousedown",e)}},[o,i,t]),(0,b.useEffect)(()=>(o(!0),()=>{o(!1)}),[o]);let l=(0,b.useMemo)(()=>(0,eo.X)(),[]);return(0,s.jsxs)(L.Z,{children:[r&&(0,s.jsx)(K.mL,{styles:{".doc-root":{overflowY:"hidden !important",paddingInlineEnd:"".concat(l,"px !important")}}}),(0,s.jsxs)("svg",{className:"overlay-svg",width:"100%",height:"100%",preserveAspectRatio:"none",children:[(0,s.jsxs)("defs",{children:[n&&(0,s.jsxs)("mask",{id:"mask",children:[(0,s.jsx)("rect",{width:"100%",height:"100%",fill:"white",rx:3,ry:3}),(0,s.jsx)("rect",{x:n.left,y:n.top,width:n.width,height:n.height,fill:"black",rx:3,ry:3})]}),(0,s.jsxs)("linearGradient",{id:"gradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[(0,s.jsx)("stop",{offset:"0%",stopColor:"#f79533"}),(0,s.jsx)("stop",{offset:"20%",stopColor:"#f37055"}),(0,s.jsx)("stop",{offset:"40%",stopColor:"#ef4e7b"}),(0,s.jsx)("stop",{offset:"60%",stopColor:"#a166ab"}),(0,s.jsx)("stop",{offset:"80%",stopColor:"#5073b8"}),(0,s.jsx)("stop",{offset:"100%",stopColor:"#1098ad"}),(0,s.jsx)("animateTransform",{attributeName:"gradientTransform",type:"rotate",from:"0",to:"1000",dur:"3s",repeatCount:"indefinite"})]})]}),(0,s.jsx)("rect",{width:"100%",height:"100%",fill:"black",opacity:"0.5",mask:"url(#mask)",id:"mask-overlay"}),n&&(0,s.jsx)("rect",{x:n.left-4,y:n.top-4,width:n.width+8,height:n.height+8,rx:3,ry:3,fill:"none",stroke:"url(#gradient)",strokeWidth:"3"})]}),(0,s.jsx)(d.a,{className:"overlay-clickable",children:n&&(0,s.jsx)(d.a,{className:"cutout-area",position:"absolute",top:n.top,left:n.left,width:"".concat(n.width,"px"),height:"".concat(n.height,"px"),borderRadius:3})})]})};var ea=i(66199),ed=i(79956),ec=i(53907),eu=i(15342),ex=i(43634),eh=i(6807),em=i(65148),ep=i(26476),eg=i(1079),ej=i(99038);let ef={createFirstGamma:!1,addCard:!1,dragToReorderCards:!1,addMedia:!1,changeTheme:!1,editWithAI:!1,tryPresenterView:!1,exportPDF:!1},ev=()=>({createFirstGamma:{title:(0,s.jsx)(m.x6,{id:"cwH/bW",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}}),detail:(0,s.jsx)(m.x6,{id:"gPnQTx"}),learnMoreLink:eg.C.CREATE_NEW_GAMMA,webm:"https://static.gamma.app/videos/editor-checklist/v2/CreateNewGamma_c0a1ff03.webm",mp4:"https://static.gamma.app/videos/editor-checklist/v2/CreateNewGamma_838d509f.mp4"},addCard:{title:(0,s.jsx)(m.x6,{id:"B3xxao"}),detail:(0,s.jsx)(m.x6,{id:"QFRh35",components:{0:(0,s.jsx)(ep.u,{})}}),webm:"https://static.gamma.app/videos/editor-checklist/v2/AddCard_b581730c.webm",mp4:"https://static.gamma.app/videos/editor-checklist/v2/AddCard_bafff15e.mp4",maskSelector:'[data-guider-highlight="add-card-button"]'},dragToReorderCards:{title:(0,s.jsx)(m.x6,{id:"eCIfAy"}),detail:(0,s.jsx)(m.x6,{id:"r2DHdM"}),webm:"https://static.gamma.app/videos/editor-checklist/v2/DragToReorder_73bf1b69.webm",mp4:"https://static.gamma.app/videos/editor-checklist/v2/DragToReorder_a5a6c98c.mp4",maskSelector:'[data-guider-highlight="filmstrip-scroller"]',actionBefore:()=>{A.R.emit("openFilmStrip",{})}},addMedia:{title:(0,s.jsx)(m.x6,{id:"upnFWM"}),detail:(0,s.jsx)(m.x6,{id:"4IBZBD",components:{0:(0,s.jsx)(ep.u,{})}}),learnMoreLink:eg.C.ADD_BLOCKS,webm:"https://static.gamma.app/videos/editor-checklist/v2/AddMedia_a78ee09c.webm",mp4:"https://static.gamma.app/videos/editor-checklist/v2/AddMedia_85b8aee8.mp4",maskSelector:'[data-guider-highlight="insert-widget"]'},changeTheme:{title:(0,s.jsx)(m.x6,{id:"UOE+DR"}),detail:(0,s.jsx)(m.x6,{id:"MOba58"}),learnMoreLink:eg.C.CHANGE_THEME,webm:"https://static.gamma.app/videos/editor-checklist/v2/ChangeTheme_18381f26.webm",mp4:"https://static.gamma.app/videos/editor-checklist/v2/ChangeTheme_a7fd3334.mp4",maskSelector:'[data-guider-highlight="toolbar-theme-button"]'},editWithAI:{title:(0,s.jsx)(m.x6,{id:"EVnzPs"}),detail:(0,s.jsx)(m.x6,{id:"t5XFEE"}),learnMoreLink:eg.C.EDIT_WITH_AI,webm:"https://static.gamma.app/videos/editor-checklist/v2/EditWithAI_47eefcc5.webm",mp4:"https://static.gamma.app/videos/editor-checklist/v2/EditWithAI_1e1eeaa6.mp4",maskSelector:'[data-guider-highlight="edit-with-ai-button"]'},tryPresenterView:{title:(0,s.jsx)(m.x6,{id:"E3nYWH"}),detail:(0,s.jsx)(m.x6,{id:"c4vcd2",components:{0:(0,s.jsx)(ep.u,{})}}),learnMoreLink:eg.C.PRESENT_MODE,webm:"https://static.gamma.app/videos/editor-checklist/v2/TryPresenting_44202db8.webm",mp4:"https://static.gamma.app/videos/editor-checklist/v2/TryPresenting_af27f32c.mp4",maskSelector:'[data-guider-highlight="present-button-group"]'},exportPDF:{title:(0,s.jsx)(m.x6,{id:"eW0Hm2"}),detail:(0,s.jsx)(m.x6,{id:"GZeq1f"}),learnMoreLink:eg.C.EXPORT,webm:"https://static.gamma.app/videos/editor-checklist/v2/ShareAndExport_3b15ca89.webm",mp4:"https://static.gamma.app/videos/editor-checklist/v2/ShareAndExport_41008843.mp4",maskSelector:'[data-guider-highlight="share-button"]',skipCompleteStepOnMaskClick:!0}}),eb=ev(),ey=()=>{let[e]=(0,eh.M)(em.E.onboardingChecklistSteps,ef),t=Object.values(eb).length,i=Object.values(e).filter(Boolean).length;return{isChecklistComplete:i===t,progress:i/t*100,stepCount:i,totalSteps:t}},eC="onboardingChecklistWidgetActivator",ew=()=>{var e;let t=(0,eu.GV)(ex.sX),i=(0,eu.GV)((0,ec.A0)(t)),n=(null==i?void 0:i.status)==="running",{user:r,isUserLoading:d}=(0,et.ur)(),{progress:c,stepCount:u,totalSteps:x,isChecklistComplete:h}=ey(),p=(0,V.dU)("gray.700","gray.200"),g=(0,V.dU)("gray.400","gray.600"),j=null==r||null==(e=r.settings)?void 0:e.needsEditorOnboarding;return n||d||h?null:(0,s.jsx)(ea.W,{children:(0,s.jsx)(a.$,{onClick:()=>{A.R.emit("toggleOpen",{behavior:"toggle"})},width:"fit-content",px:4,minW:"150px",borderRadius:"full","data-id":eC,visibility:j||0===u?"hidden":"visible",pointerEvents:j||0===u?"none":"auto",children:(0,s.jsxs)(o.B,{spacing:1,w:"100%",children:[(0,s.jsxs)(o.B,{w:"100%",direction:"row",alignItems:"center",justifyContent:"space-between",children:[(0,s.jsx)(B.D,{size:"xs",color:p,children:(0,s.jsx)(m.x6,{id:"ZDIydz"})}),(0,s.jsx)(l.E,{fontSize:"xxs",color:g,children:(0,s.jsx)(m.x6,{id:"sNvodR",values:{totalSteps:x,0:String(u)}})})]}),(0,s.jsx)(ed.k,{size:"xs",value:c,colorScheme:"green",borderRadius:"full"})]})})})};i(57690);let ek=[{heading:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.x6,{id:"WywDbS",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}})," ",(0,s.jsx)("span",{role:"img","aria-label":"party popper",className:"emoji",children:"\uD83C\uDF89"})]}),description:(0,s.jsx)(m.x6,{id:"qp5/eb",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}}),cta:(0,s.jsx)(m.x6,{id:"1K069f"})},{heading:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.x6,{id:"SikK9S",values:{GAMMA_PROPER_NOUN:ej.On}})," ",(0,s.jsx)("span",{role:"img","aria-label":"card",className:"emoji",children:"\uD83C\uDCCF"})]}),description:(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(m.x6,{id:"OXpHoP"})}),selector:'[data-guider-highlight="card-body"]'},{heading:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.x6,{id:"ufgIDV"})," ",(0,s.jsx)("span",{role:"img","aria-label":"brick",className:"emoji",children:"\uD83E\uDDF1"})]}),description:(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(m.x6,{id:"YzLd99",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}})}),shouldFocusEditor:!0,selector:".first-block-in-card"},{heading:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.x6,{id:"xL3A5l"})," ",(0,s.jsx)("span",{role:"img","aria-label":"racing flag",className:"emoji",children:"\uD83C\uDFC1"})]}),description:(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(m.x6,{id:"USbGN7",values:{GAMMA_PROPER_NOUN:ej.On}})})}],eE='[data-id="'.concat(eC,'"]'),eS=e=>{let{editor:t}=e,i=(0,$.fW)(),{setSettings:n}=(0,et.ur)(),[r,o]=(0,b.useState)(0),l=(0,Z.O2)("editor"),[a,c]=(0,b.useState)(!1),u=ek[r],{rectAttrs:x}=es({selector:u.selector}),{rectAttrs:h}=es({selector:eE}),m=u.selector&&x||h;(0,b.useEffect)(()=>{(0,ei._1)(eE,12e4).then(()=>{l.scrollTo({top:0,behavior:"smooth"}).then(()=>{requestAnimationFrame(()=>{(0,J.v)(Q.VV.ONBOARDING_WELCOME_TOUR_STARTED),c(!0)})})}).catch(()=>{})},[]);let p=(0,b.useCallback)(()=>{(0,J.v)(Q.VV.ONBOARDING_WELCOME_TOUR_STEP_COMPLETED,{step:r+1}),o(r+1)},[r]);(0,b.useEffect)(()=>{u.shouldFocusEditor&&(null==t||t.commands.focusDelayed())},[r,t,u.shouldFocusEditor]);let g=(0,b.useCallback)(()=>{(0,J.v)(Q.VV.ONBOARDING_WELCOME_TOUR_STEP_COMPLETED,{step:r+1}),c(!1),null==n||n({remove:["needsEditorOnboarding"]}),A.R.emit("toggleOpen",{behavior:"open"})},[n,r]),j=(0,b.useCallback)(()=>{o(r-1)},[r]),f=(0,ee.rd)();return!a||(0,O.Xb)()||!m?null:(0,s.jsxs)(L.Z,{children:[(0,s.jsx)(K.mL,{styles:{"[data-editor-toolbar] button":{pointerEvents:"none"}}}),(0,s.jsx)(q.L8,{isDark:f,children:(0,s.jsxs)(N.A,{isOpen:!0,lazyBehavior:"unmount",closeOnBlur:!1,isLazy:!0,gutter:8,preventOverflow:!0,boundary:"clippingParents",placement:u.selector&&x?"start-start":"top",modifiers:[{name:"detectOverflow",phase:"beforeWrite",requiresIfExists:["offset"],enabled:!0,fn:e=>{let{state:t}=e;if(!u.selector)return t.styles.popper={...t.styles.popper,left:i?"".concat(X.uA):"-".concat(X.uA)},t;let n=(0,Y.A)(t,{boundary:"clippingParents"}),s=n.top>0||n.bottom>0||n.left>0||n.right>0,r=t.elements.popper.getBoundingClientRect();return u.selector&&(null==h?void 0:h.top)&&s&&(t.styles.popper={...t.styles.popper,right:i?"auto":"0px",top:"-".concat(8,"px"),left:i?"0px":"auto",bottom:"auto",transform:"translate3d(0px, ".concat(h.top-r.height,"px, 0px)"),insetInlineEnd:X.uA}),t}}],children:[(0,s.jsx)(F.d,{children:(0,s.jsx)(d.a,{position:"absolute",pointerEvents:"none",top:"".concat(null==m?void 0:m.top,"px"),left:"".concat(null==m?void 0:m.left,"px"),width:"".concat(null==m?void 0:m.width,"px"),height:"".concat(null==m?void 0:m.height,"px")})}),(0,s.jsx)(L.Z,{children:(0,s.jsx)(eI,{step:u,onNextClick:p,onBackClick:j,onCompleteClick:g,stepIndex:r},r)})]})}),(0,s.jsx)(el,{selector:u.selector,rectAttrs:x||null,onClickTargetElement:()=>{}})]})},eI=e=>{let{step:t,onNextClick:i,onBackClick:n,onCompleteClick:r,stepIndex:c}=e,h=(0,$.fW)(),g=h?u.CeG:u.dmS,j=h?u.dmS:u.CeG,f=er((0,ee.rd)()),v=(0,V.dU)("gray.500","gray.400"),b=(0,V.dU)("gray.300","gray.600");return(0,s.jsx)(G.h,{"data-id":"tour-popover-content",shadow:"2xl",w:"400px",border:"1px solid var(--chakra-colors-gray-200)",className:"tour-popover",...f,children:(0,s.jsx)(W.e,{children:(0,s.jsxs)(o.B,{p:2,pt:4,spacing:6,children:[c!==ek.length-1&&(0,s.jsx)(l.E,{fontSize:"sm",color:b,fontWeight:"bold",mt:-2,children:(0,s.jsx)(m.x6,{id:"RfkEBH",values:{0:c+1,1:ek.length-1}})}),(0,s.jsxs)(o.B,{spacing:2,children:[(0,s.jsx)(d.a,{display:"inline",alignItems:"center",children:(0,s.jsx)(B.D,{display:"inline",variant:"fancy",size:"md",mb:2,textAlign:"start",lineHeight:"1",children:t.heading})}),(0,s.jsx)(l.E,{fontSize:"md",children:t.description}),t.helperText&&(0,s.jsx)(l.E,{fontSize:"sm",color:v,children:t.helperText})]}),0===c?(0,s.jsx)(U.o,{children:(0,s.jsx)(a.$,{w:"fit-content",variant:"solid",onClick:i,children:(0,s.jsx)(m.x6,{id:"1K069f"})})}):c===ek.length-1?(0,s.jsx)(U.o,{children:(0,s.jsx)(a.$,{onClick:r,w:"fit-content",variant:"solid",children:(0,s.jsx)(m.x6,{id:"O1h2Xs"})})}):(0,s.jsxs)(o.B,{w:"100%",alignItems:"center",justifyContent:"space-between",direction:"row",children:[(0,s.jsx)(H.K,{size:"md",variant:"plain",px:6,colorScheme:"blackAlpha",onClick:n,"aria-label":p.Ru._({id:"iH8pgl"}),icon:(0,s.jsx)(x.g,{icon:j})}),(0,s.jsx)(H.K,{px:6,size:"md",variant:"solid",onClick:i,"aria-label":p.Ru._({id:"hXzOVo"}),icon:(0,s.jsx)(x.g,{icon:g})})]})]})})})},eA=e=>{let{editor:t}=e,[i,n]=(0,b.useState)("off"),{hasInitialized:r}=(0,R.FY)(),o=r&&("tour"===i||"aiGenerate"===i)&&!T.$.IS_USER_TESTING_SESSION;return((0,b.useEffect)(()=>{if(!T.$.IS_USER_TESTING_SESSION)return M.on("triggerOnboarding",e=>{let{reason:t}=e;(0,O.Xb)()||n(t)})},[]),eT(),o)?(0,s.jsx)(eS,{editor:t}):null},eT=()=>{let e="true"===(0,D.sF)()[P.y];(0,_.o)(P.y),(0,b.useEffect)(()=>{e&&M.emit("triggerOnboarding",{reason:"tour"})},[e])};var eR=i(32617),e_=i(58809),eO=i(53281),eD=i(61106),eP=i(81043),ez=i(27229),eM=i(55765),eL=i.n(eM),eN=i(47687),eF=i.n(eN);class eV extends z.b{setup(){document.addEventListener("mousemove",this.throttled)}teardown(){document.removeEventListener("mousemove",this.throttled)}constructor(){super(),this.throttled=eF()(e=>{this.emit("move",e)},200,{leading:!0})}}let eG=eL()(()=>new eV),eW=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,n=eG(),[s,r]=(0,b.useState)(!1),o=(0,b.useRef)(null),l=(0,b.useRef)(e);return l.current=e,(0,b.useEffect)(()=>{if(t)return;let e=()=>{null!==o.current&&(clearTimeout(o.current),o.current=null)},s=()=>{e(),i&&(o.current=setTimeout(()=>{r(!1),o.current=null},i))};s();let a=n.on("move",e=>{r(l.current(e)),s()});return()=>{e(),a()}},[n,t,i]),s};var eB=i(85328),eU=i(30615);let eH=(0,b.memo)(e=>{let{forceShow:t=!1}=e,{isOpen:i,onToggle:n,onClose:r,onOpen:o}=(0,ez.j)(),l=(0,eu.GV)(ex.VJ),a=eW((0,b.useCallback)(e=>e.clientX>window.innerWidth-150&&e.clientY>window.innerHeight-150,[]));return(0,b.useEffect)(()=>{t?o():r()},[t,o,r]),(0,s.jsx)(eB.x,{me:!l||i||a||t?"0px":"-100%",transitionProperty:"margin-right",transitionDuration:"ultra-slow",transitionTimingFunction:"ease-in-out",children:(0,s.jsxs)(N.A,{returnFocusOnClose:!1,isOpen:i,onClose:r,closeOnBlur:!0,closeOnEsc:!1,children:[(0,s.jsx)(ea.W,{children:(0,s.jsx)(H.K,{onClick:()=>{n()},"aria-label":"Help",isRound:!0,size:"md",icon:(0,s.jsx)(x.g,{icon:u.Lhe})})}),(0,s.jsx)(G.h,{...X.kK,children:(0,s.jsx)(W.e,{children:(0,s.jsx)(eU.u,{onClose:r})})})]})})});eH.displayName="PresentModeHelpWidget";var eK=i(39892),eq=i(75748),eY=i(33633),eJ=i(3247),eX=i(27748),e$=i(84431),eZ=i(45143),eQ=i(54929),e0=i(20751),e1=i(22249);let e6={ifPanelHasRoomToOpen:function(e,t,i){return"left"===i?{base:t,xl:e}:{base:t,"2xl":e}}},e2=e=>{let{children:t,onClose:i,panelName:n}=e;return(0,b.useEffect)(()=>eJ.WC.on("keydown",n,e=>"Escape"===e.key&&(i(),!0)),[n,i]),t},e5=e=>{var t;let{position:i,panelLifecycle:n,editor:o,canResize:l=!0}=e,a=(0,$.fW)()?"left"===i?"right":"left":i,d=(0,b.useRef)(),[c,u]=(0,b.useState)(!1),x=(0,y.wA)(),h=(0,eu.GV)((0,e1.DP)(i)),m=(0,eu.GV)((0,e1.wM)(i)),p=(0,eu.GV)((0,e1.I2)(i)),g=(0,eu.GV)(ex.OG),j=(0,eu.GV)((0,e1.lp)(i)),f=(0,eu.GV)((0,e1.yG)(i)),v=!!(0,R.u)("docAlwaysZoomToFit")&&(null==f?void 0:f.alwaysDocked),C=null!=(t=null==f?void 0:f.canCollapse)&&t,w=(0,b.useCallback)(()=>{x((0,e1.Zv)({position:i}))},[x,i]),k=(0,b.useCallback)(()=>{x((0,e1.NE)({component:f}))},[f,x]),E=(0,b.useCallback)(e=>{x((0,e1.bz)({width:e,position:i})),n.emit("resize",{})},[x,n,i]),S=(0,eu.GV)((0,e1.aL)(i))&&l,I={zIndex:e$.$.panel,position:v?"relative":e6.ifPanelHasRoomToOpen("relative","fixed",a),top:v?0:e6.ifPanelHasRoomToOpen(0,"var(--editor-padding-top)",a),bottom:0,[a]:0},A=(0,ee.rd)();p||c||(I.transitionProperty="width",I.transitionDuration="".concat(eX.o0,"ms")),(0,b.useEffect)(()=>{let e=e=>{"width"===e.propertyName&&n.emit("resize",{})};return d.current.addEventListener("transitionend",e),()=>{d.current&&d.current.removeEventListener("transitionend",e)}},[n,d]);let T=(0,eZ.h5)(e6.ifPanelHasRoomToOpen(!0,!1,a))||!1,_=v||T;return(0,b.useEffect)(()=>{h&&!_&&C&&w()},[_,h,w,C]),(0,b.useEffect)(()=>{g&&w()},[g,w]),(0,s.jsxs)(r.s,{ref:d,...I,style:{width:h||C?j:0},boxShadow:_?"none":"2xl",borderColor:h?A?"gray.700":"blackAlpha.100":void 0,borderLeftWidth:h&&"right"===a?"1px":0,borderRightWidth:h&&"left"===a?"1px":0,maxW:"100%","data-print-hidden":!0,children:[h&&"right"===i&&S&&(0,s.jsx)(e0.$P,{isDragging:c,setIsDragging:u,position:a,width:j,minWidth:null==f?void 0:f.minWidth,setWidth:E,panelRef:d,onClose:w,initialWidth:eX.JO}),(0,s.jsx)(eQ.Y.Provider,{value:n,children:f&&(h||C)&&(0,s.jsx)(e2,{onClose:w,panelName:f.panelName,children:(0,s.jsx)(f,{isDragging:c,isOpen:h,closePanel:w,openPanel:k,panelRef:d,lifecycle:n,hasRoomToOpen:_,editor:o,...m})})}),h&&"left"===i&&S&&(0,s.jsx)(e0.$P,{isDragging:c,setIsDragging:u,position:a,width:j,minWidth:null==f?void 0:f.minWidth,setWidth:E,panelRef:d,onClose:w,initialWidth:eX.qm})]})},e3=(0,b.memo)(e=>(0,s.jsx)(e5,{position:"right",...e}));e3.displayName="RightPanelContainer";let e4=(0,b.memo)(e=>(0,s.jsx)(e5,{position:"left",...e}));e4.displayName="LeftPanelContainer";var e8=i(58959),e7=i(61204),e9=i(81278),te=i(8944);let tt=e=>{let{docId:t}=e,i=(0,eu.jL)(),n=(0,V.dU)("gray.300","gray.700"),o=(0,V.dU)("white","gray.800"),l=(0,V.dU)("transparent","transparent"),c=(0,V.dU)("gray.500","gray.400"),h=(0,V.dU)("trueblue.50","trueblue.400"),g=(0,V.dU)("trueblue.500","white"),j=(0,V.dU)("gray.600","gray.50"),f=(0,V.dU)("gray.50","gray.600"),v=(0,V.dU)("trueblue.50","trueblue.400"),y=(0,V.dU)("trueblue.500","white"),{replace:C}=(0,e9.useRouter)(),w=(0,eu.GV)(te.og),k=(0,b.useCallback)(()=>{t&&C((0,D.pF)({docId:t}),void 0,{shallow:!0})},[t,C]),E=(0,b.useCallback)(e=>{i((0,te.ey)({previewSize:e}))},[i]);return(0,b.useEffect)(()=>eJ.WC.on("keydown","SITE_PREVIEW_PANE",e=>("Escape"===e.key&&k(),!0)),[k]),(0,s.jsx)(r.s,{bg:"white",align:"flex-start",direction:"column",width:"100%","data-sites-preview-pane":!0,children:(0,s.jsxs)(e8.z,{w:"100%",spacing:0,p:2,py:2,bg:o,borderColor:n,justify:"flex-start",borderBottomWidth:"1px",children:[(0,s.jsx)(e8.z,{spacing:2,flexBasis:"30%",children:!(0,O.Xb)()&&(0,s.jsx)(a.$,{size:"sm",variant:"plain",onClick:k,children:(0,s.jsx)(e8.z,{children:(0,s.jsx)(d.a,{children:(0,s.jsx)(x.g,{icon:u.CeG})})})})}),(0,s.jsxs)(e7.e,{size:"sm",ml:24,flexBasis:"40%",justifyContent:"center",children:[(0,s.jsx)(q.Tz,{label:(0,s.jsx)(m.x6,{id:"58m6Qy"}),children:(0,s.jsx)(H.K,{"aria-label":p.Ru._({id:"58m6Qy"}),variant:"ghost",size:"sm",icon:(0,s.jsx)(x.g,{icon:u.GrJ}),bg:"mobile"===w?h:l,_hover:{color:"mobile"===w?y:j,bg:"mobile"===w?v:f},color:"mobile"===w?g:c,onClick:()=>{E("mobile")}})}),!(0,O.Xb)()&&(0,s.jsx)(q.Tz,{label:(0,s.jsx)(m.x6,{id:"fpcKeD"}),children:(0,s.jsx)(H.K,{"aria-label":p.Ru._({id:"fpcKeD"}),variant:"ghost",size:"sm",icon:(0,s.jsx)(x.g,{icon:u.w7B}),bg:"tablet"===w?h:l,_hover:{color:"tablet"===w?y:j,bg:"tablet"===w?v:f},color:"tablet"===w?g:c,onClick:()=>{E("tablet")}})}),!(0,O.Xb)()&&(0,s.jsx)(q.Tz,{label:(0,s.jsx)(m.x6,{id:"K3p0ar"}),children:(0,s.jsx)(H.K,{"aria-label":p.Ru._({id:"K3p0ar"}),variant:"ghost",size:"sm",icon:(0,s.jsx)(x.g,{icon:u.ArK}),bg:"desktop"===w?h:l,_hover:{color:"desktop"===w?y:j,bg:"desktop"===w?v:f},color:"desktop"===w?g:c,onClick:()=>{E("desktop")}})})]}),(0,s.jsx)(e8.z,{flexBasis:"30%",justifyContent:"flex-end"})]})})};var ti=i(24573),tn=i(12364),ts=i.n(tn),tr=i(99552),to=i(72492);let tl=(e,t)=>{let i=(0,eu.jL)(),n=(0,eu.CU)(),s=!!(0,eu.GV)(tr.df),r=(0,eu.GV)(ex.Ik),o=(0,eu.GV)(tr.le),l=t&&s&&r;(0,b.useEffect)(()=>{var t,s;if(!l||!e||e.gammaDocId!==o)return;let r=(0,e_.Jo)(n.getState()),a=null==r||null==(s=r.publishedSnapshot)||null==(t=s.content)?void 0:t.default;if(!a)return;let d=!(0,to.wX)(e,a);console.debug("[useDirtyStateTracking] INITIALIZING DIRTY STATE ".concat(o," via compareDocJSON"),{isDirty:d}),d&&i((0,tr.VP)({pageId:e.gammaDocId,lastUpdatedAt:new Date().toISOString()}))},[i,n,e,l,o]),(0,b.useEffect)(()=>{if(!l||!e)return;let t=ts()(()=>{i((0,tr.VP)({pageId:e.gammaDocId,lastUpdatedAt:new Date().toISOString()}))},500,{leading:!0,trailing:!0,maxWait:1e3});return e.on("update",t),()=>{e.off("update",t)}},[l,i,e])};var ta=i(44141),td=i(20925),tc=i(51967),tu=i(26053),tx=i(73813),th=i(30524),tm=i(59543),tp=i(37243),tg=i(831),tj=i.n(tg),tf=i(47665),tv=i(85235);let tb=(e,t,i,n,s)=>{let r=n-i,o=Math.max(r-Math.max(e-i,0)-Math.max(n-t,0),0),l=o/r,a=l>0&&o==t-e;return{overlap:l,viewing:s&&(a||l>.5||o>400),only:a}},ty=(e,t)=>{let i=(0,Z.O2)("editor"),[n,s]=(0,b.useState)(null),r=(0,b.useRef)({presentingCardId:null,scrollTop:0,containerHeight:0,expandedCards:{}}),o=(0,eu.GV)(ex.wC),l=(0,eu.GV)(ex.$i);(0,b.useEffect)(()=>{r.current.presentingCardId=null!=l?l:null},[l]);let a=(0,eu.GV)(ex.vy);(0,b.useEffect)(()=>{r.current.expandedCards=a},[a]),(0,b.useEffect)(()=>{let e=document.querySelector(i.scrollSelector);if(!e)return;s(e);let{height:t}=e.getBoundingClientRect();r.current.scrollTop=e.scrollTop,r.current.containerHeight=t},[i.scrollSelector,r]),(0,b.useEffect)(()=>{let e=ts()(()=>{n&&(r.current.scrollTop=n.scrollTop)},250,{trailing:!0,maxWait:500});return window.addEventListener("scroll",e,!0),()=>window.removeEventListener("scroll",e,!0)},[n]),(0,b.useEffect)(()=>{let e=ts()(()=>{n&&(r.current.containerHeight=n.getBoundingClientRect().height)},250,{trailing:!0,maxWait:500});return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[n]),(0,b.useEffect)(()=>{if(!e)return;if(o===tv.w.SLIDE_VIEW){let e=setInterval(()=>{t.emit("cardViewed",{cardId:r.current.presentingCardId,interval:1e3})},1e3);return()=>clearInterval(e)}let n=setInterval(()=>{if(document.hidden)return;let{scrollTop:n,containerHeight:s,expandedCards:o}=r.current,l=n+s;tj()((0,tp.xe)(e.state.doc,tf.jg),e=>e.node.attrs.id).map(t=>{let s,r=t.node.attrs.id,a=o[r];if(!a)return null;try{s=e.view.nodeDOM(t.pos)}catch(e){return null}if(s instanceof HTMLElement){let e=(0,ei.sR)(s,i.scrollSelector),{offsetHeight:t}=s;return{id:r,...tb(n,l,e,t+e,a)}}return null}).filter(e=>!!(null==e?void 0:e.viewing)).forEach(e=>{t.emit("cardViewed",{cardId:e.id,interval:1e3})})},1e3);return()=>clearInterval(n)},[o,e,r,t,i.scrollSelector])},tC=e=>{let{editor:t,backoffFactor:i=1}=e,n=(0,Q.st)(),[s,r]=(0,b.useState)(15e3);ty(t,tm.t);let o=(0,b.useCallback)(()=>{tm.t.flush(),r(Math.min(s*i,12e4))},[i,s]);return(0,b.useEffect)(()=>{if(!n)return;tm.t.initialize(),tm.t.on("flush",e=>{let{viewed:t}=e;for(let[e,i]of Object.entries(t))n.trackDocEvent(Q.VV.CARD_VIEWED,{card_id:e,duration:i})});let e=setInterval(()=>o(),s);return()=>{clearInterval(e),tm.t.destroy()}},[n,s,o]),null};var tw=i(11324),tk=i(75074),tE=i(39162),tS=i(77364),tI=i(57405),tA=i(29810),tT=i(55597),tR=i(90184),t_=i(647),tO=i(95563),tD=i(39099),tP=i(83817),tz=i.n(tP),tM=i(70259),tL=i(71737);let tN=e=>{let t=(0,eu.GV)(tk.Ix),{title:i}=(0,tM.d)({cardId:t||void 0,editor:e}),n=(0,eu.GV)(ex.uF,function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return tz()(...t)}),s=n.indexOf(t||""),r=(0,b.useCallback)(t=>()=>{var i,r;if(!e)return;let o=null!=(r=n[s+(t?1:-1)])?r:n[s],l=null==(i=(0,tf.W0)(e,o))?void 0:i.pos;if(!l)return;(0,tL.I5)(e,l)||e.commands.selectInsideNodeAtPos(l);let a=e.view.nodeDOM(l);a instanceof HTMLElement&&(0,Z.H1)("editor").scrollElementIntoView({element:a,delay:0})},[s,e,n]);return{cardId:t,title:i||"Untitled",canGoForward:s<n.length-1,canGoBack:s>0,goToNextCard:r(!0),goToPreviousCard:r(!1)}};var tF=i(75495),tV=i(92397);let tG=e=>{let{editor:t,isReadonly:i}=e,{selection:n}=(0,tF.y)(t),s=(0,eu.jL)();(0,b.useEffect)(()=>{if(!t)return;let e=(0,tV.hT)(t.state.doc,t.state.selection.from);if(e&&e.node&&!(0,tL.eh)(e.node)){if(i)return void s((0,tk.qq)());(0,tL.ni)(t,e.pos)}},[s,t,i,n])};var tW=i(80116),tB=i(34832),tU=i(17859),tH=i(26814),tK=i(6018),tq=i(37605),tY=i(3239),tJ=i(3383),tX=i(53615),t$=i(11403);let tZ=e=>{let{editor:t,cardId:i}=e,n=(0,eu.GV)(ex.sK),s=(0,eu.GV)(ex.nD),r=(0,R.u)("aiCardNotes"),o=(0,b.useCallback)(e=>{if(!t||!i)return;let n=(0,tf.W0)(t,i);if(!n)return;let s=t.state.doc.resolve(n.pos),r=(0,tL.PD)(s);if(!r)return;let o=(0,tX.os)(e,t.schema),{tr:l}=t.state,a=r.pos+1,d=a+r.node.content.size;l.delete(a,d).insert(a,o.content),t.view.dispatch(l)},[t,i]),l=(0,t$.wb)(o,200),[a,d]=(0,b.useState)(!1),{generate:c}=(0,tB.pt)("GenerateSpeakerNotes",{onStart(){d(!0),l("")},onContent(e){l(e)},onComplete(e){l(e),d(!1)},timeout:3e4}),u=(0,eu.CU)(),x=(0,b.useCallback)(async()=>{if(!n||!t||!i)return;let e=(0,tf.W0)(t,i);if(!e)return;let s=(0,tW.yO)(t,e.node);s.querySelectorAll("notes").forEach(e=>{var t;null==(t=e.parentElement)||t.removeChild(e)});let r=(0,tW._u)(s),o=(0,tU.$F)(),l=(0,tJ.ze)(t,e.pos),a=(0,tY.u)(u);await c({variables:{cardHtml:r,previous:l,outline:a},workspaceId:n.id}).promise,(0,tK.w)("generateCardNotes",n,o)},[c,n,t,i,u]);return{onClickGenerate:(0,tH.tO)(x,"generateCardNotes",tq.VV.GAMMA_UPSELL_CALLOUT_AI_CREDITS_GENERATE_CARD),isGenerating:a,canGenerateCardNotes:r&&s}},tQ=e=>{let{closePanel:t}=e,{editor:i}=(0,t5.mi)(),n=(0,eu.GV)(ex.nD),{cardId:o,canGoBack:d,canGoForward:c,title:h,goToNextCard:g,goToPreviousCard:j}=tN(i),{isInOfflineMode:f}=(0,E.u)();tG({editor:i,isReadonly:!n});let v=(0,ee.rd)(),b=v?"elevation.3":"white",y=v?"white":"gray.800",C=v?"gray.300":"gray.500",{onClickGenerate:w,isGenerating:k,canGenerateCardNotes:S}=tZ({editor:i,cardId:o});return(0,s.jsx)(q.L8,{isDark:v,children:(0,s.jsx)(t_.Z,{bgColor:b,"data-panelid":"card-notes-panel",color:y,children:(0,s.jsxs)(r.s,{direction:"column",h:"100%",flex:1,children:[(0,s.jsxs)(r.s,{px:6,py:4,children:[(0,s.jsx)(r.s,{flex:1,children:(0,s.jsxs)(e8.z,{spacing:4,children:[(0,s.jsx)(tO.N,{children:(0,s.jsx)(m.x6,{id:"1DBGsz"})}),n&&!f&&(0,s.jsx)(q.qT,{label:(0,s.jsx)(m.x6,{id:"qcPeK2"})})]})}),(0,s.jsx)(tS.J,{"data-card-notes-close-button":!0,onClick:t})]}),(0,s.jsxs)(tI.T,{px:6,pb:4,alignItems:"stretch",flex:1,overflowY:"hidden",spacing:4,"data-card-notes-bubble-menu-target":!0,children:[(0,s.jsxs)(e8.z,{align:"end",children:[(0,s.jsx)(l.E,{fontWeight:"600",color:C,wordBreak:"break-word",noOfLines:2,"data-testid":"card-notes-card-title",py:1,children:h}),(0,s.jsx)(tA.h,{}),S&&(0,s.jsx)(q.Tz,{label:(0,s.jsxs)(e8.z,{spacing:0,children:[(0,s.jsx)(m.x6,{id:"GyxUS3"}),(0,s.jsx)(tR.G,{type:"generateCardNotes"})]}),placement:"top",children:(0,s.jsx)(a.$,{variant:"ghost",onClick:w,isLoading:k,isDisabled:f,size:"sm","aria-label":p.Ru._({id:"ziAjHi"}),rightIcon:(0,s.jsx)(x.g,{icon:tT.p7g}),flexShrink:0,children:(0,s.jsx)(m.x6,{id:"ziAjHi"})})})]}),(0,s.jsx)(tD.z,{isEditable:n,isDark:v}),n&&(0,s.jsxs)(e8.z,{children:[(0,s.jsx)(q.Tz,{label:d?(0,s.jsx)(m.x6,{id:"cbqngJ"}):(0,s.jsx)(m.x6,{id:"4OtlnH"}),children:(0,s.jsx)(r.s,{flex:1,children:(0,s.jsx)(H.K,{"aria-label":d?p.Ru._({id:"cbqngJ"}):p.Ru._({id:"4OtlnH"}),icon:(0,s.jsx)(x.g,{icon:u.CeG}),onClick:j,isDisabled:!d,flex:1})})}),(0,s.jsx)(q.Tz,{label:c?(0,s.jsx)(m.x6,{id:"EyUKqu"}):(0,s.jsx)(m.x6,{id:"ggpGEd"}),children:(0,s.jsx)(r.s,{flex:1,children:(0,s.jsx)(H.K,{"aria-label":c?p.Ru._({id:"EyUKqu"}):p.Ru._({id:"ggpGEd"}),icon:(0,s.jsx)(x.g,{icon:u.dmS}),onClick:g,isDisabled:!c,flex:1})})})]})]})]})})})};tQ.panelPosition="right",tQ.panelName="card-notes";let t0=()=>{let{togglePanel:e,isPanelOpen:t}=(0,eY.ww)(tQ),{editor:i}=(0,tE.m)(),n=(0,eu.jL)(),s=(0,eu.GV)(ex.wC)===tv.w.SLIDE_VIEW;(0,b.useEffect)(()=>{t&&s&&e()},[t,e,s]),(0,b.useEffect)(()=>{!t&&i&&(n((0,tk.Yf)({isOpen:!1})),i.view.dispatch(i.state.tr))},[n,i,t,e]),(0,b.useEffect)(()=>{if(i)return tw.R.on("toggle",s=>{let{config:r,clickedCardId:o,activeNotesCardId:l}=s;t&&o!==l||(e(r),n((0,tk.Yf)({isOpen:!t})),i.view.dispatch(i.state.tr))})},[n,i,t,e])},t1="drag-in-progress",t6=()=>{(0,b.useEffect)(()=>{let e=()=>{document.body.classList.add(t1)},t=()=>{document.body.classList.remove(t1)};return document.body.addEventListener("dragstart",e,!0),document.body.addEventListener("dragend",t,!0),document.body.addEventListener("drop",t,!0),document.body.addEventListener("mouseup",t,!0),()=>{document.body.removeEventListener("dragstart",e,!0),document.body.removeEventListener("dragend",t,!0),document.body.removeEventListener("drop",t,!0),document.body.removeEventListener("mouseup",t,!0)}},[])};var t2=i(44630),t5=i(85607),t3=i(3276),t4=i(7756),t8=i(63902),t7=i(82957),t9=i(78116),ie=i(99743),it=i(57860),ii=i(15253),is=i(85732),ir=i(34807),io=i(49776),il=i(64084),ia=i(85684),id=i(30228),ic=i(59320),iu=i(71128),ix=i(36512);let ih=()=>{let e=(0,eZ.h5)({lg:100,xl:125,"2xl":150})||100,t=(0,eu.GV)(il.jF),i=null!==t?t:e;return{previewWidth:i,width:i+40,fontSize:i/ix.s5}};var im=i(43607),ip=i(22529),ig=i(55276);let ij=()=>{let e=(0,eu.GV)(ip.iG),t=(0,R.u)("filmstrip"),i=(0,eu.GV)(ig.wt),n=(0,im.UT)("comment"),s=(0,eu.GV)(ex.wC),r=(0,eu.GV)((0,e1.DP)("left")),o=(0,eu.GV)(te.C),l=i===t2.i.COLLABORATIVE||e;return t&&l&&(n||e)&&s===tv.w.DOC_VIEW&&!(0,O.Xb)()&&!r&&!o},iv=()=>{let e=(0,$.fW)(),t=(0,eY.t3)(),i=(0,eY.Wm)(),n=(0,eZ.h5)({base:!1,lg:!0,"3xl":t+i>0}),s=(0,eu.GV)(ex.cS),r=(0,eu.GV)(il.lh),o=ij(),l=(0,iu.Tq)(),a=(0,io.U)(),d=r&&o&&n,c=(0,ia.R)(),u=(0,ir.A)({base:"0px",[id.y3]:ic.iq})||"0px",{width:x}=ih();return(0,b.useMemo)(()=>{let n=d?"".concat(x,"px"):!a&&l.src&&"bottom-left"===l.position?"".concat(l.width+l.paddingX/2,"px"):"0px",r=s?u:c?"60px":"0px";return{"--doc-padding-left":e?r:n,"--doc-padding-right":e?n:r,"--present-padding-left":"".concat(t,"px"),"--present-padding-right":"".concat(i,"px"),"--comment-slide-margin":u}},[x,t,s,i,c,u,a,l,d,e])};var ib=i(83850);let iy=e=>"tablet"===e?"768px":"mobile"===e?(0,O.Xb)()?"100vw":"375px":"100vw",iC=e=>{let{loading:t,...i}=e,{editor:n,docId:l,previewSize:a}=i;return(0,s.jsxs)(t4.Tw,{children:[(0,s.jsx)("style",{id:"global-styles",dangerouslySetInnerHTML:{__html:ib.S.toString()}}),(0,s.jsx)(t8.Um,{children:(0,s.jsx)(r.s,{pos:"relative",justifyContent:"center",bg:"#C5C5C5",flex:1,children:!t&&n&&l?(0,s.jsx)(iw,{...i,editor:n,docId:l}):(0,s.jsx)(d.a,{flexDirection:"column",w:iy(a),h:"var(--100vh)",bg:"gray.50","data-testid":"preview-editor-loading",inset:0,children:(0,s.jsx)(U.o,{h:"100%",children:(0,s.jsx)(o.B,{align:"center",children:(0,s.jsx)(t3.y,{})})})})})})]})},iw=e=>{let{docId:t,editor:i,previewSize:n,onCreate:o}=e,l=(0,b.useMemo)(()=>(0,t7.C)().concat(t9.Q),[]),a=(0,b.useMemo)(()=>i.getJSON(),[i]),u="mobile"===n?"mobile":"desktop",x=(0,it.h)({async onCreate(e){let{editor:t}=e;console.debug("[SimpleEditor][onCreate] TipTap editor is now ready"),null==o||o({editor:t})},content:a,extensions:l,editable:!1});x.shouldUsePublishedVersion=!0;let{editorAnimationsClass:h,editorAnimationsCSSVars:m}=(0,tc.O)({editor:x,instanceId:u,scrollingParentSelector:".".concat(t2.v)}),p=(0,eu.GV)(tr.Gd),g=(0,eu.GV)(ex.SJ),j=(0,is.pg)(p),f=j?tx.kb:0,v=iy(n),y=iv();return(0,s.jsxs)(d.a,{className:(0,c.cx)("preview-editor-root",h),style:m,w:v,h:"100%",css:{...y,"--editor-width":v,"--doc-padding-top":"".concat(f,"px"),"--editor-padding-top":"".concat(50,"px")},position:"relative",shadow:"xl",children:[p&&j&&(0,s.jsx)(r.s,{pos:"absolute",top:0,left:0,w:"100%",zIndex:"10",children:(0,s.jsx)(ie._,{theme:g,editable:!1,content:p.navContent},"".concat(t,"__preview-editor-nav__").concat(u,"}"))}),(0,s.jsx)(ii.N,{editor:x},"".concat(t,"__preview-editor__").concat(u,"}"))]})};var ik=i(88586);let iE=()=>{let e=(0,eu.GV)(tr.Gd),t=(0,eu.GV)(ex.SJ),i=(0,eu.CU)(),[n]=(0,ik.vlJ)(),o=(0,b.useCallback)(async e=>{var t;let{editor:s}=e,r=null==(t=(0,tr.Gd)(i.getState()))?void 0:t.id;r&&await n({variables:{input:{siteId:r,navContent:s.state.doc.toJSON()}}})},[n,i]),l=(0,t$.lW)(o,500);return e?(0,s.jsx)(r.s,{pos:"absolute",top:0,left:0,w:"100%",zIndex:e$.$.siteNav,children:(0,s.jsx)(ie._,{theme:t,onUpdate:l,content:e.navContent,editable:!0,scrollingParentSelector:".".concat(t2.v)})}):null};var iS=i(2942),iI=i(46898),iA=i(68068),iT=i(60628),iR=i(17920),i_=i(3674),iO=i(40691),iD=i(96500),iP=i(64268),iz=i(51504),iM=i(97481),iL=i.n(iM),iN=i(22445),iF=i(27828),iV=i(17789),iG=i(74945);let iW={title:(0,s.jsx)(m.x6,{id:"DD5mqk"}),description:(0,s.jsx)(m.x6,{id:"8BmWcz"}),status:"error",position:"top",isClosable:!0},iB=e=>{let{doc:t,site:i,path:n}=e,r=(0,iI.d)(),o=(0,eu.jL)(),c=(0,eu.GV)(tr.aK),h=(0,iG.rB)(),[p]=(0,iV.b0Z)(),[g]=(0,iV.w$N)(),[j]=(0,iV._Su)(),f=(0,eu.GV)(tr.le),v=null==t?void 0:t.id,y=(0,ta.jY)({site:i,path:(0,ta.wK)(n)}),C=null==i?void 0:i.id,w=(0,b.useCallback)(async()=>{if(v){if(h)return void r(iW);(0,tr.wb)(o)(!0),await (0,ta.fb)(v),await g({variables:{id:v},refetchQueries:["GetDoc","GetSite"]}).then(()=>{r({render:function(){return(0,s.jsx)(d.a,{color:"white",p:3,bg:"green.500",shadow:"md",borderRadius:"md",children:(0,s.jsxs)(e8.z,{spacing:4,children:[(0,s.jsx)(d.a,{children:(0,s.jsx)(x.g,{icon:u.QRE})}),(0,s.jsx)(l.E,{fontWeight:"semibold",children:(0,s.jsx)(m.x6,{id:"V6Byuz"})}),y&&(0,s.jsx)(a.$,{variant:"plain",as:"a",target:"_blank",_hover:{textDecoration:"none",color:"trueblue.500"},href:y,rightIcon:(0,s.jsx)(x.g,{icon:u.Ju_}),children:(0,s.jsx)(m.x6,{id:"Zel0o2"})}),(0,s.jsx)(tS.J,{onClick:()=>r.closeAll()})]})})},status:"success",position:"top",duration:5e3,isClosable:!0})}).catch(e=>{r({title:(0,s.jsx)(m.x6,{id:"DD5mqk"}),status:"error",position:"top",isClosable:!0}),console.error("Error publishing site:",e.message)}).finally(()=>{(0,tr.wb)(o)(!1)})}},[o,v,h,g,r,y]);return{publishSite:(0,b.useCallback)(async()=>{if(C){if(h)return void r(iW);(0,tr.wb)(o)(!0),f&&await (0,ta.fb)(f),await p({variables:{id:C},update:(e,t)=>{let{data:i}=t,n=null==i?void 0:i.publishSite;n&&n.routes.forEach(t=>{e.updateQuery({query:iV.iVk,variables:{id:t.docId}},e=>{var i,n,s;return(e||console.log("%c Publish doc _data is undefined or null","color: red; font-size: 16px"),null==e?void 0:e.doc)?{doc:{...e.doc,publishedTime:null==(i=t.doc)?void 0:i.publishedTime,publishedSnapshotId:null==(n=t.doc)?void 0:n.publishedSnapshotId,currentSnapshotId:null==(s=t.doc)?void 0:s.currentSnapshotId}}:e})})}}).then(()=>{r({render:function(){return(0,s.jsx)(d.a,{color:"white",p:3,bg:"green.500",shadow:"md",borderRadius:"md",children:(0,s.jsxs)(e8.z,{spacing:4,children:[(0,s.jsx)(d.a,{children:(0,s.jsx)(x.g,{icon:u.QRE})}),(0,s.jsx)(l.E,{fontWeight:"semibold",children:(0,s.jsx)(m.x6,{id:"V6Byuz"})}),y&&(0,s.jsx)(a.$,{variant:"plain",as:"a",target:"_blank",_hover:{textDecoration:"none",color:"trueblue.500"},href:y,rightIcon:(0,s.jsx)(x.g,{icon:u.Ju_}),children:(0,s.jsx)(m.x6,{id:"Zel0o2"})}),(0,s.jsx)(tS.J,{onClick:()=>r.closeAll()})]})})},status:"success",position:"top",duration:5e3,isClosable:!0})}).catch(e=>{r({title:(0,s.jsx)(m.x6,{id:"DD5mqk"}),description:(0,s.jsx)(m.x6,{id:"R4PZ4k"}),status:"error",position:"top",isClosable:!0}),console.error("Error publishing site:",e.message)}).finally(()=>{(0,tr.wb)(o)(!1)})}},[C,h,o,f,p,r,y]),publishDoc:w,isPublishing:c}};var iU=i(14900);let iH=e=>{var t;let{site:i}=e,n=null==i||null==(t=i.currentDeployment)?void 0:t.deploymentTime,r=(0,b.useMemo)(()=>({fromNow:(0,iU.Gx)(n),calendar:(0,iU.Yq)(n,"PPpp")}),[n]);return(0,s.jsx)(m.x6,{id:"ay/UB+",values:{0:r.fromNow},components:{0:(0,s.jsx)(q.Tz,{label:r.calendar,placement:"top",shouldWrapChildren:!0}),1:(0,s.jsx)(l.E,{as:"span",cursor:"pointer",style:{textDecoration:"underline"}})}})},iK=e=>{let t=(0,eu.GV)(tr.Gd),i=(0,ta.m8)(t),n=!(0,ta.dv)(t),r=(0,eu.GV)(tr.Tx),o=(0,eu.GV)(tr.vP),{icon:l,text:a,color:d}=(0,b.useCallback)(()=>e?{icon:(0,s.jsx)(x.g,{icon:u.z1G,height:13,width:13}),text:(0,s.jsx)(m.x6,{id:"mkk40+"}),color:"gray.500"}:n?{icon:(0,s.jsx)(x.g,{icon:u.DW4,height:13,width:13}),text:(0,s.jsx)(m.x6,{id:"r5OY1d"}),color:"gray.500"}:i?r>0||o?{icon:(0,s.jsx)(x.g,{icon:u.ijf,height:13,width:13}),text:(0,s.jsx)(m.x6,{id:"eVV2pl"}),color:"orange.500"}:{icon:(0,s.jsx)(x.g,{icon:u.vBH,height:13,width:13}),text:(0,s.jsx)(m.x6,{id:"Rgbxkx"}),color:"green.500"}:{icon:(0,s.jsx)(x.g,{icon:u.Bwz,height:13,width:13}),text:(0,s.jsx)(m.x6,{id:"tpB6bH"}),color:"gray.600"},[e,n,i,r,o])(),c=e?null:n?(0,s.jsx)(m.x6,{id:"u8Rqhk"}):!1===i||r>0||o?(0,s.jsx)(m.x6,{id:"Ys0XoA"}):null,h=!1===n&&!e;return{statusText:a,statusIcon:l,statusColor:d,detailText:c,needsPublish:!i||o||r>0,lastPublishedTime:t?(0,s.jsx)(iH,{site:t}):null,publishEnabled:h}},iq=()=>{let e=(0,eu.GV)(tr.Gd),t=(0,iG.Gx)(),{publishSite:i,isPublishing:n}=iB({site:e}),{needsPublish:r,publishEnabled:c,statusColor:h,statusIcon:p,statusText:g}=iK(n),j=(0,V.dU)(!1,!0);return t&&e&&(0,ta.dv)(e)?(0,s.jsx)(iF.m,{px:0,minH:4,children:(0,s.jsxs)(o.B,{w:"100%",bg:j?"gray.700":"gray.50",borderRadius:"md",p:4,align:"center",direction:"row",spacing:1,children:[(0,s.jsxs)(e8.z,{alignItems:"start",children:[(0,s.jsx)(d.a,{color:h,children:p}),(0,s.jsxs)(tI.T,{spacing:0,color:j?"gray.200":void 0,textAlign:"left",align:"start",children:[(0,s.jsx)(l.E,{fontWeight:"500",fontSize:"sm",color:h,children:g}),(0,s.jsx)(l.E,{color:"gray.500",fontSize:"xs",children:(0,s.jsx)(iH,{site:e})})]})]}),(0,s.jsx)(tA.h,{}),(0,s.jsx)(a.$,{flexShrink:"0",size:"sm",variant:r?"solid":"plain",leftIcon:(0,s.jsx)(x.g,{icon:u.MNJ}),isDisabled:!c,onClick:i,isLoading:n,children:(0,s.jsx)(m.x6,{id:"EEYbdt"})})]})}):null};var iY=i(81664),iJ=i(80314),iX=i(96441),i$=i(38907),iZ=i(38036),iQ=i(20845),i0=i(89942),i1=i(67909),i6=i(36071),i2=i(54731),i5=i(31090),i3=i(16426);let i4=e=>{let{onClose:t,domainName:i,onDelete:n,isDeleting:r}=e,c=[{icon:u.Ubr,color:"red.500",text:(0,s.jsx)(m.x6,{id:"1qESbF"})},{icon:u.Ubr,color:"red.500",text:(0,s.jsx)(m.x6,{id:"GkV7CV"})},{icon:u.e68,color:"green.500",text:(0,s.jsx)(m.x6,{id:"Gf+uYk",values:{GAMMA_PROPER_NOUN:ej.On}})},{icon:u.e68,color:"green.500",text:(0,s.jsx)(m.x6,{id:"Tvl9G3"})}],h="string"==typeof i&&(0,s.jsx)(iJ.N,{href:(0,ta.bO)({domain:{name:i}}),target:"_blank",color:"deepocean.600",textDecoration:"underline",children:i});return(0,s.jsxs)(i1.aF,{isOpen:!0,onClose:t,trapFocus:!1,size:"xl",isCentered:!0,closeOnOverlayClick:!1,children:[(0,s.jsx)(i6.m,{}),(0,s.jsxs)(i2.$,{children:[(0,s.jsx)(iR.r,{children:(0,s.jsx)(o.B,{spacing:0,children:(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"KgOxk4"})})})}),(0,s.jsx)(iO.c,{children:(0,s.jsxs)(o.B,{spacing:4,children:[(0,s.jsx)(i5.B8,{spacing:2,alignItems:"center",bg:"sky.50",p:4,rounded:"lg",children:c.map((e,t)=>{let{icon:i,color:n,text:r}=e;return(0,s.jsxs)(i5.ck,{display:"flex",flexDirection:"row",gap:2,alignItems:"center",children:[(0,s.jsx)(d.a,{color:n,children:(0,s.jsx)(x.g,{icon:i,size:"xs"})}),(0,s.jsx)(l.E,{children:r})]},t)})}),(0,s.jsx)(l.E,{children:h?(0,s.jsx)(m.x6,{id:"WOQUJu",values:{domainLink:h}}):(0,s.jsx)(m.x6,{id:"BEnwMG"})})]})}),(0,s.jsx)(i3.j,{children:(0,s.jsxs)(e7.e,{children:[(0,s.jsx)(a.$,{isDisabled:r,variant:"ghost",colorScheme:"gray",onClick:t,children:(0,s.jsx)(m.x6,{id:"dEgA5A"})}),(0,s.jsx)(a.$,{variant:"hazardous",isLoading:r,onClick:n,loadingText:p.Ru._({id:"EF2EU9"}),children:(0,s.jsx)(m.x6,{id:"t/YqKh"})})]})})]})]})};var i8=i(74676),i7=i(41974),i9=i(76461),ne=i(22832);let nt=e=>{let{code:t,data:i}=e;switch(t){case ik.sYx.AddARecord:return(0,s.jsx)(m.x6,{id:"ZIfa5n",values:{0:i.ip},components:{0:(0,s.jsx)("strong",{}),1:(0,s.jsx)(ne.C,{})}});case ik.sYx.AddCnameRecordSubdomain:return(0,s.jsx)(m.x6,{id:"edcjuc",values:{0:i.subdomain,1:i.cnameDomain},components:{0:(0,s.jsx)("strong",{}),1:(0,s.jsx)(ne.C,{}),2:(0,s.jsx)(ne.C,{})}});case ik.sYx.EditCnameRecordSubdomain:return(0,s.jsx)(m.x6,{id:"ngCUo8",values:{0:i.subdomain,1:i.cnameDomain},components:{0:(0,s.jsx)(ne.C,{}),1:(0,s.jsx)("strong",{}),2:(0,s.jsx)(ne.C,{})}});case ik.sYx.RemoveARecord:return(0,s.jsx)(m.x6,{id:"GLzRh5",values:{0:i.ip},components:{0:(0,s.jsx)("strong",{}),1:(0,s.jsx)(ne.C,{})}});case ik.sYx.RemoveAaaaRecord:return(0,s.jsx)(m.x6,{id:"g1KLfp",values:{0:i.ip},components:{0:(0,s.jsx)("strong",{}),1:(0,s.jsx)(ne.C,{})}});case ik.sYx.AddCnameRecordWww:return(0,s.jsx)(m.x6,{id:"Hb2/CF",values:{0:i.cnameDomain},components:{0:(0,s.jsx)("strong",{}),1:(0,s.jsx)(ne.C,{})}});case ik.sYx.EditCnameRecordWww:return(0,s.jsx)(m.x6,{id:"LmV2TD",values:{0:i.cnameDomain},components:{0:(0,s.jsx)(ne.C,{}),1:(0,s.jsx)("strong",{}),2:(0,s.jsx)(ne.C,{})}});case ik.sYx.ContactGammaSupport:return(0,s.jsx)(m.x6,{id:"Wr1wrv",values:{GAMMA_PROPER_NOUN:ej.On}});case ik.sYx.SslModeFullCloudflare:return(0,s.jsx)(m.x6,{id:"D61i6v"});case ik.sYx.CheckDnsCloudflare:return(0,s.jsx)(m.x6,{id:"gYfbYc"})}return(0,s.jsx)(s.Fragment,{})};var ni=i(67604),nn=i(63111);let ns=e=>{let t=(0,ni.A)(e),i=new Date;return 30>=Math.abs((0,nn.A)(i,t))},nr=e=>{var t,i,n;let{domain:s}=e,[r,o]=(0,b.useState)(!1),l=(0,b.useRef)(null),{data:a}=(0,iV.SmF)({variables:{name:s.name},skip:s.builtin||"failed"===s.status}),d=!!((null==a?void 0:a.checkDomain)&&(null==(t=a.checkDomain.actions)?void 0:t.length)&&(null==(n=a.checkDomain)||null==(i=n.dns)?void 0:i.status)!==ik.mXm.Ok);return(0,b.useEffect)(()=>{let{createdTime:e,setupMethod:t}=s;if(!("string"==typeof e&&d&&(t===ik.hbC.Automatic||t===ik.hbC.Purchase)))return void o(!1);let i=ns(e);if(o(i),i)return l.current=setInterval(()=>{let t=ns(e);if(o(t),!t){o(!1),l.current&&(clearInterval(l.current),l.current=null);return}},3e5),()=>{l.current&&clearInterval(l.current)}},[s,d]),(0,b.useMemo)(()=>{var e;return{showDNSIssues:d&&!r,checkDomainActions:(null==a||null==(e=a.checkDomain)?void 0:e.actions)||[]}},[d,r,a])};var no=i(78140),nl=i(36999),na=i(41283),nd=i(85595);let nc=e=>{let{domain:t,numDomains:i,onDomainSetupClick:n,onEditBuiltInDomainNameModalOpen:r,onSetPreferredDomainClick:o,onDeleteClick:a}=e,d=(0,R.u)("siteIndexingUi"),c=!t.builtin&&("verified"!==t.status||"verified"===t.status&&i>1),h=t.canonical&&d;return(0,s.jsxs)(no.W,{placement:"bottom-end",children:[(0,s.jsx)(nl.I,{as:H.K,"aria-label":p.Ru._({id:"0GlsS5"}),size:"sm",variant:"ghost",colorScheme:"blackAlpha",icon:(0,s.jsx)(x.g,{icon:u.Dwc})}),(0,s.jsxs)(na.c,{children:[!t.builtin&&(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:u.dB,fixedWidth:!0}),onClick:()=>n(t.name),children:(0,s.jsx)(m.x6,{id:"Nn7vhd"})}),t.builtin&&(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:u.MT7,fixedWidth:!0}),onClick:r,children:(0,s.jsx)(m.x6,{id:"VMKg48"})}),d&&!t.canonical&&(0,s.jsxs)(nd.D,{icon:(0,s.jsx)(x.g,{icon:u.s6x,fixedWidth:!0}),onClick:()=>o(t.id),alignItems:"baseline",children:[(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"AZUBKO"})}),(0,s.jsx)(l.E,{fontSize:"sm",color:"gray.500",maxW:"220px",children:(0,s.jsx)(m.x6,{id:"8nEUqj"})})]}),c&&(0,s.jsx)(q.Tz,{label:t.canonical&&d&&"Set another domain as preferred first",placement:"top",shouldWrapChildren:!0,children:(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:u.vev,fixedWidth:!0}),color:h?"red.300":"red.500",onClick:()=>{h||a(t.id)},disabled:h,children:(0,s.jsx)(m.x6,{id:"CKbh5n"})})})]})]})};var nu=i(83638),nx=i(25223),nh=i(35605);let nm=e=>{let{isOpen:t,onClose:i,domain:n,siteId:r}=e,o=(0,iI.d)(),d=null==n?void 0:n.name,c=null==d?void 0:d.split(".")[0].split("-").slice(-1)[0],[u,x]=(0,b.useState)(null==d?void 0:d.split(".")[0].split("-").slice(0,-1).join("-")),h=null==d?void 0:d.split(".").slice(1).join("."),[g,{loading:j}]=(0,ik.g1r)(),f=(0,b.useCallback)(()=>{g({variables:{input:{siteId:r,name:u}}}).then(()=>{o({title:(0,s.jsx)(m.x6,{id:"oMgC5V"}),description:(0,s.jsx)(m.x6,{id:"tIBLtD"}),duration:3e3,position:"top",isClosable:!1,status:"success"}),i()}).catch(e=>{o({title:(0,s.jsx)(m.x6,{id:"YoFYYT"}),description:(0,s.jsx)(m.x6,{id:"Wd0ucu"}),duration:3e3,position:"top",isClosable:!1,status:"error"}),console.error("[BuiltInDomainEditModal] Failed to change domain name:",e)})},[g,r,u,o,i]);return(0,s.jsxs)(i1.aF,{isOpen:t,onClose:i,size:"md",closeOnOverlayClick:!1,children:[(0,s.jsx)(i6.m,{}),(0,s.jsxs)(i2.$,{children:[(0,s.jsx)(iR.r,{children:(0,s.jsx)(m.x6,{id:"VMKg48"})}),(0,s.jsx)(i_.s,{}),(0,s.jsx)(iO.c,{children:(0,s.jsxs)(nu.MJ,{children:[(0,s.jsxs)(e8.z,{children:[(0,s.jsx)(iZ.p,{value:u,onKeyDown:e=>{"Enter"===e.key&&f()},onChange:e=>{x((0,nh.Fw)(e.target.value))},placeholder:p.Ru._({id:"dcSbw0"})}),(0,s.jsxs)(nx.l,{whiteSpace:"nowrap",children:["-",c,".",h]})]}),(0,s.jsx)(nu.eK,{lineHeight:"normal",children:(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"bvN4Vx"})})})]})}),(0,s.jsxs)(i3.j,{children:[(0,s.jsx)(a.$,{onClick:i,mr:3,variant:"ghost",children:(0,s.jsx)(m.x6,{id:"dEgA5A"})}),(0,s.jsx)(a.$,{variant:"solid",onClick:f,isLoading:j,isDisabled:u.length<3,children:(0,s.jsx)(m.x6,{id:"tfDRzk"})})]})]})]})},np={pending:{tooltip:(0,s.jsx)(m.x6,{id:"/BjVEU"}),badgeText:(0,s.jsx)(m.x6,{id:"bl9677"}),badgeColorScheme:"yellow"},failed:{tooltip:(0,s.jsx)(m.x6,{id:"7Bj3x9"}),badgeText:(0,s.jsx)(m.x6,{id:"7Bj3x9"}),badgeColorScheme:"red"}},ng=e=>{let{status:t,onClick:i}=e;if("verified"===t)return null;let{tooltip:n,badgeText:r,badgeColorScheme:o}=np[t];return(0,s.jsx)(q.Tz,{label:n,placement:"top",children:(0,s.jsx)(i8.E,{display:"flex",justifyContent:"center",colorScheme:o,cursor:i?"pointer":"default",onClick:i||void 0,children:r})})},nj=e=>{let{domain:t,onDomainSetupClick:i,path:n,onDeleteClick:r,siteId:c,numDomains:h}=e,p=(0,R.u)("siteIndexingUi"),[g]=(0,ik.Zfy)(),j=(0,ta.bO)({domain:t,path:n}),f=(0,iI.d)(),[v]=(0,ik.MyE)(),{checkDomainActions:y,showDNSIssues:C}=nr({domain:t}),w=(0,b.useCallback)(async()=>{await v({variables:{id:t.id}}),f({title:(0,s.jsx)(m.x6,{id:"LIAJwx"}),status:"success",duration:3e3,position:"top",isClosable:!0})},[v,t.id,f]),k=(0,b.useCallback)(e=>{e&&g({variables:{id:e}})},[g]),{isOpen:E,onOpen:S,onClose:I}=(0,ez.j)({id:"edit-domain-modal"});return(0,s.jsxs)(i7.Z,{variant:"outline",children:[(0,s.jsx)(i9.b,{children:(0,s.jsxs)(o.B,{direction:"row",alignItems:"baseline",children:[(0,s.jsx)(d.a,{children:(0,s.jsx)(x.g,{icon:u.Bwz})}),(0,s.jsxs)(o.B,{spacing:1,w:"100%",children:[(0,s.jsxs)(e8.z,{children:[(0,s.jsx)(o.B,{children:"verified"===t.status?(0,s.jsx)(q.Tz,{label:j,placement:"top",children:(0,s.jsx)(a.$,{as:iJ.N,variant:"link",href:j,wordBreak:"break-all",target:"_blank",rightIcon:(0,s.jsx)(d.a,{ms:2,children:(0,s.jsx)(x.g,{icon:tT.Ju_,size:"xs"})}),whiteSpace:"normal",children:t.name})}):(0,s.jsx)(l.E,{children:t.name})}),(0,s.jsx)(tA.h,{}),(0,s.jsx)(e8.z,{children:(0,s.jsx)(ng,{status:t.status,onClick:"failed"===t.status?w:null})}),(0,s.jsx)(nc,{domain:t,numDomains:h,onDomainSetupClick:i,onEditBuiltInDomainNameModalOpen:S,onSetPreferredDomainClick:k,onDeleteClick:r})]}),p&&t.canonical&&(0,s.jsx)(i8.E,{colorScheme:"gray",w:"fit-content",children:(0,s.jsx)(m.x6,{id:"lEMup4"})}),C&&(0,s.jsxs)(o.B,{spacing:2,fontSize:"xs",color:"gray.500",children:[(0,s.jsxs)(l.E,{children:[(0,s.jsx)(m.x6,{id:"ezr3/E"})," "]}),(0,s.jsx)(i5.Xy,{ps:"0",spacing:"2",children:y.map((e,t)=>(0,s.jsx)(i5.ck,{sx:{code:{fontSize:"xxs",bg:"gray.50",color:"gray.700"}},children:nt(e)},e.code+t))})]})]})]})}),(0,s.jsx)(nm,{isOpen:E,onClose:I,domain:t,siteId:c})]})};var nf=i(73110),nv=i(42721);let nb=()=>{let e=(0,b.useRef)(!1),[t,i]=(0,b.useState)(()=>void 0!==window.entri);return(0,t$.nW)("https://cdn.goentri.com/entri.js",{predicate:()=>void 0===window.entri,onload:()=>{i(!0),e.current=!0}}),{entriReady:t}};var ny=i(37219);let nC=async()=>{if(!window.entri)throw Error("Entri not found");return fetch("/api/domains/connectToken").then(e=>e.json()).then(e=>{if(!e.auth_token)throw Error("No auth token returned");return e.auth_token})},nw=async e=>{let{firstName:t,lastName:i,email:n,locale:s}=e,r=await nC();if(!window.entri)throw Error("Entri not found");let{dnsRecords:o}=(0,ta.oX)(""),l={applicationId:"gamma",applicationName:"Gamma",token:r,dnsRecords:o,sellVersion:"v3",locale:s,whiteLabel:{theme:{primary:"#dcebfd",onPrimary:"#262527",secondary:"#0540ad",onSecondary:"#ffffff",headerBackground:"#dcebfd",interactive:"#0540ad",premiumBadge:"#fee9fb",onPremiumBadge:"#b71f97",priceBadge:"#e2f7e1",onPriceBadge:"#1a561c",activating:"#0540ad",onActivating:"#ffffff"},sell:{flowTarget:"_blank",overlayScreenHeight:"60%",partnerName:"Gamma",partnerLogo:ny.Yd,partnerIcon:ny.Uf,contact:{firstName:t,lastName:i,email:n}}}};return console.log("[launchEntri] Purchasing Entri with config",l),window.entri.purchaseDomain(l),nE()},nk=async(e,t)=>{let i=await nC(),{domain:n,dnsRecords:s,isRootDomain:r,subdomain:o}=(0,ta.oX)(e),l={applicationId:"gamma",token:i,prefilledDomain:n,dnsRecords:s,locale:t,...!r&&{defaultSubdomain:o,forceSubdomain:!0}};return console.log("[launchEntri] Launching Entri with config",l),window.entri.showEntri(l),nE()},nE=()=>new Promise((e,t)=>{let i=n=>{if(window.removeEventListener("onEntriClose",i),n.detail.success)e(n.detail);else{var s,r;let e=null==n||null==(s=n.detail)?void 0:s.error;if(!e||(null==(r=e.details)?void 0:r.includes("Please refresh")))return t();let i=e.title||"",o=e.details||"",l=i&&o?": ":"";t("".concat(i).concat(l).concat(o).trim()||void 0)}};window.addEventListener("onEntriClose",i,!1)}),nS=e=>{let{siteId:t}=e,i=(0,Q.st)(),{user:n}=(0,nv.ur)(),r=(0,nf.O)(),{entriReady:o}=nb(),l=(0,iI.d)(),[d,c]=(0,b.useState)(!1),[u,{loading:x}]=(0,ik.yuV)(),h=(0,b.useCallback)(async()=>{t&&(c(!0),nw({firstName:(null==n?void 0:n.firstName)||"",lastName:(null==n?void 0:n.lastName)||"",email:(null==n?void 0:n.email)||"",locale:r}).then(e=>{if(e&&"purchase"===e.setupType&&e.domain){let n=e.domain;null==i||i.track(Q.VV.SITE_DOMAIN_PURCHASED,{domain:n,siteId:t}),u({variables:{input:{name:n,siteId:t,method:ik.hbC.Purchase}}}).then(()=>{null==i||i.track(Q.VV.SITE_DOMAIN_ADDED,{domain:n,siteId:t,source:"entriSell"}),l({title:(0,s.jsx)(m.x6,{id:"5Ae0kE"}),description:(0,s.jsx)(m.x6,{id:"HqV46b"}),status:"success",duration:3e3,isClosable:!0,position:"top"})}).catch(e=>{console.error("[DomainListWrapper] error adding domain error",e),l({title:(0,s.jsx)(m.x6,{id:"JXFM3z"}),description:(null==e?void 0:e.message)&&e.message,status:"error",duration:null,position:"top",isClosable:!0})})}}).catch(e=>{console.error("[DomainListWrapper] entriPurchaseDomain error",e),l({title:e?(0,s.jsx)(m.x6,{id:"JXFM3z"}):(0,s.jsx)(m.x6,{id:"vr6nIz"}),description:e||void 0,status:"error",duration:e?null:3e3,position:"top",isClosable:!0})}).finally(()=>{c(!1)}))},[u,i,t,l,n,r]);return t?(0,s.jsx)(a.$,{variant:"outline",size:"md",onClick:h,isLoading:d,isDisabled:!o,children:(0,s.jsx)(m.x6,{id:"b2BZV7"})}):null},nI=e=>{let{isOpen:t,onClose:i,domainName:n,onTransferConfirm:r,onTransferCancel:d,domainToTransfer:c,isTransferring:u}=e,x=(0,b.useCallback)(()=>{d(),i()},[i,d]),h=(0,b.useCallback)(async()=>{r(),i()},[i,r]);return c?(0,s.jsx)(q.L8,{isDark:!1,children:(0,s.jsxs)(i1.aF,{isOpen:t,onClose:x,size:"lg",children:[(0,s.jsx)(i6.m,{}),(0,s.jsxs)(i2.$,{children:[(0,s.jsx)(iR.r,{children:(0,s.jsx)(m.x6,{id:"hqplvI"})}),(0,s.jsx)(i_.s,{}),(0,s.jsx)(iO.c,{children:(0,s.jsxs)(o.B,{spacing:2,children:[(0,s.jsx)(l.E,{children:c.siteArchived?(0,s.jsx)(m.x6,{id:"SeHn75",values:{domainName:n,0:c.siteName}}):(0,s.jsx)(m.x6,{id:"tX38ij",values:{domainName:n,0:c.siteName}})}),(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"rKH6wM"})})]})}),(0,s.jsxs)(i3.j,{children:[(0,s.jsx)(a.$,{variant:"ghost",mr:3,onClick:x,children:(0,s.jsx)(m.x6,{id:"yz7wBu"})}),(0,s.jsx)(a.$,{isLoading:u,variant:"hazardous",onClick:h,children:(0,s.jsx)(m.x6,{id:"vTZxnA"})})]})]})]})}):(0,s.jsx)(s.Fragment,{})},nA=e=>{var t;let{site:i,path:n,onDomainSetupClick:r,onAddDomain:d,isAddingDomain:c,refetchSites:u}=e,x=(0,iI.d)(),{currentWorkspace:h}=(0,et.ur)(),[g,j]=(0,b.useState)(),[f,v]=(0,b.useState)(),[y,C]=(0,b.useState)(""),{isOpen:w,onOpen:k,onClose:E}=(0,ez.j)({id:"delete-domain-modal"}),{isOpen:S,onOpen:I,onClose:A}=(0,iN.E)({id:"transferDomainModal"}),[T,{loading:R}]=(0,ik.D3l)({fetchPolicy:"network-only",nextFetchPolicy:"network-only"}),_=i.domains.find(e=>e.id===g),O=(0,ta.zC)(y)&&void 0===i.domains.find(e=>e.name===y),[D,{loading:P}]=(0,ik.InM)(),[z,{loading:M}]=(0,ik.OyM)(),[L,N]=(0,b.useState)(void 0),F=(0,b.useCallback)(async e=>{var t;let n=await T({variables:{name:e,workspaceId:null==h?void 0:h.id}}),s=null==n||null==(t=n.data)?void 0:t.domains,r=null==s?void 0:s[0];if(i&&r){v(r),I();return}d(e),v(void 0),C("")},[null==h?void 0:h.id,T,d,I,i]);(0,t$.Vg)(()=>{g?N(null==_?void 0:_.name):N(void 0)},[g,null==_?void 0:_.name],[g]);let V=(0,b.useCallback)(()=>{E(),j(()=>void 0)},[E]),G=(0,b.useCallback)(async()=>{_&&(await D({variables:{id:g}}),await u(),x({title:(0,s.jsx)(m.x6,{id:"V4fbcv",values:{0:_.name}}),status:"success",duration:3e3,position:"top",isClosable:!0}),V())},[u,D,g,_,V,x]),W=(0,i0.ez)("custom_domains"),B=(0,ta.H3)(i.domains),U=(0,b.useCallback)(()=>{v(void 0)},[]),H=(0,b.useCallback)(async()=>{f&&(await z({variables:{id:null==f?void 0:f.id,siteId:i.id},refetchQueries:["GetSite"]}),x({title:(0,s.jsx)(m.x6,{id:"dHhDGG",values:{0:f.name}}),position:"top",status:"success",duration:5e3}),C(""),v(void 0))},[f,i.id,x,z]);return(0,s.jsxs)(o.B,{spacing:8,p:2,children:[(0,s.jsxs)(o.B,{spacing:2,children:[(0,s.jsx)(m.x6,{id:"aCOtCt"}),B.map(e=>(0,s.jsx)(nj,{domain:e,onDomainSetupClick:r,path:n,onDeleteClick:e=>{j(e),k()},numDomains:i.domains.length||0,siteId:i.id},e.id))]}),W&&(0,s.jsxs)(o.B,{spacing:4,mb:2,children:[(0,s.jsxs)(o.B,{children:[(0,s.jsx)(l.E,{fontSize:"md",children:(0,s.jsx)(m.x6,{id:"1y9z1r"})}),(0,s.jsx)(nS,{siteId:null==i?void 0:i.id})]}),(0,s.jsxs)(o.B,{children:[(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"DiyKLs"})}),(0,s.jsxs)(e8.z,{children:[(0,s.jsx)(iZ.p,{bg:"white",placeholder:(null==i||null==(t=i.domains)?void 0:t.length)?p.Ru._({id:"jt/2Ky"}):p.Ru._({id:"1y9z1r"}),value:y,onChange:e=>C(e.target.value),onKeyDown:e=>{"Enter"===e.key&&O&&(e.preventDefault(),F(y))}}),(0,s.jsx)(o.B,{children:(0,s.jsx)(q.Tz,{label:(0,s.jsx)(m.x6,{id:"aUB5ST"}),placement:"top",shouldWrapChildren:!0,isDisabled:O,children:(0,s.jsx)(a.$,{isDisabled:!O,variant:"plain",onClick:()=>{F(y)},isLoading:c||R,children:(0,s.jsx)(m.x6,{id:"EdEpYN"})})})})]})]})]}),!W&&(0,s.jsx)(iQ.c,{segmentEvent:Q.VV.GAMMA_PRO_UPSELL_DOMAINS,title:(0,s.jsx)(m.x6,{id:"m6aLo0"}),description:(0,s.jsx)(m.x6,{id:"xFELnF",values:{GAMMA_PRO_PROPER_NOUN:ej.Ol,GAMMA_PROPER_NOUN:ej.On}}),targetFeature:"custom_domains"}),w&&(0,s.jsx)(i4,{onClose:V,onDelete:G,domainName:L,isDeleting:P}),(0,s.jsx)(nI,{isOpen:S,onClose:A,onTransferCancel:U,domainName:y,domainToTransfer:f,onTransferConfirm:H,isTransferring:M})]})};var nT=i(41960),nR=i(42706),n_=i(29768),nO=i(59142),nD=i(54920),nP=i(92130),nz=i(55452),nM=i(3509);let nL=e=>{let{isOpen:t,onClose:i,domainName:n,onDomainConfirmed:d}=e,[c,h]=(0,b.useState)("initial"),p=(0,nf.O)(),{entriReady:g}=nb(),[j,f]=(0,b.useState)(!1),v=(0,iI.d)(),{dnsRecords:y,isRootDomain:C,subdomain:w}=(0,b.useMemo)(()=>(0,ta.oX)(n||""),[n]);return(0,s.jsx)(q.L8,{isDark:!1,children:(0,s.jsxs)(i1.aF,{isOpen:t,onClose:i,size:"3xl",trapFocus:!1,children:[(0,s.jsx)(i6.m,{}),(0,s.jsxs)(i2.$,{children:[(0,s.jsx)(iR.r,{children:(0,s.jsx)(m.x6,{id:"YSyDVG",values:{domainName:n,GAMMA_PROPER_NOUN:ej.On}})}),(0,s.jsx)(i_.s,{}),(0,s.jsxs)(iO.c,{children:["initial"===c&&(0,s.jsx)(i7.Z,{variant:"filled",children:(0,s.jsx)(i9.b,{children:(0,s.jsxs)(o.B,{spacing:4,py:4,mx:"auto",children:[(0,s.jsxs)(o.B,{spacing:2,children:[(0,s.jsxs)(o.B,{spacing:1,children:[(0,s.jsx)(l.E,{textAlign:"center",fontSize:"2xl",children:(0,s.jsx)(x.g,{icon:u.Bwz,size:"lg"})}),(0,s.jsx)(l.E,{fontWeight:"semibold",fontSize:"lg",textAlign:"center",children:(0,s.jsx)(m.x6,{id:"w5l5pM"})})]}),(0,s.jsx)(l.E,{textAlign:"center",maxW:"unset",children:(0,s.jsx)(m.x6,{id:"aV1OpM",values:{GAMMA_PROPER_NOUN:ej.On}})})]}),(0,s.jsx)(r.s,{align:"center",justify:"center",w:"100%",children:(0,s.jsxs)(o.B,{w:64,maxW:"100%",children:[(0,s.jsx)(a.$,{size:"md",variant:"solid",isDisabled:!g,isLoading:j,onClick:()=>{n&&(f(!0),nk(n,p).then(e=>{console.log("[ENTRI] Successfully setup domain",e),null==d||d({domainName:n,source:"automatic"})}).catch(e=>{e&&nz.Cp("[entri.showEntri] Error setting up domain: ".concat(e)),v({title:e?(0,s.jsx)(m.x6,{id:"l/2jzv"}):(0,s.jsx)(m.x6,{id:"FZ1Qqq"}),description:e,status:"error",duration:3e3,isClosable:!0,position:"top"})}).finally(()=>{f(!1)}))},children:(0,s.jsx)(m.x6,{id:"qu+sXe"})}),(0,s.jsxs)(e8.z,{children:[(0,s.jsx)(iD.c,{}),(0,s.jsx)(l.E,{color:"gray.600",children:(0,s.jsx)(m.x6,{id:"BzEFor"})}),(0,s.jsx)(iD.c,{})]}),(0,s.jsx)(a.$,{size:"md",variant:"plain",onClick:()=>{h("manualSetup")},children:(0,s.jsx)(m.x6,{id:"ANIrop"})})]})})]})})}),"manualSetup"===c&&(0,s.jsx)(i7.Z,{variant:"filled",children:(0,s.jsx)(i9.b,{children:(0,s.jsxs)(o.B,{spacing:6,children:[(0,s.jsx)(l.E,{fontWeight:"semibold",fontSize:"lg",children:(0,s.jsx)(m.x6,{id:"L5N7HX"})}),(0,s.jsxs)(nT.X,{variant:"simple",children:[(0,s.jsx)(nR.d,{children:(0,s.jsxs)(n_.Tr,{children:[(0,s.jsx)(nO.Th,{children:(0,s.jsx)(m.x6,{id:"6YtxFj"})}),(0,s.jsx)(nO.Th,{children:(0,s.jsx)(m.x6,{id:"+zy2Nq"})}),(0,s.jsx)(nO.Th,{isNumeric:!0,children:(0,s.jsx)(m.x6,{id:"HKH+W+"})})]})}),(0,s.jsx)(nD.N,{children:(y||[]).map(e=>(0,s.jsxs)(n_.Tr,{children:[(0,s.jsx)(nP.Td,{fontFamily:"mono",children:e.host}),(0,s.jsx)(nP.Td,{fontFamily:"mono",children:e.type}),(0,s.jsx)(nP.Td,{isNumeric:!0,fontFamily:"mono",children:e.value})]},e.value))})]}),(0,s.jsxs)(iP.F,{status:"info",colorScheme:"orange",children:[(0,s.jsx)(iz._,{}),(0,s.jsxs)(o.B,{children:[(0,s.jsx)(l.E,{fontWeight:"bold",fontSize:"md",children:(0,s.jsx)(m.x6,{id:"NxHkkp"})}),(0,s.jsxs)(i5._J,{ps:"4",spacing:"2",children:[C?1===nM.Wc.length?(0,s.jsx)(i5.ck,{children:(0,s.jsx)(m.x6,{id:"wz2Cgq",values:{0:nM.Wc[0]},components:{0:(0,s.jsx)(ne.C,{colorScheme:"gray"}),1:(0,s.jsx)(ne.C,{colorScheme:"gray"})}})}):(0,s.jsx)(i5.ck,{children:(0,s.jsx)(m.x6,{id:"+kOqFW",values:{0:nM.Wc.slice(0,-1).map(e=>(0,s.jsx)(ne.C,{colorScheme:"gray",children:e},e)),1:nM.Wc.slice(-1)[0]},components:{0:(0,s.jsx)(ne.C,{colorScheme:"gray"}),1:(0,s.jsx)(e8.z,{display:"inline",divider:(0,s.jsx)("span",{children:", "})}),2:(0,s.jsx)(ne.C,{colorScheme:"gray"})}})}):null,C&&(0,s.jsx)(i5.ck,{children:(0,s.jsx)(m.x6,{id:"vLov0O",components:{0:(0,s.jsx)(ne.C,{colorScheme:"gray"}),1:(0,s.jsx)(ne.C,{colorScheme:"gray"})}})}),(0,s.jsx)(i5.ck,{children:(0,s.jsx)(m.x6,{id:"Jmb6Yp",values:{subdomain:w,GAMMA_SITES_HOST:nM._o},components:{0:(0,s.jsx)(ne.C,{colorScheme:"gray"}),1:(0,s.jsx)(ne.C,{colorScheme:"gray"}),2:(0,s.jsx)(ne.C,{colorScheme:"gray"})}})})]})]})]}),d&&(0,s.jsxs)(e8.z,{justifyContent:"space-between",children:[(0,s.jsx)(a.$,{variant:"plain",onClick:()=>h("initial"),children:(0,s.jsx)(m.x6,{id:"iH8pgl"})}),(0,s.jsx)(a.$,{variant:"solid",onClick:()=>{i(),null==d||d({domainName:n,source:"manual"})},size:"md",mx:"auto",children:(0,s.jsx)(m.x6,{id:"RyhVuk"})})]})]})})})]}),(0,s.jsx)(i3.j,{})]})]})})},nN=e=>{let{children:t,shouldWrap:i=!1}=e;return i?(0,s.jsx)(iF.m,{py:16,maxW:"container.md",children:t}):(0,s.jsx)(s.Fragment,{children:t})},nF=e=>{let{showHeadings:t=!0}=e,i=(0,Q.st)(),n=(0,eu.GV)(tr.Gd),a=(0,iI.d)(),{refetch:d}=(0,iV.DL0)({variables:{id:null==n?void 0:n.id},fetchPolicy:"cache-first",skip:!(null==n?void 0:n.id)}),{isOpen:c,onOpen:h,onClose:p}=(0,iN.E)({id:"domainSetupModal"}),g=null==n?void 0:n.domains.find(e=>"pending"===e.status),[j,f]=(0,b.useState)(null),[v,{loading:y}]=(0,iV.yuV)(),[C,w]=(0,b.useState)();(0,b.useEffect)(()=>{if(!g)return;let e=setInterval(()=>{d()},1e4);return()=>{clearInterval(e)}},[g,d,n]);let k=(0,b.useCallback)(e=>{w(e),h()},[h]),E=(0,b.useCallback)(e=>{let{domainName:t,source:r}=e;"addDomain"===j&&v({variables:{input:{siteId:null==n?void 0:n.id,name:t,method:"automatic"===r?iV.hbC.Automatic:iV.hbC.Manual}}}).then(()=>{null==i||i.track(Q.VV.SITE_DOMAIN_ADDED,{domain:t,siteId:null==n?void 0:n.id,source:r}),a({title:(0,s.jsx)(m.x6,{id:"p8Oc6N"}),description:(0,s.jsx)(m.x6,{id:"HqV46b"}),status:"success",duration:3e3,isClosable:!0,position:"top"}),p()}).catch(e=>{let t=(0,i$.vI)(e).some(e=>"max_domains_reached"===e);a({title:t?(0,s.jsx)(m.x6,{id:"634yzf"}):(0,s.jsx)(m.x6,{id:"HugOMA"}),description:t?(0,s.jsx)(m.x6,{id:"aMKkZK"}):(0,s.jsx)(m.x6,{id:"PZCqeW"}),status:"error",isClosable:!0,position:"top"})})},[v,i,j,p,null==n?void 0:n.id,a]);return console.debug("%cDomainsPanel debug","background-color: #cc00ff",{site:n}),(0,s.jsx)(r.s,{w:"100%",flex:1,direction:"column",mt:4,children:(0,s.jsxs)(nN,{shouldWrap:t,children:[t&&(0,s.jsxs)(o.B,{spacing:1,mb:4,children:[(0,s.jsx)(B.D,{children:(0,s.jsx)(m.x6,{id:"AZ4xlc"})}),(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"tNT34Z",values:{GAMMA_PROPER_NOUN:ej.On}})})]}),n?(0,s.jsx)(nA,{site:n,onDomainSetupClick:k,onAddDomain:e=>{h(),w(e),f("addDomain")},isAddingDomain:y,refetchSites:d}):(0,s.jsx)(iX.Y,{}),c&&C&&(0,s.jsx)(nL,{domainName:C,isOpen:c,onClose:()=>{p(),f(null)},onDomainConfirmed:j?E:null}),(0,s.jsx)(r.s,{justify:"center",w:"100%",children:(0,s.jsx)(iJ.N,{href:eg.C.PUBLISH_SITE,target:"_blank",gap:2,fontSize:"sm",color:"deepocean.950",children:(0,s.jsxs)(o.B,{direction:"row",alignItems:"center",spacing:1.5,children:[(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"Px95UX"})}),(0,s.jsx)(x.g,{icon:u.Ju_,size:"xs"})]})})})]})})};var nV=i(33787),nG=i(83743),nW=i(99430),nB=i(87996),nU=i(59230),nH=i(89528),nK=i(43183);let nq={src:"/_next/static/media/no-navbar.e9d28333.png"},nY={src:"/_next/static/media/top-navbar.97a69a83.png"};var nJ=i(74771),nX=i(72470),n$=i(77979),nZ=i(83106);let nQ=e=>{let{gtmContainerId:t,setGtmContainerId:i}=e;return(0,s.jsxs)(nu.MJ,{children:[(0,s.jsx)(e8.z,{justifyContent:"center",children:(0,s.jsxs)(nx.l,{display:"flex",flex:"1",my:.5,mx:0,children:[(0,s.jsx)(m.x6,{id:"d4WWfP"}),(0,s.jsx)(q.qT,{ms:2,label:(0,s.jsx)(m.x6,{id:"gmEwbH"})}),(0,s.jsx)(tA.h,{}),(0,s.jsx)(a.$,{"aria-label":"Learn more about Google Tag Manager",as:"a",variant:"link",href:"https://support.google.com/tagmanager/answer/6103696?hl=en",target:"_blank",size:"sm",rightIcon:(0,s.jsx)(nJ.p,{ms:-1}),children:(0,s.jsx)(m.x6,{id:"zwWKhA"})})]})}),(0,s.jsxs)(nX.M,{children:[(0,s.jsx)(n$.W,{pointerEvents:"none",color:"gray.500",w:"fit-content",px:3,children:"GTM -"}),(0,s.jsx)(iZ.p,{placeholder:"XXXXXX",paddingStart:16,value:t||"",onChange:e=>{i(nZ.W.sanitize(e.currentTarget.value).replace(/[\W_]+/g,"").toUpperCase().slice(0,10))}})]})]})},n0=e=>{let{pixelId:t,setPixelId:i}=e;return(0,s.jsxs)(nu.MJ,{children:[(0,s.jsx)(e8.z,{justifyContent:"center",children:(0,s.jsxs)(nx.l,{display:"flex",flex:"1",m:0,children:[(0,s.jsx)(m.x6,{id:"163jQp"}),(0,s.jsx)(q.qT,{ms:2,label:(0,s.jsx)(m.x6,{id:"mynmm2",components:{0:(0,s.jsx)("span",{"aria-label":"arrow-right",role:"img"})}})}),(0,s.jsx)(r.s,{mx:2,mb:1.5,alignItems:"center",children:(0,s.jsx)(i8.E,{colorScheme:"green",children:(0,s.jsx)(m.x6,{id:"isRobC"})})}),(0,s.jsx)(tA.h,{}),(0,s.jsx)(a.$,{"aria-label":"Learn more about the Meta Pixel",as:"a",variant:"link",href:"https://developers.facebook.com/docs/meta-pixel/get-started",target:"_blank",size:"sm",rightIcon:(0,s.jsx)(nJ.p,{ms:-1}),children:(0,s.jsx)(m.x6,{id:"zwWKhA"})})]})}),(0,s.jsx)(r.s,{children:(0,s.jsx)(iZ.p,{ps:4,placeholder:"12345*****67890",value:t||"",onChange:e=>{i(nZ.W.sanitize(e.currentTarget.value).replace(/[\W_]+/g,"").toUpperCase().slice(0,20))}})})]})};var n1=i(13366),n6=i(98164);let n2=e=>{let{isOpen:t,onClose:i,onCancel:n,domains:r,onSelectPreferredDomain:d}=e,c=r.toSorted((e,t)=>{if(e.builtin&&!t.builtin)return 1;if(!e.builtin&&t.builtin)return -1;let i={verified:0,pending:1,failed:2},n=i[e.status]-i[t.status];return 0!==n?n:new Date(e.createdTime).getTime()-new Date(t.createdTime).getTime()}),[u,x]=(0,b.useState)(c[0].id),h=()=>{x(""),n()};return(0,s.jsxs)(i1.aF,{isOpen:t,onClose:h,isCentered:!0,size:"lg",children:[(0,s.jsx)(i6.m,{}),(0,s.jsxs)(i2.$,{children:[(0,s.jsx)(iR.r,{pb:3,children:(0,s.jsx)(m.x6,{id:"C5F8B8"})}),(0,s.jsx)(i_.s,{}),(0,s.jsx)(iO.c,{children:(0,s.jsxs)(o.B,{spacing:4,children:[(0,s.jsx)(l.E,{fontSize:"sm",color:"gray.600",children:(0,s.jsx)(m.x6,{id:"DH6iym"})}),(0,s.jsx)(n1.z,{value:u,onChange:x,children:(0,s.jsx)(o.B,{spacing:2,children:c.map(e=>(0,s.jsx)(n6.s,{value:e.id,children:e.name},e.id))})})]})}),(0,s.jsx)(i3.j,{children:(0,s.jsxs)(e8.z,{spacing:3,children:[(0,s.jsx)(a.$,{variant:"ghost",onClick:h,children:(0,s.jsx)(m.x6,{id:"dEgA5A"})}),(0,s.jsx)(a.$,{colorScheme:"green",onClick:()=>{u&&d(u),i()},isDisabled:!u,children:(0,s.jsx)(m.x6,{id:"4sCfSM"})})]})})]})]})},n5=e=>{let t=(0,eu.GV)(tr.Gd);return t?(0,s.jsx)(n3,{site:t,...e}):null},n3=e=>{var t,i,n,d;let{site:c,showHeadings:h=!0,doc:g}=e,j=(0,iI.d)(),f=(0,R.u)("sitesNav"),v=(0,R.u)("siteIndexingUi"),[y,C]=(0,b.useState)(c.name),[w,k]=(0,b.useState)(c.gtmContainerId),[E,S]=(0,b.useState)(c.metaPixelId),[I,A]=(0,b.useState)(c.navEnabled),[T,_]=(0,b.useState)((null==g||null==(t=g.file)?void 0:t.searchEngineIndexingEnabled)||!1),[O,D]=(0,b.useState)(!1),[P,z]=(0,b.useState)(!1),[M,L]=(0,b.useState)(null),{currentWorkspace:N}=(0,et.ur)(),[F]=(0,ik.vlJ)(),[V]=(0,ik.snR)(),[G]=(0,ik.Zfy)(),{isOpen:W,onOpen:U,onClose:K}=(0,ez.j)(),Y=T&&(0,ta.dv)(c),J=(0,eK.ez)("search_engine_indexing"),X=(0,b.useCallback)(async()=>{var e,t;if(!(null==c?void 0:c.id))return;D(!0);let i={siteId:c.id,name:y,navEnabled:I,gtmContainerId:w||null,metaPixelId:E||null};!I||(null==c?void 0:c.navContent)||(i.navContent=(0,tx.aG)());let n=[F({variables:{input:i}})],r=null==g||null==(e=g.file)?void 0:e.id;r&&T!==(null==g||null==(t=g.file)?void 0:t.searchEngineIndexingEnabled)&&n.push(V({variables:{fileId:r,enable:T}})),await Promise.all(n),j({title:(0,s.jsxs)(tI.T,{spacing:0,alignItems:"start",children:[(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"bZn5Ok"})}),(0,s.jsx)(l.E,{fontWeight:"400",children:(0,s.jsx)(m.x6,{id:"dZ+7oe"})})]}),duration:5e3,status:"success",isClosable:!0,position:"top"}),D(!1)},[null==g||null==(i=g.file)?void 0:i.id,null==g||null==(n=g.file)?void 0:n.searchEngineIndexingEnabled,w,T,E,y,I,c.id,null==c?void 0:c.navContent,j,V,F]),$=(0,b.useCallback)(async e=>{(null==c?void 0:c.id)&&(z(!0),await F({variables:{input:{siteId:c.id,faviconUrl:e}}}),j({title:e?(0,s.jsx)(m.x6,{id:"64GEyu"}):(0,s.jsx)(m.x6,{id:"/K2cLG"}),status:"success",isClosable:!0,position:"top"}),z(!1))},[null==c?void 0:c.id,j,F]),Z=e=>{if((_(e),e)&&!c.domains.some(e=>!0===e.canonical)){if(1===c.domains.length)return void Q(c.domains[0].id);U()}},Q=async e=>{await G({variables:{id:e}}),j({title:(0,s.jsx)(m.x6,{id:"8c5DRi"}),status:"success",duration:3e3,isClosable:!0,position:"top"})},ee=(0,b.useMemo)(()=>{var e;let t=w||void 0,i=(null==c?void 0:c.gtmContainerId)||void 0,n=E||void 0,s=(null==c?void 0:c.metaPixelId)||void 0;return y!==(null==c?void 0:c.name)||I!==(null==c?void 0:c.navEnabled)||t!==i||n!==s||T!==((null==g||null==(e=g.file)?void 0:e.searchEngineIndexingEnabled)||!1)},[w,null==c?void 0:c.gtmContainerId,null==c?void 0:c.metaPixelId,null==c?void 0:c.name,null==c?void 0:c.navEnabled,E,y,I,T,null==g||null==(d=g.file)?void 0:d.searchEngineIndexingEnabled]);return(0,s.jsxs)(r.s,{w:"100%",flex:1,direction:"column",px:2,children:[(0,s.jsxs)(nN,{shouldWrap:h,children:[h&&(0,s.jsx)(B.D,{size:"md",letterSpacing:"tight",fontWeight:"800",mb:12,children:(0,s.jsx)(m.x6,{id:"Tz0i8g"})}),(0,s.jsxs)(o.B,{spacing:4,mt:6,children:[(0,s.jsxs)(nu.MJ,{children:[(0,s.jsx)(e8.z,{justifyContent:"center",children:(0,s.jsx)(nx.l,{flex:"1",children:(0,s.jsx)(m.x6,{id:"Lve3H6"})})}),(0,s.jsx)(iZ.p,{onChange:e=>{C(e.currentTarget.value)},placeholder:p.Ru._({id:"ZiMSMQ"}),value:y})]}),(0,s.jsxs)(nu.MJ,{children:[(0,s.jsx)(e8.z,{justifyContent:"center",children:(0,s.jsx)(nx.l,{flex:"1",children:(0,s.jsx)(m.x6,{id:"+Qaboy"})})}),(0,s.jsx)(r.s,{h:"150px",w:"100%",position:"relative",justify:"center",align:"center",children:(null==c?void 0:c.faviconUrl)?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.s,{align:"center",justify:"center",w:"128px",h:"128px",border:"1px solid var(--chakra-colors-blackAlpha-200)",children:(0,s.jsx)(nV._,{src:null==c?void 0:c.faviconUrl,maxW:"100px",maxH:"100px",borderRadius:"sm"})}),(0,s.jsx)(q.Tz,{label:(0,s.jsx)(m.x6,{id:"XyBdok"}),children:(0,s.jsx)(H.K,{zIndex:2,position:"absolute",top:0,right:0,isRound:!0,isDisabled:P,size:"sm",icon:(0,s.jsx)(x.g,{icon:u.yLS}),"aria-label":p.Ru._({id:"XyBdok"}),onClick:()=>$(null)})})]}):P||M===nU.A.Uploading?(0,s.jsx)(t3.y,{}):(0,s.jsx)(nB.Zc,{orgId:null==N?void 0:N.id,uploadType:"favicon",editType:"favicon",dropHereText:p.Ru._({id:"hVCCpY",values:{0:"%{browse}"}}),customHeight:"150px",customFontSize:"xs",onUploadStart:()=>{L(nU.A.Uploading)},onUploadSuccess:async(e,t)=>{let{src:i,uploadResultStep:n}=e;"optimized"===n&&(await $(i),L(nU.A.Done))},onUploadFailed:e=>{L(nU.A.Error),j({title:(0,s.jsx)(m.x6,{id:"aECahe"})}),console.error("[Site SettingsPanel] Favicon upload error",e)},sx:{width:"100%",".uppy-Root":{border:"1px solid var(--chakra-colors-gray-200)",borderRadius:"md",width:"100%"},".uppy-DragDrop-label":{fontSize:"xs",color:"gray.500"},".uppy-DragDrop--isDragDropSupported":{border:"none"},".uppy-DragDrop-arrow":{transform:"scale(0.85)"}}})}),(0,s.jsx)(l.E,{fontSize:"xs",color:"gray.500",mt:2,children:(0,s.jsx)(m.x6,{id:"TvUKq9"})})]}),f&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(iD.c,{}),(0,s.jsxs)(nu.MJ,{children:[(0,s.jsx)(e8.z,{justifyContent:"center",children:(0,s.jsx)(nx.l,{flex:"1",children:(0,s.jsx)(m.x6,{id:"UxKoFf"})})}),(0,s.jsxs)(nG.r,{columns:2,spacing:6,flex:1,children:[(0,s.jsx)(n4,{name:p.Ru._({id:"Nom9QG"}),src:nY.src,isSelected:I,onClick:()=>{A(!0)}}),(0,s.jsx)(n4,{name:p.Ru._({id:"BvDFuc"}),src:nq.src,isSelected:!I,onClick:()=>{A(!1)}})]})]})]}),(0,s.jsx)(iD.c,{}),v&&(0,s.jsxs)(o.B,{direction:"column",spacing:0,children:[(0,s.jsxs)(o.B,{direction:"row",justifyContent:"space-between",children:[(0,s.jsx)(l.E,{children:"Make discoverable on web"}),(0,s.jsx)(nH.Ch,{canUseFeature:J,productFeature:"search_engine_indexing",h:"fit-content"}),(0,s.jsx)(tA.h,{}),(0,s.jsx)(nW.d,{isChecked:Y,disabled:!(0,ta.dv)(c)||!J&&!T,onChange:e=>Z(e.target.checked)})]}),(0,s.jsx)(l.E,{color:"gray.500",fontSize:"xs",children:"When enabled, your site may appear in search results on the web"})]}),(0,s.jsx)(nQ,{gtmContainerId:w,setGtmContainerId:k}),(0,s.jsx)(n0,{pixelId:E,setPixelId:S}),g&&(0,s.jsx)(nK.w,{label:(0,s.jsx)(m.x6,{id:"ebOoCq",values:{GAMMA_PROPER_NOUN:ej.On}}),segmentEvent:tq.VV.GAMMA_PRO_UPSELL_SITE_REMOVE_WATERMARK,targetWorkspace:g.organization})]})]}),(0,s.jsx)(r.s,{w:"100%",flex:1,direction:"column",pos:"sticky",bottom:0,children:(0,s.jsxs)(r.s,{mx:-2,flex:1,mb:-2,py:4,bg:"white",children:[(0,s.jsx)(tA.h,{}),(0,s.jsx)(a.$,{variant:"solid",isDisabled:!ee,onClick:X,isLoading:O,children:(0,s.jsx)(m.x6,{id:"tfDRzk"})})]})}),(0,s.jsx)(n2,{isOpen:W,onClose:K,onCancel:()=>{_(!1),K()},domains:c.domains,onSelectPreferredDomain:e=>{Q(e)}})]})},n4=e=>{let{name:t,src:i,onClick:n,isSelected:r,...a}=e;return(0,s.jsxs)(o.B,{p:2,bg:r?"trueblue.50":"transparent",_hover:{bg:"trueblue.50",cursor:"pointer"},borderRadius:"md",spacing:2,...a,transitionProperty:"common",transitionDuration:"normal",onClick:n,children:[(0,s.jsx)(d.a,{height:"80px",bg:"gray.50",borderRadius:"md",borderWidth:"1px",overflow:"hidden",children:i&&(0,s.jsx)(nV._,{src:i,width:"100%",height:"100%",objectFit:"contain",borderRadius:"md"})}),(0,s.jsxs)(e8.z,{children:[r&&(0,s.jsx)(d.a,{children:(0,s.jsx)(x.g,{icon:u.e68})}),(0,s.jsx)(l.E,{fontSize:"sm",fontWeight:"500",children:t})]})]})};var n8=i(5091),n7=i(91140);let n9=e=>{let{label:t,initialValue:n="",updateValue:r,helperText:o,language:l,...a}=e,[c,u]=(0,b.useState)(n),[x,h]=(0,b.useState)(null),m=(0,t$.lW)(r,100),[p,g]=(0,b.useState)();(0,b.useEffect)(()=>{"css"===l?Promise.all([i.e(6171),i.e(6374),i.e(960)]).then(i.bind(i,30960)).then(e=>{g(e.css())}):"html"===l&&Promise.all([i.e(6171),i.e(6374),i.e(960),i.e(5516),i.e(83)]).then(i.bind(i,80083)).then(e=>{g(e.html())})},[l]),(0,t$.Vg)(()=>{h(null),m(c)},[c,m],[c]);let j=[p].filter(Boolean);return(0,s.jsxs)(nu.MJ,{isInvalid:!!x,children:[(0,s.jsx)(nx.l,{children:t}),x&&(0,s.jsx)(n8.Wt,{children:x}),o&&(0,s.jsx)(nu.eK,{children:o}),(0,s.jsx)(d.a,{border:"1px solid",borderColor:"gray.200",fontSize:"md",position:"relative",children:(0,s.jsx)(b.Suspense,{fallback:(0,s.jsx)("span",{}),children:(0,s.jsx)(n7.j,{value:c,extensions:j,onChange:u,...a})})})]})},se=(0,b.memo)(e=>{let{editor:t}=e,{bodyStart:i}=(0,eu.GV)(ex.BP),n=(0,b.useCallback)(e=>{null==t||t.commands.updateNestedAttributesAtPos(0,{customCode:{bodyStart:e}})},[t]);return(0,s.jsx)(r.s,{w:"100%",flex:1,direction:"column",p:2,pt:6,children:(0,s.jsx)(n9,{label:p.Ru._({id:"fC5kYg"}),helperText:p.Ru._({id:"0AZNtw"}),initialValue:i,updateValue:n,language:"html",height:"600px"})})});se.displayName="CustomCodePanel";let st=(0,b.memo)(e=>{let{selectedPanel:t,setSelectedPanel:i}=e,n=(0,R.u)("docCustomCode");return(0,s.jsx)(o.B,{spacing:4,children:(0,s.jsx)(o.B,{spacing:8,children:(0,s.jsxs)(e7.e,{variant:"ghost",size:"sm",borderRadius:"full",w:"100%",children:[(0,s.jsx)(a.$,{borderRadius:"md",leftIcon:(0,s.jsx)(x.g,{icon:u.y5z,fixedWidth:!0}),"data-website-panel-active-view-button":"domains",colorScheme:"domains"===t?"trueblue":"gray",bg:"domains"===t?"trueblue.100":void 0,onClick:()=>i("domains"),flex:1,children:(0,s.jsx)(m.x6,{id:"AZ4xlc"})}),(0,s.jsx)(a.$,{borderRadius:"md",leftIcon:(0,s.jsx)(x.g,{icon:u.BH7,fixedWidth:!0}),"data-website-panel-active-view-button":"website",colorScheme:"website"===t?"trueblue":"gray",bg:"website"===t?"trueblue.100":void 0,onClick:()=>i("website"),flex:1,children:(0,s.jsx)(m.x6,{id:"Tz0i8g"})}),n&&(0,s.jsx)(a.$,{borderRadius:"md",leftIcon:(0,s.jsx)(x.g,{icon:u.jTw,fixedWidth:!0}),"data-website-panel-active-view-button":"code",colorScheme:"code"===t?"trueblue":"gray",bg:"code"===t?"trueblue.100":void 0,onClick:()=>i("code"),flex:1,children:(0,s.jsx)(m.x6,{id:"E16GGw"})})]})})})});st.displayName="SettingsPanelHeader";var si=i(24351),sn=i(58495);let ss=e=>{var t;let{title:i,site:n}=e,s="/".concat((0,nh.Fw)(i||"untitled"));return(null==n||null==(t=n.routes)?void 0:t.find(e=>e.path===s))&&(s="".concat(s,"-").concat((0,sn.Ak)(6))),s},sr={variant:"outline",transitionProperty:"all",transitionDuration:"normal",cursor:"pointer",boxShadow:"none",tabIndex:0,_hover:{shadow:"lg",borderColor:"trueblue.300",bg:"trueblue.50"},_focusVisible:{boxShadow:"none",outline:"none"},_focus:{boxShadow:"outline"}},so=e=>{let{sites:t}=e,i=(0,eu.GV)(e_.Jo),n=(0,Q.st)(),{currentWorkspace:a}=(0,et.ur)(),[d]=(0,ik.Imo)(),[c,h]=(0,b.useState)(!1),p=(0,iI.d)(),{push:g,reload:j}=(0,e9.useRouter)(),f=(0,b.useCallback)(async e=>{if(!i)return;h(!0);let r=null==t?void 0:t.find(t=>t.id===e),o=i.id;if(!(null==a?void 0:a.id))return void console.error("[MoveToSiteModal] No currentWorkspace found");let l=ss({title:i.title,site:r});if(await (0,ta.fb)(o),!o)return void console.error("[MoveToSiteModal] No docId found");null==n||n.track(Q.VV.DOC_MOVED_TO_SITE,{doc_id:o,site_id:e}),d({variables:{input:{siteId:e,docId:o,path:l}},refetchQueries:["GetSite"]}).then(()=>{(0,D.pF)({docId:o}),console.debug("[MoveToSiteModal] Doc moved to site. Adding route then navigating to editor",o),p({position:"top",title:(0,s.jsx)(m.x6,{id:"oMgC5V"}),description:(0,s.jsx)(m.x6,{id:"rYG2u6"}),status:"success",duration:5e3}),j()}).catch(e=>{p({position:"top",title:"Error",description:e.message,status:"error",duration:5e3}),h(!1)}).finally(()=>{h(!1)})},[n,null==a?void 0:a.id,i,j,d,t,p]);return(0,s.jsxs)(s.Fragment,{children:[c&&(0,s.jsx)(r.s,{w:"100",h:"400px",maxH:"30vh",children:(0,s.jsx)(iX.Y,{})}),!c&&(0,s.jsxs)(o.B,{spacing:4,children:[(0,s.jsx)(o.B,{pt:2,pb:2,children:(0,s.jsxs)(l.E,{fontSize:"sm",letterSpacing:"normal",color:"gray.600",fontWeight:"500",children:[(0,s.jsx)(m.x6,{id:"1osTfm",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP},components:{0:(0,s.jsx)("strong",{})}})," ",(0,s.jsxs)(iJ.N,{href:eg.C.CREATE_SITE,textDecoration:"underline",isExternal:!0,color:"trueblue.500",children:[(0,s.jsx)(m.x6,{id:"Px95UX"}),(0,s.jsx)(nJ.p,{mx:"2px"})]})," "]})}),t&&t.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.E,{fontSize:"sm",letterSpacing:"normal",color:"gray.600",fontWeight:"500",children:(0,s.jsx)(m.x6,{id:"kjbPb3",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}})}),null==t?void 0:t.map(e=>(0,s.jsx)(i7.Z,{onClick:()=>f(e.id),onKeyPress:t=>{"Enter"===t.key&&f(e.id)},...sr,children:(0,s.jsx)(i9.b,{children:(0,s.jsxs)(e8.z,{children:[(0,s.jsx)(o.B,{spacing:0,children:(0,s.jsxs)(e8.z,{children:[e.faviconUrl&&(0,s.jsx)(nV._,{w:"4",src:e.faviconUrl}),(0,s.jsx)(l.E,{fontWeight:"600",children:e.name})]})}),(0,s.jsx)(tA.h,{}),(0,s.jsx)(x.g,{icon:u.dmS})]})})},e.id))]})]})]})},sl=()=>{let{isOpen:e,onOpen:t,onClose:i}=(0,iN.E)({id:"MoveToSiteDisclosure"}),{currentWorkspace:n}=(0,et.ur)(),{data:r,loading:o}=(0,ik._qT)({variables:{workspaceId:null==n?void 0:n.id},skip:!(null==n?void 0:n.id),fetchPolicy:"cache-first"}),l=null==r?void 0:r.sites;return o?(0,s.jsx)(t3.y,{size:"xs"}):l&&0===l.length?(0,s.jsx)(s.Fragment,{}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.$,{variant:"plain",onClick:t,colorScheme:"trueblue",children:(0,s.jsx)(m.x6,{id:"hsMvVQ"})}),(0,s.jsxs)(i1.aF,{isOpen:e,onClose:i,size:"3xl",children:[(0,s.jsx)(i6.m,{}),(0,s.jsxs)(i2.$,{children:[(0,s.jsx)(iR.r,{children:(0,s.jsx)(m.x6,{id:"i4b0iJ"})}),(0,s.jsx)(i_.s,{}),(0,s.jsx)(iO.c,{maxH:"80vh",overflowY:"auto",children:(0,s.jsx)(so,{sites:l})}),(0,s.jsx)(i3.j,{children:(0,s.jsx)(a.$,{mr:3,onClick:i,children:(0,s.jsx)(m.x6,{id:"yz7wBu"})})})]})]})]})},sa=e=>{let{onEnable:t,isLoading:i}=e;return(0,s.jsx)(o.B,{align:"center",justify:"center",spacing:4,flex:1,p:6,mt:8,children:(0,s.jsx)(si.p,{size:"md",title:(0,s.jsx)(m.x6,{id:"CcudBl",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}}),description:(0,s.jsx)(m.x6,{id:"xEtury"}),children:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(o.B,{w:"100%",mt:4,children:[(0,s.jsx)(a.$,{variant:"solid",onClick:t,isLoading:i,children:(0,s.jsx)(m.x6,{id:"oL6HHo"})}),(0,s.jsx)(sl,{})]}),(0,s.jsx)(a.$,{as:iJ.N,variant:"ghost",isExternal:!0,href:eg.C.CREATE_SITE,rightIcon:(0,s.jsx)(x.g,{icon:u.vMs,size:"sm"}),children:(0,s.jsx)(m.x6,{id:"Px95UX"})})]})})})};var sd=i(55775),sc=i(58297),su=i(18833),sx=i(42328);let sh=(0,su.P)(d.a),sm={initial:{opacity:0,translateY:-40},animate:{opacity:1,translateY:0},exit:{opacity:0,translateY:40},transition:{duration:.3}},sp=e=>{let{isLoading:t,onChange:i,isChecked:n,isDisabled:o,enabledText:l,disabledText:a}=e;return(0,s.jsxs)(r.s,{cursor:o?"not-allowed":"pointer",className:(0,c.cx)("gamma-switch-container",t&&"loading",n?"active":""),opacity:o?.6:1,children:[(0,s.jsx)(d.a,{as:"label",className:"text",fontSize:"sm",justifyContent:"center",htmlFor:"gamma-checkbox",position:"relative",overflow:"hidden",children:(0,s.jsx)(sx.N,{initial:!1,children:t?(0,s.jsx)(sh,{as:"span",position:"absolute",...sm,children:(0,s.jsx)(t3.y,{size:"sm"})},"loading"):n?(0,s.jsx)(sh,{as:"span",position:"absolute",...sm,children:l},"checked"):(0,s.jsx)(sh,{as:"span",position:"absolute",...sm,children:a},"unchecked")})}),(0,s.jsxs)(d.a,{as:"label",className:"switch",pointerEvents:o?"none":"auto",children:[(0,s.jsx)("input",{id:"gamma-checkbox",type:"checkbox",onChange:i,disabled:t||o}),(0,s.jsx)("span",{className:"slider round"})]})]})},sg=(0,K.i7)({"0%":{transform:"scale(1)",opacity:1},"50%":{transform:"scale(1.7)",opacity:0},"100%":{transform:"scale(1)",opacity:0}}),sj=(0,K.i7)({"0%":{transform:"scale(1)",opacity:1},"15%":{transform:"scale(1)",opacity:1},"60%":{transform:"scale(1.7)",opacity:0},"100%":{transform:"scale(1)",opacity:0}}),sf=(0,K.i7)({"0%":{transform:"scale(1)"},"30%":{transform:"scale(1)"},"50%":{transform:"scale(1.05)"},"70%":{transform:"scale(1)"},"100%":{transform:"scale(1)"}}),sv=e=>{let{icon:t,showDisabled:i=!1,shouldPulse:n=!1,bg:r="gray.200",color:o="gray.700"}=e,[l]=(0,sd.rd)("colors",[r]);return(0,s.jsx)(sc.j,{color:o,textAlign:"center",bg:r,size:8,opacity:i?.5:1,position:"relative",animation:n?"".concat(sf," 2.7s infinite"):"none",sx:{":before":n?{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",content:"''",boxShadow:"inset 0 0 0 3px ".concat(l),transition:"transform 0.2s, opacity 0.2s",animation:"".concat(sg," 2.7s infinite")}:{},":after":n?{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",content:"''",boxShadow:"inset 0 0 0 2px ".concat(l),transition:"transform 0.2s, opacity 0.2s",animation:"".concat(sj," 2.7s infinite")}:{}},children:i?(0,s.jsxs)("span",{className:"fa-stack",children:[(0,s.jsx)(x.g,{icon:u.$Dv,className:"fa-stack-1x"}),(0,s.jsx)(x.g,{icon:t,className:"fa-stack-1x"})]}):(0,s.jsx)(x.g,{size:"1x",icon:t})})},sb=e=>{let{isLoading:t=!1,site:i,onChange:n,disabledText:o,doc:a}=e,c=(0,ta.dv)(i),x=(0,iG.mL)(),h=(0,et.Iy)("manage",a),p=x||h,g=!!(t||o||!p),j=(0,ta.m8)(i),f=p?o||(t?(0,s.jsx)(m.x6,{id:"mkk40+"}):c?(0,s.jsx)(m.x6,{id:"f4CBNf"}):(0,s.jsx)(m.x6,{id:"5G4vd5"})):(0,s.jsx)(m.x6,{id:"Z2uNdQ"});return i?(0,s.jsxs)(e8.z,{w:"100%",justify:"space-between","data-testid":"toggle-website-settings",children:[(0,s.jsx)(d.a,{children:(0,s.jsxs)(r.s,{alignItems:"center",children:[(0,s.jsx)(sv,{shouldPulse:j,bg:j?"sky.600":"gray.200",color:j?"white":"gray.700",icon:j?u.LIr:u.Bwz}),(0,s.jsxs)(d.a,{ml:3,children:[(0,s.jsx)(e8.z,{children:(0,s.jsx)(l.E,{children:j?(0,s.jsx)(m.x6,{id:"5JIk9r"}):c?(0,s.jsx)(m.x6,{id:"AAm5jh"}):(0,s.jsx)(m.x6,{id:"HzFHhy"})})}),(0,s.jsx)(r.s,{align:"center",children:(0,s.jsx)(e8.z,{spacing:1,align:"center",children:(0,s.jsx)(l.E,{fontSize:"xs",color:"gray.500",css:{textWrap:"balance"},children:i&&j?(0,s.jsx)(m.x6,{id:"m0x7lb"}):c?(0,s.jsx)(m.x6,{id:"N4VTXP"}):(0,s.jsx)(m.x6,{id:"39MFjF",values:{GAMMA_PROPER_NOUN:ej.On}})})})})]})]})}),(0,s.jsx)(d.a,{children:(0,s.jsx)(q.Tz,{label:f,placement:"top",shouldWrapChildren:!0,children:(0,s.jsx)(sp,{isChecked:c,isDisabled:g,isLoading:t,onChange:n})})})]}):null},sy=e=>{var t,i;let{doc:n}=e,{isOpen:o,onClose:l,onOpen:a}=(0,iN.E)({id:"SiteSettingsDrawer"}),d=(0,iI.d)(),c=(0,eu.jL)(),u=(0,eu.GV)(tr.Gd),x=(0,eu.GV)(tr.df),{editor:h}=(0,t5.mi)(),{currentWorkspace:p}=(0,et.ur)(),[g,j]=(0,b.useState)(!1),[f]=(0,ik.Ybb)(),[v]=(0,ik.yqC)(),[y]=(0,ik.Xcb)(),[C]=(0,ik.LTv)(),[w,k]=(0,b.useState)("domains"),E=n.id,S=n.title,I=null==p?void 0:p.id,A=null==n||null==(t=n.theme)?void 0:t.id,T=!1==!!n.site?null:(null==(i=n.site)?void 0:i.enabled)?"enabled":"disabled",R=!!u,O=(null==u?void 0:u.archived)?(0,s.jsx)(m.x6,{id:"jxz7x1",values:{GAMMA_PROPER_NOUN:ej.On}}):null,{query:D}=(0,e9.useRouter)();(0,_.o)("showDomains"),(0,b.useEffect)(()=>{let e=iY.R.on("openSiteSettings",e=>{k(e),a()});return()=>{e()}},[a]),(0,b.useEffect)(()=>{"true"===D.showDomains&&iY.R.emit("openSiteSettings","domains")},[D.showDomains]);let P=(0,b.useCallback)(async()=>{if(I){j(!0),C({variables:{id:E,themeId:null}});try{await f({variables:{input:{workspaceId:I,name:S,themeId:A,routes:[{docId:E,path:"/"}]}},refetchQueries:["GetDoc"]}).then(e=>{let{data:t}=e;(0,tr.wC)(c)({site:null==t?void 0:t.createSite,docId:E})})}catch(e){console.error("[WebsiteSettingsModal] Failed to create site",e.message),d({title:(0,s.jsx)(m.x6,{id:"Pdboh4"}),description:(0,s.jsx)(m.x6,{id:"8wxFbh"}),status:"error",duration:5e3,isClosable:!0,position:"top"})}finally{j(!1)}}},[f,c,E,S,A,d,C,I]),z=(0,b.useCallback)(async()=>{if(x){j(!0);try{await v({variables:{id:x},update:(e,t)=>{let{data:i}=t;e.updateQuery({query:ik.iVk,variables:{id:E}},e=>e&&e.doc?iL()({},e,{doc:{site:null==i?void 0:i.disableSite}}):e)}})}catch(e){console.error("[WebsiteSettingsModal] Failed to deactivate site",e.message),d({title:(0,s.jsx)(m.x6,{id:"ksq4sM"}),description:(0,s.jsx)(m.x6,{id:"VE0YVl"}),status:"error",duration:5e3,isClosable:!0,position:"top"})}finally{j(!1)}}},[v,E,x,d]),M=(0,b.useCallback)(async()=>{if(x){j(!0);try{await y({variables:{id:x},update:(e,t)=>{let{data:i}=t;e.updateQuery({query:ik.iVk,variables:{id:E}},e=>e&&e.doc?iL()({},e,{doc:{site:null==i?void 0:i.enableSite}}):e)}})}catch(e){console.error("[WebsiteSettingsModal] Failed to re-activate site",e.message),d({title:(0,s.jsx)(m.x6,{id:"aQnYTJ"}),description:(0,s.jsx)(m.x6,{id:"E2sPQM"}),status:"error",duration:5e3,isClosable:!0,position:"top"})}finally{j(!1)}}},[E,y,x,d]),L=(0,b.useCallback)(()=>{null===T?P():"enabled"===T?z():"disabled"===T&&M()},[P,z,M,T]);return(0,s.jsx)(q.L8,{isDark:!1,children:(0,s.jsx)(iA._s,{isOpen:o,onClose:l,size:"md",trapFocus:!1,blockScrollOnMount:!1,children:(0,s.jsxs)(iT.z,{p:0,shadow:"xl",children:[(0,s.jsx)(iR.r,{children:(0,s.jsx)(m.x6,{id:"WtsmDd"})}),(0,s.jsx)(i_.s,{}),(0,s.jsxs)(iO.c,{children:[(0,s.jsxs)(tI.T,{spacing:4,align:"stretch",children:[(0,s.jsx)(sb,{isLoading:g,site:u,doc:n,onChange:L,disabledText:O}),R&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(iq,{}),(0,s.jsx)(iD.c,{}),"disabled"===T&&(0,s.jsxs)(iP.F,{status:"warning",mb:6,children:[(0,s.jsx)(iz._,{}),(0,s.jsx)(m.x6,{id:"CHu+l0"})]}),(0,s.jsxs)(r.s,{direction:"column",children:[(0,s.jsx)(st,{selectedPanel:w,setSelectedPanel:k}),"website"===w?(0,s.jsx)(n5,{showHeadings:!1,doc:n}):"domains"===w?(0,s.jsx)(nF,{showHeadings:!1}):"code"===w?(0,s.jsx)(se,{editor:h}):null]})]})]}),!u&&(0,s.jsx)(sa,{onEnable:L,isLoading:g})]})]})})})};var sC=i(96430),sw=i(73689);let sk="onboarding-checklist-popover-content";var sE=i(80074);let sS=e=>{let{item:t,itemKey:i,onButtonClick:n}=e,r=(0,V.dU)("gray.700","gray.200"),d=(0,V.dU)("gray.500","gray.400"),c=(0,V.dU)("gray.400","gray.300"),u=(0,b.useCallback)(()=>{(0,J.v)(tq.VV.ONBOARDING_CHECKLIST_WIDGET_ITEM_LEARN_MORE_CLICKED,{item:i})},[i]);return(0,s.jsx)(W.e,{overflowY:"auto","data-id":"onboarding-checklist-item-detail",sx:{kbd:{color:"gray.700"}},children:(0,s.jsxs)(o.B,{spacing:4,py:2,children:[(0,s.jsx)(sE.g,{ratio:16/9,children:(0,s.jsxs)("video",{autoPlay:!0,loop:!0,muted:!0,playsInline:!0,controls:!0,children:[(0,s.jsx)("source",{src:t.mp4}),(0,s.jsx)("source",{src:t.webm})]})}),(0,s.jsxs)(o.B,{children:[(0,s.jsx)(B.D,{size:"md",children:t.title}),(0,s.jsxs)(l.E,{fontSize:"sm",color:r,children:[t.detail&&t.detail,t.learnMoreLink&&(0,s.jsxs)(s.Fragment,{children:[" ",(0,s.jsxs)(iJ.N,{href:t.learnMoreLink,isExternal:!0,display:"inline-block",alignItems:"center",color:d,textDecoration:"underline",_hover:{color:c},verticalAlign:"text-top",fontSize:"xs",onClick:u,children:[(0,s.jsx)(m.x6,{id:"zwWKhA"})," ",(0,s.jsx)(nJ.p,{})]})]})]})]}),(0,s.jsx)(a.$,{variant:"solid",onClick:n,size:"sm",id:"completeButton",children:(0,s.jsx)(m.x6,{id:"76gPWk"})})]})})};var sI=i(38676);let sA=e=>{let{item:t,onClick:i,itemKey:n,isCompleted:r,showPointer:c}=e,h=(0,V.dU)("gray.700","white"),m=(0,V.dU)("gray.600","gray.400"),p=(0,V.dU)("blackAlpha.50","blackAlpha.100"),g=(0,V.dU)("gray.400","gray.600"),j=r?g:h,f=(0,V.dU)("trueblue.50","trueblue.50"),v=(0,$.fW)();return(0,s.jsx)(a.$,{w:"100%",py:.5,variant:"link",alignItems:"flex-start",justifyContent:"flex-start",onClick:e=>{e.stopPropagation(),i()},id:"checklist-item-".concat(n),textDecoration:"none",color:j,_hover:{textDecoration:"none",color:m,bgColor:p},fontSize:"sm",fontWeight:"medium",css:{"--checklist-item-highlight-color":f},className:r?"highlight-animation":"",whiteSpace:"normal",textAlign:"start",children:(0,s.jsxs)(o.B,{direction:"row",alignItems:"flex-start",spacing:2,w:"100%",position:"relative",children:[(0,s.jsx)(d.a,{w:"fit-content",color:r?g:j,children:r?(0,s.jsx)(x.g,{icon:u.e68,fixedWidth:!0}):(0,s.jsx)(x.g,{icon:u.Nfw,fixedWidth:!0})}),(0,s.jsxs)(d.a,{children:[(0,s.jsx)(l.E,{pos:"relative",lineHeight:"1.5",display:"inline",...r?{background:"linear-gradient(currentColor, currentColor)",backgroundRepeat:"no-repeat",textDecoration:"none",backgroundPosition:"0% 50%",backgroundSize:"100% 2px",className:"strike-animation ".concat(v?"strike-animation-rtl":"")}:{},children:t.title}),c&&(0,s.jsx)(d.a,{display:"inline-block",position:"absolute",marginInlineStart:2,className:v?"pointer-animation-rtl":"pointer-animation-ltr",lineHeight:0,fontSize:"2xl",bottom:"10px",children:(0,s.jsx)("span",{role:"img","aria-label":"show me how",children:v?"\uD83D\uDC49":"\uD83D\uDC48"})})]})]})})},sT=e=>{let{onMinimizeClick:t,onListItemClick:i,completedSteps:n,steps:r}=e,{progress:a,stepCount:c,totalSteps:u}=ey(),h=(0,V.dU)("gray.400","gray.600"),p=(0,V.dU)("blackAlpha","whiteAlpha");return(0,s.jsxs)(d.a,{children:[(0,s.jsx)(d.a,{position:"absolute",top:1,insetInlineEnd:2,zIndex:3,children:(0,s.jsx)(H.K,{variant:"ghost",color:"currentColor",colorScheme:p,isRound:!1,size:"xs",icon:(0,s.jsx)(x.g,{icon:tT.AJu,fixedWidth:!0}),"aria-label":"Minimize",onClick:t})},"onboarding-checklist-popover-minimize-button"),(0,s.jsx)(sI.D,{border:"0 none",children:(0,s.jsxs)(o.B,{spacing:2,children:[(0,s.jsxs)(o.B,{direction:"row",alignItems:"baseline",justifyContent:"flex-start",children:[(0,s.jsx)(B.D,{size:"sm",children:(0,s.jsx)(m.x6,{id:"ZDIydz"})}),(0,s.jsx)(l.E,{fontSize:"xs",color:h,children:(0,s.jsx)(m.x6,{id:"llY0P5",values:{totalSteps:u,0:String(c)}})})]}),(0,s.jsx)(ed.k,{size:"sm",colorScheme:"green",value:a,isAnimated:!0,borderRadius:"full"})]})}),(0,s.jsx)(W.e,{children:(0,s.jsx)(o.B,{spacing:4,w:"100%",children:(0,s.jsx)(o.B,{spacing:1,w:"100%",children:r.map(e=>{let[t,r]=e,o=n[t],l=Object.entries(n).find(e=>{let[t,i]=e;return!i}),a=l&&l[0]===t;return(0,s.jsx)(sA,{item:r,onClick:()=>{i(t)},itemKey:t,isCompleted:o,showPointer:a},t)})})})})]})};i(51407);let sR=ev(),s_=e=>{let{onEditClick:t}=e,[i,n]=(0,eh.M)(em.E.onboardingChecklistSteps,ef),r=(0,ee.rd)(),c=(0,b.useMemo)(()=>Object.entries(sR),[]),u=(0,$.fW)(),{isOpen:x,onOpen:h,onClose:p,onToggle:g}=(0,ez.j)({id:"onboarding-checklist-popover"}),{isOpen:j,onOpen:f,onClose:v}=(0,ez.j)({id:"attached-helper-popover"}),[y,C]=(0,b.useState)(null),w=null!==y&&sR[y]||null,{rectAttrs:k}=es({selector:null==w?void 0:w.maskSelector}),{rectAttrs:E}=es({selector:'[data-id="'.concat(eC,'"]')}),S=k||E,I=(0,b.useCallback)(async e=>{"addMedia"===e&&(A.R.emit("bringInsertWidgetToFront",{inFront:!0}),await new Promise(e=>setTimeout(e,500))),(0,J.v)(tq.VV.ONBOARDING_CHECKLIST_WIDGET_ITEM_VIEWED,{item:e}),C(e);let t=sR[e];(null==t?void 0:t.actionBefore)&&t.actionBefore(),requestAnimationFrame(()=>{f()})},[f]),T=(0,b.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"btn";y&&((0,J.v)(tq.VV.ONBOARDING_CHECKLIST_WIDGET_ITEM_COMPLETED,{item:y,method:e}),C(null),v(),n({...i,[y]:!0}),"addMedia"===y&&A.R.emit("bringInsertWidgetToFront",{inFront:!1}))},[i,v,y,n]),R=!!(j&&w),{reward:_}=(0,sw.bS)("confettiOriginator","confetti"),{reward:O}=(0,sw.bS)("checklist-item-createFirstGamma","confetti"),{isChecklistComplete:D}=ey();(0,b.useEffect)(()=>{D&&((0,J.v)(tq.VV.ONBOARDING_CHECKLIST_WIDGET_COMPLETED),setTimeout(()=>{_()},500))},[D,_]),(0,b.useEffect)(()=>A.R.on("toggleOpen",e=>{let{behavior:t="toggle",skipTracking:i=!1}=e;if(!i){let e={open:tq.VV.ONBOARDING_CHECKLIST_WIDGET_OPENED,close:tq.VV.ONBOARDING_CHECKLIST_WIDGET_CLOSED,toggle:x?tq.VV.ONBOARDING_CHECKLIST_WIDGET_CLOSED:tq.VV.ONBOARDING_CHECKLIST_WIDGET_OPENED};(0,J.v)(e[t])}({open:()=>{h(),D&&n(ef)},close:p,toggle:g})[t]()}),[D,x,p,h,g,n]),(0,b.useEffect)(()=>{A.R.emit("isInOnboardingChecklist",x)},[x]),(0,b.useEffect)(()=>{let e=document.querySelector('[data-id="'.concat(sk,'"]')),t=null==e?void 0:e.closest(".chakra-popover__popper");t&&(k?t.style.pointerEvents="none":t.style.pointerEvents="auto",y?t.style.zIndex="1":t.style.zIndex="".concat(e$.$.onboardingChecklist))},[y,k]);let P=(0,b.useCallback)(()=>{null!=w&&w.skipCompleteStepOnMaskClick||T("mask")},[T,w]);(0,b.useEffect)(()=>{x&&!i.createFirstGamma&&(n({...ef,createFirstGamma:!0}),(0,J.v)(tq.VV.ONBOARDING_CHECKLIST_WIDGET_ITEM_COMPLETED,{item:"createFirstGamma",method:"auto"}),O())},[i.createFirstGamma,n,O,x]);let z=(0,b.useCallback)(()=>{(0,J.v)(tq.VV.ONBOARDING_CHECKLIST_WIDGET_CLOSED),p()},[p]),M=er(r),W=(0,V.dU)("gray.500","gray.400");return(0,s.jsxs)(q.L8,{isDark:r,children:[(0,s.jsxs)(N.A,{isOpen:x,placement:"top",gutter:8,children:[(0,s.jsx)(F.d,{children:(0,s.jsx)(ew,{})}),(0,s.jsx)(L.Z,{children:(0,s.jsx)(G.h,{"data-id":sk,marginInlineEnd:X.uA,...M,children:D?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(sC.q,{fontSize:"xxs",zIndex:3,onClick:p}),(0,s.jsxs)(o.B,{align:"center",justify:"flex-start",direction:"column",textAlign:"start",spacing:4,py:6,pb:4,px:4,children:[(0,s.jsxs)(o.B,{spacing:2,children:[(0,s.jsx)(B.D,{size:"lg",id:"confettiOriginator",children:(0,s.jsx)("span",{role:"img","aria-label":"confetti",children:"\uD83C\uDF89"})}),(0,s.jsx)(B.D,{size:"lg",textAlign:"start",children:(0,s.jsx)(m.x6,{id:"KQBnUP"})}),(0,s.jsx)(l.E,{fontSize:"sm",children:(0,s.jsx)(m.x6,{id:"hAMA9K",values:{GAMMA_PROPER_NOUN:ej.On}})})]}),(0,s.jsxs)(o.B,{flexDirection:"column",justifyContent:"center",alignContent:"center",spacing:2,w:"100%",children:[(0,s.jsx)(a.$,{as:iJ.N,width:"100%",href:"/create",variant:"solid",target:"_blank",size:"sm",textDecoration:"none !important",onClick:()=>{(0,J.v)(tq.VV.ONBOARDING_CHECKLIST_WIDGET_COMPLETION_MODAL_CTA_CLICKED,{cta:"create"})},children:(0,s.jsx)(m.x6,{id:"WudVHw"})}),(0,s.jsx)(a.$,{width:"100%",variant:"plain",size:"sm",onClick:()=>{(0,J.v)(tq.VV.ONBOARDING_CHECKLIST_WIDGET_COMPLETION_MODAL_CTA_CLICKED,{cta:"edit"}),p(),t()},children:(0,s.jsx)(m.x6,{id:"bObOD4"})})]}),(0,s.jsx)(l.E,{fontSize:"xs",color:W,children:(0,s.jsx)(m.x6,{id:"sapBOc",components:{0:(0,s.jsx)(ep.u,{})}})})]})]}):(0,s.jsx)(sT,{onMinimizeClick:z,onListItemClick:I,completedSteps:i,steps:c})})})]}),(0,s.jsxs)(L.Z,{children:[(0,s.jsxs)(N.A,{strategy:"fixed",isOpen:R,lazyBehavior:"unmount",closeOnBlur:!1,placement:k?"end-start":"top",isLazy:!0,gutter:8,modifiers:[{name:"computeStyles",options:{gpuAcceleration:!1}},{name:"detectOverflow",phase:"beforeWrite",requiresIfExists:["offset"],enabled:!0,fn:e=>{let{state:t}=e,i=(0,Y.A)(t,{boundary:"clippingParents"}),n=i.top>0||i.bottom>0||i.left>0||i.right>0,s=t.elements.popper.getBoundingClientRect();return(null==E?void 0:E.top)&&n&&(t.styles.popper={...t.styles.popper,right:u?"auto":"0px",top:"-".concat(8,"px"),left:u?"0px":"auto",bottom:"auto",transform:"translate3d(0px, ".concat(E.top-s.height,"px, 0px)"),marginInlineEnd:X.uA}),t}}],children:[(0,s.jsx)(F.d,{children:(0,s.jsx)(d.a,{position:"absolute",pointerEvents:"none",top:"".concat(null==S?void 0:S.top,"px"),left:"".concat(null==S?void 0:S.left,"px"),width:"".concat(null==S?void 0:S.width,"px"),height:"".concat(null==S?void 0:S.height,"px")})}),w&&y&&R&&(0,s.jsx)(L.Z,{children:(0,s.jsx)(G.h,{w:"400px",...M,children:(0,s.jsx)(sS,{item:w,itemKey:y,onButtonClick:()=>{T("btn")}})})})]}),y&&(0,s.jsx)(el,{selector:(null==w?void 0:w.maskSelector)||"",onClickTargetElement:P,rectAttrs:k||null,lockScroll:!0})]})]})};var sO=i(37930),sD=i(48478),sP=i(6760),sz=i(84462),sM=i.n(sz),sL=i(14753),sN=i(11496);let sF=sM()(()=>parseFloat(getComputedStyle(document.documentElement).fontSize)),sV=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,{fontSize:t,defaultContentWidth:i}=(0,eu.GV)(ex.Uu);return sG({zoomLevel:e,docSettingsFontSize:t,defaultContentWidth:i,viewportScaleFactor:(0,sL.t)(),theme:(0,eu.GV)(ex.SJ)})},sG=e=>{let{docSettingsFontSize:t,defaultContentWidth:i,zoomLevel:n=1,viewportScaleFactor:s,theme:r}=e,o=(0,O.Xb)(),{cardWidthEms:l,baseFontSize:a}=(0,sN.S)({fontSize:t,contentWidth:i,theme:r,isMobileDevice:o});return s*a*sF()*n*l};var sW=i(15607),sB=i(36679);let sU={portrait:{max:1,min:.4},landscape:{max:1,min:.5}};function sH(e,t){var i;let n=e&&getComputedStyle(e).getPropertyValue(t);return n?parseInt(null==(i=n.match(/\d+/))?void 0:i[0],10):0}let sK=e=>{let{cardWrapperWidth:t,cardWrapperLeftPaddingNum:i,cardWrapperRightPaddingNum:n}=e;return t-i-n},sq=()=>{let{max:e,min:t}=sU[(0,eu.GV)(ex.fX)||"landscape"]||sU.landscape;return{max:e,min:t}},sY=e=>{let{editor:t,editorWrapperDiv:i,aspectRatioValue:n}=e,s=(0,eu.jL)(),{max:r,min:o}=sq(),l=(0,b.useCallback)(e=>{e<r&&e>o?s((0,ex.Ye)({zoomLevel:e})):e>=r?s((0,ex.Ye)({zoomLevel:r})):e<=o&&s((0,ex.Ye)({zoomLevel:o}))},[s,r,o]),a=(0,eu.GV)((0,e1.lp)("left")),d=(0,eu.GV)((0,e1.lp)("right")),c=(0,eu.GV)(ex.yh),u=t&&(0,sW.jB)(t,0),x=sV(),h=(0,b.useCallback)(()=>{try{if(!i)return;document.body.classList.add(sB.Ur);let e=function(e,t){let i=null==e?void 0:e.querySelector(".card-wrapper"),n=sH(i,"padding-top"),s=sH(i,"padding-bottom"),r=null==i?void 0:i.clientWidth,o=sH(i,"padding-left"),l=sH(i,"padding-right");return{editorHeight:t.clientHeight,cardWrapperTopPaddingNum:n,cardWrapperBottomPaddingNum:s,cardWrapperWidth:r,cardWrapperLeftPaddingNum:o,cardWrapperRightPaddingNum:l}}(u,i);if(0===e.cardWrapperWidth)return;let t=sK(e),s=n&&t/n,r=function(e){let{editorHeight:t,cardWrapperTopPaddingNum:i,cardWrapperBottomPaddingNum:n}=e;return t-i-n}(e),o=s&&s-r;if(n&&o&&o>-10){let e=r*n,t=Math.round(e/x*100);l(t/100)}else{let e=Math.round(t/x*100);l(e/100)}requestAnimationFrame(()=>{document.body.classList.remove(sB.Ur)})}catch(e){nz.Cp(e),console.error(e)}},[i,n,u,x,l]);(0,b.useEffect)(()=>{c&&h()},[c,h]),(0,b.useEffect)(()=>{c&&ts()(h,200)()},[c,h,a,d]),(0,b.useEffect)(()=>(c&&window.addEventListener("resize",h),c||window.removeEventListener("resize",h),()=>{window.removeEventListener("resize",h)}),[h,c])},sJ=[1.4,1.3,1.2,1.1,1,.9,.8,.7,.6,.5],sX=e=>{let{editor:t,editorWrapperDiv:i,aspectRatioValue:n}=e,r=(0,ee.rd)(),o=(0,eu.jL)(),l=(0,eu.GV)(ex.Uu),d=(0,eu.GV)(ex.sA),c=(0,eu.GV)(ex.We),u=(0,eu.GV)(ex.yh),x=l.scaleContentToFit,h=(0,R.u)("docAlwaysZoomToFit");sY({editor:t,editorWrapperDiv:i,aspectRatioValue:n});let m=e=>{o((0,ex.Ye)({zoomLevel:e}))},g=e=>{o((0,ex.us)({enabled:e}))};return((0,b.useEffect)(()=>{let e="social"===d.formatType,t="fluid"!==l.cardDimensions&&"deck"===d.formatType;e||t||x?o((0,ex.us)({enabled:!0})):"fluid"===l.cardDimensions&&(o((0,ex.Ye)({zoomLevel:1})),h?o((0,ex.us)({enabled:!0})):o((0,ex.us)({enabled:!1})))},[o,d.formatType,l.cardDimensions,x,h]),x)?null:(0,s.jsx)(q.L8,{isDark:r,children:(0,s.jsxs)(no.W,{children:[(0,s.jsx)(nl.I,{w:"fit-content",as:a.$,position:"relative",size:"xs",minWidth:"46px",maxW:"46px",borderRadius:"full",fontSize:"11px",px:"1",sx:{fontVariantNumeric:"tabular-nums"},children:"".concat(Math.round(100*c),"%")}),(0,s.jsx)(na.c,{children:(0,s.jsxs)(sO.i,{value:u?"fit":"".concat(c),onChange:e=>{if("fit"===e)return void g(!0);m(parseFloat(e)),g(!1)},children:[sJ.map(e=>(0,s.jsxs)(sD.k,{value:"".concat(e),children:[Math.round(100*e),"%"]},e)),(0,s.jsx)(sP.N,{}),(0,s.jsx)(sD.k,{value:"fit",children:p.Ru._({id:"u4iXQi"})})]})})]})})},s$=e=>{let{editor:t,editorWrapperDiv:i,aspectRatioValue:n}=e;return(0,s.jsx)(eD.x,{zIndex:e$.$.bottomRightControls,children:(0,s.jsxs)(o.B,{direction:"column",alignItems:"flex-end",children:[(0,s.jsx)(sX,{editor:t,editorWrapperDiv:i,aspectRatioValue:n}),(0,s.jsxs)(o.B,{direction:"row",children:[(0,s.jsx)(s_,{onEditClick:()=>{null==t||t.commands.focusDelayed()}}),(0,s.jsx)(eP.P,{showOnboardingChecklist:!0})]})]})})};var sZ=i(44811),sQ=i(94289),s0=i(8255),s1=i(87386),s6=i(62452),s2=i(72386),s5=i(10817),s3=i(77387),s4=i(30034),s8=i(62171);let s7=b.createContext({enabled:!1,registerEditor:(e,t)=>{},getAllCards:()=>[],userMessage:"",setUserMessage:e=>{}});function s9(){return(0,b.useContext)(s7)}let re=e=>{let{children:t}=e,i=(0,b.useRef)(new Map),n=(0,b.useRef)(""),r=(0,b.useRef)((e,t)=>{i.current.set(e,t)}),o=(0,b.useRef)(()=>Array.from(i.current.values()).map(e=>{var t,i;return null==(i=e.state.doc.firstChild)||null==(t=i.content.toJSON())?void 0:t[0]}).filter(Boolean)),l=(0,b.useCallback)(e=>{n.current=e},[]);return(0,s.jsx)(s7.Provider,{value:{enabled:!0,registerEditor:r.current,getAllCards:o.current,userMessage:n.current,setUserMessage:l},children:t})};var rt=i(48993),ri=i(63821),rn=i(10500);let rs=e=>{let{cardId:t,onClick:i}=e,n=(0,eu.GV)((0,rt.qw)(t)),r=(0,eu.GV)(ex.SJ);return n?(0,s.jsxs)(o.B,{zIndex:1,mt:"4.5em",width:"180px",bg:"whiteAlpha.500",border:"1px solid",borderColor:"blackAlpha.300",borderRadius:"lg",p:4,sx:{"*":{"backdrop-filter":"none !important","-webkit-backdrop-filter":"none !important"}},children:[n.variants.map(e=>{if(!e)return null;let{label:o,card:l,id:a}=e;return(0,s.jsx)(rr,{theme:r,isSelected:n.selected===a,label:o,card:l,onClick:()=>{i({cardId:t,variationId:a})}},a)}),n.variants.length<2&&(0,s.jsx)(U.o,{children:(0,s.jsx)(t3.y,{})})]}):null},rr=e=>{let{label:t,card:i,theme:n,isSelected:a=!1,onClick:d=()=>{}}=e,c=(0,b.useMemo)(()=>(0,s1.createDocWithCards)({},[i]),[i]);return(0,s.jsxs)(o.B,{align:"start",children:[(0,s.jsx)(r.s,{borderRadius:"md",bg:"white",shadow:a?"outline":"md",overflow:"hidden",cursor:"pointer",_hover:{bg:"trueblue.50"},transitionProperty:"common",transitionDuration:"fast",onClick:d,children:(0,s.jsx)(r.s,{sx:s3.o,css:{"--editor-font-size":"0.15rem","--editor-width":"150px"},justifyContent:"center",alignItems:"top",pointerEvents:"none",children:(0,s.jsx)(s3.S,{content:c,theme:n,isThumbnail:!0})})}),(0,s.jsxs)(l.E,{fontSize:"sm",children:[a&&(0,s.jsx)(rn.S,{boxSize:3,mr:2}),t]})]})},ro="ai-wizard-editor-root",rl=e=>{let{doc:t,cards:i,theme:n=(0,s2.N)()}=e,o=(0,s8.fS)(n),l=(0,s6.Mw)(n),a=(0,s8.FD)(o,l),d=(0,eu.jL)(),{registerEditor:c}=s9();return((0,b.useEffect)(()=>()=>{d((0,rt.cL)())},[d]),t)?(0,s.jsxs)(r.s,{bg:"gray.50",overflowY:"auto",overflowX:"hidden",justifyContent:"flex-start",alignContent:"center",alignItems:"center",alignSelf:"stretch",direction:"column",width:"100%",height:"100%",position:"relative",className:ro,...a,children:[(0,s.jsx)(s4.s,{}),i.map((e,i)=>{var n;let r=null==(n=e.attrs)?void 0:n.id;return r?(0,s.jsx)(ra,{doc:t,cardId:r,cardIndex:i,cardJSON:e,onCreate:e=>{c(r,e)}},r):null})]}):null},ra=e=>{let{cardId:t,cardIndex:i,cardJSON:n,doc:o,onCreate:l}=e,a=(0,eu.jL)(),[d,c]=(0,b.useState)(null),{userMessage:u}=s9(),x=(0,ri.F)({editor:d});(0,b.useEffect)(()=>{d&&x({doc:d.state.doc,cardId:t,message:u})},[x,d,t,i,u]);let h=(0,b.useMemo)(()=>(0,s1.createDocWithCards)({},[n]),[n]),m=(0,eu.GV)((0,rt.vE)(t));(0,t$.Vg)(()=>{if(!d||!m)return;let e=(0,tf.W0)(d,t);e&&d.commands.command(t=>{let{tr:i}=t,n=sQ.bP.fromJSON(d.schema,m.card);return i.replaceWith(e.pos,e.pos+e.node.nodeSize,n),!0})},[d,m,t],[m]);let p=(0,b.useCallback)(e=>{let{cardId:i,variationId:n}=e;d&&i===t&&a((0,rt.S6)({cardId:t,variantId:n}))},[a,d,t]);return(null==o?void 0:o.id)?(0,s.jsxs)(r.s,{className:"ai-variation-editor-".concat(t),alignItems:"flex-start",sx:s3.o,my:-8,children:[(0,s.jsx)(rs,{cardId:t,onClick:p}),(0,s.jsx)(s5.b,{initialContent:h,onCreate:e=>{let{editor:t}=e;c(t),l(t)},doc:o,docId:o.id,scrollingParentSelector:".".concat(ro),readOnly:!0,isStatic:!0,animationsEnabled:!1,extensions:[],shouldSupportMenus:!1})]}):null},rd=e=>{let{isOpen:t,onClose:i,onOpen:n}=(0,iN.E)({id:"cardSuggestionDrawer"}),r=(0,eu.GV)(ex.SJ),[o]=(0,b.useState)(()=>(0,sZ.U1)({reducer:eu.Ki}));return(0,s.jsx)(y.Kq,{store:o,children:(0,s.jsx)(rc,{...e,isOpen:t,onClose:i,onOpen:n,theme:r})})},rc=(n=e=>{let{doc:t,editor:i,theme:n,isOpen:r,onClose:o,onOpen:l}=e,[d,c]=(0,b.useState)([]),[u,x]=(0,b.useState)(null),{getAllCards:h,setUserMessage:p}=s9(),g=(0,b.useCallback)(()=>{o(),c([]),x(null)},[o]),j=(0,b.useCallback)(()=>{if(g(),!i)return;let e={type:"document",content:h()};console.log("[handleConfirm] contentToUse",e);let t=1,n=i.state.doc.nodeSize-2,s=(0,tf.W0)(i,u);if(s){n=(t=s.pos)+s.node.nodeSize;let i=e.content.find(e=>{var t;return(null==(t=e.attrs)?void 0:t.id)===u});if(!i)return void console.warn("[handleConfirm] Count not find card to use");e=i}i.commands.command(s=>{let{tr:r}=s;return r.replaceRangeWith(t,n,sQ.bP.fromJSON(i.schema,e)),!0})},[g,i,u,h]),f=(0,b.useCallback)(async(e,t,i)=>{l(),x(t),c(e.toJSON().content[0].content.filter(e=>{var i;return null===t||(null==(i=e.attrs)?void 0:i.id)===t})),p(i)},[l,p]);return(0,b.useEffect)(()=>{if(i)return s0.R.on("openSuggestionEditor",e=>{let{cardId:t,userMessage:n}=e;f(i.view.state.doc,t,n)})},[i,f]),(0,s.jsxs)(iA._s,{placement:"bottom",onClose:o,isOpen:r,trapFocus:!0,isFullHeight:!0,children:[(0,s.jsx)(i6.m,{}),(0,s.jsxs)(iT.z,{borderTopRadius:"xl",h:"calc(var(--100vh) - 24px)",transform:"none !important",children:[(0,s.jsx)(i_.s,{zIndex:"10",backgroundColor:"white",mr:2,shadow:"md"}),(0,s.jsx)(iO.c,{p:0,h:"100%",children:d.length>0&&t?(0,s.jsx)(rl,{doc:t,cards:d,theme:n}):(0,s.jsx)(iX.Y,{})}),(0,s.jsx)(i3.j,{borderTop:"1px solid #000",borderColor:"gray.200",children:(0,s.jsxs)(e7.e,{spacing:4,children:[(0,s.jsx)(a.$,{variant:"ghost",onClick:o,children:(0,s.jsx)(m.x6,{id:"dEgA5A"})}),(0,s.jsx)(a.$,{variant:"solid",onClick:j,children:(0,s.jsx)(m.x6,{id:"7VpPHA"})})]})})]})]})},(0,b.memo)(e=>(0,s.jsx)(re,{children:(0,s.jsx)(n,{...e})})));var ru=i(17928),rx=i(65978),rh=i(42670),rm=i(7270),rp=i(26449),rg=i(68917);let rj=e=>{let{count:t,onClose:i,commentStatusFilter:n,setCommentStatusFilter:o}=e;return(0,s.jsxs)(r.s,{width:"100%",px:6,py:4,justifyContent:"space-between",alignItems:"center",h:16,tabIndex:0,outline:"none",children:[(0,s.jsx)(r.s,{flex:1,children:(0,s.jsxs)(e8.z,{spacing:4,children:[(0,s.jsx)(tO.N,{children:(0,s.jsx)(m.x6,{id:"eiUA4k",values:{count:t}})}),(0,s.jsxs)(no.W,{closeOnSelect:!0,children:[(0,s.jsx)(nl.I,{as:a.$,size:"sm",rightIcon:(0,s.jsx)(rg.D,{}),children:n===ik.EB6.Open?(0,s.jsx)(m.x6,{id:"dXB4UR"}):(0,s.jsx)(m.x6,{id:"jeFwPX"})}),(0,s.jsx)(na.c,{zIndex:3,children:(0,s.jsxs)(sO.i,{defaultValue:n,title:p.Ru._({id:"0cVgUw"}),type:"radio",children:[(0,s.jsx)(sD.k,{onClick:()=>o(ik.EB6.Open),value:"open",children:(0,s.jsx)(m.x6,{id:"dXB4UR"})}),(0,s.jsx)(sD.k,{onClick:()=>o(ik.EB6.Closed),value:"closed",children:(0,s.jsx)(m.x6,{id:"jeFwPX"})})]})})]})]})}),(0,s.jsx)(tS.J,{onClick:i,"data-comment-feed-close-button":!0})]})};var rf=i(36842),rv=i(21465),rb=i(72926);let ry=e=>{let{user:t,editor:i}=e,[n,r]=(0,b.useState)(()=>{let e=(0,rv.tq)(i,ic.S5);return e&&e.length?e[0]:(0,rv.CD)(()=>ic.S5,i,"")});(0,b.useEffect)(()=>{if(n&&i)return()=>{var e,t;null==(e=(t=i.commands).createDraftComment)||e.call(t,n)}},[n,i]);let o=(0,rb.Zb)({draftComment:n,clearDraftComment(){var e,t,s,o;n&&(null==(s=(o=i.commands).removeDraftComments)||s.call(o,[n]));let l=(0,rv.CD)(()=>ic.S5,i,"");null==(e=(t=i.commands).createDraftComment)||e.call(t,l),r(l)},editor:i}),l=(0,b.useCallback)(e=>{let{editor:t}=e;r(e=>e?{...e,json:t.view.state.doc.toJSON(),text:t.view.state.doc.textContent}:e)},[]);return(0,s.jsx)(rf.h,{draftComment:n,user:t,onCommentDraftUpdate:l,onCommentSave:o,commentIdToHighlight:null})},rC=()=>({today:p.Ru._({id:"ecUA8p"}),thisWeek:p.Ru._({id:"yByRxz"}),earlier:p.Ru._({id:"HPqZkW"})}),rw=e=>{var t;let{onClose:i,editor:n}=e,o=(0,eu.GV)(e_.Jo),{isConnected:l}=(0,E.u)(),[a,c]=(0,b.useState)(ik.EB6.Open),u=null==o?void 0:o.comments,x=null==o||null==(t=o.comments)?void 0:t.filter(e=>e.status===a),h=(0,eu.GV)(ex.wC),p=(0,et.Iy)("comment",o)&&l,{user:g}=(0,et.ur)(),j=(0,S.h6)(o,g),f=(0,b.useMemo)(()=>(0,rp.WP)({items:x||[],sortBy:rp.VJ,latestTimeGetterFn:rp.wS}),[x]);return u&&o&&n?(0,s.jsxs)(r.s,{direction:"column",h:"100%",overflowX:"hidden",className:rx.V,w:"100%",children:[(0,s.jsx)(rj,{commentStatusFilter:a,setCommentStatusFilter:c,count:(null==x?void 0:x.length)||0,onClose:i}),(0,s.jsxs)(r.s,{direction:"column",className:"comments-list",flex:1,overflowY:"auto",tabIndex:0,outline:"none",children:[(0,s.jsx)(eq.r,{description:(0,s.jsx)(m.x6,{id:"pQvCbR"}),isConnected:l,mx:6}),j&&!g&&o&&(0,s.jsx)(rm.W,{doc:o,accessLink:j}),p&&(0,s.jsx)(d.a,{px:6,py:2,children:(0,s.jsx)(ry,{user:g,editor:n})}),!(null==x?void 0:x.length)&&(0,s.jsx)(U.o,{p:6,children:(0,s.jsx)(si.p,{size:"sm",title:"open"===a?(0,s.jsx)(m.x6,{id:"0Bm90s"}):(0,s.jsx)(m.x6,{id:"QnXc6h"}),description:(0,s.jsx)(m.x6,{id:"iB9OEi"})})}),Object.entries(f).filter(e=>{let[,t]=e;return t.length}).map(e=>{let[t,l]=e;return(0,s.jsxs)(r.s,{direction:"column",children:[(0,s.jsx)(q._x,{px:6,pt:4,pb:2,position:"sticky",top:-2,bg:"white",zIndex:2,children:rC()[t]}),(0,s.jsx)(r.s,{direction:"column",children:l.map(e=>(0,s.jsx)(rh.h,{instanceType:"feed",userCanComment:p,editor:n,comment:e,selfUser:g,docId:null==o?void 0:o.id,editorMode:h,onClose:i,isRootComment:!0,pt:6,px:6,pb:4},e.id))})]},t)})]})]}):null},rk=e=>{let{closePanel:t}=e,{editor:i}=(0,tE.m)();return(0,b.useEffect)(()=>{let e=e=>{let{open:i}=e;i&&t()};return ru.LF.on(ru.DN.POPUP_COMMENT_TOGGLED,e),()=>{ru.LF.on(ru.DN.POPUP_COMMENT_TOGGLED,e)}},[t]),(0,s.jsx)(t_.Z,{bgColor:"white","data-panelid":"comment-feed-panel",children:(0,s.jsx)(rw,{onClose:t,editor:i})})};rk.panelPosition="right",rk.panelName="comment-feed";let rE=()=>{let{togglePanel:e,isPanelOpen:t}=(0,eY.ww)(rk);return{toggleCommentsPanel:e,isCommentsPanelOpen:t}};var rS=i(70315),rI=i(64961),rA=i(19783);let rT=()=>{var e,t;let i=(0,eu.GV)(e_.Jo),{user:n}=(0,nv.ur)(),s=(0,nv.Iy)("manage",i)&&!!n,r=null==i||null==(e=i.docGenerateInput)?void 0:e.docGeneration;if(i&&r&&(null==(t=i.createdBy)?void 0:t.id)===(null==n?void 0:n.id)&&s)return(0,D.o0)(r)};var rR=i(5221),r_=i(99745),rO=i(16306);let rD=e=>{let{onClose:t}=e;return(0,s.jsxs)(o.B,{flex:1,align:"center",justify:"center",p:6,spacing:6,children:[(0,s.jsx)(nV._,{src:"https://cdn.gamma.app/zc87vhr30n8uf3n/b4b04402416f4ec8b5c1dc24f4c2a3d6/optimized/Sal-Spaceship-Riding.png",px:12}),(0,s.jsx)(rO.q,{children:(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"jVQv+Q"})})}),(0,s.jsx)(a.$,{variant:"ghost",colorScheme:"blackAlpha",leftIcon:(0,s.jsx)(x.g,{icon:u.Jyw}),onClick:t,children:(0,s.jsx)(m.x6,{id:"pqZJT2"})})]})},rP=()=>(0,s.jsxs)(iP.F,{status:"warning",mt:12,minH:20,flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",borderRadius:"lg",borderWidth:"1px",children:[(0,s.jsx)(rR.X,{children:(0,s.jsx)(m.x6,{id:"rvbk/4"})}),(0,s.jsx)(r_.T,{children:(0,s.jsx)(m.x6,{id:"XNkIFY"})})]});var rz=i(36218),rM=i(63867);let rL="40px",rN=e=>{let{value:t,onChange:i,onSubmit:n,isLoading:r,editor:o,resetMessages:a}=e;(0,im.lC)(o);let{selection:d,doc:c}=o.state,u=c.textBetween(d.from,d.to,"\n"),h=(0,eK.ez)("unlimited_credits"),g=(0,b.useRef)(null),[j,f]=(0,b.useState)(!1),v=d instanceof rM.nh,y=d instanceof rM.U3,C=v&&"card"===d.node.type.name,w=d.empty||C?p.Ru._({id:"XrfE9D"}):v?p.Ru._({id:"CsUli9"}):y&&u?p.Ru._({id:"+NPPZN",values:{0:function(e,t){return e.length>50?e.slice(0,50)+"...":e}(u,50)}}):p.Ru._({id:"/fY1js"}),k=(0,b.useCallback)(()=>{g.current&&(g.current.style.height=rL,g.current.style.height="".concat(g.current.scrollHeight,"px"))},[]);return(0,b.useEffect)(()=>(o.on("selectionUpdate",k),()=>{o.off("selectionUpdate",k)}),[o,k]),(0,b.useEffect)(()=>{j?k():setTimeout(()=>{f(!0),k()},400)},[j,w,k,t]),(0,s.jsxs)(e8.z,{align:"end",children:[(0,s.jsx)(nX.M,{size:"md",children:(0,s.jsx)(rz.T,{"data-gamma-child-tiptap-editor":!0,id:"ai-chat-input",h:rL,minH:rL,ref:g,resize:"none",maxH:j?32:rL,bg:"white",shadow:"md",autoFocus:!0,placeholder:w,value:t,onKeyPress:e=>{"Enter"!==e.key||!(t.length>0)||r||e.shiftKey||(e.preventDefault(),n())},onChange:e=>i(e.target.value),paddingInlineEnd:12})}),(0,s.jsx)(q.Tz,{placement:"top",label:(0,s.jsxs)(tI.T,{spacing:0,children:[(0,s.jsx)(m.x6,{id:"4k2VbT"}),!h&&(0,s.jsx)(l.E,{color:"gray.400",children:(0,s.jsx)(m.x6,{id:"jxCfNz",components:{0:(0,s.jsx)(tR.G,{type:"chatSuggestion",ml:0})}})}),(0,s.jsx)(q.iM,{shortcut:"Enter"})]}),children:(0,s.jsx)(H.K,{"aria-label":"Send message",isDisabled:!t||r,size:"sm",h:rL,w:rL,variant:"solid",icon:(0,s.jsx)(x.g,{icon:tT.fmP,fixedWidth:!0}),onClick:n})})]})},rF=b.createContext({scrollToBottom:()=>{},onClose:()=>{}}),rV=()=>b.useContext(rF);var rG=i(76083),rW=i(42142),rB=i(59684),rU=i(79555),rH=i(66634),rK=i(73581),rq=i(12562),rY=i(47314),rJ=i(75703);class rX extends rH.a{async runPrompt(e){let{input:t,context:i,variables:n,trackFns:s,retries:r=2}=e,o=await (0,rK.U)(t,i.interactionId,{timeout:rq.of.get("aiRequestTimeouts").basicReply});if(!o)throw Error("Couldn't get response from prompt");if((0,rY.t)(o)||(null==o?void 0:o.includes("```"))){if(r<=0)throw new rB.K$("Did not receive proper response after retries",{chatMessage:"Sorry, I am having trouble understanding. Could you try asking in a different way?",inputMessage:i.message,resp:o,interactionId:i.interactionId});return s.trackRequestRetry({interactionId:i.interactionId,retriesRemaining:r,resp:o}),this.runPrompt({input:t,context:i,variables:n,trackFns:s,retries:r-1})}return o}async run(e){let{context:t,addMessage:i,history:n,trackFns:s,provider:r}=e,o={message:t.message},l=(0,rJ.K)(n||[]),a=this.prompt.prepare({variables:o,history:l,params:{provider:r},interactionId:t.interactionId}),d=await this.runPrompt({input:a,context:t,variables:o,trackFns:s,retries:1});s.trackRequestComplete({taskContext:t,outputMessage:d}),i({from:"Designer",type:"text",message:d,resp:d,interactionId:t.interactionId})}constructor(e){super(e),this.prompt=e.prompt}}let r$=[new rX({key:"CHAT",description:"A general chat message, or a request that doesn't fit any of the previous categories",classifyExamples:["hi how are you","hdfoho;safjw","help there are bees everywhere","great job!","this looks ugly"],prompt:new rU.F({systemPromptOperation:ik.mc.BasicReplyChatSystem,userPromptOperation:ik.mc.BasicReplyChatUser,variables:["message"],params:{maxTokens:150,temperature:0}})})],rZ=e=>r$.find(t=>t.key===e),rQ=e=>!!r$.find(t=>t.key===e);var r0=i(7158),r1=i(28630),r6=i(3819);class r2 extends rH.a{async run(e){var t,i;let{addMessage:n,context:s,trackFns:r,history:o,imageOptions:l}=e,a=performance.now(),d=r6.V.prepare({variables:{input:s.message,html:s.editorContext.cardContent.html}}),c=await (0,rK.U)(d,s.interactionId);if(!c)throw Error("Couldn't get response from prompt");let u={prompt:c,count:1,model:null!=(t=null==l?void 0:l.model)?t:R.of.get("aiGeneratedImagesDefaultModel"),stylePrompt:null==l?void 0:l.stylePrompt},x=r1.Rz[u.model],h={interactionId:s.interactionId,interface:"generate-image",provider:x.provider,streaming:!1,inputContent:c,docId:s.docId,generateImageOptions:u};try{(0,tU.rl)(h);let e=null==(i=(0,et.P9)())?void 0:i.id,t=await (0,r1.hU)({interactionId:s.interactionId,docId:s.docId,workspaceId:e,...u});if(0===t.length)throw Error("No images generated");n({from:"Designer",type:"generateImage",suggestions:t,interactionId:s.interactionId,isFirstGenerationInSession:!o||!o.some(e=>"generateImage"===e.type),message:s.message}),(0,tU.Yh)({...h,latency:performance.now()-a,generateImageUrls:t.map(e=>e.attrs.src)}),r.trackRequestComplete({taskContext:s,outputContent:JSON.stringify(t),outputMessage:""})}catch(e){console.error("(caught) [AIGenerateImage] error:",e),(0,tU.tB)({...h,latency:performance.now()-a,errorName:"GenerateImageError",errorMessage:e.message,outputMessage:""})}}constructor(e){super(e)}}let r5=[new r2({key:"GENERATE_IMAGE",description:"Generate an image using AI.",classifyExamples:["generate an image of a panda eating starbursts","add an AI image that shows people talking and working","use AI to make a picture of a laptop on a windowsill","generate an image of a watercolor painting of a flower vase"],classifyReply:"Sure, I'll generate an image of a panda..."})],r3=e=>r5.find(t=>t.key===e),r4=e=>!!r3(e);var r8=i(83605),r7=i(90010),r9=i(9922),oe=i.n(r9),ot=i(91242),oi=i(63562);class on{isApplied(e){return!!(0,tf.W0)(e,this.cardId)}getPreviewJson(e){let t=e.state.tr;this.transact(e,t);let i=oe()(t.doc.toJSON());return(0,oi.sT)(i,this.cardId)}apply(e){if(this.isApplied(e))return void console.debug("[InsertCardModification] NOT applying modification, card already exists with cardId=".concat(this.cardId),{modification:this});let t=e.state.tr;this.transact(e,t),console.debug("[InsertCardModification] Applying modification",{modification:this}),e.view.dispatch(t),(0,tV.OM)({editor:e,cardId:this.cardId})}transact(e,t){let i=(0,tf.W0)(e,this.afterCardId);if(!i)return null;let n=(0,oi.ni)(e,this.content),s=i.pos+i.node.nodeSize;t.insert(s,n.content.firstChild);let r=(0,ot.s)(t.doc.resolve(s),1);return t.setSelection(r),{from:s,to:s+t.doc.nodeAt(s).nodeSize}}getContentForTracking(){return this.content}constructor(e){this.type="insert-card",this.description=e.description,this.cardId=e.cardId,this.afterCardId=e.afterCardId,this.content=e.content}}class os{isApplied(e){return!(0,tf.W0)(e,this.cardId)}getPreviewJson(e){return null}apply(e){let t=e.state.tr,i=(0,tf.W0)(e,this.cardId);i&&(t.delete(i.pos,i.pos+i.node.nodeSize),console.debug("[RemoveCardModification] Applying modification",{modification:this}),e.view.dispatch(t))}getContentForTracking(){return this.cardId}constructor(e){this.type="remove-card",this.description=e.description,this.cardId=e.cardId}}var or=i(30481);class oo extends or.dV{async getResponseMessages(e){let{editor:t,context:i,response:{suggestion:n,message:s,raw:r}}=e;if(!n)throw new rB.tF("No card content returned",{interactionId:i.interactionId,resp:r,chatMessage:s||(0,or.Fz)(),inputMessage:i.message});let o=(0,r7.IZ)((0,r7.lI)(t)),{aiOptions:l}=(0,r7.lI)(t),a=null==l?void 0:l.imageOptions,d=await (0,r8.Lm)(n,{loadImages:!0,docFormatKey:o.formatType,cardIndex:1,imageOptions:a||{provider:"web"},theme:i.editorContext.theme,context:{docId:i.docId,workspaceId:(0,et.gx)(),interactionId:i.interactionId}}),c=d.attrs.id,u=new on({description:"New Card",content:{type:"json",json:[d]},cardId:c,afterCardId:i.editorContext.card.cardId}),x={label:"New card",modification:u,jsonContentPreview:u.getPreviewJson(t)},h=new os({description:"Remove card",cardId:c}),m={label:"Remove card",modification:h,jsonContentPreview:h.getPreviewJson(t)},p={from:"Designer",type:"suggestContent",resp:r,message:s||"How about this?",suggestions:[x,m],interactionId:i.interactionId};return console.debug("[addCard]",{insert:x,remove:m,message:s,html:n,content:d}),{messages:[p],suggestionToApply:x}}}let ol=new oo({key:"ADD_CARD",description:"Add a new card after the current one",classifyExamples:["add a new slide","add a card describing our mission","i want a new section for leadership development","make another card","on a new card compare the two options in a table"],classifyReply:"Ok, I'll start writing a new card...",prompt:new rU.F({systemPromptOperation:ik.mc.AddCardSystem,userPromptOperation:ik.mc.AddCardUser,variables:["html","message","outline"],params:{temperature:.7,maxTokens:1e3}})});var oa=i(17275);class od{isApplied(e){let t=(0,tf.W0)(e,this.cardId);return t?t.node.attrs.layout===this.layout:(console.error("[SetCardLayoutModification.apply] Could not find card to update: ".concat(this.cardId,", maybe deleted")),!1)}getPreviewJson(e){let t=e.state.tr;this.transact(e,t);let i=oe()(t.doc.toJSON()),n=(0,oi.sT)(i,this.cardId);return console.debug("[SetCardLayoutModification.getPreviewJson] result",n),n}apply(e){if(this.isApplied(e))return void console.debug("[SetCardLayoutModification] NOT applying modification, card already has layout=".concat(this.layout),{modification:this});let t=e.state.tr;this.transact(e,t),console.debug("[SetCardLayoutModification] Applying modification",{modification:this}),e.view.dispatch(t),(0,tV.OM)({editor:e,cardId:this.cardId})}transact(e,t){let i=(0,tf.W0)(e,this.cardId);if(!i)return void console.error("[SetCardLayoutModification.apply] Could not find card to update: ".concat(this.cardId,", maybe deleted"));(0,oa.c)(e,t,i.pos,this.layout)}getContentForTracking(){return this.layout}constructor(e){this.type="set-card-layout",this.description=e.description,this.cardId=e.cardId,this.layout=e.layout}}let oc=()=>p.Ru._({id:"ppX7+s"});class ou extends or.dV{async getResponseMessages(e){let{editor:t,context:i,rangeId:n,response:{suggestion:s,raw:r,message:o}}=e;if(!s)throw new rB.tF("No card layout returned",{resp:r,chatMessage:oc(),inputMessage:i.message,interactionId:i.interactionId});if(!(0,tf.pI)(s))throw console.error("Invalid card layout:",s),new rB.tF("Invalid card layout: ".concat(s),{resp:r,chatMessage:oc(),inputMessage:i.message,interactionId:i.interactionId});let l=new od({description:p.Ru._({id:"nyQWMb"}),cardId:i.editorContext.card.cardId,layout:s}),a={label:p.Ru._({id:"nyQWMb"}),modification:l,jsonContentPreview:l.getPreviewJson(t)},d=new od({description:p.Ru._({id:"HxF6Fk"}),cardId:i.editorContext.card.cardId,layout:i.editorContext.card.attrs.layout}),c={label:p.Ru._({id:"HxF6Fk"}),modification:d,jsonContentPreview:d.getPreviewJson(t)};return{messages:[{from:"Designer",type:"suggestContent",resp:r,message:o||p.Ru._({id:"pMSbe+"}),interactionId:i.interactionId,suggestions:[a,c]}],suggestionToApply:a}}}let ox=new ou({key:"MOVE_ACCENT_IMAGE",description:"Move or remove the accent image of the card. Use ADD_IMAGE to add accent images.",classifyExamples:["move the sand dune to the left","remove the cover photo"],classifyReply:"Ok, I will move the accent image to the left...",getTaskTarget:e=>e.card,prompt:new rU.F({systemPromptOperation:ik.mc.ChangeAccentImageLayoutSystem,userPromptOperation:ik.mc.ChangeAccentImageLayoutUser,variables:["html","message"],params:{temperature:.2,maxTokens:100}}),checkEnabled:e=>"blank"!==e.card.attrs.layout}),oh=new rU.F({systemPromptOperation:ik.mc.ChangeContentSystem,userPromptOperation:ik.mc.ChangeContentUser,variables:["html","message","outline"],params:{temperature:.7,maxTokens:1e3}}),om=new or.dV({key:"CHANGE_CONTENT",description:"Rephrase, summarize, expand, change text formatting, add content, or express ideas differently.",classifyExamples:["condense this to just the key points","say this like a pirate","make this more formal","add a box about health benefits","add more text please","make the bullets red","make the text bigger","fill in the last  column","write something about ___","add ___ to the table"],classifyReply:"Ok, I'll try making it shorter...",prompt:oh,jsxPrompt:"ChatChangeContent"});var op=i(92053),og=i(20615),oj=i(20196),of=i(8327);let ov=new rU.F({systemPromptOperation:ik.mc.RateImagesSystem,userPromptOperation:ik.mc.RateImagesUser,variables:["dataset"],params:{temperature:.1,maxTokens:100}}),ob=async(e,t)=>{let i=e.map((e,t)=>{let{description:i,query:n}=e;return"".concat(t+1,": ").concat(i,": ").concat(n)}).join("\n"),n=ov.prepare({variables:{dataset:i},history:[]});return(await (0,rK.U)(n,t,{timeout:rq.of.get("aiRequestTimeouts").rateImages})||"").split("\n").map(e=>{let[,t]=e.split("-");return Number(t.trim())})};class oy extends or.dV{async getResponseData(e,t){let i=(await Promise.all(e.replaceAll(this.key,"").split("\n").map(async e=>{let t=e.split(",").map(e=>e.trim()).slice(0,2);return await (0,og.r)({queries:t,count:oj.s.count,provider:"web",prefetch:!0,options:{gammaFeature:"aiChat"}})}))).flat();console.debug("[SuggestImagesTask][getResponseData] allResults",i);let n=i.map(e=>{let{image:t,query:i}=e,n=(0,of.TF)(t,i,"web");return{description:(0,of.ve)(n)||"",query:i}});console.debug("[SuggestImagesTask][imageRatingData]",{imagesToRate:n});try{let e=await ob(n,t);if(console.debug("[SuggestImagesTask][imageRatingValues]",{imageRatingValues:e}),e.length!==i.length)throw Error("Image rating values length does not match allResults length");let s=i.map((t,i)=>({...t,rating:e[i]})).sort((e,t)=>t.rating-e.rating);return console.debug("[SuggestImagesTask][allResultsSorted]",{allResultsSorted:s}),s}catch(e){console.warn("[SuggestImagesTask] Error rating images. Returing unsorted results.",e)}return i}async getResponseMessages(e){let{context:t,response:{message:i,raw:n,suggestion:s}}=e;if(!s)throw new rB.tF("No image results were returned",{resp:n,inputMessage:t.message,chatMessage:i||"I'm sorry, I wasn't able to find any images for this.",interactionId:t.interactionId});return{messages:[{from:"Designer",type:"suggestImages",suggestions:await this.getResponseData(s,t.interactionId),resp:n,interactionId:t.interactionId,message:i||"Here are some suggestions:"}]}}}let oC=new oy({key:"ADD_IMAGE",description:"Add images, or replace an existing image. Do not use for moving or removing images.",classifyExamples:["add a picture of a bus","find some different images","this needs a pic","show me dolphins","find a meme of stonks","give me more images","add a background image","i need a graph of population over time"],classifyReply:"Let me look for some good bus pictures...",getTaskTarget:e=>e.defaultRange,prompt:new rU.F({systemPromptOperation:ik.mc.SuggestImagesSystem,userPromptOperation:ik.mc.SuggestImagesUser,variables:["html","message"],params:{temperature:.7,maxTokens:500}})});var ow=i(8584);class ok extends or.dV{getResponseData(e){let t=[];for(let i of e.matchAll(/^\/\/\s*(.*)$\n(.*)$/gm)){let e=i[1],n=i[2];t.push({reason:e,value:n})}return t}async getResponseMessages(e){let{editor:t,context:i,rangeId:n,response:{suggestion:s,message:r,raw:o}}=e;if(!s)throw new rB.tF("No suggestions found in response",{interactionId:i.interactionId,inputMessage:i.message,chatMessage:r||p.Ru._({id:"7KKeOM"})});let l=this.getResponseData(s).map(e=>{let i=new ow.m(t,{description:e.reason,content:{type:"html",html:e.value},rangeId:n});return{...e,modification:i}}),a=this.determineTaskTarget(i.editorContext).html,d=new ow.m(t,{description:p.Ru._({id:"HxF6Fk"}),content:{type:"html",html:a},rangeId:n}),c={reason:p.Ru._({id:"HxF6Fk"}),value:a,modification:d};return{messages:[{from:"Designer",type:"suggestText",message:r||p.Ru._({id:"3YHvwF"}),resp:o,suggestions:[...l,c],interactionId:i.interactionId}]}}}let oE=new ok({key:"SUGGEST_TEXT",description:"Open-ended request to rephrase a sentence or paragraph",classifyExamples:["write a better headline","How else could i say this?","this feels too corporate","suggest a more engaging way to say this","give me a more interesting description"],classifyReply:"Let me think of some other headlines...",getTaskTarget:e=>e.selectionRange,prompt:new rU.F({systemPromptOperation:ik.mc.SuggestTextSystem,userPromptOperation:ik.mc.SuggestTextUser,variables:["html","message"],params:{temperature:.7,maxTokens:1e3}}),checkEnabled(e){let{selection:t}=e,i=t instanceof rM.U3,n=t.$from.parent.eq(t.$to.parent);return i&&!t.empty&&t.to-t.from<800&&n}});class oS{apply(e,t){t.setThemeWithAccentImages(this.themeId)}isApplied(e,t){return t.isThemeApplied(this.themeId)}getPreviewJson(){return null}getContentForTracking(){return this.themeId}constructor(e,t){this.type="change-theme",this.description=t.description,this.themeId=t.themeId}}class oI extends or.dV{async getResponseMessages(e){let{editor:t,context:i,response:{raw:n,suggestion:s,message:r},themeModificationController:o}=e,{currentThemeId:l,isValidTheme:a}=o,d=null==s?void 0:s.split("\n"),c=await this.getFilteredSuggestions({ids:d,idToRemove:l,editor:t,isValid:a});if(0===c.length)throw new rB.tF("[SuggestContentTask] No themes provided in prompt response",{resp:n,chatMessage:p.Ru._({id:"GNHk+9"}),inputMessage:i.message,interactionId:i.interactionId});let u={label:p.Ru._({id:"HxF6Fk"}),themeId:l,modification:new oS(t,{description:p.Ru._({id:"HxF6Fk"}),themeId:l}),isOriginal:!0};return{messages:[{from:"Designer",type:"suggestThemes",resp:n,message:r||p.Ru._({id:"pMSbe+"}),suggestions:[...c,u],interactionId:i.interactionId}],suggestionToApply:c[0]}}async getFilteredSuggestions(e){let{ids:t,idToRemove:i,editor:n,isValid:s}=e;return t&&0!==t.length?(await Promise.all(t.map(e=>s(e).then(t=>t?e:null)))).filter(e=>null!==e).filter(e=>e!==i).map(e=>{let t=new oS(n,{description:p.Ru._({id:"nyQWMb"}),themeId:e});return{label:p.Ru._({id:"nyQWMb"}),themeId:e,modification:t}}):[]}}let oA=new oI({key:"SUGGEST_THEME",description:"Suggest a theme for the deck. This task will suggest themes based on the deck content or the prompt",classifyExamples:["change the theme","give me a blue theme","change the color palette","make this a dark theme","use a more colorful theme","let's change the look and the feel","change the theme to lilac and periwinkle","i'd like it to look more cheerful and welcoming"],classifyReply:"Let me find some themes...",prompt:new rU.F({systemPromptOperation:ik.mc.SuggestThemeSystem,userPromptOperation:ik.mc.SuggestThemeUser,variables:["html","message","outline"],params:{temperature:.7,maxTokens:100,model:"gpt-4-1106-preview"}})}),oT=[ox,op.t,om,oE,oC,ol,oA],oR=e=>oT.find(t=>t.key===e),o_=e=>!!oT.find(t=>t.key===e);class oO extends rH.a{async run(e){let{classificationResult:t,addMessage:i,context:n,trackFns:s}=e;i({from:"Designer",type:"unsupported",task:t.classification,message:this.apology,learnMoreLink:this.apologyLink,resp:t.resp,interactionId:n.interactionId}),s.trackRequestComplete({taskContext:n,outputMessage:this.apology})}constructor(e){super(e),this.apology=e.apology,this.apologyLink=e.apologyLink}}let oD=new oO({key:"CHANGE_CARD_BACKGROUND",description:"Change the background of the entire section.",classifyExamples:["make the background red","put a tunnel in the background","remove the background","get rid of the image in the background"],apology:"Sorry, I can't change backgrounds yet, but you can click on a card and change the background yourself. You can also change the document background by clicking Page Setup located at the top left corner of the page."}),oP=new oO({key:"CHANGE_FONT",description:"Change the font family or font style.",classifyExamples:["give me a more playful font","make the headings use arial","change the font to be more readable"],apology:"Sorry, I can't change fonts yet. But you can edit them yourself by creating a custom theme.",apologyLink:"https://gamma.app/public/o2he6ual8noal7u#card-82e40n78edir2x8"}),oz=new oO({key:"RESIZE_IMAGE",description:"Change the size of an image (its dimensions), or crop an image",classifyExamples:["make the image smaller","can you make the cat bigger","crop it so it's just the face","I want the disposition of the photos for more portrait instead of landscape"],apology:"Sorry, I can't resize images yet. But you can do it yourself by clicking on the image and dragging the boxes on the corners, or pressing the crop button above the image."}),oM=new oO({key:"EDIT_IMAGE",description:"Edit the appearance of an image",classifyExamples:["make the image brighter","add a blue border to the image","make the image black and white","add a nice filter to the image"],apology:"Sorry, I can't edit images yet."}),oL=new oO({key:"EXPORT",description:"Export or download the deck into a different a format.",classifyExamples:["download as ppt","make a pdf","export to google slides"],apology:"Sorry, I can't export files yet. However, you can download a PDF yourself by using the Share menu."}),oN=new oO({key:"SPLIT_CARD",description:"Split a card into multiple cards, or move content between cards.",classifyExamples:["break this into two cards","split this up as multiple slides","put the gallery on the next card"],apology:"Sorry, I can't split cards or move things between them yet. However, you can split cards yourself by typing /split inside a card."}),oF=new oO({key:"NEW_DECK",description:"Create a whole new deck",classifyExamples:["i need a presentation about [topic]","write a whole document about animal","make me a landing page about this"],apology:"To make a new deck, go back to the home screen and click New with AI."}),oV=new oO({key:"CHANGE_MULTIPLE_CARDS",description:"Make changes across multiple cards at once",classifyExamples:["I want this entire deck to be summarized","combine the cards together in one","make the whole doc sound more professional","make the deck more consistent","translate all of the cards","change the font for the whole deck"],apology:"Sorry, I can only change one card at a time right now."}),oG=new oO({key:"CHANGE_ANOTHER_CARDS",description:"Make changes for an unselected card",classifyExamples:["make the same change for the next card","do the same thing for the other cards","change the last card too","make this layout match the layout of the previous card","copy the first section from the last card here"],apology:"Sorry, I can only look at one card at a time right now. You can have me edit other cards by clicking on them."}),oW=new oO({key:"ADD_VIDEO",description:"Add a video or replace an existing video",classifyExamples:["add a youtube video about scrum","find videos of cats","i need more videos"],apology:"Sorry, I can't search for videos yet. You can embed video by copying the URL and pasting it into the card directly."}),oB=new oO({key:"ADD_FOOTNOTE",description:"Add a footnote to a card, or change footnotes",classifyExamples:["add a biography for him in a footnote","put the details into footnotes"],apology:"Sorry, I haven't learned to add footnotes yet. You can make footnotes by highlighting text and clicking the footnote button in the menu."}),oU=new oO({key:"MOVE_CARD",description:"Move a card to a different position in the deck",classifyExamples:["shift the slide to the top","move this card to the bottom"],apology:"Sorry, I haven't learned to move cards yet. You can move them by hovering on the table of contents on the left side of the screen and dragging them around."}),oH=new oO({key:"ADD_CHART",description:"Add a chart, diagram, or graph",classifyExamples:["put this information into a scatter plot","add a card about market share using a pie chart","i need to display this as a flow chart","create a diagram illustrating the interactions and relationships","can you change the card to have a line graph","turn this into a gantt chart","could you do this as a funnel diagram"],apology:"Sorry, Gamma doesn't support charts yet. You can paste in images of charts from other tools, or type /diagram in the editor to draw your own."}),oK=new oO({key:"ANIMATION",description:"Add animations to a card or edit animations",classifyExamples:["animate transitions","make the text appear one by one","fade in the images","make the bullets fly in"],apology:'Sorry, Gamma doesn\'t support custom animations yet. You can animate line by line by going into Present mode and pressing S for "spotlight".'}),oq=[oD,oP,oz,oM,oL,oN,oF,oV,oG,oW,oB,oU,oH,oK,new oO({key:"FOLLOW_LINK",description:"Read content from an external website",classifyExamples:["go to this website and add the content to this card http://www.example.com/","here is his linkedin page now add the details https://www.linkedin.com/...","add the images from https://medium.com/posts/2022/9/6/..."],apology:"Sorry, I'm not able to open links and read the content."}),new oO({key:"SHADOW",description:"Add or edit shadow for an element or text",classifyExamples:["add a drop shadow to the image","make the text have a shadow","make the button have a darker shadow"],apology:"Sorry, I'm not able to add custom shadows yet."})],oY=e=>oq.find(t=>t.key===e),oJ=e=>!!oY(e),oX=new rU.F({variables:["message","taskList","ackExamples","html","cardHtml"],systemPromptOperation:ik.mc.ClassifySystem,userPromptOperation:ik.mc.ClassifyUser,params:{maxTokens:100,temperature:.2}}),o$=[...oT,...oq,...r$,...r5],oZ="\uD83D\uDE14 Sorry, I didn't understand your request. Could you please try asking a different way?",oQ=async e=>{let t,{message:i,context:n,history:s,provider:r}=e,{ackExamples:o,taskList:l,enabledTasks:a}=o6(o$,n.editorContext),d=R.of.get("aiChatJsx"),c=o2(s),u={message:i,ackExamples:o,taskList:l,html:n.editorContext.defaultRange.html,cardHtml:n.editorContext.card.html},x=oX.prepare({variables:u,params:{provider:r},history:c});console.debug("[AIChat classify] Getting classification",{classifyHistory:c,input:x});let h=await (0,r0.wo)(x);if(d){let{promise:e}=(0,tB.i4)({variables:{message:u.message,html:u.html,cardHtml:u.cardHtml,taskList:u.taskList,ackExamples:u.ackExamples,history:c.map(e=>({role:e.role===ik.VDI.Assistant?"assistant":"user",content:e.content||""}))},interactionId:n.interactionId,workspaceId:n.workspaceId,promptKey:"ChatClassify",opts:{timeout:R.of.get("aiRequestTimeouts").classify}});t=await e}else t=await (0,rK.U)(h,n.interactionId,{timeout:R.of.get("aiRequestTimeouts").classify});let m=o1(t,a);return(m||(console.debug("Failed classification, trying again...",{resp:t,parsedResp:m}),m=o1(t=await (0,rK.U)(x,n.interactionId),a)),m)?(console.debug("[AIChat classify] Got classification",{resp:t,parsedResp:m}),m):{type:"UNKNOWN",classification:"UNKNOWN",ack:oZ,resp:t||""}},o0="Ok, I'll get right on it.",o1=(e,t)=>{var i;if(!e)return;let n=e.split("\n"),s=null==(i=n[0])?void 0:i.trim().toUpperCase();if(!t.find(e=>e.key===s))return;let r=n[1];return{classification:s.trim(),ack:r.includes(s.trim())?o0:r||("UNKNOWN"!==s?o0:oZ),resp:e,type:"CLASSIFICATION"}},o6=(e,t)=>{let i=e.filter(e=>!t||!e.checkEnabled||e.checkEnabled(t));return{taskList:i.map(e=>{var t;return"".concat(e.key,": ").concat(e.description,"\n").concat(null==(t=e.classifyExamples)?void 0:t.map(e=>"- ".concat(e)).join("\n"))}).join("\n\n"),ackExamples:i.filter(e=>e.classifyExamples&&e.classifyExamples.length>0&&e.classifyReply).map(e=>"Request:\n".concat(e.classifyExamples[0],"\nResponse:\n").concat([e.key,e.classifyReply].join("\n"))).join("\n\n"),enabledTasks:i}},o2=e=>e.slice(-7).map(e=>"User"===e.from?{role:ik.VDI.User,content:e.message}:e.isClassification?{role:ik.VDI.Assistant,content:e.resp}:null).filter(e=>!!e),o5=()=>{let{editor:e}=(0,tE.m)(),t=null==e?void 0:e.gammaDocId,{updateDocThemeWithAccentImages:i}=(0,ee.Kt)({docId:t,editor:e}),n=(0,eu.GV)(ex.r2),s=(0,b.useCallback)(e=>n===e,[n]),r=(0,ik.H4n)();return{setThemeWithAccentImages:i,isThemeApplied:s,currentThemeId:n,isValidTheme:(0,b.useCallback)(async e=>{try{let{data:t}=await r.query({query:ik.xAr,variables:{id:e},returnPartialData:!1});return(null==t?void 0:t.theme)!==null}catch(e){return console.warn("[useThemeModificationController.isValidTheme] Error checking if theme is valid",e),!1}},[r])}},o3=()=>(0,R.u)("azureOpenAI")?ik.eON.Azure:ik.eON.Openai;var o4=i(66380),o8=i(98673);let o7=()=>{let e=(0,eu.CU)(),t=(0,eu.jL)(),i=(0,b.useCallback)((e,i)=>{t((0,o8.F1)({taskContext:e,provider:i})),(0,tU.rl)({interactionId:e.interactionId,interface:"chat",inputMessage:e.message,docId:e.docId,cardId:e.editorContext.card.cardId,provider:i})},[t]),n=(0,b.useCallback)(e=>{t((0,o8.Q6)(e))},[t]),s=(0,b.useCallback)(e=>{t((0,o8.lb)(e))},[t]),r=(0,b.useCallback)(i=>{t((0,o8.G8)(i));let{taskContext:n}=i,s=(0,o8.SY)(n.interactionId)(e.getState());if(!s)return void console.error("[trackRequestComplete] no data found for interactionId",n.interactionId);(0,tU.UL)({interactionId:n.interactionId,interface:"chat",docId:n.docId,cardId:s.cardId,classification:s.classification,provider:s.provider,inputMessage:n.message,inputContent:s.inputContent,rawResponse:i.resp,outputMessage:s.outputMessage,outputContent:s.outputContent,latency:performance.now()-n.startTime,timeToComplete:performance.now()-n.startTime})},[t,e]),o=(0,b.useCallback)(t=>{let{outputMessage:i,errorMessage:n,errorCode:s,interactionId:r,resp:o,errorName:l}=t,a=(0,o8.SY)(r)(e.getState());if(!a)return void console.error("[trackRequestError] no data found for interactionId",r);(0,tU.tB)({interactionId:r,interface:"chat",docId:a.docId,cardId:a.cardId,classification:a.classification,provider:a.provider,inputMessage:a.message,inputContent:a.inputContent,outputMessage:i,errorName:l,errorMessage:n,errorCode:s,rawResponse:o,latency:performance.now()-a.startTime})},[e]),l=(0,b.useCallback)(t=>{let{interactionId:i,retriesRemaining:n,resp:s}=t,r=(0,o8.SY)(i)(e.getState());if(!r)return void console.error("[trackRequestRetry] no data found for interactionId",i);(0,tU.zA)({interactionId:i,interface:"chat",classification:r.classification,docId:r.docId,cardId:r.cardId,provider:r.provider,inputMessage:r.message,inputContent:r.inputContent,rawResponse:s,retriesRemaining:n})},[e]),a=(0,b.useCallback)(t=>{let{interactionId:i,suggestionContent:n,suggestionType:s,suggestionLabel:r,autoApplied:o}=t,l=(0,o8.SY)(i)(e.getState());if(!l)return void console.error("[trackSuggestionApplied] no data found for interactionId",i);let a="string"==typeof n?n:"html"===n.type?n.html:"json"===n.type?n.json:void 0;(0,tU.hj)({interactionId:i,interface:"chat",docId:l.docId,cardId:l.cardId,classification:l.classification,provider:l.provider,inputMessage:l.message,inputContent:l.inputContent,outputMessage:l.outputMessage,outputContent:l.outputContent,suggestionType:s,suggestionLabel:r,suggestionContent:a,autoApplied:!!o})},[e]);return(0,b.useMemo)(()=>({trackClassification:n,trackRequestComplete:r,trackInputContent:s,trackRequestSent:i,trackRequestError:o,trackRequestRetry:l,trackSuggestionApplied:a}),[n,s,r,i,o,l,a])},o9=e=>{let{editor:t,addMessage:i,getMessageHistory:n}=e,s=(0,eu.CU)(),r=o7(),{hasEnoughCreditsToChat:o}=(0,tH.B9)(),l=o5(),a=o3(),d=(0,eu.jL)(),c=(0,eu.GV)(rW.Hw),{imageModel:u,imageStyle:x}=(0,o4.V)(),h=(0,b.useCallback)(e=>{d((0,rW.Lx)(e))},[d]);return{sendMessage:(0,b.useCallback)(async e=>{var d;let c,m,p,{message:g}=e;if(!t)return;let j=(0,tU.$F)(),f=null==(d=(0,et.P9)(t.gammaOrgId))?void 0:d.id;try{c=(0,tY.s)(t,s),m={interactionId:j,startTime:performance.now(),message:g,editorContext:c,docId:t.gammaDocId,workspaceId:f},console.debug("[AIChat] starting interaction",m);let e=n();i({from:"User",type:"text",message:g,interactionId:j});let d=R.of.get("aiChatJsx")?"amazon":a;if(r.trackRequestSent(m,d),!o)return;h("classifying");let v=await oQ({message:g,context:m,history:e,provider:a});if(r.trackClassification({taskContext:m,classification:v.classification}),h("fetching"),console.debug("[AIChat] Starting task",{taskContext:m,classification:v.classification,history:e}),"UNKNOWN"===v.type)i({from:"Designer",type:"text",message:v.ack,resp:v.resp,isClassification:!0,interactionId:j}),r.trackRequestComplete({taskContext:m,outputMessage:v.ack});else if(rQ(v.classification)){let n=rZ(v.classification);await n.run({editor:t,addMessage:i,context:m,classificationResult:v,history:e,trackFns:r,themeModificationController:l,provider:a})}else if(oJ(v.classification)){let n=oY(v.classification);await n.run({editor:t,context:m,addMessage:i,classificationResult:v,history:e,trackFns:r,themeModificationController:l,provider:a})}else if(o_(v.classification)){i({from:"Designer",type:"text",message:v.ack||"Sure, let me see what I can do...",resp:v.resp,isClassification:!0});let e=n(),s=oR(v.classification);await s.run({editor:t,context:m,addMessage:i,classificationResult:v,history:e,trackFns:r,themeModificationController:l,provider:a}),p="chatSuggestion"}else if(r4(v.classification)){i({from:"Designer",type:"text",message:v.ack||"Sure, let me see what I can do...",resp:v.resp,isClassification:!0});let n=r3(v.classification);await n.run({editor:t,context:m,addMessage:i,classificationResult:v,history:e,trackFns:r,themeModificationController:l,provider:a,imageOptions:{model:u,stylePrompt:x}}),p="generateImage"}}catch(t){console.log("[AIChat.sendMessage] ERROR: ".concat(t.message,"}"),{err:t,taskContext:m});let e="Sorry, something unexpected happened. Please try again.";if(t instanceof rB.Bb){let n=t.opts.chatMessage||e;i({from:"Designer",type:"text",message:n,resp:t.opts.resp,interactionId:j}),r.trackRequestError({errorName:t.name,interactionId:j,outputMessage:n,errorMessage:t.message,resp:t.opts.resp})}else nz.Cp(t),i({from:"Designer",type:"text",message:e,interactionId:j}),r.trackRequestError({errorName:t.name,interactionId:j,outputMessage:e,errorMessage:t.message,errorCode:(0,i$.vI)(t)[0]})}p&&(0,tK.w)(p,void 0,j),h("idle")},[t,s,n,i,r,o,l,a,h,u,x]),status:c}};var le=i(17496);let lt=(0,b.memo)(e=>{let{message:t}=e,i=(0,iI.d)(),n=(0,Q.st)(),{scrollToBottom:r}=rV(),l=(0,b.useRef)(null),[d,c]=(0,b.useState)(!1),[h,g]=(0,b.useState)(null);(0,b.useEffect)(()=>{if(d){var e;null==(e=l.current)||e.focus(),null==r||r()}},[d,r,n]);let j=t.interactionId,f=t.type,v=(0,b.useCallback)(e=>{g(e),c(!0),null==n||n.track(Q.VV.AI_SUGGESTION_FEEDBACK,{interactionId:j,rating:e,type:f})},[n,j,f]),y=(0,b.useCallback)(()=>{var e;c(!1),null==n||n.track(Q.VV.AI_SUGGESTION_FEEDBACK,{interactionId:j,rating:h,type:f,feedback:null==(e=l.current)?void 0:e.value}),l.current&&(l.current.value=""),i({title:(0,s.jsx)(m.x6,{id:"d6N994"}),description:(0,s.jsx)(m.x6,{id:"YVJNHr",values:{GAMMA_PROPER_NOUN:ej.On}}),status:"success",duration:5e3,isClosable:!0})},[i,n,j,h,f]);return(0,s.jsxs)(o.B,{width:"100%",children:[(0,s.jsxs)(e8.z,{children:[(0,s.jsx)(tA.h,{}),(0,s.jsxs)(e7.e,{size:"xs",variant:"ghost",colorScheme:"blackAlpha",children:[(0,s.jsx)(q.Tz,{label:(0,s.jsx)(m.x6,{id:"kR82DG"}),placement:"top",children:(0,s.jsx)(H.K,{"aria-label":"thumbs down",color:"poor"===h?"red.600":void 0,borderWidth:"1px",borderColor:"poor"===h?"red.600":"transparent",bg:"poor"===h?"red.100":void 0,_hover:{bg:"poor"===h?"red.200":"blackAlpha.100"},icon:(0,s.jsx)(x.g,{icon:u.lS9}),onClick:()=>{v("poor")}})}),(0,s.jsx)(q.Tz,{label:(0,s.jsx)(m.x6,{id:"y1GvbS"}),placement:"top",children:(0,s.jsx)(H.K,{"aria-label":"thumbs up",color:"good"===h?"green.600":void 0,borderWidth:"1px",borderColor:"good"===h?"green.600":"transparent",bg:"good"===h?"green.100":void 0,_hover:{bg:"good"===h?"green.200":"blackAlpha.100"},icon:(0,s.jsx)(x.g,{icon:u.Wcv}),onClick:()=>{v("good")}})})]})]}),(0,s.jsx)(le.S,{in:d,children:(0,s.jsxs)(o.B,{children:[(0,s.jsx)(rz.T,{ref:l,bg:"white",size:"sm",placeholder:p.Ru._({id:"ZVGh9y"})}),(0,s.jsxs)(e7.e,{children:[(0,s.jsx)(tA.h,{}),(0,s.jsx)(a.$,{onClick:()=>c(!1),size:"xs",variant:"ghost",colorScheme:"blackAlpha",children:(0,s.jsx)(m.x6,{id:"6Uau97"})}),(0,s.jsx)(a.$,{onClick:y,size:"xs",variant:"plain",children:(0,s.jsx)(m.x6,{id:"RoafuO"})})]})]})})]})});lt.displayName="SuggestionFeedback";let li=(0,b.memo)(e=>{let{message:t,editor:i}=e,n=t.suggestions.slice(0,1),r=(0,eu.jL)(),d=(0,eu.CU)(),c=(0,b.useCallback)(()=>(0,rW.Lt)(d.getState()),[d]),{sendMessage:u}=o9({addMessage:(0,b.useCallback)(e=>{let t={timestamp:Date.now(),...e};r((0,rW.tj)({message:t}))},[r]),getMessageHistory:c,editor:i});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(rO.q,{children:(0,s.jsxs)(o.B,{align:"start",children:[(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"A9MA7Q",components:{0:(0,s.jsx)(a.$,{variant:"link",onClick:()=>{u({message:t.message||""})}})}})}),(0,s.jsx)(l.E,{color:"gray.500",textAlign:"center",fontSize:"xs",children:(0,s.jsx)(m.x6,{id:"ygs5tU"})}),(0,s.jsx)(nG.r,{columns:2,spacing:2,w:"100%",children:n.map(e=>(0,s.jsx)(nV._,{src:e.attrs.src,onDragStart:()=>{i&&(0,rG.fS)(i,{type:"image",attrs:e.attrs})},h:36,draggable:!0,w:"100%",borderRadius:"md",transitionDuration:"normal",transitionProperty:"common",objectFit:"cover",cursor:"grab",_hover:{shadow:"outline"}},e.attrs.src))}),(0,s.jsx)(lt,{message:t})]})}),t.isFirstGenerationInSession&&(0,s.jsx)(rO.q,{children:(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"cszDVM",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}})})})]})});li.displayName="GenerateImage";var ln=i(73272),ls=i.n(ln);let lr=()=>[p.Ru._({id:"91gjMr"}),p.Ru._({id:"PHyjBQ"}),p.Ru._({id:"zhFV/H"}),p.Ru._({id:"4ReFRy"}),p.Ru._({id:"aepNQh"}),p.Ru._({id:"fr8euV"}),p.Ru._({id:"+TEOEl"}),p.Ru._({id:"gQIRQv"}),p.Ru._({id:"pbDMHv"}),p.Ru._({id:"LP7cSD"}),p.Ru._({id:"ugneAh"})],lo=()=>[p.Ru._({id:"DZ/eyq"}),p.Ru._({id:"S2U0+k"}),p.Ru._({id:"YZJ7kT"}),p.Ru._({id:"fLq3m1"}),p.Ru._({id:"1nrH2R"})],ll=e=>{let{sendMessage:t}=e,[i]=(0,b.useState)(ls()(lr(),4).concat(ls()(lo(),2)));return(0,s.jsx)(tI.T,{spacing:2,align:"flex-start",children:i.map((e,i)=>(0,s.jsx)(a.$,{variant:"unstyled",bg:"white",borderRadius:"md",size:"sm",px:2,border:"1px solid",borderColor:"gray.200",color:"deepocean.500",fontWeight:"500",_hover:{bg:"deepocean.50",color:"deepocean.700"},onClick:()=>{t(e)},children:e},i))})},la=e=>({from:"Designer",type:"text",message:e?p.Ru._({id:"q65R55",values:{userName:e}}):p.Ru._({id:"15sYsk"}),timestamp:Date.now()}),ld=e=>{let{sendMessage:t,hideSuggestions:i=!1}=e,{user:n}=(0,nv.ur)();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(rO.q,{from:"Designer",children:la(null==n?void 0:n.firstName).message}),!i&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.E,{color:"gray.500",fontSize:"sm",children:(0,s.jsx)(m.x6,{id:"MVir6z"})}),(0,s.jsx)(ll,{sendMessage:t})]})]})};var lc=i(73652);function lu(e,t,i){var n;return null!=(n=i.find(i=>i.modification.isApplied(e,t)))?n:null}function lx(e,t){let i=(0,eu.GV)(ex.SJ),n=o5(),[s,r]=(0,b.useState)(()=>e?lu(e,n,t):null),o=(0,b.useCallback)(()=>{e&&r(lu(e,n,t))},[e,t,n]);return(0,b.useEffect)(()=>{if(!e)return;let i=ts()(()=>{r(lu(e,n,t))},1e3);return e.on("update",i),()=>{e.off("update",i)}},[e,t,n]),(0,b.useEffect)(()=>{o()},[o,i]),{activeSuggestion:s,forceUpdate:o}}let lh=(0,b.memo)(e=>{let{message:t,editor:i}=e,n=o7(),r=o5(),{activeSuggestion:a,forceUpdate:d}=lx(i,t.suggestions),c=(0,b.useCallback)(e=>{i&&(n.trackSuggestionApplied({interactionId:t.interactionId,suggestionType:e.type,suggestionLabel:e.description,suggestionContent:e.getContentForTracking()}),e.apply(i,r),d())},[i,d,t.interactionId,r,n]);return i?(0,s.jsx)(rO.q,{children:(0,s.jsxs)(o.B,{divider:(0,s.jsx)(iD.c,{borderColor:"blackAlpha.200"}),children:[(0,s.jsx)(l.E,{children:t.message||"How's this?"}),t.suggestions.map((e,t)=>(0,s.jsx)(lm,{isSelected:e.label===(null==a?void 0:a.label),jsonContentPreview:e.jsonContentPreview,label:e.label,modification:e.modification,onClick:()=>{c(e.modification)}},t)),(0,s.jsx)(lt,{message:t})]})}):null});lh.displayName="SuggestContent";let lm=e=>{let{label:t,modification:i,jsonContentPreview:n,isSelected:o,onClick:a}=e,c=(0,eu.GV)(ex.SJ);console.debug("[".concat(t,"] jsonContentPreview"),n,i);let u=(0,b.useCallback)(()=>{o||a()},[o,a]);return(0,s.jsxs)(e8.z,{onClick:u,cursor:"pointer",px:2,py:1,borderRadius:"xl",_hover:{bg:"blackAlpha.100"},bg:o?"whiteAlpha.600":void 0,transitionProperty:"common",transitionDuration:"normal",spacing:4,children:[n&&(0,s.jsx)(r.s,{sx:{"mask-image":"linear-gradient(to bottom, black 75%, transparent 100%)"},children:(0,s.jsx)(r.s,{sx:s3.o,justifyContent:"center",alignItems:"top",width:"150px",h:16,children:(0,s.jsx)(d.a,{transformOrigin:"top",transform:"scale(0.15)",pointerEvents:"none",children:(0,s.jsx)(s3.S,{content:n,theme:c})})})}),(0,s.jsx)(l.E,{flex:1,fontSize:"sm",children:t}),(0,s.jsx)(lc.J,{in:o,children:(0,s.jsx)(x.g,{icon:tT.e68,fixedWidth:!0})})]})};var lp=i(59018),lg=i.n(lp),lj=i(60908);let lf=(0,b.memo)(e=>{let{message:t,editor:i}=e,n=t.suggestions.slice(0,8),r=lg()(n.map(e=>{let{query:t}=e;return t})),a=0===r.length?p.Ru._({id:"QICyFn"}):1==r.length?p.Ru._({id:"x/YBq7",values:{0:r[0].toLowerCase()}}):2==r.length?p.Ru._({id:"Tn1hkb",values:{0:r[0].toLowerCase(),1:r[1].toLowerCase()}}):p.Ru._({id:"Z918ro",values:{0:r[0].toLowerCase(),1:r[1].toLowerCase(),2:r[2].toLowerCase()}});return(0,s.jsx)(rO.q,{children:(0,s.jsxs)(o.B,{align:"start",children:[(0,s.jsxs)(l.E,{children:[a," ",(0,s.jsx)(m.x6,{id:"CvUN7V"})]}),(0,s.jsx)(l.E,{color:"gray.500",textAlign:"center",fontSize:"xs",children:(0,s.jsx)(m.x6,{id:"fg3FfA"})}),(0,s.jsx)(nG.r,{columns:2,spacing:2,w:"100%",children:n.map(e=>{let{image:t,query:n,provider:r}=e,o=(0,lj.Ub)(t.thumbnailUrl,{width:250,height:250});return(0,s.jsx)(nV._,{src:o,fallbackSrc:t.thumbnailUrl,onDragStart:()=>{i&&(0,rG.fS)(i,{type:"image",attrs:(0,of.TF)(t,n,r)})},h:24,draggable:!0,w:"100%",borderRadius:"md",transitionDuration:"normal",transitionProperty:"common",objectFit:"cover",cursor:"grab",_hover:{shadow:"outline"}},t.id)})}),(0,s.jsx)(lt,{message:t})]})})});lf.displayName="SuggestImage";let lv=e=>e.replace(/(<([^>]+)>)/gi,""),lb=(0,b.memo)(e=>{let{message:t,editor:i}=e,n=o7(),r=o5(),{activeSuggestion:o,forceUpdate:a}=lx(i,t.suggestions);return(0,s.jsx)(rO.q,{from:t.from,children:(0,s.jsxs)(tI.T,{spacing:2,align:"start",children:[(0,s.jsx)(l.E,{children:t.message||"Here are some ideas:"}),t.suggestions.map((e,l)=>(0,s.jsx)(ly,{value:e,isSelected:e===o,onClick:()=>{if(!i)return;let{modification:s}=e;n.trackSuggestionApplied({interactionId:t.interactionId,suggestionType:s.type,suggestionLabel:s.description,suggestionContent:s.getContentForTracking()}),s.apply(i,r),a()}},l)),(0,s.jsx)(lt,{message:t})]})})}),ly=e=>{let{value:t,isSelected:i,onClick:n}=e,r=(0,b.useCallback)(()=>{i||n()},[i,n]);return(0,s.jsxs)(e8.z,{onClick:r,cursor:"pointer",p:4,borderRadius:"xl",_hover:{bg:"whiteAlpha.600"},bg:"white",transitionProperty:"common",transitionDuration:"normal",spacing:4,shadow:"md",align:"start",children:[(0,s.jsxs)(d.a,{children:[(0,s.jsx)(l.E,{fontSize:"sm",color:"gray.500",children:t.reason}),(0,s.jsx)(l.E,{fontSize:"sm",noOfLines:3,children:lv(t.value)})]}),(0,s.jsx)(lc.J,{in:i,children:(0,s.jsx)(x.g,{icon:tT.e68,fixedWidth:!0})})]})};lb.displayName="SuggestText";var lC=i(27250);let lw=(0,b.memo)(e=>{let{message:t,editor:i}=e,{onClose:n}=rV(),r=o7(),d=o5(),{activeSuggestion:c}=lx(i,t.suggestions),h=(0,b.useCallback)(e=>{i&&(r.trackSuggestionApplied({interactionId:t.interactionId,suggestionType:t.type,suggestionLabel:e.description,suggestionContent:e.getContentForTracking()}),e.apply(i,d))},[i,r,t,d]);return(0,s.jsx)(rO.q,{children:(0,s.jsxs)(o.B,{children:[(0,s.jsx)(l.E,{children:t.message}),t.suggestions.map(e=>{let{themeId:t,label:i,isOriginal:n}=e;return(0,s.jsxs)(b.Fragment,{children:[n&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(iD.c,{borderColor:"blackAlpha.200"}),(0,s.jsxs)(l.E,{children:[i,": "]})]}),(0,s.jsx)(lk,{themeId:t,onClick:()=>h(e.modification),isSelected:(null==c?void 0:c.themeId)===t})]},t)}),(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"eVMeEi"})}),(0,s.jsx)(a.$,{leftIcon:(0,s.jsx)(x.g,{icon:u.fyG}),w:"100%",onClick:()=>{n(),iY.R.emit("toggleThemeBlock",!0)},children:(0,s.jsx)(m.x6,{id:"ni+gIz"})}),(0,s.jsx)(lt,{message:t})]})})});lw.displayName="SuggestThemes";let lk=(0,b.memo)(e=>{let{themeId:t,onClick:i,isSelected:n}=e,r=(0,ee.Lb)(t);return"new"===r.id?null:(0,s.jsxs)(tI.T,{onClick:i,cursor:"pointer",p:2,borderRadius:"xl",_hover:{bg:"blackAlpha.100"},bg:n?"whiteAlpha.600":void 0,transitionProperty:"common",transitionDuration:"normal",children:[(0,s.jsx)(d.a,{borderRadius:"lg",overflow:"hidden",w:"100%",children:(0,s.jsx)(lC.q,{theme:r,variant:"outline"})}),(0,s.jsxs)(e8.z,{alignSelf:"flex-start",color:n?"trueblue.700":void 0,children:[(0,s.jsx)(lc.J,{in:n,unmountOnExit:!0,children:(0,s.jsx)(x.g,{icon:tT.e68,fixedWidth:!0})}),(0,s.jsx)(l.E,{fontSize:"sm",fontWeight:n?"semibold":void 0,children:r.name})]})]})});lk.displayName="ThemeMessageThumbnailPreview";let lE=(0,b.memo)(e=>{let{message:t,sendMessage:i}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(rO.q,{children:t.message&&(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(l.E,{children:[(0,s.jsx)("span",{className:"emoji",role:"img","aria-label":"sorry",children:"\uD83D\uDE14"})," ",t.message," ",t.learnMoreLink&&(0,s.jsxs)(iJ.N,{href:t.learnMoreLink,textDecoration:"underline",isExternal:!0,children:["Learn more ",(0,s.jsx)(nJ.p,{mx:"2px",fontSize:"sm"})]})]})})}),(0,s.jsx)(l.E,{color:"gray.500",fontSize:"sm",children:"Here are some other things I can do:"}),(0,s.jsx)(ll,{sendMessage:i})]})});lE.displayName="UnsupportedTask";let lS=(0,b.memo)(e=>{let{message:t}=e;return(0,s.jsx)(rO.q,{warning:t.warning,from:t.from,children:t.message})});lS.displayName="UserDesignerMessage";let lI=e=>{let{messages:t,scrollSelector:i,editor:n,sendMessage:l,isLoading:a,onClose:d}=e,{hasEnoughCreditsToChat:c,isCreditsReady:u}=(0,tH.B9)(),x=(0,b.useCallback)(()=>{let e=i&&document.querySelector(i);e&&setTimeout(()=>{requestAnimationFrame(()=>{e.scrollTo({top:e.scrollHeight,behavior:"smooth"})})},400)},[i]),h=(0,b.useRef)({scrollToBottom:x,onClose:d});return h.current.scrollToBottom=x,(0,s.jsx)(rF.Provider,{value:h.current,children:(0,s.jsx)(r.s,{flex:1,flexDirection:"column",justifyContent:"flex-end",children:(0,s.jsx)(o.B,{pt:12,spacing:2,children:(0,s.jsxs)(sx.N,{children:[(0,s.jsx)(ld,{sendMessage:l,hideSuggestions:u&&!c}),t.map(e=>{if("text"===e.type)return(0,s.jsx)(lS,{message:e},e.timestamp);if("suggestImages"===e.type)return(0,s.jsx)(lf,{message:e,editor:n},e.timestamp);if("generateImage"===e.type)return(0,s.jsx)(li,{message:e,editor:n},e.timestamp);if("suggestText"===e.type)return(0,s.jsx)(lb,{message:e,editor:n},e.timestamp);if("suggestThemes"===e.type)return(0,s.jsx)(lw,{message:e,editor:n},e.timestamp);else if("suggestContent"===e.type)return(0,s.jsx)(lh,{message:e,editor:n},e.timestamp);else if("unsupported"===e.type)return(0,s.jsx)(lE,{message:e,sendMessage:l},e.timestamp);return console.warn("[MessageList] Message type not found",e),null}),a&&(0,s.jsx)(lA,{},"loading")]})})})})},lA=()=>(0,s.jsx)(rO.q,{from:"Designer",children:(0,s.jsx)(lT,{})}),lT=()=>(0,s.jsxs)(r.s,{className:"bouncing-loader",justify:"center",children:[(0,s.jsx)("div",{}),(0,s.jsx)("div",{}),(0,s.jsx)("div",{})]}),lR=e=>{let{editor:t,scrollSelector:i,onClose:n}=e,[l,a]=(0,b.useState)(""),d=(0,R.u)("openAiStatus"),c=(0,eu.jL)(),h=(0,Z.O2)("editor"),p=(0,eu.CU)(),g=(0,eu.GV)(rW.Lt),j=(0,eu.GV)(rW.Wp),[f,y]=(0,b.useState)(null),C=(0,b.useCallback)(()=>(0,rW.Lt)(p.getState()),[p]),w=(0,b.useCallback)(e=>{let t={timestamp:Date.now(),...e};c((0,rW.tj)({message:t}))},[c]),k=(0,b.useCallback)(()=>{c((0,rW.cL)())},[c]),{status:E,sendMessage:S}=o9({addMessage:w,getMessageHistory:C,editor:t});(0,b.useEffect)(()=>{let e=i&&document.querySelector(i);e&&requestAnimationFrame(()=>{e.scrollTop=e.scrollHeight})},[i,g]);let I="idle"!==E;(0,b.useEffect)(()=>{if(!j.length||I)return;let{task:e,id:t}=j[0];!1===e.submit?a(e.message):S({message:e.message}),c((0,rW.nD)({id:t}))},[I,S,c,j]);let A=(0,b.useCallback)(()=>{if(!f||!t)return;let e=document.querySelector('[data-card-id="'.concat(f,'"]')),i=(0,Z.cH)(e,100);null!=i&&i.yAxisInView||h.scrollElementIntoView({element:e})},[t,h,f]),T=(0,b.useCallback)(e=>{A(),S({message:e})},[A,S]),_=(0,b.useCallback)(()=>{T(l),a("")},[T,l]),D=(0,tH.tO)(_,"chatSuggestion",Q.VV.GAMMA_UPSELL_CALLOUT_AI_CREDITS_CHAT);(0,b.useEffect)(()=>{if(!t)return;let e=()=>{let e=(0,tV.hT)(t.state.doc,t.state.selection.from);e&&y(e.node.attrs.id)};return e(),t.on("selectionUpdate",e),()=>{t.off("selectionUpdate",e)}},[t]);let P=rT();return t?"DOWN"===d?(0,s.jsx)(rD,{onClose:n}):(0,s.jsxs)(r.s,{direction:"column",h:"100%",w:"100%",px:6,pb:2,children:["DEGRADED"===d&&(0,s.jsx)(rP,{}),(0,s.jsx)(lI,{scrollSelector:i,messages:g,editor:t,sendMessage:T,isLoading:I,onClose:n}),(0,s.jsxs)(o.B,{pos:"sticky",bottom:0,py:2,pt:4,bg:"gray.50",children:[(0,s.jsx)(rN,{editor:t,value:l,onChange:a,onSubmit:D,isLoading:I,resetMessages:k}),(0,s.jsx)(rA.f,{modalId:"ai-credits-modal-message-list",variant:"ghost",justify:"flex-end",segmentEvent:Q.VV.GAMMA_UPSELL_CALLOUT_AI_CREDITS_CHAT})]}),(0,s.jsxs)(e7.e,{position:"absolute",top:1,insetInlineStart:4,variant:"ghost",colorScheme:"blackAlpha",children:[(0,s.jsx)(q.Tz,{label:(0,s.jsx)(m.x6,{id:"5eg0kp"}),placement:"top",children:(0,s.jsx)(H.K,{color:"currentColor","aria-label":"reset-chat",icon:(0,s.jsx)(x.g,{icon:u.XAi}),onClick:k,isRound:!0})}),P&&(0,s.jsx)(q.Tz,{label:(0,s.jsx)(m.x6,{id:"pC3anp",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}}),placement:"top",children:(0,s.jsx)(H.K,{color:"currentColor","aria-label":"source-prompt",icon:(0,s.jsx)(x.g,{icon:u.LjI}),as:v(),href:P,target:(0,O.sX)()?"_self":"_blank",isRound:!0})})]})]}):null},l_=e=>{let{onClose:t}=e;return(0,s.jsx)(r.s,{width:"100%",px:6,py:4,justifyContent:"space-between",alignItems:"center",h:8,tabIndex:0,outline:"none",position:"absolute",top:0,children:(0,s.jsx)(tS.J,{"data-design-partner-close-button":!0,position:"absolute",top:2,insetInlineEnd:6,zIndex:1,onClick:t})})},lO="design-partner-panel-wrapper",lD=()=>{let{togglePanel:e,isPanelOpen:t}=(0,eY.ww)(lP),{editor:i}=(0,tE.m)(),n=(0,R.u)("aiChat"),s=(0,eu.jL)();(0,b.useEffect)(()=>()=>{s((0,rW.cL)())},[]);let r=(0,eu.GV)(ex.nD);return(0,b.useEffect)(()=>{!r&&t&&e()},[r,t,e]),(0,b.useEffect)(()=>{var e,n;i&&(null==(e=(n=i.commands).setSalOpen)||e.call(n,t))},[i,t]),(0,b.useEffect)(()=>{if(n)return rI.R.on("toggle",t=>{let{config:i}=t;e(i)})},[e,n]),(0,b.useEffect)(()=>{if(n)return ru.LF.on("queueDesignPartnerTask",t=>{s((0,rW.UT)({task:t})),e({disableTransition:!1,override:"open"}),console.log("queueDesignPartnerTask",t)})},[s,n,e]),(0,b.useEffect)(()=>{if(!n||!r)return;let t=(0,rS.Ay)("mod+shift+S");return eJ.WC.on("keydown","DESIGN_PARTNER_PANEL",i=>!!t(i)&&(e(),!0))},[e,n,r]),{isDesignPartnerPanelOpen:t}},lP=e=>{let{closePanel:t}=e,{editor:i}=(0,tE.m)();return(0,b.useEffect)(()=>eJ.WC.on("keydown","DESIGN_PARTNER_PANEL",e=>!!document.activeElement.closest('[data-panelid="design-partner-panel"]')&&"Escape"===e.key&&(t(),!0)),[t]),(0,s.jsx)(t_.Z,{bgColor:"gray.50","data-panelid":"design-partner-panel",borderInlineStartWidth:"1px",children:(0,s.jsxs)(r.s,{direction:"column",h:"100%",overflowY:"auto",overflowX:"hidden",className:"".concat(lO," buddy-scroll"),w:"100%",children:[(0,s.jsx)(l_,{onClose:t}),(0,s.jsx)(lR,{editor:i,scrollSelector:".".concat(lO),onClose:t})]})})};lP.panelPosition="right",lP.panelName="chat";let lz=e=>{let{disabled:t=!1,docId:i}=e;if(!t)return null;let n="https://metabase.internal.gamma.app/question/1558-workspace-lookup-by-id?org_id=none&doc_id=".concat(i);return(0,s.jsxs)(r.s,{direction:"row",bg:"red.500",color:"white",py:3,px:4,align:"center",fontSize:"sm",children:[(0,s.jsxs)(tI.T,{flex:"1",align:"start",spacing:0,children:[(0,s.jsxs)(l.E,{fontWeight:"bold",children:["This ",ej.TP," is disabled."]}),(0,s.jsx)(l.E,{opacity:"0.7",fontSize:"xs",children:"It is only visible to Gamma support personnel. For more information, check the admin site."})]}),(0,s.jsx)(a.$,{variant:"plain",size:"sm",mr:4,rightIcon:(0,s.jsx)(x.g,{icon:u.Ju_}),onClick:()=>{n&&window.open(n,"_blank")},children:"Admin page"})]})};var lM=i(21290),lL=i(90394),lN=i(20715),lF=i(2905),lV=i(89811),lG=i(96064),lW=i(2543),lB=i(64206),lU=i(8505),lH=i(37471);let lK=e=>{let{onGenerateSuccess:t,webpageOnly:i=!0}=e,[n,r]=(0,b.useState)("createWithAI"),[o,l]=(0,b.useState)([]),[a,d]=(0,b.useState)(void 0),c=(0,b.useMemo)(()=>({goToScreen:(e,t)=>{d(null==t?void 0:t.generateId),l(e=>[...e,n]),r(e)},navEnabled:"createGenerate"!==n&&"createWithAI"!==n&&"home"!==n,webpageOnly:i,skipThemeStep:!0,onGenerateSuccess:t}),[n,t,i]),u=(0,b.useMemo)(()=>{switch(n){case"createWithAI":case"home":return lW.m;case"createImport":return lG.D;case"createPaste":return lB.b;case"promptEditor":return function(){return(0,s.jsx)(lU.y,{id:a,children:(0,s.jsx)(lF.V,{})})};case"createGenerate":return function(){return a?(0,s.jsx)(lU.y,{id:a,children:(0,s.jsx)(lV.r,{autosetLocale:!1})}):(0,s.jsx)(lV.r,{autosetLocale:!0})};default:throw Error("invalid page")}},[a,n]);return(0,s.jsx)(lH.lW.Provider,{value:c,children:(0,s.jsx)(u,{})})},lq=e=>{let{isOpen:t,onClose:i}=e;return(0,s.jsx)(q.L8,{isDark:!1,children:(0,s.jsxs)(iA._s,{isOpen:t,placement:"bottom",onClose:i,isFullHeight:!0,children:[(0,s.jsx)(i6.m,{}),(0,s.jsxs)(iT.z,{h:"calc(var(--100vh) - 24px)",p:0,children:[(0,s.jsx)(i_.s,{zIndex:"sticky"}),(0,s.jsx)(iO.c,{p:0,children:(0,s.jsx)(lK,{onGenerateSuccess:i})})]})]})})},lY=e=>{var t;let{doc:i}=e,n=(0,ee.rd)(),r=(0,iI.d)(),l=null==i||null==(t=i.accessLinks)?void 0:t[0],d=(0,b.useMemo)(()=>(0,D.LN)({docTitle:null==i?void 0:i.title,docId:null==i?void 0:i.id,token:null==l?void 0:l.token,absolute:!0}),[i,null==l?void 0:l.token]),{onCopy:c}=(0,lL.i)(d),h=(0,b.useCallback)(()=>{(0,lN.dd)({docId:null==i?void 0:i.id,source:"docWizardFooter",type:"tokenUrl"}),c(),r({title:(0,s.jsx)(m.x6,{id:"pQjjYo"}),status:"success",position:"top",duration:1e3,isClosable:!1})},[null==i?void 0:i.id,c,r]),p=rT();return(0,s.jsxs)(o.B,{spacing:4,textAlign:"center",children:[(0,s.jsx)(B.D,{size:"md",children:(0,s.jsx)(m.x6,{id:"bB+DHs"})})," ",(0,s.jsx)(a.$,{as:v(),target:(0,O.sX)()?"_self":"_blank",variant:"solid",colorScheme:n?"blackAlpha":"whiteAlpha",leftIcon:(0,s.jsx)(x.g,{icon:u.QLR}),href:"/create",children:(0,s.jsx)(m.x6,{id:"xFxi2V"})}),p?(0,s.jsx)(a.$,{leftIcon:(0,s.jsx)(x.g,{icon:u.LjI}),variant:"plain",as:v(),target:(0,O.sX)()?"_self":"_blank",href:p,children:(0,s.jsx)(m.x6,{id:"550oRP"})}):(0,s.jsx)(a.$,{leftIcon:(0,s.jsx)(x.g,{icon:u.CQO}),variant:"plain",onClick:h,children:(0,s.jsx)(m.x6,{id:"RGCCrg"})})]})},lJ=()=>{let{isOpen:e,onClose:t,onOpen:i}=(0,iN.E)({id:"add-page-ai-modal"}),n=(0,eu.GV)(tr.Gd),r=(0,ta.dv)(n),{publishSite:l,isPublishing:d}=iB({site:n}),c=(0,ee.rd)();return(0,s.jsxs)(o.B,{spacing:4,textAlign:"center",children:[(0,s.jsx)(B.D,{size:"md",children:(0,s.jsx)(m.x6,{id:"bB+DHs"})}),(0,s.jsx)(a.$,{variant:"solid",colorScheme:c?"blackAlpha":"whiteAlpha",leftIcon:(0,s.jsx)(x.g,{icon:u.QLR}),onClick:i,children:(0,s.jsx)(m.x6,{id:"K3193W"})}),r&&(0,s.jsx)(a.$,{leftIcon:(0,s.jsx)(x.g,{icon:u.MNJ}),variant:"plain",onClick:l,isLoading:d,children:(0,s.jsx)(m.x6,{id:"2uGo/E"})}),(0,s.jsx)(lq,{isOpen:e,onClose:t})]})},lX=()=>(0,s.jsx)(o.B,{spacing:4,textAlign:"center",children:(0,s.jsx)(B.D,{size:"md",children:(0,s.jsx)(m.x6,{id:"tL6yYg",values:{GAMMA_PROPER_NOUN:ej.On}})})}),l$=e=>{var t,i;let{doc:n}=e,r=null==n||null==(i=n.docGenerateInput)||null==(t=i.docGeneration)?void 0:t.generationType;return n?r===ik.xbH.UploadPptV2?(0,s.jsx)(lX,{}):n.site?n.site&&!(0,O.Xb)()?(0,s.jsx)(lJ,{}):null:(0,s.jsx)(lY,{doc:n}):null};var lZ=i(19515),lQ=i.n(lZ),l0=i(13731),l1=i.n(l0),l6=i(96104),l2=i.n(l6),l5=i(56143);let l3=[{key:"content_quality",category:"content",label:(0,s.jsx)(m.x6,{id:"geq9gH"})},{key:"missing_content",category:"content",label:(0,s.jsx)(m.x6,{id:"n4zPFX"})},{key:"wrong_language",category:"content",label:(0,s.jsx)(m.x6,{id:"R2Ly6h"})},{key:"amount_of_text",category:"content",label:(0,s.jsx)(m.x6,{id:"pi+Tez"})},{key:"inaccurate_content",category:"content",label:(0,s.jsx)(m.x6,{id:"Qk+SyG"})},{key:"image_quality",category:"image",label:(0,s.jsx)(m.x6,{id:"ESjmDR"})},{key:"number_of_images",category:"image",label:(0,s.jsx)(m.x6,{id:"x6yr/9"})},{key:"layouts_and_templates",category:"layout",label:(0,s.jsx)(m.x6,{id:"5yz5Kl"})},{key:"theme_styling",category:"layout",label:(0,s.jsx)(m.x6,{id:"nTZNkL"})}],l4={key:"other",category:"other",label:(0,s.jsx)(m.x6,{id:"/IX/7x"})},l8=[{key:"missing_content",category:"content",label:(0,s.jsx)(m.x6,{id:"n4zPFX"})},{key:"inaccurate_content",category:"content",label:(0,s.jsx)(m.x6,{id:"04mUQ2"})},{key:"missing_images",category:"image",label:(0,s.jsx)(m.x6,{id:"CLDdsj"})},{key:"image_quality",category:"image",label:(0,s.jsx)(m.x6,{id:"ESjmDR"})},{key:"wrong-layout",category:"layout",label:(0,s.jsx)(m.x6,{id:"x2M7iY"})},{key:"colors-fonts",category:"layout",label:(0,s.jsx)(m.x6,{id:"nTZNkL"})},{key:"animations",category:"animations",label:(0,s.jsx)(m.x6,{id:"HgWdP3"})},{key:"import_speed",category:"performance",label:(0,s.jsx)(m.x6,{id:"YJPN3F"})},{key:"too-similar",category:"layout",label:(0,s.jsx)(m.x6,{id:"R5upbf"})}],l7=e=>{let{docId:t,isDark:i,generationType:n,interactionId:r}=e,o=(0,b.useMemo)(()=>{let e=n===ik.xbH.UploadPptV2?l8:l3;return lQ()(l2()(l1()(l2()(e),"category"))).concat([l4])},[n]),l=(0,b.useCallback)(e=>{(0,tU.xN)({rating:e,doc_id:t,interactionId:r,generationType:n})},[t,n,r]),a=(0,b.useCallback)((e,i,s)=>{(0,tU.EQ)({feedback:i,tags:s,rating:e,doc_id:t,generationType:n,interactionId:r})},[t,n,r]);return(0,s.jsx)(l5.No,{feedbackTags:o,trackRating:l,trackFeedback:a,isDark:i})};var l9=i(98841),ae=i(52077),at=i(69768);let ai=e=>{let[t]=(0,b.useState)(()=>(0,D.sF)()[e]);return(0,b.useEffect)(()=>{setTimeout(()=>{(0,at.g5)({query:{...(0,D.sF)(),[e]:void 0},emitChange:!1})})},[]),t},an=e=>{var t,i,n,s;let{editor:r}=e,o=r&&null!=(n=null==(t=(0,r7.lI)(r))?void 0:t.generateInfo)?n:{},l=ai("source"),a=(0,eu.GV)((0,ec.A0)(null==r?void 0:r.gammaDocId)),d=null,{user:c}=(0,et.ur)(),u=null==c||null==(i=c.settings)?void 0:i.needsEditorOnboarding;return(0,b.useEffect)(()=>{u&&l===ae.MH&&M.emit("triggerOnboarding",{reason:"aiGenerate"})},[u,l]),l===ae.MH?a&&("complete"===a.status||"error"===a.status)&&(d=a.id):l===l9.p&&(d=null!=(s=o.interactionId)?s:null),{interactionId:d}},as=(0,b.memo)(e=>{var t,i;let{interactionId:n}=e,l=(0,eu.GV)(e_.Jo),d=(0,R.u)("insertWidgetBottom"),c=(0,ee.rd)(),u=null==l||null==(i=l.docGenerateInput)||null==(t=i.docGeneration)?void 0:t.generationType,x=d?lM.PX:lM.C9,[h,p]=(0,b.useState)(!1),g=(0,b.useCallback)(()=>{p(!0)},[]),j=c?{background:"gray.800",color:"white",borderTop:"2px solid var(--chakra-colors-whiteAlpha-200)"}:{background:"white",color:void 0,borderTop:"2px solid var(--chakra-colors-blackAlpha-200)"};return l?(0,s.jsx)(q.L8,{isDark:c,children:(0,s.jsx)(r.s,{className:"chakra-dont-set-collapse","data-doc-wizard-footer":!0,w:"100%",mt:(0,O.Xb)()?void 0:"-".concat(x),children:(0,s.jsx)(le.S,{in:!h,style:{width:"100%"},unmountOnExit:!0,children:(0,s.jsx)(r.s,{pt:[10,10,20],pb:[4,4,8],w:"100%",position:"relative",...j,children:(0,s.jsx)(iF.m,{maxW:"450px",children:(0,s.jsxs)(o.B,{spacing:8,children:[(0,s.jsx)(l$,{doc:l}),(0,s.jsx)(l7,{docId:l.id,isDark:c,interactionId:n,generationType:u}),(0,s.jsx)(U.o,{pt:[0,0,4],w:"100%",children:(0,s.jsx)(a.$,{size:"sm",onClick:g,variant:"text",colorScheme:"blackAlpha",children:(0,s.jsx)(m.x6,{id:"vLyv1R"})})})]})})})})})}):null});as.displayName="DocWizardFooterInner";let ar=e=>{let{editor:t}=e,{interactionId:i}=an({editor:t});return i?(0,s.jsx)(as,{interactionId:i}):null};var ao=i(49405);let al=e=>{let{onCloneClick:t,onSignupClick:i,isLoggedIn:n}=e;return(0,s.jsx)(d.a,{bg:"white",border:"0.5px solid var(--chakra-colors-gray-50)",borderRadius:"md",shadow:"md",display:"column",p:4,position:"relative",children:n?(0,s.jsxs)(e8.z,{children:[(0,s.jsxs)(l.E,{me:1,children:[(0,s.jsx)(m.x6,{id:"HMsJrS",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP},components:{0:(0,s.jsx)("strong",{})}})," ","\uD83D\uDE0D"]}),(0,s.jsx)(a.$,{variant:"solid",onClick:t,children:(0,s.jsx)(m.x6,{id:"he3ygx"})})]}):(0,s.jsxs)(e8.z,{children:[(0,s.jsxs)(l.E,{me:1,children:[(0,s.jsx)(m.x6,{id:"FEyEJk",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP,GAMMA_PROPER_NOUN:ej.On},components:{0:(0,s.jsx)("strong",{})}})," ","\uD83D\uDE0D"]}),(0,s.jsx)(a.$,{as:v(),href:"/signup",onClick:i,variant:"solid",textDecoration:"none !important",children:(0,s.jsx)(m.x6,{id:"e+RpCP"})})]})})},aa=e=>{let t=!(0,O.Xb)(),{user:i}=(0,et.ur)(),n=(0,iI.d)(),s=(0,b.useRef)(),r=(0,ao.Z)(),o=(0,b.useCallback)(()=>{e&&(null===Q.zS||void 0===Q.zS||Q.zS.track(Q.VV.EXAMPLE_SIGNUP_CLICKED,{doc_id:e.id,title:e.title}))},[e]),l=(0,b.useCallback)(()=>{r({docId:null==e?void 0:e.id,docTitle:null==e?void 0:e.title,source:"example_deck_clone_toast"})},[e,r]);(0,b.useEffect)(()=>()=>{s.current&&n.close(s.current)},[n]);let a=t&&e,d=!!i;(0,t$.Vg)(()=>{s.current&&n.close(s.current),a&&(s.current=n({position:"bottom",render:()=>al({onCloneClick:l,isLoggedIn:d,onSignupClick:o}),isClosable:!0,duration:null}))},[e,t,l,o,a,i,n,d],[a,d])};var ad=i(86932),ac=i(27196),au=i(10955);let ax="sessionId1",ah=tp.YY.create({addStorage:()=>({user:{}}),addCommands(){return{user:e=>()=>{let t=(0,eu.KA)();return this.storage.user=iL()({},this.storage.user,e),t.dispatch((0,ex.vK)({sessionId:ax})),t.dispatch((0,ex._)({collaborators:[this.storage.user]})),!0}}}}),am=e=>{var t;let{docId:i,snapshotId:n,scrollingParentSelector:o,onCreate:l}=e,a=(0,eu.GV)(e_.Jo);aa(a);let[c]=(0,b.useState)(()=>[t9.Q,ac.Li.configure({scrollerSelector:o}),ah,ad.wg]),{user:u,anonymousUser:x,isUserLoading:h,color:m}=(0,et.ur)(),[p,g]=(0,b.useState)(),{data:j,loading:f,error:v}=(0,ik.YDl)({variables:{docId:i,snapshotId:n},skip:!n});(0,b.useEffect)(()=>{!h&&p&&p.commands.user({id:(null==u?void 0:u.id)||x.id,color:m.value,sessionId:ax,idleSince:null,name:(null==u?void 0:u.displayName)||x.displayName||"",profileImageUrl:(null==u?void 0:u.profileImageUrl)||"",isReady:!h})},[p,u,m,h,x]);let y=j&&void 0!==j.snapshot&&!f&&a;return(0,s.jsxs)(d.a,{"data-testid":"example-static-editor-wrapper",flex:"1",height:"100%",children:[!y||v?(0,s.jsxs)(r.s,{direction:"column",height:"100%",flex:"1",bg:"gray.50",alignItems:"center",justifyContent:"center",children:[!y&&(0,s.jsx)(t3.y,{}),v&&(0,s.jsxs)(U.o,{h:"100%",children:["There was an error loading this ",ej.TP,":"," ",v.message]})]}):(0,s.jsx)(d.a,{"data-testid":"example-static-editor-wrapper-inner",transitionProperty:"common",transitionDuration:"750ms",transitionTimingFunction:"ease-out",opacity:+!!y,children:(0,s.jsx)(td.bw,{doc:a,editorId:"main",docId:i,extensions:c,onCreate:e=>{let{editor:t}=e;g(t),setTimeout(()=>{l&&l(t)},10)},readOnly:!0,initialContent:null==(t=j.snapshot)?void 0:t.content.default,scrollingParentSelector:o})}),(0,s.jsx)(au.d,{forceShow:!0,abuseReportingEnabled:!1})]})},ap=e=>{let t=(0,et.IM)();return(0,eu.GV)(i=>{let n=(0,e_.nU)(i);return!!n&&t.can(e,n)})};var ag=i(69138),aj=i(83550),af=i(343),av=i(8139),ab=i(53505);let ay=()=>{let e=(0,af.$)(),t=(0,ao.Z)(),{push:i}=(0,e9.useRouter)();return(0,b.useCallback)(async n=>{let s,{title:r,titleEdited:o,path:l,file:a,isSite:d=!1,sourceDocId:c,format:u,docSettings:x}=n;if(!a)return;if(c)await t({docId:c,source:ik.ALe.SitesDuplicatePage,fileId:null==a?void 0:a.id,path:l,onSuccess:e=>{s=e}});else{let t=d?av.S9.webpage_fluid.docSettings():av.S9.deck_default.docSettings(),i={settings:{...x||t},format:u||(d?"webpage":"deck")},n=l||(0,ab.X)({path:"/untitled-page",file:a}),{docId:c}=await e({title:r,titleEdited:o,path:n,file:a,source:"file_add_page",documentAttributes:i});s=c}if(!s)return;let h=(0,D.pF)({docId:s});await i(h,void 0,{shallow:!0})},[e,t,i])},aC=e=>{let{isOpen:t,onClose:i}=e;return(0,s.jsx)(q.L8,{isDark:!1,children:(0,s.jsxs)(q._s,{isOpen:t,placement:"bottom",onClose:i,isFullHeight:!0,children:[(0,s.jsx)(q.QP,{}),(0,s.jsxs)(q.zj,{h:"calc(var(--100vh) - 24px)",p:0,children:[(0,s.jsx)(q.s1,{zIndex:"sticky"}),(0,s.jsx)(q.ys,{p:0,children:(0,s.jsx)(lK,{onGenerateSuccess:i,webpageOnly:!1})})]})]})})};var aw=i(2241);let ak=e=>{let{pageTitle:t,pageTitleEdited:i,path:n,useMonoFont:r,onEditSubmit:a,setIsEditing:d,isEditing:c,isSelected:u,...x}=e,[h,p]=(0,b.useState)(t||""),[g,j]=(0,b.useState)(!!i),f=a&&d,v=(u||c)&&f,y=(0,V.dU)("gray.600","gray.500"),C=(0,b.useRef)(null);return(0,b.useEffect)(()=>{c&&C.current&&C.current.focus()},[c]),(0,s.jsxs)(o.B,{spacing:1,alignItems:"flex-start",justifyContent:"flex-start",...x,children:[c&&f?(0,s.jsx)(iZ.p,{ref:C,value:h,variant:"outline",size:"xs",ps:1,bg:"inherit",_focus:{bg:"inherit"},_hover:{bg:"inherit"},fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",onBlur:e=>null==a?void 0:a(e.target.value,g),onChange:e=>{let t=e.target.value;p(t),j(!!t)},onKeyDown:e=>{if("Escape"===e.key){e.stopPropagation(),d(!1),p(t||"");return}"Enter"!==e.key||e.shiftKey||e.metaKey||(e.preventDefault(),a(h,g),d(!1))}}):(0,s.jsx)(l.E,{textAlign:"start",ps:1,noOfLines:1,maxW:"100%",whiteSpace:"normal",onClick:()=>{v&&d(!0)},children:h||(0,s.jsx)(m.x6,{id:"kveQAJ"})}),n&&(0,s.jsx)(l.E,{ps:1,color:y,textAlign:"start",noOfLines:1,fontFamily:r?"mono":void 0,fontSize:"xs",whiteSpace:"normal",wordBreak:"break-all",children:(0,s.jsx)(aw.B.span,{dir:r?"ltr":void 0,children:n})})]})},aE=e=>{let{isMainPage:t=!1,hasChanges:i=!1,isLoading:n=!1,isSelected:r=!1}=e,o=r?tT.A4h:u.A4h,l=r?tT.muz:u.muz,a=r?tT.Eur:u.Eur;return n?(0,s.jsx)(t3.y,{size:"xs"}):t?(0,s.jsx)(x.g,{icon:l,fixedWidth:!0}):i?(0,s.jsx)(x.g,{icon:a,fixedWidth:!0}):(0,s.jsx)(x.g,{icon:o,fixedWidth:!0})};var aS=i(45460),aI=i(8527);let aA=(0,aS.R)((e,t)=>{let{isSelected:i,children:n,...r}=e,{tab:o}=(0,aI.o)("Tabs",{variant:"soft-rounded",size:"sm"});return(0,s.jsx)(e8.z,{ref:t,__css:o,spacing:2,"aria-selected":i,...r,children:n})});var aT=i(47867);let aR=e=>{let{onRenamePageClick:t,page:i,...n}=e,r=ay(),o=(0,eu.GV)(e_.nU),l=(0,b.useCallback)(()=>{o&&r({file:o,title:i.title,path:(0,ab.X)({path:i.path||"",file:o}),sourceDocId:i.id})},[r,o,i]);return(0,s.jsxs)(na.c,{maxW:"sm",...n,children:[(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:u.MT7,fixedWidth:!0}),onClick:t,children:(0,s.jsx)(m.x6,{id:"2wxgft"})}),(0,s.jsx)(sP.N,{}),(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:u.$3n,fixedWidth:!0}),onClick:l,children:(0,s.jsx)(m.x6,{id:"OjVdwX"})})]})},a_=e=>{let{onRenamePageClick:t,page:i,...n}=e;return(0,s.jsx)(no.W,{modifiers:[{name:"flip",enabled:!0,options:{fallbackPlacements:["end"]}}],children:e=>{let{isOpen:r}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(nl.I,{"data-id":"sidebar-item-menu-button",ms:3,as:H.K,variant:"ghost",size:"xs",icon:(0,s.jsx)(d.a,{transitionProperty:"common",transitionDuration:"normal",_groupHover:{opacity:1},_hover:{opacity:1},_active:{opacity:1},opacity:+!!r,children:(0,s.jsx)(x.g,{icon:u.Dwc,fixedWidth:!0})}),...n}),(0,s.jsx)(L.Z,{children:(0,s.jsx)(aR,{"data-id":"sidebar-item-menu-list",onRenamePageClick:t,page:i})})]})}})},aO=e=>{let{page:t,isMainPage:i,isSelected:n,showPath:r,canEdit:o}=e,l=null==t?void 0:t.id,a=(0,D.pF)({docId:l}),c=(0,b.useRef)(null),[u,x]=(0,b.useState)(!1),h=(0,iI.d)(),[p]=(0,ik.cGn)(),g=(0,b.useCallback)((e,t)=>{x(!1),p({variables:{id:l,title:e,titleEdited:t}}).catch(e=>{let t=e instanceof Error&&e.message;h({title:t?(0,s.jsx)(m.x6,{id:"Ty2/Ny",values:{errMessage:t}}):(0,s.jsx)(m.x6,{id:"cxcrLk"}),position:"top",status:"error"})})},[l,h,p]);(0,b.useEffect)(()=>{if(!n||!(null==c?void 0:c.current))return;let{inView:e}=(0,aT.cH)(c.current)||{};e||c.current.scrollIntoView()},[n]);let j=n?{}:{as:n?void 0:v(),href:a,shallow:!0};return(0,s.jsx)(d.a,{...j,onClick:e=>{e.target instanceof Element&&(e.target.closest('[data-id="sidebar-item-menu-button"]')&&e.preventDefault(),e.target.closest('[data-id="sidebar-item-menu-list"]')&&(e.preventDefault(),e.stopPropagation()))},children:(0,s.jsxs)(aA,{ref:c,isSelected:n,alignItems:r?"start":"center",justifyContent:r?"flex-start":"center",role:"group",children:[(0,s.jsx)(d.a,{children:(0,s.jsx)(aE,{isMainPage:i,hasChanges:!1,isLoading:!1,isSelected:n})}),(0,s.jsx)(ak,{pageTitle:t.title,path:r?i?(0,s.jsx)(m.x6,{id:"i0qMbr"}):t.path:void 0,useMonoFont:r&&!i,isEditing:u,pageTitleEdited:t.titleEdited,setIsEditing:o?x:void 0,onEditSubmit:o?g:void 0,isSelected:!!n}),o&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(tA.h,{}),(0,s.jsx)(q.Tz,{label:(0,s.jsx)(m.x6,{id:"ipYK1+"}),placement:"top",children:(0,s.jsx)(d.a,{children:(0,s.jsx)(a_,{page:t,onRenamePageClick:()=>{x(!0)},alignSelf:"center"})})})]})]})})},aD=e=>{let{file:t,isSite:i}=e,{isOpen:n,onClose:r,onOpen:a}=(0,iN.E)({id:"add-page-ai-modal"}),d=(0,eu.GV)(ex.zu),c=ay(),[h,g]=(0,b.useState)(!1),j=(0,b.useCallback)(()=>{a()},[a]),f=(0,b.useCallback)(()=>{g(!0),c({path:"/untitled-page",title:p.Ru._({id:"kveQAJ"}),titleEdited:!1,file:t,isSite:i,format:d.format||void 0,docSettings:(0,r7.gX)(d)}).then(()=>{g(!1)})},[c,d,t,i]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(no.W,{children:[(0,s.jsx)(q.Tz,{label:(0,s.jsx)(m.x6,{id:"yLRlZm"}),children:(0,s.jsx)(nl.I,{as:H.K,isRound:!0,size:"xs",isLoading:h,onFocus:e=>e.preventDefault(),"data-testid":"add-page",icon:(0,s.jsx)(x.g,{icon:u.QLR})})}),(0,s.jsx)(L.Z,{children:(0,s.jsx)(na.c,{maxW:80,zIndex:"tooltip",children:(0,s.jsxs)(aj.r,{title:p.Ru._({id:"yLRlZm"}),children:[(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:u.QLR,fixedWidth:!0}),onClick:f,children:(0,s.jsxs)(o.B,{spacing:0,children:[(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"SSZKB9"})}),(0,s.jsx)(l.E,{fontSize:"xs",color:"gray.500",children:(0,s.jsx)(m.x6,{id:"S65lUr"})})]})}),(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:tT.p7g,fixedWidth:!0}),onClick:j,children:(0,s.jsxs)(e8.z,{align:"flex-start",children:[(0,s.jsxs)(o.B,{spacing:0,children:[(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"OppH33"})}),(0,s.jsx)(l.E,{fontSize:"xs",color:"gray.500",children:(0,s.jsx)(m.x6,{id:"P/o+t+"})})]}),(0,s.jsx)(tA.h,{}),(0,s.jsx)(i8.E,{h:"fit-content",colorScheme:"deepocean",ms:2,children:(0,s.jsx)(m.x6,{id:"jsQZMk"})})]})})]})})})]}),(0,s.jsx)(aC,{isOpen:n,onClose:r})]})},aP=e=>{let{onClose:t,file:i,currentPageId:n}=e,r=(0,eu.GV)(e_.hB),l=ap("edit"),a=(0,eu.GV)(e_.lh);return i?(0,s.jsxs)(o.B,{spacing:2,w:"100%",children:[(0,s.jsxs)(e8.z,{children:[(0,s.jsx)(q._x,{textAlign:"start",flex:1,children:(0,s.jsx)(m.x6,{id:"wRR604"})}),l&&(0,s.jsx)(aD,{isSite:r,file:i}),(0,s.jsx)(q.Tz,{label:(0,s.jsx)(m.x6,{id:"PJfMyC"}),children:(0,s.jsx)(tS.J,{onClick:t})})]}),(0,s.jsx)(o.B,{spacing:1,children:a.map(e=>(0,s.jsx)(aO,{page:e,isMainPage:e.id===i.mainPageId,isSelected:e.id===n,showPath:r,canEdit:l},e.id))})]}):null},az=e=>{let{onPanelClose:t,file:i,currentPageId:n}=e;return(0,s.jsx)(aP,{onClose:t,file:i,currentPageId:n})},aM=e=>{let{closePanel:t}=e,i=(0,ee.rd)(),n=(0,eR.u)("multipageEditor"),r=(0,eu.GV)(e_.nU),o=(0,eu.GV)(e_.Vs);return(0,s.jsx)(q.L8,{isDark:i,children:(0,s.jsx)(t_.Z,{bg:i?"gray.900":"white",borderRight:"1px solid",borderColor:i?"gray.800":"gray.200","data-panelid":"pages-panel",overflowX:"hidden",px:4,pt:4,children:n&&r&&(0,s.jsx)(az,{onPanelClose:t,file:r,currentPageId:null==o?void 0:o.id})})})};aM.panelPosition="left",aM.panelName="pages";let aL=e=>{let{togglePanel:t,isPanelOpen:i}=(0,eY.ww)(aM,e),n=(0,eu.GV)(ex.wC),s=(0,eu.GV)(e_.d_),r=ap("edit"),o=!!(e&&s&&r);return(0,ag.V)(()=>{o&&t({override:"open",disableTransition:!1})},[t,o],[o]),(0,b.useEffect)(()=>{n!==tv.w.DOC_VIEW&&t({override:"closed",disableTransition:!0})},[n,t]),{togglePagesPanel:t,isPagesPanelOpen:i}};var aN=i(96990),aF=i(3844);let aV=[{transform:"translateX(0px)"},{transform:"translateX(10px)"},{transform:"translateX(0px)"},{transform:"translateX(-10px)"},{transform:"translateX(0px)"},{transform:"translateX(10px)"},{transform:"translateX(0px)"},{transform:"translateX(-10px)"},{transform:"translateX(0px)"}],aG={duration:400,easing:"ease-in-out"},aW=e=>{var t;let{docId:i}=e,{onClose:n}=(0,ez.j)(),{onPasswordSubmitted:d}=(0,tE.m)(),[c,h]=(0,b.useState)(!1),[g,j]=(0,b.useState)(""),[f,v]=(0,b.useState)(!1),[y,C]=(0,b.useState)(""),w=(0,b.useRef)(null),[k,{data:E}]=(0,ik.tS1)();(0,b.useEffect)(()=>{k({variables:{docId:i}})},[i,k]);let S=(0,b.useCallback)(()=>{f||null==d||d(g).then(e=>{let{data:t}=e;(null==t?void 0:t.doc)?v(!0):(w.current&&w.current.animate(aV,aG),C(p.Ru._({id:"jvNV6s",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}})))})},[g,f,C,v,d]);return(0,s.jsxs)(i1.aF,{isOpen:!0,onClose:n,isCentered:!0,size:"xl",children:[(0,s.jsx)(i6.m,{}),(0,s.jsxs)(i2.$,{ref:w,p:8,children:[(0,s.jsx)(iR.r,{children:(0,s.jsxs)(o.B,{alignItems:"center",children:[(0,s.jsx)(aN.e,{src:(null==E||null==(t=E.publicDoc)?void 0:t.logoUrl)||aF.A.src,size:"lg"}),(0,s.jsx)(B.D,{children:(0,s.jsx)(m.x6,{id:"GZ6qi2"})}),(0,s.jsx)(l.E,{fontSize:"md",letterSpacing:"normal",fontWeight:"500",children:(0,s.jsx)(m.x6,{id:"rp/zfh"})})]})}),(0,s.jsx)(iO.c,{display:"flex",flexDirection:"column",alignItems:"center",children:(0,s.jsx)(o.B,{as:"form",spacing:4,onSubmit:e=>{e.preventDefault(),g.length&&S()},w:"100%",children:(0,s.jsxs)(nu.MJ,{isInvalid:!!y,children:[(0,s.jsx)(nx.l,{children:(0,s.jsx)(m.x6,{id:"8ZsakT"})}),(0,s.jsxs)(nX.M,{children:[(0,s.jsx)(iZ.p,{type:c?"text":"password",placeholder:"Enter the password",value:g,onChange:e=>{j(e.target.value)},borderColor:y?"red":"gray.200"}),(0,s.jsx)(n$.t,{children:(0,s.jsx)(H.K,{variant:"ghost",size:"sm",onClick:()=>h(!c),"aria-label":p.Ru._({id:"tniYMG"}),icon:c?(0,s.jsx)(x.g,{icon:u.k6j}):(0,s.jsx)(x.g,{icon:u.pS3}),_focus:{outline:"none"}})})]}),y&&(0,s.jsx)(n8.Wt,{children:y}),!y&&(0,s.jsx)(nu.eK,{color:"gray.600",children:(0,s.jsx)(m.x6,{id:"tSTf2H",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}})})]})})}),(0,s.jsx)(i3.j,{flex:1,w:"100%",children:(0,s.jsx)(r.s,{flex:1,align:"center",justify:"center",textAlign:"center",children:(0,s.jsx)(a.$,{w:"100%",variant:"solid",isDisabled:!g.length,onClick:S,children:(0,s.jsx)(m.x6,{id:"xGVfLh"})})})})]})]})};var aB=i(33612),aU=i.n(aB),aH=i(80911);let aK=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"body",i=(0,eu.jL)(),n=(0,Z.O2)("editor"),s=(0,eY.t3)(),r=(0,eu.GV)(ex.kn,tz()),o=(0,eu.GV)(ex.FI,tz()),l=!!(null==o?void 0:o.pos);(0,b.useEffect)(()=>{if(!e)return;let t=ts()(()=>{r&&i((0,ex.mF)({attached:!1}))},500,{leading:!0}),n=(0,ei.Ei)({topOffset:100,requiredCookie:"spotlightScrollDebug=true"});return document.addEventListener("wheel",t,!0),()=>{n(),t.cancel(),document.removeEventListener("wheel",t,!0)}},[e,i,r,l,t]);let a=(0,eu.GV)(ex.e4,tz());(0,b.useEffect)(()=>{if(!e||a)return;let t=ts()(()=>{if(n.inProgress)return;let t=(0,sW.MY)(e,100,s);if(!t)return void console.debug("[useHandleScrollAndSelectionChange][handleScroll] Unable to find topPosPct.");i((0,ex.m7)(t))},250,{trailing:!0,maxWait:500}),r=ts()(()=>{if(e.state.selection instanceof aH.J)return;let t=document.querySelector(n.scrollSelector||""),s=null==t?void 0:t.getBoundingClientRect(),r=e.state.selection.from,o=(0,sW.jB)(e,r);if(!t||!s||!o)return void console.debug("[useHandleScrollAndSelectionChange][handleSelectionChange] missing data",{domNodeToUse:o});let l=o.getBoundingClientRect(),a=parseFloat(((e.view.coordsAtPos(r).top-l.y)/l.height).toFixed(2));i((0,ex.m7)({pos:r,pct:a}))},250,{trailing:!0,maxWait:500});return t(),e.on("selectionUpdate",r),window.addEventListener("scroll",t,!0),()=>{e.off("selectionUpdate",r),window.removeEventListener("scroll",t,!0)}},[e,i,n,a,s])},aq=()=>{let e=(0,iI.d)(),t=(0,eu.jL)();return(0,b.useCallback)(i=>{let{collaborator:n,localIsFollowing:o,localIsAttached:a}=i,d={attached:!0};o?a?d.following=null:e.closeAll():(d.following=n.sessionId,e.closeAll(),e({duration:2e3,position:"bottom",render:function(){return(0,s.jsxs)(r.s,{bg:"gray.50",p:3,px:6,align:"center",borderRadius:"md",shadow:"md",children:[(0,s.jsx)(aN.e,{size:"sm",src:n.profileImageUrl,border:"solid 2px ".concat(n.color),color:aU()(n.color).isDark()?"white":"black",bg:n.color}),(0,s.jsx)(l.E,{ml:2,children:(0,s.jsx)(m.x6,{id:"lULvWe",values:{0:n.name}})})]})}})),console.debug("[CollaboratorsPanel] Clicked on collaborator ".concat(n.name,". Setting following to ").concat(d)),t((0,ex.mF)(d))},[e,t])},aY=e=>{let{editor:t,collaborators:i,user:n}=e,s=(0,b.useRef)(!1),r=aq(),o=new URLSearchParams(window.location.search),l=o.get("following_id"),a=o.get("follow_on_start");(0,b.useEffect)(()=>{if(s.current||!a||(null==n?void 0:n.id)===l||!t)return;let e=i.find(e=>e.id===l);e&&(r({collaborator:e,localIsAttached:!1,localIsFollowing:!1}),s.current=!0)},[l,a,t,i,n,r])},aJ="sessionId1",aX=tp.YY.create({addStorage:()=>({user:{}}),addCommands(){return{user:e=>()=>{let t=(0,eu.KA)();return this.storage.user=iL()({},this.storage.user,e),t.dispatch((0,ex.vK)({sessionId:aJ})),t.dispatch((0,ex._)({collaborators:[this.storage.user]})),!0}}}}),a$=e=>{var t;let{docId:i,snapshotId:n,scrollingParentSelector:o,onCreate:l,theme:a,hideMadeWithGammaBadge:c=!1}=e,[u]=(0,b.useState)(()=>[t9.Q,ac.Li.configure({scrollerSelector:o}),aX,ad.wg]),{user:x,isUserLoading:h,anonymousUser:m,color:p}=(0,et.ur)(),[g]=(0,eh.M)(em.E.gammaDocPasswords,{}),[j,f]=(0,b.useState)(),{data:v,loading:y,error:C}=(0,ik.YDl)({variables:{docId:i,snapshotId:n,password:g[i]},skip:!n}),w=(0,eu.GV)(e_.Jo);(0,b.useEffect)(()=>{!h&&j&&j.commands.user({id:(null==x?void 0:x.id)||m.id,color:p.value,sessionId:aJ,idleSince:null,name:(null==x?void 0:x.displayName)||m.displayName||"",profileImageUrl:(null==x?void 0:x.profileImageUrl)||"",isReady:!h})},[j,x,p,h,m]);let k=v&&void 0!==v.snapshot&&!y&&w;return(0,s.jsxs)(d.a,{"data-testid":"public-static-editor-wrapper",flex:"1",height:"100%",children:[!k||C?(0,s.jsxs)(r.s,{direction:"column",height:"100%",flex:"1",bg:"gray.50",alignItems:"center",justifyContent:"center",children:[!k&&(0,s.jsx)(t3.y,{}),C&&(0,s.jsxs)(U.o,{h:"100%",children:["There was an error loading this ",ej.TP,":"," ",C.message]})]}):(0,s.jsx)(d.a,{"data-testid":"public-static-editor-wrapper-inner",transitionProperty:"common",transitionDuration:"750ms",transitionTimingFunction:"ease-out",opacity:+!!k,children:(0,s.jsx)(td.bw,{doc:w,editorId:"main",docId:i,theme:a||void 0,extensions:u,onCreate:e=>{let{editor:t}=e;f(t),setTimeout(()=>{l&&l(t)},10)},readOnly:!0,initialContent:null==(t=v.snapshot)?void 0:t.content.default,scrollingParentSelector:o})}),j&&(0,s.jsx)(tC,{editor:j,backoffFactor:2}),!c&&(0,s.jsx)(au.d,{docWorkspace:null==w?void 0:w.organization})]})};var aZ=i(88507);let aQ={[tv.w.DOC_VIEW]:"doc",[tv.w.SLIDE_VIEW]:"present",[tv.w.DOC_PREVIEW]:"preview"},a0=Object.fromEntries(Object.entries(aQ).map(e=>{let[t,i]=e;return[i,t]})),a1=e=>{let t=(0,y.wA)(),i=(0,D.sF)().mode,n=(0,eu.GV)(ex.wC),s=(0,b.useCallback)(e=>{let t=e||n,{mode:i}=(0,D.sF)(),s=aQ[t];i!==s&&(0,at.g5)({query:{...(0,D.sF)(),mode:s},emitChange:!1})},[n]);(0,aZ.w)(s,[n]),(0,b.useEffect)(()=>at.uE.on("changed",()=>s()),[s]),(0,t$.Vg)(function(){if(!e)return;let n=a0[i],{cardId:r}=(0,D.$9)();n===tv.w.SLIDE_VIEW&&(r?(console.debug("[useQuerySync] initializeModeFromQuery - Entering slide view -> spotlightCardById:",r),e.commands.spotlightCardById(r)):(console.debug("[useQuerySync] initializeModeFromQuery - Entering slide view -> spotlightCurrentCard"),e.commands.spotlightCurrentCard())),n&&t((0,ex.iY)({mode:n})),s(n)},[e,t,i,s],[e])};var a6=i(50333),a2=i.n(a6),a5=i(61385),a3=i(74677);let a4=(e,t)=>e.docChanged?(0,a3.A)(e).flatMap(i=>{let n={from:i.newStart,to:i.newEnd};return function(e,t,i){let n=[];if(t.from===t.to){let i=e.nodeAt(t.from);i&&n.push({node:i,pos:t.from})}return e.nodesBetween(t.from,t.to,(e,t)=>{i(e)&&n.push({node:e,pos:t})}),n}(e.doc,n,t)}):[];var a8=i(67200);let a7="disable-card-size-animations",a9=()=>{let e=(0,eu.GV)(ex.yh),t=(0,eu.GV)(ex.We),i=(0,eu.GV)(ex.Uu),n=(0,iI.d)(),{min:r}=sq(),[o,l]=(0,b.useState)(null),[a,d]=(0,b.useState)(null);return(0,b.useEffect)(()=>{t<=r&&i.scaleContentToFit&&(a&&n.close(a),l(n({title:(0,s.jsx)(m.x6,{id:"IxUcyZ"}),description:(0,s.jsx)(m.x6,{id:"v9rGLj"}),status:"info",position:"top",duration:3e3})))},[t,i.scaleContentToFit,r,n,a]),(0,b.useEffect)(()=>{if(o&&t>r&&i.scaleContentToFit){n.close(o);let e=n({title:(0,s.jsx)(m.x6,{id:"oWpmCA"}),description:(0,s.jsx)(m.x6,{id:"S0DQn7"}),status:"success",position:"top",duration:3e3});l(null),d(e)}},[o,i.scaleContentToFit,r,n,t]),!e||t<=r},de=e=>{let{editor:t}=e,i=(0,eu.CU)(),n=(0,sL.t)(),s=a9(),r=(0,b.useCallback)(e=>{var r;let{transaction:o}=e;if(!o.docChanged||o.getMeta("scaleContentToFit")||(0,a8.he)(o)||s||o.getMeta("rearrangeCards"))return;let l=null==(r=(0,r7.iS)(o.doc))?void 0:r.attrs.settings;if(!l||!(null==l?void 0:l.scaleContentToFit))return;if(o.steps.some(e=>"attr"in e&&"settings"===e.attr&&l.scaleContentToFit&&"fluid"!==l.cardDimensions)||(0,a8.Xq)(o)){let e=(0,tp.Nx)(o.doc,{from:0,to:o.doc.lastChild.nodeSize},tf.jg);requestAnimationFrame(()=>{e.forEach(e=>{let{node:s}=e;dt({id:s.attrs.id,editor:t,cardFontScale:s.attrs.fontScale,isTopLayout:"top"===s.attrs.layout,docSettingsFromTransaction:l,viewportScaleFactor:n,store:i})})});return}let a=a4(o,tf.jg);a.length&&a.forEach(e=>{let{node:s}=e;di({id:s.attrs.id,editor:t,cardFontScale:s.attrs.fontScale,isTopLayout:"top"===s.attrs.layout,docSettingsFromTransaction:l,viewportScaleFactor:n,store:i})})},[t,i,n,s]);return(0,b.useEffect)(()=>{if(t&&!t.isThumbnail)return t.on("update",r),()=>{t.off("update",r)}},[t,r]),null},dt=async e=>{let{id:t,editor:i,cardFontScale:n,isTopLayout:s,docSettingsFromTransaction:r,viewportScaleFactor:o,store:l}=e;if(!i)return;let a=(0,tf.W0)(i,t);if(!a)return;let d=(0,sW.jB)(i,a.pos);if(!d)return;let c=dn({cardElt:d,cardFontScale:n,isTopLayout:s,docSettingsFromTransaction:r,viewportScaleFactor:o,store:l});c!==n&&i.chain().updateAttributesAtPos(a.pos,{fontScale:c}).setMeta("scaleContentToFit",!0).setMeta("addToHistory",!1).run()},di=eF()(dt,250,{leading:!0}),dn=e=>{let{cardElt:t,cardFontScale:i,isTopLayout:n,docSettingsFromTransaction:s,viewportScaleFactor:r,store:o}=e,l=(0,ex.We)(o.getState()),a=(0,ex.SJ)(o.getState()),d=1,c=null==t?void 0:t.querySelector("[data-card-id]"),u=null==t?void 0:t.querySelector("[data-card-body]"),x=ds({docSettingsFromTransaction:s,zoomLevel:l,viewportScaleFactor:r,theme:a});if(!c||!u||!x)return i||d;if(Math.abs(x-function(e,t){let i=e.querySelector('[data-layout-item-id="body"]'),n=null==i?void 0:i.querySelector("[data-node-view-content]"),s=e.querySelector('[data-layout-item-id="accent"]');if(t&&s){let e=s.clientHeight,t=null==n?void 0:n.clientHeight;return t?t+e:0}return(null==n?void 0:n.clientHeight)||0}(t,n))<1.01*x-x/1.01)return i;for(document.body.classList.add(a7),d+=.05;d>a5.o5&&(d=a2()(d-.05,2),c.style.setProperty("--card-font-scale",d.toString()),!(u.scrollHeight<=1.01*x)););return document.body.classList.remove(a7),requestAnimationFrame(()=>{c.style.removeProperty("--card-font-scale")}),d},ds=sM()(function(e){let{docSettingsFromTransaction:t,zoomLevel:i,viewportScaleFactor:n,theme:s}=e,r=null==t?void 0:t.cardDimensions,o=r?h.EXPORT_ASPECT_RATIOS[r]:16/9;if(o)return sG({zoomLevel:i,docSettingsFontSize:null==t?void 0:t.fontSize,defaultContentWidth:null==t?void 0:t.defaultContentWidth,viewportScaleFactor:n,theme:s})/o});var dr=i(55252),dl=i(40556);let da=e=>{var t;let{onClose:i,isOpen:n,site:d}=e,{replace:c}=(0,e9.useRouter)(),u=(0,iI.d)(),[x,{data:h,loading:p}]=(0,ik.GBQ)(),g=null==h||null==(t=h.archiveSite)?void 0:t.archived,j=(0,b.useCallback)(async()=>{if(null==d?void 0:d.id)try{await x({variables:{id:null==d?void 0:d.id}}),i()}catch(e){console.error("[DeleteGammaModal] Failed to archive site",e.message),u({title:(0,s.jsx)(m.x6,{id:"aBvGpM"}),description:(0,s.jsx)(m.x6,{id:"DVB9Jq"}),status:"error",duration:5e3,isClosable:!0,position:"top"})}},[x,null==d?void 0:d.id,u]);return((0,b.useEffect)(()=>{g&&(i(),c("/#sites"),u({title:(0,s.jsx)(m.x6,{id:"oGP1Fe"}),description:(0,s.jsx)(m.x6,{id:"sqh0jP"}),status:"success",duration:5e3,isClosable:!0,position:"top"}))},[g,i,c,u,d]),p||g)?(0,s.jsx)(L.Z,{children:(0,s.jsx)(r.s,{w:"100%",h:"100%",zIndex:"overlay",position:"absolute",top:"0",left:"0",background:"whiteAlpha.800",flex:1,children:(0,s.jsx)(iX.Y,{})})}):(0,s.jsxs)(i1.aF,{onClose:i,isOpen:n,size:"lg",children:[(0,s.jsx)(i6.m,{}),(0,s.jsxs)(i2.$,{children:[(0,s.jsx)(iR.r,{children:(0,s.jsx)(m.x6,{id:"cw2uO1",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}})}),(0,s.jsx)(i_.s,{isDisabled:p}),(0,s.jsx)(iO.c,{children:(0,s.jsxs)(o.B,{spacing:4,children:[(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"87gjhX",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}})}),(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"tOGRxi",values:{0:(null==d?void 0:d.name)?'"'.concat(null==d?void 0:d.name,'"'):""}})}),(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"MluQ97",values:{GAMMA_ARTIFACT_PROPER_NOUN_PLURAL:ej.Ix},components:{0:(0,s.jsx)(iJ.N,{color:"trueblue.500",colorScheme:"trueblue",href:"/#trash",textDecoration:"underline",isExternal:!0}),1:(0,s.jsx)(nJ.p,{mx:"2px"})}})})]})}),(0,s.jsx)(i3.j,{children:(0,s.jsxs)(e7.e,{children:[(0,s.jsx)(a.$,{variant:"ghost",onClick:i,children:(0,s.jsx)(m.x6,{id:"dEgA5A"})}),(0,s.jsx)(a.$,{variant:"hazardous",onClick:j,isLoading:p,children:(0,s.jsx)(m.x6,{id:"cnGeoo"})})]})})]})]})},dd=e=>{let{site:t}=e,{isOpen:i,onOpen:n,onClose:r}=(0,ez.j)({id:"trash-site-modal"}),[o]=(0,ik.BL9)(),l=(0,iG.Gx)(),a=null==t?void 0:t.archived,d=(0,b.useCallback)(()=>{(null==t?void 0:t.id)&&o({variables:{id:t.id},optimisticResponse:{unarchiveSite:{id:t.id,__typename:"Site"}}})},[null==t?void 0:t.id,o]);return l&&t?a?(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{fixedWidth:!0,icon:tT.ub2}),onClick:d,children:(0,s.jsx)(m.x6,{id:"yKu/3Y"})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(nd.D,{color:"red.500",icon:(0,s.jsx)(x.g,{fixedWidth:!0,icon:u.yLS}),onClick:()=>{n()},children:(0,s.jsx)(m.x6,{id:"NOLglc",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}})}),i&&(0,s.jsx)(da,{isOpen:i,onClose:r,site:t})]}):(0,s.jsx)(s.Fragment,{})},dc=e=>({[tv.w.DOC_VIEW]:{buttonLabel:"present"===e?(0,s.jsx)(m.x6,{id:"eZb+lw"}):(0,s.jsx)(m.x6,{id:"rdUucN"}),shortcutIcon:tT.ijD,shortcutKeys:(0,q.lp)("Mod+Enter"),shortcutLabel:"present"===e?(0,s.jsx)(m.x6,{id:"MF+p5R"}):(0,s.jsx)(m.x6,{id:"V76CPb"})},[tv.w.SLIDE_VIEW]:{buttonLabel:(0,s.jsx)(m.x6,{id:"ydzS9x"}),shortcutIcon:tT.APi,shortcutKeys:"Esc",shortcutLabel:(0,s.jsx)(m.x6,{id:"IkakN2"})},[tv.w.DOC_PREVIEW]:{buttonLabel:(0,s.jsx)(m.x6,{id:"ydzS9x"}),shortcutIcon:tT.APi,shortcutKeys:"Esc",shortcutLabel:(0,s.jsx)(m.x6,{id:"nN6ipi"})}});var du=i(59190),dx=i(6845),dh=i(53891),dm=i(10995);let dp=(0,rS.Ay)("mod+Enter"),dg=(0,rS.Ay)("Esc"),dj=(0,rS.Ay)("mod+Esc"),df=(0,rS.Ay)("shift+mod+Enter"),dv=e=>function(t){t((0,ex.mF)({attached:!1})),t((0,ex.iY)({mode:e}))},db=(e,t)=>{let i=document.querySelector(t);if(!i)return;let n=i.getBoundingClientRect();e.commands.scrollToNodeWithPin(document.elementFromPoint(n.width/2,100),100)},dy=e=>{let{editorWrapperEl:t,scrollingParentSelector:i,forceToolbarShownBecauseOnboarding:n}=e,s=(0,eu.jL)(),[r,o]=(0,b.useState)(!1),[l,a]=(0,b.useState)(!1),{editor:d}=(0,t5.mi)(),c=(0,eu.GV)(ex.wC),u=(0,b.useRef)(c);(0,b.useEffect)(()=>{u.current=c},[c]);let x=(0,eu.GV)(ex.Zi),h=(0,eu.GV)(ex.QF),m=(0,dm.x)(),p=(0,Q.st)(),g=(0,b.useCallback)(e=>{d&&!d.isDestroyed&&(e===tv.w.SLIDE_VIEW?((0,dx.jL)(d.state.doc,s),(0,dh.Hy)(d,!1),d.commands.spotlightCurrentCard()):(d.commands.turnOffSpotlight(!0),db(d,i)),s(dv(e)))},[s,d,i]),j=(0,b.useCallback)(()=>{let e=()=>{setTimeout(()=>{document.activeElement&&document.activeElement instanceof HTMLElement&&document.activeElement.blur()})};try{var t,i,n,s;if(null==(t=document.body)?void 0:t.requestFullscreen){null==(n=document.body)||n.requestFullscreen(),e();return}(null==(i=document.body)?void 0:i.webkitRequestFullscreen)&&(null==(s=document.body)||s.webkitRequestFullscreen(),e())}catch(e){console.debug("[PresentBlock] Error entering fullscreen:",e)}},[]),f=(0,b.useCallback)(()=>{try{if(document.fullscreenElement)return void document.exitFullscreen();document.webkitCurrentFullScreenElement&&document.webkitExitFullscreen&&document.webkitExitFullscreen()}catch(e){console.debug("[PresentBlock] Error exiting fullscreen:",e)}},[]),v=(0,R.u)("realUserMetrics"),{recordExitSlideModePerformance:y,recordEnterSlideModePerformance:C}=(0,du.td)(v),w=(0,b.useCallback)(e=>{let{fullscreen:t=!1,presentAction:i="present"}=e;u.current!==tv.w.SLIDE_VIEW&&(g("preview"===i?tv.w.DOC_PREVIEW:tv.w.SLIDE_VIEW),t&&j(),null==p||p.trackDocEvent(Q.VV.PRESENT_MODE_ENTERED,{presentAction:i}),C({isFullscreen:t}),s((0,ex.Ye)({zoomLevel:1})),setTimeout(()=>{document.activeElement&&document.activeElement instanceof HTMLElement&&document.activeElement.blur()}))},[g,j,p,C,s]),k=(0,b.useCallback)(()=>{u.current!==tv.w.DOC_VIEW&&(g(tv.w.DOC_VIEW),r&&f(),n&&requestAnimationFrame(()=>{A.R.emit("toggleOpen",{behavior:"open",skipTracking:!0})}),null==p||p.trackDocEvent(Q.VV.PRESENT_MODE_EXITED),y({isFullscreen:r}))},[g,r,f,y,u,p,n]);return(0,b.useEffect)(()=>{let e=()=>{null!==document.fullscreenElement||l||k(),null!==document.webkitCurrentFullScreenElement||l||k(),o(e=>!e),a(!1)};return document.addEventListener("fullscreenchange",e),document.addEventListener("webkitfullscreenchange",e),document.addEventListener("mozfullscreenchange",e),()=>{document.removeEventListener("fullscreenchange",e),document.removeEventListener("webkitfullscreenchange",e),document.removeEventListener("mozfullscreenchange",e)}},[l,k,f]),(0,aZ.w)(()=>{d&&!d.isDestroyed&&c===tv.w.DOC_VIEW&&requestAnimationFrame(()=>{let e=d.state.selection;e instanceof aH.J&&d.commands.command(t=>{let{tr:i}=t;return i.setSelection(e.createSelectionNear()),!0})})},[d,c]),(0,b.useEffect)(()=>eJ.WC.on("keydown","PRESENT_BLOCK",e=>{let t=u.current===tv.w.SLIDE_VIEW,i=u.current===tv.w.DOC_VIEW;if(dj(e)&&t)return k(),!0;if(!m(e)){if(dp(e))return e.preventDefault(),w({fullscreen:!1}),!0;if(df(e))return e.preventDefault(),w({fullscreen:!0}),!0;if(dg(e)&&!i&&!x&&!h)return k(),!0}}),[w,k,j,x,h,t,m]),{enterSlideView:w,exitSlideView:k,enterFullscreen:j,exitFullscreen:f,exitedFullscreenByClick:l,isFullscreen:r,setIsFullscreen:o,setExitedFullscreenByClick:a}},dC=e=>{let{editorWrapperEl:t,scrollingParentSelector:i}=e,n=(0,eu.GV)(ex.wC),r=(0,R.u)("presentFullScreen"),{shortcutIcon:o,shortcutKeys:l,buttonLabel:a}=dc("present")[n],{enterSlideView:d,exitSlideView:c}=dy({editorWrapperEl:t,scrollingParentSelector:i});return(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:o,fixedWidth:!0}),command:l,onClick:()=>{n===tv.w.SLIDE_VIEW?c():d({fullscreen:r,presentAction:"present"})},children:a})};var dw=i(46091),dk=i(39247);let dE=(0,b.createContext)({isLoading:!1,loadPage:()=>{throw Error("Context not initialized")}}),dS=function(e,t){var i,n,s;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o="card"===e.type,l=null==(i=e.attrs)?void 0:i.id;if(!["doc","document","card","cardLayoutItem"].includes(null!=(s=e.type)?s:""))return r;if(o){if(!l)return r;let i=t[l];if(r[l]=(0,s1.getCardTitle)(e),!i||!Object.values(i).length)return r;t=i}return null==(n=e.content)||n.forEach(e=>{dS(e,t,r)}),r},dI=e=>{let{initialDoc:t,file:i,children:n}=e,[r,o]=(0,b.useState)(),[l,a]=(0,b.useState)(),[d,{data:c,loading:u}]=(0,ik.gto)({nextFetchPolicy:"cache-only"}),[x,{loading:h}]=(0,ik.XWf)(),m=c?c.doc:t,p=(0,eu.CU)();(0,b.useEffect)(()=>{if(!(null==m?void 0:m.id))return;let e=p.getState();if((t=>{let i=(0,e_.Jo)(e);return!!i&&i.id===t})(m.id)){let t=(0,dk.rZ)(e).reduce((e,t)=>(e[t.id]=t.title,e),{});o((0,ex.Ev)(e)),a(t);return}x({variables:{id:m.id}}).then(e=>{var t,i,n;let{data:s}=e,r=null==s||null==(n=s.doc)||null==(i=n.currentSnapshot)||null==(t=i.content)?void 0:t.default;if(!r)return;let l=(0,s1.generateCardIdMapFromJSONContent)(r),d=dS(r,l.cardIdMap.tree);o(l.cardIdMap),a(d)})},[null==m?void 0:m.id,x,p]);let g=(0,b.useCallback)(e=>{d({variables:{id:e.id}})},[d]);return(0,s.jsx)(dE.Provider,{value:{loadPage:g,doc:m,file:i,isLoading:u||h,cardIdMap:r,cardTitleMap:l},children:n})};var dA=i(41781),dT=i(74003);let dR="gray.600",d_=e=>{let{error:t,refetch:i,...n}=e;return(0,s.jsx)(d.a,{px:6,py:4,...n,children:(0,s.jsxs)(iP.F,{p:6,status:"error",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",children:[(0,s.jsx)(iz._,{mr:0,boxSize:"30px",alignSelf:"center"}),(0,s.jsx)(rR.X,{mt:4,mb:2,fontSize:"md",children:(0,s.jsx)(m.x6,{id:"uNQm3r"})}),(0,s.jsx)(r_.T,{maxWidth:"md",children:t.message}),(0,s.jsx)(a.$,{mt:4,onClick:()=>i(),children:(0,s.jsx)(m.x6,{id:"6gRgw8"})})]})})};var dO=i(40162);let dD={slide:{enter:{visibility:"visible",opacity:1,scaleY:1,transition:{duration:.2,ease:[.4,0,.2,1]}},exit:{transitionEnd:{visibility:"hidden"},opacity:0,scaleY:.1,transition:{duration:.1,easings:"easeOut"}}}},dP=(0,aS.R)((e,t)=>{var i;let{file:n,selectedPageId:r,onPageSelected:o,getMenuItemProps:d,children:c,animation:h,matchWidth:g=!0,...j}=e,f=n.pages.find(e=>e.id===r);return(0,s.jsxs)(no.W,{isLazy:!0,matchWidth:g,children:[(0,s.jsx)(nl.I,{textAlign:"start",as:a.$,variant:"plain",rightIcon:(0,s.jsx)(x.g,{icon:u.tdl}),leftIcon:(0,s.jsx)(aE,{isMainPage:(null==f?void 0:f.id)===n.mainPageId}),ref:t,...j,children:null!=c?c:(0,s.jsx)(l.E,{noOfLines:1,fontSize:["xs","sm"],children:null!=(i=null==f?void 0:f.title)?i:(0,s.jsx)(m.x6,{id:"wtrAUY"})})}),(0,s.jsx)(na.c,{maxWidth:g?void 0:"sm",motionProps:h?{variants:dD[h]}:void 0,children:(0,s.jsx)(sO.i,{type:"radio",value:r,title:p.Ru._({id:"wRR604"}),onChange:e=>{o(n.pages.find(t=>t.id===e))},children:n.pages.map(e=>{var t;return(0,s.jsx)(sD.k,{fontSize:"sm",value:e.id,...null!=(t=null==d?void 0:d(e))?t:{},children:(0,s.jsxs)(l.E,{as:"span",display:"inline-flex",gap:4,alignItems:"center",children:[(0,s.jsx)(aE,{isMainPage:e.id===n.mainPageId,isSelected:e.id===r}),(0,s.jsx)(l.E,{noOfLines:1,children:e.title})]})},e.id)})})})]})}),dz=()=>{let{doc:e,file:t,loadPage:i}=(0,b.useContext)(dE),n=(0,eu.GV)(e_.d_);return t&&e&&n?(0,s.jsx)(dP,{maxW:"md",file:t,animation:"slide",selectedPageId:e.id,onPageSelected:i}):null},dM=()=>p.Ru._({id:"QbrUIo"}),dL=()=>p.Ru._({id:"FbBkvL"}),dN=e=>{let{isAnalyticsLoading:t,hasError:i,view:n,setView:o,description:d}=e;return i?(0,s.jsx)(iR.r,{children:(0,s.jsx)(m.x6,{id:"ZlwDi6"})}):(0,s.jsxs)(r.s,{direction:"column",flex:1,children:[(0,s.jsx)(iR.r,{children:t?(0,s.jsx)(dF,{}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.x6,{id:"ZlwDi6"}),(0,s.jsxs)(tI.T,{align:"stretch",spacing:4,children:[(0,s.jsx)(l.E,{color:"gray.500",fontSize:"sm",fontWeight:"normal",letterSpacing:"normal",children:d}),(0,s.jsx)(dz,{}),(0,s.jsxs)(dO.B,{children:[(0,s.jsx)(dO.Q,{children:(0,s.jsx)(a.$,{leftIcon:(0,s.jsx)(x.g,{icon:tT.q9c,"aria-label":dM()}),variant:"ghost",fontWeight:"600",bg:"deckView"===n?"trueblue.50":"transparent",color:"deckView"===n?"trueblue.500":dR,onClick:()=>o("deckView"),children:dM()})}),(0,s.jsx)(dO.Q,{children:(0,s.jsx)(a.$,{leftIcon:(0,s.jsx)(x.g,{icon:tT.Mkm,"aria-label":dL()}),variant:"ghost",fontWeight:"600",bg:"cardEngagement"===n?"trueblue.50":"transparent",color:"cardEngagement"===n?"trueblue.500":dR,onClick:()=>o("cardEngagement"),children:dL()})})]})]})]})}),(0,s.jsx)(i_.s,{})]})},dF=()=>(0,s.jsxs)(tI.T,{align:"stretch",spacing:4,children:[(0,s.jsx)(dA.E,{h:12,width:"30%"}),(0,s.jsx)(dA.E,{h:4,width:"80%"})]});var dV=i(41633);let dG=e=>{let{degree:t,alpha:i=1,startColor:n="#ECC94B",endColor:s="#38A169"}=e;if(Number.isNaN(t))return aU()("#e5e0df").toHex8String();let r=aU()(n).toHsl(),o=aU()(s).toHsl();return aU()({h:(0,dV.Cc)(r.h,o.h,t),s:(0,dV.Cc)(r.s,o.s,t),l:(0,dV.Cc)(r.l,o.l,t),a:i}).toHex8String()},dW=(e,t)=>e.reduce((e,i)=>(e[i.cardId]=i[t],e),{}),dB=(e,t)=>{let i=0;for(let s in e){var n;i+=null!=(n=t[s])?n:0,i+=dB(e[s],t)}return i},dU=(e,t)=>{let i=0;for(let s in e){var n;i=Math.max((null!=(n=t[s])?n:0)+dB(e[s],t),i)}return i};var dH=i(22348),dK=i.n(dH);let dq=e=>{let{cardsViewed:t,totalCards:i}=e,n=dG({degree:t/i}),o=i>0;return(0,s.jsxs)(e8.z,{spacing:3,children:[(0,s.jsxs)(r.s,{flex:1,position:"relative",children:[(0,s.jsx)(ed.k,{h:4,flex:1,borderRadius:"sm",value:t,max:o?i:void 0,bg:"gray.200",sx:{"> div":{bg:n}}}),o&&t===i&&(0,s.jsx)(dJ,{top:0,right:0,transform:"translate(50%,-50%)",position:"absolute"})]}),(0,s.jsx)(l.E,{w:{base:10,lg:12},fontSize:"sm",whiteSpace:"nowrap",textAlign:"left",children:o?"".concat(t,"/").concat(i):(0,s.jsx)(m.x6,{id:"8Va3Pt"})})]})},dY=e=>{let{cardCount:t}=e,i=(0,b.useMemo)(()=>dK()(1,t),[t]);return(0,s.jsxs)(e8.z,{spacing:3,filter:"blur(3px)",children:[(0,s.jsx)(r.s,{flex:1,position:"relative",children:(0,s.jsx)(ed.k,{h:4,flex:1,borderRadius:"sm",value:i,max:t,bg:"gray.300",sx:{"> div":{bg:"gray.300"}}})}),(0,s.jsxs)(l.E,{w:{base:10,lg:12},fontSize:"sm",whiteSpace:"nowrap",textAlign:"left",color:"gray.600",children:[i,"/",t]})]})},dJ=e=>{let{...t}=e;return(0,s.jsx)(sc.j,{bg:"green.500",size:"18px",border:"2px solid white",color:"white",...t,children:(0,s.jsx)(x.g,{icon:tT.e68,"aria-label":p.Ru._({id:"y886Ns"}),size:"xs"})})},dX=e=>t=>(0,dV.Cc)(0,100,t/e),d$=e=>{let{cards:t,isColorized:i=!1,scaleToMax:n=!1,includeChildren:r,showViewersPercent:o=!1,leftLabel:l,rightLabel:a,tooltipLabel:c,cardLookupTable:u,onAnalyticsPanelClose:x}=e,h=dX(r?dU(t,u):Math.max(...Object.values(u))),m=(0,b.useCallback)(e=>h(e),[h]);return(0,s.jsxs)(d.a,{mt:6,mb:4,children:[(0,s.jsxs)(e8.z,{mb:3,children:[(0,s.jsx)(e8.z,{children:(0,s.jsx)(q._x,{children:l})}),(0,s.jsx)(tA.h,{}),(0,s.jsx)(e8.z,{children:(0,s.jsx)(q.Tz,{placement:"top",label:c,children:(0,s.jsx)(e8.z,{children:(0,s.jsx)(q._x,{borderBottom:"0.125em dashed",borderBottomColor:"gray.400",children:a})})})})]}),(0,s.jsx)(d.a,{width:"100%",children:Object.entries(t).map(e=>{var t;let[l,a]=e;return(0,s.jsx)(dZ,{id:l,childCards:a,percentage:null!=(t=u[l])?t:0,calculatePercentageScale:m,isColorized:i,cardLookupTable:u,scaleToMax:n,includeChildren:r,showViewersPercent:o,onAnalyticsPanelClose:x},l)})})]})},dZ=e=>{let{id:t,cardLookupTable:i,childCards:n,percentage:a,calculatePercentageScale:c,isColorized:h,scaleToMax:p,includeChildren:g,showViewersPercent:j,onAnalyticsPanelClose:f}=e,[v,y]=(0,b.useState)(!1),C=(0,b.useCallback)(()=>{y(!v)},[v]),{cardTitleMap:w}=(0,b.useContext)(dE),k=null==w?void 0:w[t],E=Object.values(n).length>0,S=0===a,I=g?a+dB(n,i):a,A=v?I:0,T=p?c(I):Math.min(100,A),R=v?a:I,_=p?c(R):Math.min(100,R),O={startColor:"#F6AD55",endColor:"#68D391"},D=h?dG({degree:T/100,...O}):"trueblue.50",P=h?dG({degree:_/100,...O}):"trueblue.100";return(0,s.jsxs)(o.B,{children:[(0,s.jsx)(r.s,{direction:"column",children:(0,s.jsxs)(r.s,{h:8,px:2,bg:"gray.50",borderRadius:"md",position:"relative",overflow:"hidden",alignItems:"center",_focusWithin:{shadow:"outline"},children:[(0,s.jsxs)(e8.z,{pos:"absolute",zIndex:1,children:[E&&(0,s.jsx)(H.K,{"aria-label":"expand-card",size:"xs",variant:"ghost",isRound:!0,colorScheme:"blackAlpha",icon:(0,s.jsx)(x.g,{icon:u.XkK}),transform:v?"rotate(90deg)":"",onClick:C,_focus:{shadow:"none"}}),!E&&(0,s.jsx)(r.s,{w:6,justifyContent:"center",alignItems:"center",children:S?(0,s.jsx)(q.Tz,{label:(0,s.jsx)(m.x6,{id:"s+PDNe"}),children:(0,s.jsx)(d.a,{color:"blackAlpha.500",children:(0,s.jsx)(x.g,{icon:tT.k6j,size:"sm"})})}):(0,s.jsx)(d.a,{color:"blackAlpha.300",fontSize:"xx-small",children:(0,s.jsx)(x.g,{icon:tT.ZPt,size:"sm"})})}),(0,s.jsx)(l.E,{color:S?"blackAlpha.500":void 0,noOfLines:1,children:k||(0,s.jsx)(m.x6,{id:"wja8aL"})})]}),(0,s.jsxs)(d.a,{position:"absolute",w:"100%",height:"100%",top:0,left:0,pointerEvents:"none",children:[(0,s.jsx)(d.a,{position:"absolute",h:"100%",bg:S?"blackAlpha.200":D,w:"".concat(T,"%")}),(0,s.jsx)(d.a,{transitionProperty:"all",transitionDuration:"normal",position:"absolute",h:"100%",bg:S?"blackAlpha.300":P,w:"".concat(_,"%")})]}),h&&100===a&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(tA.h,{}),(0,s.jsx)(dJ,{alignSelf:"center",zIndex:1})]})]})}),(0,s.jsx)(d.a,{pl:8,children:E&&Object.entries(n).map(e=>{var t;let[n,r]=e;return(0,s.jsx)(le.S,{in:v,children:(0,s.jsx)(dZ,{id:n,childCards:r,percentage:null!=(t=i[n])?t:0,cardLookupTable:i,calculatePercentageScale:c,scaleToMax:p,isColorized:h,includeChildren:g,showViewersPercent:j,onAnalyticsPanelClose:f})},n)})})]})},dQ=()=>(0,s.jsx)(o.B,{spacing:2,children:(0,s.jsx)(m.x6,{id:"QXJTby",components:{0:(0,s.jsx)(l.E,{}),1:(0,s.jsx)(l.E,{}),2:(0,s.jsx)(l.E,{})}})}),d0=e=>{let{timeInMS:t}=e;return void 0===t?(0,s.jsx)(s.Fragment,{}):(0,s.jsx)(m.x6,{id:"yXHI9B",values:{timeInSeconds:t/1e3}})},d1=(e,t)=>"viewTimePercent"===e?{chartDescription:(0,s.jsx)(m.x6,{id:"dpTE1c",values:{viewerCount:t}}),leftLabel:(0,s.jsx)(m.x6,{id:"ml51m3"}),rightLabel:(0,s.jsx)(m.x6,{id:"8R7bfR"})}:{chartDescription:(0,s.jsx)(m.x6,{id:"b2VMTo",values:{viewerCount:t}}),leftLabel:(0,s.jsx)(m.x6,{id:"kTgCTO"}),rightLabel:(0,s.jsx)(m.x6,{id:"AKDcmS"})},d6=e=>{let{docId:t,viewerFilter:i,currentViewerFilterCount:n,onAnalyticsPanelClose:r}=e,{cardIdMap:o}=(0,b.useContext)(dE),{data:l,error:c,loading:h,refetch:p}=(0,ik.NI5)({variables:{docId:t}}),[g,j]=(0,b.useState)("viewTimePercent"),{chartDescription:f,rightLabel:v,leftLabel:y}=d1(g,n),C="viewersOnly"===i?"viewers":"everyone",w=(0,R.u)("cardViewedThreshold"),k=(0,b.useMemo)(()=>{var e;return(null==l||null==(e=l.docCardsStats)?void 0:e[C])||[]},[null==l?void 0:l.docCardsStats,C]),E=(0,b.useMemo)(()=>dW(k,g),[k,g]),S=(0,b.useCallback)(()=>j("viewTimePercent"),[]),I=(0,b.useCallback)(()=>j("viewersPercent"),[]);return(0,s.jsxs)(d.a,{children:[(0,s.jsxs)(e8.z,{my:4,children:[(0,s.jsx)(a.$,{leftIcon:(0,s.jsx)(x.g,{icon:u.a$,"aria-label":"Time spend"}),variant:"ghost",fontWeight:"600",bg:"viewTimePercent"===g?"trueblue.50":"transparent",color:"viewTimePercent"===g?"trueblue.500":dR,onClick:S,children:(0,s.jsx)(m.x6,{id:"XyvAeS"})}),(0,s.jsx)(a.$,{leftIcon:(0,s.jsx)(x.g,{icon:tT.Bi7,"aria-label":"Percent viewed"}),variant:"ghost",fontWeight:"600",bg:"viewersPercent"===g?"trueblue.50":"transparent",color:"viewersPercent"===g?"trueblue.500":dR,onClick:I,children:(0,s.jsx)(m.x6,{id:"vXtpAZ"})})]}),(0,s.jsx)(d5,{description:f}),c&&(0,s.jsx)(d_,{error:c,refetch:p}),(h||!o)&&!c&&(0,s.jsx)(d2,{}),!h&&!c&&o&&(0,s.jsx)(d$,{cards:o.tree,cardLookupTable:E,scaleToMax:"viewTimePercent"===g,isColorized:"viewersPercent"===g,includeChildren:"viewTimePercent"===g,showViewersPercent:"viewersPercent"===g,rightLabel:v,leftLabel:y,tooltipLabel:"viewTimePercent"===g?(0,s.jsx)(dQ,{}):(0,s.jsx)(d0,{timeInMS:w}),onAnalyticsPanelClose:r})]})},d2=e=>{let{includeDescription:t=!1}=e;return(0,s.jsx)(r.s,{direction:"column",mt:6,mb:4,children:(0,s.jsxs)(tI.T,{align:"stretch",children:[t&&(0,s.jsx)(dA.E,{h:5,mb:3,w:"70%"}),[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,s.jsx)(dA.E,{h:8},t))]})})},d5=e=>{let{description:t}=e;return(0,s.jsx)(l.E,{color:dR,children:t})};var d3=i(30742),d4=i(96414),d8=i(4192),d7=i(21157),d9=i.n(d7),ce=i(26194),ct=i.n(ce);let ci=e=>{let{uniqueViewers:t,docCreatedDate:i}=e,n=(0,R.u)("cardViewedThreshold");return(0,s.jsx)(nR.d,{children:(0,s.jsxs)(n_.Tr,{children:[(0,s.jsx)(cn,{label:(0,s.jsx)(m.x6,{id:"LZHJAq",values:{uniqueViewers:t}}),tooltip:(0,s.jsx)(m.x6,{id:"aaiIlJ",values:{docCreatedDate:i}}),width:"40%"}),(0,s.jsx)(cn,{label:(0,s.jsx)(m.x6,{id:"pRGfP3"}),width:"35%"}),(0,s.jsx)(cn,{label:(0,s.jsx)(m.x6,{id:"QfqHuz"}),tooltip:(0,s.jsx)(d0,{timeInMS:n}),width:"25%"})]})})},cn=e=>{let{label:t,width:i,tooltip:n}=e,r=(0,s.jsx)(nO.Th,{w:i,children:(0,s.jsx)(l.E,{display:"inline",borderBottom:n?"0.125em dashed":void 0,borderBottomColor:n?"gray.400":void 0,children:t})});return n?(0,s.jsx)(q.Tz,{placement:"top",label:n,children:r}):r},cs=["Yesterday at 11:02 am","Today at 12:55 pm","Dec 12, 2020, 10:19 pm","Apr 14, 2023, 4:30 pm","Jan 1, 2021, 12:03 am","Dec 7, 1984, 12:03 am","May 14, 2002, 3:56 pm"],cr=e=>{let{viewers:t,currentViewerFilterCount:i,docCreatedDate:n,creatorId:r,contributors:o,cardCount:a,handleTableRowClick:d,hasIndividualAnalytics:c}=e,{user:u}=(0,et.ur)(),x=c?t:ct()(t,e=>{var t;return[+((null==(t=e.user)?void 0:t.id)!==(null==u?void 0:u.id)),-e.lastOpened]}).slice(0,3);return(0,s.jsx)(d4.K,{children:(0,s.jsxs)(nT.X,{colorScheme:"blackAlpha",children:[(0,s.jsx)(ci,{uniqueViewers:i,docCreatedDate:n}),(0,s.jsx)(nD.N,{children:x.map((e,i)=>{let{user:n,lastOpened:x,visitorId:h}=e,m=(null==n?void 0:n.id)===r,g=o.some(e=>e.user.id===(null==n?void 0:n.id)),j=n?n.displayName+(n.id===(null==u?void 0:u.id)?" "+p.Ru._({id:"dDUgzP"}):"")||"":p.Ru._({id:"VmjbJY"}),f=x?d9()((0,rp.OG)(x)):p.Ru._({id:"/JO3xr"}),v={name:j,id:(null==n?void 0:n.id)||h||"",email:null==n?void 0:n.email,isCreator:m,isContributor:g,profileImg:null==n?void 0:n.profileImageUrl,lastOpened:f},b=i===t.length-1,y=(null==n?void 0:n.id)===(null==u?void 0:u.id),C=!c&&!y;return(0,s.jsxs)(n_.Tr,{cursor:"pointer",onClick:()=>d(v),_hover:{bg:"blackAlpha.50"},borderBottom:"none",children:[(0,s.jsx)(nP.Td,{borderBottom:b?"0 none":void 0,children:(0,s.jsx)(co,{name:j,email:null==n?void 0:n.email,profileImg:null==n?void 0:n.profileImageUrl,isContributor:g,isCreator:m,isAnonymous:!n})}),(0,s.jsx)(nP.Td,{borderBottom:b?"0 none":void 0,children:C?(0,s.jsx)(l.E,{fontSize:"sm",filter:"blur(3px)",color:"gray.600",children:cs[i%cs.length]}):(0,s.jsx)(l.E,{fontSize:"sm",children:f})}),(0,s.jsx)(nP.Td,{borderBottom:b?"0 none":void 0,children:C?(0,s.jsx)(dY,{cardCount:a}):(0,s.jsx)(dq,{cardsViewed:e.cardsViewed||0,totalCards:a||0})})]},(null==n?void 0:n.id)||h)})})]})})},co=e=>{let{name:t,profileImg:i,email:n="",isCreator:r=!1,isContributor:a=!1,isAnonymous:d=!1,...c}=e;return(0,s.jsxs)(e8.z,{...c,children:[(0,s.jsx)(aN.e,{size:"sm",name:t,src:i}),(0,s.jsxs)(o.B,{spacing:.5,children:[(0,s.jsxs)(l.E,{children:[t,d&&(0,s.jsx)(q.qT,{label:(0,s.jsx)(m.x6,{id:"VHgG8W",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}}),ml:2})]}),(0,s.jsxs)(e8.z,{mt:1,children:[(0,s.jsx)(l.E,{fontSize:"sm",color:"gray.500",children:n}),(r||a)&&(0,s.jsx)(d8.vw,{size:"sm",transform:"translate(0, 1.5px)",children:r?(0,s.jsx)(m.x6,{id:"UE2beD"}):(0,s.jsx)(m.x6,{id:"3L51iw"})})]})]})]})},cl=e=>{var t,i,n,r;let{user:o,onBackClick:l,docId:c,onAnalyticsPanelClose:u}=e,{cardIdMap:x}=(0,b.useContext)(dE),{data:h,error:p,loading:g,refetch:j}=(0,ik.NI5)({variables:{docId:c,userId:o.id},skip:!c||!o.id,pollInterval:9e5,notifyOnNetworkStatusChange:!0}),f=null!=(r=null==h||null==(i=h.docCardsStats)||null==(t=i.everyone)?void 0:t.length)?r:0,v=null==h||null==(n=h.docCardsStats)?void 0:n.cardCount,y=(0,b.useMemo)(()=>{var e;return(null==h||null==(e=h.docCardsStats)?void 0:e.everyone)||[]},[null==h?void 0:h.docCardsStats]),C=(0,b.useMemo)(()=>dW(y,"viewTimePercent"),[y]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(iR.r,{children:(0,s.jsx)(a.$,{"aria-label":"Back",leftIcon:(0,s.jsx)(d3.g,{}),variant:"ghost",onClick:l,children:(0,s.jsx)(m.x6,{id:"iH8pgl"})})}),(0,s.jsx)(i_.s,{}),(0,s.jsx)(iD.c,{}),(0,s.jsx)(iO.c,{children:(0,s.jsxs)(d.a,{children:[(0,s.jsx)(ca,{user:o,showLastOpened:!0}),v&&(0,s.jsx)(d5,{description:(0,s.jsx)(m.x6,{id:"YJOrjl",values:{cardsViewed:f,totalCards:v}})}),g&&!p&&(0,s.jsx)(d2,{includeDescription:!0}),p&&(0,s.jsx)(d_,{error:p,refetch:j}),!p&&!g&&x&&(0,s.jsx)(d$,{cards:x.tree,scaleToMax:!0,includeChildren:!0,leftLabel:(0,s.jsx)(m.x6,{id:"ml51m3"}),rightLabel:(0,s.jsx)(m.x6,{id:"8R7bfR"}),cardLookupTable:C,tooltipLabel:(0,s.jsx)(dQ,{}),onAnalyticsPanelClose:u})]})})]})},ca=e=>{let{user:t,showLastOpened:i}=e;return(0,s.jsxs)(e8.z,{align:"center",my:6,children:[(0,s.jsx)(co,{name:t.name,profileImg:t.profileImg,email:t.email,isCreator:t.isCreator,isContributor:t.isContributor,width:i?"50%":void 0}),i&&(0,s.jsxs)(tI.T,{align:"flex-start",spacing:0,children:[(0,s.jsx)(q._x,{children:(0,s.jsx)(m.x6,{id:"pRGfP3"})}),(0,s.jsx)(l.E,{children:t.lastOpened})]})]})},cd=(e,t,i)=>"everyone"===e?p.Ru._({id:"1IE7uf",values:{everyone:t}}):"viewersOnly"===e?p.Ru._({id:"r/tA4Y",values:{viewersOnly:i}}):p.Ru._({id:"V9JX7d"}),cc={everyone:tT.USd,viewersOnly:tT.pS3,accessLinkOnly:tT.wic},cu=e=>{let{selected:t,handleMenuItemChange:i,everyoneCount:n,viewersOnlyCount:o}=e;return(0,s.jsxs)(no.W,{children:[(0,s.jsx)(nl.I,{leftIcon:(0,s.jsx)(x.g,{size:"xs",icon:cc[t]}),as:a.$,size:"md",rightIcon:(0,s.jsx)(x.g,{size:"xs",icon:u.Jt$}),children:cd(t,n,o)}),(0,s.jsx)(na.c,{zIndex:2,maxW:"380px",children:(0,s.jsxs)(sO.i,{defaultValue:t,value:t,onChange:e=>{Array.isArray(e)||i(e)},children:[(0,s.jsx)(sD.k,{value:"everyone",isDisabled:0===n,children:(0,s.jsxs)(r.s,{align:"center",children:[(0,s.jsx)(x.g,{icon:cc.everyone,size:"xs"}),(0,s.jsxs)(d.a,{ml:3,children:[(0,s.jsx)(l.E,{children:cd("everyone",n,o)}),(0,s.jsx)(l.E,{fontSize:"sm",color:"gray.500",children:(0,s.jsx)(m.x6,{id:"c5ESvc",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}})})]})]})}),(0,s.jsx)(sD.k,{value:"viewersOnly",isDisabled:0===o,children:(0,s.jsxs)(r.s,{align:"center",children:[(0,s.jsx)(x.g,{icon:cc.viewersOnly,size:"xs"}),(0,s.jsxs)(d.a,{ml:3,children:[(0,s.jsx)(l.E,{children:cd("viewersOnly",n,o)}),(0,s.jsx)(l.E,{fontSize:"sm",color:"gray.500",children:(0,s.jsx)(m.x6,{id:"5hKO48",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}})})]})]})}),!1]})})]})};var cx=i(77126),ch=i(96784),cm=i(19034),cp=i(66490),cg=i(8995),cj=i(59557),cf=i(14974),cv=i(1860),cb=i(23275),cy=i(26658),cC=i(88678),cw=i(25927),ck=i(54772),cE=i(40149);let cS={top:55,right:20,bottom:40,left:24},cI=e=>Math.round(e).toString(),cA=e=>Math.max(...e.map(e=>(0,cC.A)(e.toString(),{fontFamily:"body",fontSize:"var(--chakra-fontSizes-sm)",fontWeight:"600"})||0)),cT={backgroundColor:"var(--chakra-colors-blackAlpha-800)",color:"var(--chakra-colors-gray-50)",fontFamily:"var(--chakra-fonts-body)",boxShadow:"var(--chakra-shadows-4)",fontSize:"var(--chakra-fontSizes-xs)",borderRadius:"var(--chakra-radii-sm)",fontWeight:"var(--chakra-fontWeights-semibold)",borderWidth:"1px",borderColor:"black",paddingRight:"var(--chakra-space-1-5)",paddingLeft:"var(--chakra-space-1-5)",paddingTop:"var(--chakra-space-0-5)",paddingBottom:"var(--chakra-space-0-5)",zIndex:"var(--chakra-zIndex-tooltip)",minWidth:"60px",lineHeight:"var(--chakra-lineHeights-base)"},cR="var(--chakra-colors-gray-500)",c_="var(--chakra-colors-gray-200)",cO=e=>e.map(e=>e.x),cD=e=>e.map(e=>e.y),cP=e=>{let{width:t,height:i,margin:n=cS,chartData:r,TooltipInner:o,showZero:l,shouldRoundYValues:a,showMaxAndMiddle:c,barColor:u,customTooltipStyles:x,onClick:h=()=>{}}=e,{showTooltip:m,tooltipOpen:p,tooltipLeft:g,tooltipTop:j,tooltipData:f,hideTooltip:v}=(0,cw.A)(),y=(0,b.useRef)(),C=(0,b.useRef)();(0,b.useEffect)(()=>()=>{y.current&&clearTimeout(y.current),C.current&&clearTimeout(C.current)},[]);let w=cD(r),k=Math.max(...w),E=[k,Math.round(k/2)],S=cA(c?E:w),I=n.left+S,A=t-I-n.right,T=i-n.top-n.bottom,R={...ck.k,...cT,...x},_=(0,b.useMemo)(()=>(0,cf.A)({range:[0,A],domain:cO(r),padding:.3}),[A,r]),O=(0,b.useMemo)(()=>(0,cv.A)({range:[T,0],round:!0,domain:[0,k]}),[T,k]),D=l?O(Math.min(...w.filter(e=>0!==e))):T,P=l&&T-D>6;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.a,{children:(0,s.jsxs)("svg",{width:t,height:i,children:[(0,s.jsx)("rect",{x:0,y:0,rx:4,width:t,height:i,fill:"var(--chakra-colors-gray-50)"}),(0,s.jsx)(cg.A,{top:n.top,left:I,children:r.map(e=>{var t,i;let n=e.y,r=e.x,o="bar-".concat(r,"-").concat(n),a=_.bandwidth(),d=T-(null!=(t=O(n))?t:0),c=P&&0===d?6:d,x=null!=(i=_(r))?i:0,p=T-c;return(0,s.jsxs)(cg.A,{children:[(0,s.jsx)(cb.A,{x:x,y:p,width:a,height:c,radius:5,topLeft:!0,topRight:!0,fill:l&&0===n?c_:u,onMouseLeave:()=>{y.current=window.setTimeout(()=>{v()},300)},onMouseMove:t=>{y.current&&clearTimeout(y.current);let i=(0,cp.A)(t);m({tooltipData:e,tooltipTop:null==i?void 0:i.y,tooltipLeft:null==i?void 0:i.x})},onClick:t=>h(t,e)}),(0,s.jsx)(cy.A,{x:x,y:0,width:a,height:Math.max(0,T-c),opacity:0,onMouseLeave:()=>{C.current=window.setTimeout(()=>{v()},300)},onMouseMove:t=>{C.current&&clearTimeout(C.current);let i=(0,cp.A)(t);m({tooltipData:e,tooltipTop:null==i?void 0:i.y,tooltipLeft:null==i?void 0:i.x})}})]},o)})}),(0,s.jsx)(ch.A,{top:n.top,left:I,scale:O,stroke:c_,strokeWidth:2,tickValues:c?E:void 0,numTicks:c?void 0:2,hideZero:!0,tickFormat:a?cI:void 0,tickLength:6,tickStroke:c_,tickLabelProps:()=>({fill:cR,textAnchor:"end",fontFamily:"var(--chakra-fonts-body)",fontSize:"var(--chakra-fontSizes-sm)",fontWeight:"600",dy:"0.33em",dx:-4})}),(0,s.jsx)(cm.A,{top:T+n.top,left:I,scale:_,stroke:c_,numTicks:4,tickStroke:c_,tickLabelProps:()=>({fill:cR,textAnchor:"middle",fontFamily:"var(--chakra-fonts-body)",fontSize:"var(--chakra-fontSizes-sm)",fontWeight:"600",dy:4}),strokeWidth:2,tickLength:6})]})}),p&&f&&(0,s.jsx)(cE.A,{top:j,left:g,style:R,children:(0,s.jsx)(o,{x:f.x,y:f.y})})]})},cz=e=>{let{chartTitle:t,TooltipInner:i,showZero:n=!0,shouldRoundYValues:r=!0,showMaxAndMiddle:o=!0,data:a,barColor:c="var(--chakra-colors-trueblue-200)",customTooltipStyles:u,onClick:x=()=>{},...h}=e;return(0,s.jsxs)(d.a,{position:"relative",height:"300px",...h,children:[(0,s.jsx)(l.E,{size:"xs",color:"gray.500",fontWeight:"600",position:"absolute",top:3,left:"50%",transform:"translateX(-50%)",children:t}),(0,s.jsx)(cj.A,{children:e=>{let{width:t,height:l}=e;return t<10?null:(0,s.jsx)(cP,{width:t,height:l,showZero:n,chartData:a,barColor:c,customTooltipStyles:u,onClick:x,TooltipInner:i,shouldRoundYValues:r,showMaxAndMiddle:o})}})]})},cM=(e,t)=>{let i="LLL d",n=new Date;n.setDate(n.getDate()-t+1);let s=[];for(let r=0;r<t;r++){let t=new Date(n);t.setDate(t.getDate()+r);let o=(0,cx.A)(t,{representation:"date"}),l=e.find(e=>e.date===o);l?s.push({x:(0,iU.Yq)(l.date,i),y:l.uniqueVisitors?l.uniqueVisitors:0}):s.push({x:(0,iU.Yq)(o,i),y:0})}return s},cL=e=>{let{viewData:t,dayCount:i}=e,n=cM(t,i);return(0,s.jsx)(cz,{data:n,my:3,chartTitle:(0,s.jsx)(m.x6,{id:"mSEibf"}),TooltipInner:cN})},cN=e=>{let{x:t,y:i}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.E,{children:t}),(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"6MKtHx",values:{y:i}})})]})},cF=e=>e.every(e=>0===e.uniqueVisitors),cV=(e,t)=>t&&t.dailyViews?"everyone"===e?t.dailyViews.everyone?t.dailyViews.everyone:[]:"viewersOnly"===e&&t.dailyViews.viewers?t.dailyViews.viewers:[]:[],cG=(e,t,i)=>{var n,s,r;if(!i)return 0;let o=null!=(s=i.uniqueViewers)?s:0,l=null!=(r=null==(n=e.editors)?void 0:n.length)?r:0;return"everyone"===t?o:"viewersOnly"===t?Math.max(0,o-l):0},cW=e=>{var t,i;let{doc:n,handleSharePanelOpen:l,onAnalyticsPanelClose:d,canShare:c}=e,{loading:u,data:x,error:h,refetch:g}=(0,ik.Y0k)({variables:{memoId:n.id},skip:!n.id,pollInterval:9e5,notifyOnNetworkStatusChange:!0}),{user:j}=(0,et.ur)(),[f,v]=(0,b.useState)("deckView"),[y,C]=(0,b.useState)(null),[w,k]=(0,b.useState)("everyone"),E=(0,iU.Yq)(n.createdTime,"PPP"),S=n.title||(0,s.jsx)(m.x6,{id:"wja8aL"}),I=(null==x?void 0:x.memoStats.viewers)||[],A=(null==x||null==(t=x.memoStats.dailyViews)?void 0:t.dayCount)||0,T=cV(w,null==x?void 0:x.memoStats),R=(0,eK.ez)("individual_analytics",n.organization),{openUpsellModal:_}=(0,dT.I)(),O=cF(T),D=I.filter(e=>{var t;return"everyone"===w||!(null==(t=n.editors)?void 0:t.some(t=>{var i,n;return(null==(i=e.user)?void 0:i.id)===(null==(n=t.user)?void 0:n.id)}))}),P=cG(n,w,null==x?void 0:x.memoStats),z=(0,b.useCallback)(e=>{k(e)},[]),M=(0,b.useCallback)(e=>{v(e)},[]),L=(0,b.useCallback)(e=>{if(!R&&e.id!==(null==j?void 0:j.id))return void _({segmentEvent:Q.VV.GAMMA_PRO_UPSELL_SUBSCRIPTION_INDIVIDUAL_ANALYTICS});C(e)},[_,R,j]),N=(0,b.useCallback)(()=>{C(null)},[]),F=void 0!==h;return(0,s.jsxs)(s.Fragment,{children:[y&&(0,s.jsx)(cl,{user:y,onBackClick:N,docId:n.id,onAnalyticsPanelClose:d}),!y&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(dN,{hasError:F,isAnalyticsLoading:u,setView:M,view:f,description:(0,s.jsx)(m.x6,{id:"uEtUah",values:{docTitle:S,docCreatedDate:E}})}),F&&(0,s.jsx)(d_,{error:h,refetch:g}),!F&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(iD.c,{}),(0,s.jsxs)(iO.c,{children:[u&&(0,s.jsx)(cB,{}),!u&&I.length<=1&&c&&(0,s.jsx)(cU,{handleSharePanelOpen:l}),!u&&(0,s.jsxs)(o.B,{direction:"column",mt:4,spacing:4,children:[(0,s.jsxs)(r.s,{direction:"row",justify:"space-between",align:"center",children:[(0,s.jsx)(B.D,{as:"h2",size:"md",children:"cardEngagement"===f?dL():dM()}),(0,s.jsx)(cu,{selected:w,handleMenuItemChange:z,everyoneCount:cG(n,"everyone",null==x?void 0:x.memoStats),viewersOnlyCount:cG(n,"viewersOnly",null==x?void 0:x.memoStats)})]}),"deckView"===f&&O&&(0,s.jsx)(cH,{handleSharePanelOpen:l,dayCount:A}),"deckView"===f&&!O&&(0,s.jsx)(cL,{viewData:T,dayCount:A}),"cardEngagement"===f&&(0,s.jsx)(d6,{docId:n.id,viewerFilter:w,currentViewerFilterCount:P,onAnalyticsPanelClose:d}),(0,s.jsx)(cr,{creatorId:(null==(i=n.createdBy)?void 0:i.id)||"",viewers:D,currentViewerFilterCount:P,docCreatedDate:E,contributors:n.editors||[],cardCount:(null==x?void 0:x.memoStats.cardCount)||0,handleTableRowClick:L,hasIndividualAnalytics:R}),D.length>3&&!R&&(0,s.jsx)(a.$,{variant:"ghost",size:"sm",color:"gray.600",colorScheme:"gray",onClick:()=>_({segmentEvent:Q.VV.GAMMA_PRO_UPSELL_SUBSCRIPTION_INDIVIDUAL_ANALYTICS}),children:(0,s.jsx)(m.x6,{id:"BKBX4n",values:{0:D.length-3}})}),!R&&(0,s.jsx)(iQ.c,{title:(0,s.jsx)(m.x6,{id:"h5AmZ4"}),segmentEvent:Q.VV.GAMMA_PRO_UPSELL_SUBSCRIPTION_INDIVIDUAL_ANALYTICS,description:p.Ru._({id:"GYgPBy"}),targetFeature:"individual_analytics"})]})]})]})]})]})},cB=()=>(0,s.jsxs)(r.s,{direction:"column",py:2,children:[(0,s.jsx)(dA.E,{h:10,width:"40%",mb:4}),(0,s.jsx)(dA.E,{h:40,mb:4}),(0,s.jsx)(tI.T,{align:"stretch",children:[void 0,void 0,void 0].map((e,t)=>(0,s.jsx)(dA.E,{h:12},t))})]}),cU=e=>{let{handleSharePanelOpen:t}=e;return(0,s.jsx)(r.s,{p:3,px:4,mt:2,bg:"gray.50",color:dR,borderRadius:"base",children:(0,s.jsxs)(r.s,{align:"baseline",fontSize:"sm",children:[(0,s.jsx)(d.a,{pr:2,children:(0,s.jsx)(x.g,{icon:tT.X46,"aria-label":"user-icon",size:"sm"})}),(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"FNMh4I",components:{0:(0,s.jsx)(l.E,{as:"button",onClick:t,textDecoration:"underline",fontWeight:"600",color:"gray.700"})}})})]})})},cH=e=>{let{handleSharePanelOpen:t,dayCount:i}=e;return(0,s.jsxs)(iP.F,{my:4,p:6,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",colorScheme:"gray",children:[(0,s.jsx)(sc.j,{size:"30px",bg:"gray.500",children:(0,s.jsx)(x.g,{icon:tT.Vf1,color:"white"})}),(0,s.jsx)(rR.X,{mt:4,mb:2,fontSize:"md",children:(0,s.jsx)(m.x6,{id:"2OzAI5"})}),i>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r_.T,{maxWidth:"sm",children:(0,s.jsx)(m.x6,{id:"qQLmo7",values:{dayCount:i}})}),(0,s.jsx)(a.$,{mt:4,onClick:t,children:(0,s.jsx)(m.x6,{id:"6Jkfdh",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}})})]})]})},cK=e=>{var t,i,n,r,o,a;let{doc:c,onAnalyticsPanelClose:u}=e,{cardIdMap:x}=(0,b.useContext)(dE),{user:h}=(0,et.ur)(),{data:p,error:g,loading:j,refetch:f}=(0,ik.NI5)({variables:{docId:c.id,userId:null==h?void 0:h.id},skip:!(null==h?void 0:h.id),pollInterval:9e5,notifyOnNetworkStatusChange:!0}),v=null!=(a=null==p||null==(i=p.docCardsStats)||null==(t=i.everyone)?void 0:t.length)?a:0,y=null==p||null==(n=p.docCardsStats)?void 0:n.cardCount,C=(0,b.useMemo)(()=>{var e;return(null==p||null==(e=p.docCardsStats)?void 0:e.everyone)||[]},[null==p?void 0:p.docCardsStats]),w=(0,b.useMemo)(()=>dW(C,"viewTimePercent"),[C]);if(!h)return null;let k=h.id===(null==(r=c.createdBy)?void 0:r.id),E=null==(o=c.editors)?void 0:o.some(e=>e.user.id===h.id),S={name:h.displayName,id:h.id,profileImg:h.profileImageUrl,email:h.email,isContributor:E,isCreator:k};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(iR.r,{children:[(0,s.jsx)(m.x6,{id:"ZlwDi6"}),(0,s.jsx)(l.E,{fontSize:"sm",fontWeight:"normal",letterSpacing:"normal",color:"gray.500",noOfLines:1,children:c.title||(0,s.jsx)(m.x6,{id:"wja8aL"})}),(0,s.jsx)(dz,{})]}),(0,s.jsx)(i_.s,{}),(0,s.jsx)(iD.c,{}),(0,s.jsx)(iO.c,{children:(0,s.jsxs)(d.a,{children:[(0,s.jsx)(ca,{user:S}),void 0!==y&&(0,s.jsx)(d5,{description:(0,s.jsx)(m.x6,{id:"YJOrjl",values:{cardsViewed:v,totalCards:y}})}),j&&!g&&(0,s.jsx)(d2,{includeDescription:!0}),g&&(0,s.jsx)(d_,{error:g,refetch:f,px:0}),!g&&!j&&x&&(0,s.jsx)(d$,{cards:x.tree,scaleToMax:!0,includeChildren:!0,leftLabel:(0,s.jsx)(m.x6,{id:"ml51m3"}),rightLabel:(0,s.jsx)(m.x6,{id:"8R7bfR"}),cardLookupTable:w,tooltipLabel:(0,s.jsx)(dQ,{}),onAnalyticsPanelClose:u}),(0,s.jsxs)(iP.F,{children:[(0,s.jsx)(iz._,{}),(0,s.jsx)(m.x6,{id:"Znuvj3",values:{GAMMA_PROPER_NOUN:ej.On,GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}})]})]})})]})},cq=e=>{let{mode:t,isAnalyticsPanelOpen:i,onAnalyticsPanelClose:n,onSharePanelOpen:o}=e,l=(0,eZ.h5)({base:"sm",md:"2xl",lg:"4xl"}),d=!!o&&"full"==t,{doc:c}=(0,b.useContext)(dE),h=(0,b.useCallback)(()=>{o&&(o(),n())},[o,n]);return c?(0,s.jsx)(q.L8,{isDark:!1,children:(0,s.jsxs)(i1.aF,{onClose:n,isOpen:i,size:l,blockScrollOnMount:!1,children:[(0,s.jsx)(i6.m,{}),(0,s.jsxs)(i2.$,{mx:2,minW:0,children:["full"===t?(0,s.jsx)(cW,{doc:c,handleSharePanelOpen:h,onAnalyticsPanelClose:n,canShare:d}):(0,s.jsx)(cK,{doc:c,onAnalyticsPanelClose:n}),(0,s.jsx)(iD.c,{my:4}),(0,s.jsx)(i3.j,{children:(0,s.jsxs)(r.s,{justifyContent:d?"space-between":"flex-end",flex:1,children:[d&&(0,s.jsx)(a.$,{leftIcon:(0,s.jsx)(x.g,{icon:u.t5Z}),variant:"ghost",onClick:h,children:(0,s.jsx)(m.x6,{id:"6Jkfdh",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}})}),(0,s.jsx)(a.$,{variant:"solid",onClick:n,children:(0,s.jsx)(m.x6,{id:"DPfwMq"})})]})})]})]})}):null},cY=(0,dw.A)(e=>{let{doc:t,file:i,...n}=e,r=(0,R.u)("multipageEditor");return(0,s.jsx)(dI,{initialDoc:t,file:r?i:void 0,children:(0,s.jsx)(cq,{...n})})}),cJ=e=>{let{doc:t,file:i,mode:n}=e,r=(0,Q.st)(),{isOpen:o,onClose:l,onOpen:a}=(0,iN.E)({id:"analyticsPanelDisclosure"}),d=(0,b.useCallback)(()=>{null==r||r.track(Q.VV.DOC_ANALYTICS_VIEWED,{docId:null==t?void 0:t.id,source:"toolbar_doc_menu",type:"personal",device:(0,O.ZI)()}),a()},[r,null==t?void 0:t.id,a]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:u.q9c,fixedWidth:!0}),onClick:d,children:(0,s.jsx)(m.x6,{id:"ZlwDi6"})}),t&&o&&(0,s.jsx)(cY,{file:i,doc:t,isAnalyticsPanelOpen:o,onAnalyticsPanelClose:l,mode:n})]})},cX=e=>{let{toggleCommentsPanel:t}=e;return(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:u.DN2,fixedWidth:!0}),onClick:t,children:(0,s.jsx)(m.x6,{id:"VbyRUy"})})};var c$=i(78481);let cZ=(0,b.memo)(e=>{let{isOpen:t,onClose:i,editor:n}=e,r=(0,c$.N)(n),{bodyStart:o}=(0,eu.GV)(ex.BP),l=(0,b.useCallback)(e=>{null==n||n.commands.updateNestedAttributesAtPos(0,{customCode:{bodyStart:e}})},[n]);return(0,s.jsx)(q.L8,{isDark:!1,children:(0,s.jsxs)(iA._s,{returnFocusOnClose:!1,isOpen:t,placement:"right",onClose:i,size:"lg",children:[(0,s.jsx)(i6.m,{background:"none"}),(0,s.jsxs)(iT.z,{onKeyDown:r,"data-testid":"custom-code-drawer",motionProps:{variants:{enter:{x:"0%",transition:{duration:.2}},exit:{x:"100%",transition:{duration:.1}}}},children:[(0,s.jsx)(i_.s,{}),(0,s.jsx)(iR.r,{children:(0,s.jsx)(m.x6,{id:"E16GGw"})}),(0,s.jsx)(iO.c,{overflowX:"hidden",children:(0,s.jsx)(n9,{label:p.Ru._({id:"fC5kYg"}),helperText:p.Ru._({id:"0AZNtw"}),initialValue:o,updateValue:l,language:"html",height:"600px"})}),(0,s.jsx)(i3.j,{children:(0,s.jsx)(a.$,{w:"100%",variant:"solid",onClick:i,children:(0,s.jsx)(m.x6,{id:"DPfwMq"})})})]})]})})});cZ.displayName="CustomCodeDrawer";let cQ=e=>{let{editor:t}=e,{isOpen:i,onOpen:n,onClose:r}=(0,iN.E)({id:"codeEditor"});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:u.jTw,fixedWidth:!0}),onClick:n,children:(0,s.jsxs)(e8.z,{children:[(0,s.jsx)(m.x6,{id:"cnlGIm"}),(0,s.jsx)(tA.h,{}),(0,s.jsx)(i8.E,{colorScheme:"green",ml:2,children:(0,s.jsx)(m.x6,{id:"YBt9YP"})})]})}),(0,s.jsx)(cZ,{editor:t,isOpen:i,onClose:r})]})},c0=e=>{let{doc:t}=e,[i]=(0,ik.fQ5)(),[n]=(0,ik.u6W)(),r=(0,b.useCallback)(e=>()=>{if(!t.id)return;let s={id:t.id};e?i({variables:s,optimisticResponse:{archiveDoc:{...s,archived:e,__typename:"Doc"}}}):n({variables:s,optimisticResponse:{unarchiveDoc:{...s,archived:e,__typename:"Doc"}}})},[i,t.id,n]);return t.archived?(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:u.IbX,fixedWidth:!0}),onClick:r(!1),children:(0,s.jsx)(m.x6,{id:"yKu/3Y"})}):(0,s.jsx)(nd.D,{"data-testid":"doc-menu-trash-button",color:"red.500",icon:(0,s.jsx)(x.g,{icon:u.yLS,fixedWidth:!0}),onClick:r(!0),children:(0,s.jsx)(m.x6,{id:"NOLglc",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}})})};var c1=i(59426),c6=i(79958);let c2=e=>{var t,i;let{doc:n}=e,r=(null==n?void 0:n.createdTime)&&(0,c1.A)((0,ni.A)(n.createdTime),"PPP"),o=(0,c6.B)(null==n?void 0:n.title);return(0,s.jsxs)(d.a,{px:4,py:2,maxW:"300px",children:[(0,s.jsx)(l.E,{noOfLines:6,children:o}),(0,s.jsx)(l.E,{fontSize:"sm",color:"gray.500",noOfLines:1,children:(0,s.jsx)(m.x6,{id:"jlWdji",values:{createdTime:r}})}),(0,s.jsx)(q.Tz,{label:null==n||null==(t=n.createdBy)?void 0:t.email,children:(0,s.jsx)(l.E,{display:"inline-block",fontSize:"sm",color:"gray.500",noOfLines:1,children:(0,s.jsx)(m.x6,{id:"t490IT",values:{0:null==n||null==(i=n.createdBy)?void 0:i.displayName}})})})]})},c5=e=>{let{doc:t,editor:i}=e,n=(0,ao.Z)(),r=(0,b.useCallback)(()=>{if(!i)return;let e=i.getJSON();n({docId:t.id,initialContent:e,source:"editor_toolbar_doc_menu_duplicate",newWindow:!(0,O.sX)()})},[t.id,n,i]);return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:u.$3n,fixedWidth:!0}),onClick:r,children:(0,s.jsx)(m.x6,{id:"0Fcoqv",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}})})})},c3=()=>(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:u.mHA,fixedWidth:!0}),onClick:()=>{iY.R.emit("openSharePanel",{view:"export"})},children:(0,s.jsx)(m.x6,{id:"U8WPSi"})});var c4=i(62522);let c8=e=>{let{editor:t,doc:i}=e,n=(0,eu.GV)(ex.SJ),[r]=(0,ik.bME)(),o=(0,eu.GV)(ex.Jq),l=(0,b.useCallback)(async()=>{var e;if(!t)return;let s=(0,tW.KC)(t,t.state.doc.firstChild.content,{disableBookmarks:!0}),l={...(0,c4.Xg)(),contentTemplate:s,themeId:null==n?void 0:n.id,numCards:t.state.doc.firstChild.childCount},a=await r({variables:{input:{workspaceId:i.organization.id,generationType:ik.xbH.PasteText,input:{format:o,settings:l}}}});window.open("/generate/".concat(null==(e=a.data)?void 0:e.createDocGeneration.id),"_blank")},[t,r,i,n,o]);return(0,R.u)("generateDeckTemplate")?(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:u.S5R,fixedWidth:!0}),as:iJ.N,textDecoration:"none !important",onClick:l,children:(0,s.jsx)(m.x6,{id:"Q31roh"})}):null},c7=e=>{let{site:t,path:i,domain:n}=e,r=n?(0,ta.bO)({domain:n,path:i}):(0,ta.jY)({site:t,path:i});return r?(0,s.jsx)(q.Tz,{label:(0,s.jsx)(m.x6,{id:"kcKqQj"}),placement:"top",children:(0,s.jsx)(H.K,{ms:-1,href:r,as:v(),target:"_blank","aria-label":p.Ru._({id:"WklWxF"}),variant:"ghost",color:"gray.500",size:"xs",icon:(0,s.jsx)(x.g,{icon:u.fLi}),pointerEvents:"auto",onClick:e=>{e.stopPropagation()}})}):null},c9=e=>{var t,i;let{doc:n,site:r,showCreatedInfo:o}=e,a=(0,c6.B)(null==n?void 0:n.title),c=null==(t=r.routes)?void 0:t.find(e=>e.docId===n.id),u=(0,ta.SG)(n,r);return(0,s.jsxs)(d.a,{px:4,pb:2,maxW:"300px",children:[(0,s.jsxs)(e8.z,{align:"start",children:[(0,s.jsx)(l.E,{noOfLines:2,children:a}),u&&(0,s.jsx)(c7,{site:r,path:null==c?void 0:c.path})]}),c&&(0,s.jsx)(ue,{path:c.path}),o&&"createdTime"in n&&(0,s.jsx)(l.E,{fontSize:"sm",color:"gray.500",noOfLines:1,mt:2,children:(0,s.jsx)(m.x6,{id:"oJFw5Q",values:{0:(0,iU.Bo)(n.createdTime)}})}),"createdBy"in n&&o&&(0,s.jsx)(l.E,{display:"inline-block",fontSize:"sm",color:"gray.500",noOfLines:1,children:(0,s.jsx)(m.x6,{id:"t490IT",values:{0:null==n||null==(i=n.createdBy)?void 0:i.displayName}})})]})},ue=e=>{let{path:t}=e;return"/"===t?(0,s.jsx)(l.E,{fontSize:"sm",color:"gray.500",children:(0,s.jsx)(m.x6,{id:"wFCbbC"})}):(0,s.jsx)(l.E,{fontFamily:"mono",fontSize:"sm",color:"gray.500",children:t})},ut=e=>{let{onClick:t,icon:i,label:n}=e;return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(nd.D,{icon:i||(0,s.jsx)(x.g,{icon:u.BH7,fixedWidth:!0}),onClick:t||(()=>{iY.R.emit("openPageSetup","cards")}),children:n||(0,s.jsx)(m.x6,{id:"Kx2GmY"})})})},ui=e=>{let{site:t}=e,i=(0,c1.A)((0,ni.A)(t.createdTime),"PPP");return(0,s.jsxs)(d.a,{px:4,pb:2,maxW:"300px",children:[(0,s.jsx)(l.E,{noOfLines:6,children:t.name}),(0,s.jsx)(l.E,{fontSize:"sm",color:"gray.500",noOfLines:1,children:(0,s.jsx)(m.x6,{id:"jlWdji",values:{createdTime:i}})})]})},un=e=>{let{label:t=(0,s.jsx)(m.x6,{id:"sAalO9"}),showUpsellBadge:i,settingsTab:n="website"}=e,{openUpsellModal:r}=(0,dT.I)(),o=(0,b.useCallback)(()=>r({segmentEvent:Q.VV.GAMMA_PRO_UPSELL_SITE_ADD_CUSTOM_DOMAIN}),[r]),l=(0,b.useCallback)(()=>{iY.R.emit("openSiteSettings",n)},[n]);return(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:u.Bwz,fixedWidth:!0}),onClick:i?o:l,children:(0,s.jsxs)(e8.z,{justifyContent:"space-between",alignItems:"center",children:[t,i&&(0,s.jsx)(d.a,{children:(0,s.jsx)(nH.zL,{})})]})})};var us=i(53984);let ur=e=>{let{doc:t}=e,{isOpen:i,onClose:n,onOpen:r}=(0,iN.E)({id:"snapshotsDrawer"});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:u.a$,fixedWidth:!0}),onClick:r,children:(0,s.jsx)(m.x6,{id:"6Z5x06"})}),t&&(0,s.jsx)(us.d,{doc:t,isOpen:i,onClose:n})]})},uo=()=>{let e=rT();return e?(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:u.LjI,fixedWidth:!0}),as:iJ.N,textDecoration:"none !important",href:e,target:(0,O.sX)()?"_self":"_blank",children:(0,s.jsx)(m.x6,{id:"7U0bM7"})}):null},ul=()=>(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:u.fyG,fixedWidth:!0}),onClick:()=>ru.LF.emit(ru.DN.OPEN_THEME_DRAWER,{}),children:(0,s.jsx)(m.x6,{id:"90/Rx7"})}),ua=e=>{let{editor:t}=e,i=(0,b.useCallback)(()=>{t&&t.commands.undo()},[t]);return(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:u.V3T,fixedWidth:!0}),onClick:i,command:(0,q.lp)("Mod+Z"),children:(0,s.jsx)(m.x6,{id:"9uI/rE"})})},ud=e=>{var t;let{doc:i,file:n,toggleCommentsPanel:r,editorWrapperEl:o,scrollingParentSelector:l}=e,{isConnected:a,isInOfflineMode:c}=(0,E.u)(),h=(0,R.u)("editDocAI"),{user:g}=(0,et.ur)(),j=(0,iI.d)(),f=(0,et.Iy)("view",i),v=(0,et.Iy)("comment",i),y=(0,et.Iy)("edit",i),C=(0,et.Iy)("manage",i),w=(0,eu.GV)(tr.Gd),k=(0,iG.zm)(),S=(0,eu.GV)(ex.wC)===tv.w.SLIDE_VIEW,{editor:I}=(0,tE.m)(),A=(0,eu.GV)(ex.nD),{favoriteDoc:T}=(0,dl.I)({refetchQueries:["GetDoc"]}),_=(0,b.useCallback)(async e=>{g&&g.id&&i&&(await T(e,{id:i.id,docUser:i.docUser})(),j({title:e?p.Ru._({id:"pL78ec"}):p.Ru._({id:"Qh7QmR"}),status:"success",duration:2e3,position:"top",isClosable:!1}))},[i,T,g,j]),O=!!(null==(t=i.docUser)?void 0:t.favorited),D=!!h||!C,P=!!g&&D&&!i.site,z=!!h&&v,M=!!(g&&0!==g.workspaceMemberships.length&&!i.site),L=f&&!!g,N=(0,R.u)("docCustomCode")&&y,F=y&&I;if(!a){let e=F&&c&&!w,t=A&&c&&!w,n=z&&c&&!w,o=t||e||n;return(0,s.jsx)(uc,{children:(0,s.jsxs)(aj.r,{children:[w?(0,s.jsx)(d.a,{pt:2,children:(0,s.jsx)(ui,{site:w})}):(0,s.jsx)(c2,{doc:i}),o&&(0,s.jsx)(sP.N,{}),t&&(0,s.jsx)(ua,{editor:I}),e&&(0,s.jsx)(ut,{}),n&&(0,s.jsx)(cX,{toggleCommentsPanel:r})]})})}let V=i.site?(0,s.jsx)(m.x6,{id:"gKmuNS"}):void 0;return(0,s.jsxs)(na.c,{zIndex:"popover",maxH:"100vh",minW:"280px",maxW:"360px",overflow:"auto",children:[(0,s.jsxs)(aj.r,{children:[w?(0,s.jsx)(c9,{doc:i,site:w}):(0,s.jsx)(c2,{doc:i}),(0,s.jsx)(sP.N,{}),A&&(0,s.jsx)(ua,{editor:I}),O?(0,s.jsx)(nd.D,{icon:(0,s.jsx)(d.a,{color:"yellow.400",children:(0,s.jsx)(x.g,{fixedWidth:!0,icon:tT.yy})}),onClick:()=>_(null),children:(0,s.jsx)(m.x6,{id:"T/pF0Z"})}):(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{fixedWidth:!0,icon:u.yy}),onClick:()=>_(new Date),children:(0,s.jsx)(m.x6,{id:"pBsoKL"})}),y&&(0,s.jsx)(ur,{doc:i}),i.site&&(0,s.jsx)(dC,{editorWrapperEl:o,scrollingParentSelector:l}),(0,s.jsx)(uo,{}),k&&!S&&(0,s.jsx)(ul,{}),F&&(0,s.jsx)(ut,{}),L&&(0,s.jsx)(c3,{}),N&&(0,s.jsx)(cQ,{editor:I})]}),w?(0,s.jsx)(sP.N,{}):null,(0,s.jsxs)(aj.r,{children:[w&&(0,s.jsx)(ui,{site:w}),w?null:(0,s.jsx)(sP.N,{}),z&&(0,s.jsx)(cX,{toggleCommentsPanel:r}),P&&(0,s.jsx)(cJ,{file:n,doc:i,mode:C?"full":"personal"}),C&&(0,s.jsx)(un,{label:V}),M&&(0,s.jsx)(c5,{doc:i,editor:I}),(0,s.jsx)(c8,{doc:i,editor:I}),C&&(0,s.jsx)(dd,{site:w}),!i.site&&C&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(sP.N,{}),(0,s.jsx)(c0,{doc:i})]})]})]})},uc=e=>{let{children:t}=e;return(0,s.jsxs)(na.c,{zIndex:"popover",maxH:"100vh",minW:"280px",maxW:"360px",overflow:"auto",children:[(0,s.jsx)(eq.r,{description:(0,s.jsx)(m.x6,{id:"0CAvhs"}),isConnected:!1,maxWidth:"300px"}),t]})},uu=e=>{let{onSuccess:t,onError:i=()=>{}}=e,[n,s]=(0,b.useState)(()=>()=>Promise.resolve());return{setDoneFn:s,doActionIfVerified:(0,b.useCallback)(()=>{n().then(t,i)},[n,t,i])}};var ux=i(60120),uh=i(74709),um=i(74231),up=i(75570);let ug=e=>{let{onClose:t,onDiscard:i,onSave:n}=e;return(0,s.jsx)(q.L8,{isDark:!1,children:(0,s.jsxs)(i1.aF,{onEsc:t,onClose:t,closeOnOverlayClick:!0,isOpen:!0,isCentered:!0,children:[(0,s.jsx)(i6.m,{}),(0,s.jsxs)(i2.$,{children:[(0,s.jsx)(iR.r,{children:(0,s.jsx)(m.x6,{id:"fhv6Ac"})}),(0,s.jsx)(i_.s,{onClick:t}),(0,s.jsx)(iO.c,{children:(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"dkIYZO"})})}),(0,s.jsx)(i3.j,{children:(0,s.jsxs)(o.B,{spacing:2,direction:"row",align:"center",children:[(0,s.jsx)(a.$,{onClick:i,children:(0,s.jsx)(m.x6,{id:"bzSI52"})}),(0,s.jsx)(a.$,{variant:"solid",onClick:n,children:(0,s.jsx)(m.x6,{id:"GkU8It"})})]})})]})]})})},uj=(e,t)=>{var i;return null==e||null==(i=e.routes.find(e=>e.docId===t))?void 0:i.path},uf=e=>{let{openOtherDocModal:t,registerDoneFn:i}=e,n=(0,V.dU)("gray.200","gray.600"),r=(0,iI.d)(),[c,u]=(0,b.useState)(!1),x=(0,i0.Fd)(),h=(0,eu.GV)(e_.Jo),p=(0,eu.GV)(tr.Gd),[g,{loading:j}]=(0,ik.Imo)(),f=uj(p,null==h?void 0:h.id),[v,y]=(0,b.useState)(()=>(0,ta.nx)(f||"")),[C,w]=(0,b.useState)(()=>(0,ta.nx)(f||"")),k=(0,ta.Gu)({routes:(null==p?void 0:p.routes)||[],path:(0,ta.wK)(v),docId:null==h?void 0:h.id}),E=!!k,S=C!==v&&!E,I=(0,b.useCallback)(()=>{y(C)},[C]),[A,T]=(0,b.useState)(new up.c),R=(0,b.useCallback)(()=>{if(!S)return;if(!(null==p?void 0:p.id)||!(null==h?void 0:h.id))return void console.error("Missing site or doc");let e=(0,ta.GM)(v);g({variables:{input:{siteId:p.id,docId:h.id,path:e}},refetchQueries:["GetSite"]}).then(()=>{w((0,ta.nx)(e)),y((0,ta.nx)(e)),u(!0),A.resolve(),T(new up.c)}).catch(e=>{r({status:"error",title:(0,s.jsx)(m.x6,{id:"dl5vwx"}),description:e.message}),A.reject(e),T(new up.c),console.error("[UrlSlugForm] Error setting route",e.message)})},[S,null==h?void 0:h.id,v,g,null==p?void 0:p.id,r,A,T]),{isOpen:_,onClose:O,onOpen:D}=(0,iN.E)({id:"unsaved-page-metadata-modal"});return((0,b.useEffect)(()=>{i(()=>()=>(S?D():A.resolve(),A.promise))},[i,A,S,D]),x)?(0,s.jsxs)(o.B,{children:[(0,s.jsx)(o.B,{direction:"row",children:(0,s.jsxs)(l.E,{children:[(0,s.jsx)(m.x6,{id:"dq8+qI"})," "]})}),(0,s.jsx)(tA.h,{}),(0,s.jsx)(o.B,{spacing:2,children:(0,s.jsx)(e8.z,{spacing:1,children:(0,s.jsxs)(nu.MJ,{as:"fieldset",isInvalid:E,children:[(0,s.jsx)(e8.z,{children:(0,s.jsxs)(nX.M,{children:[(0,s.jsx)(uh.G6,{children:"/"}),(0,s.jsx)(iZ.p,{isDisabled:j,flex:2,value:v,onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),R())},onChange:e=>{y((0,nh.Fw)(e.currentTarget.value))},borderColor:n}),(0,s.jsx)(um.s,{in:S,unmountOnExit:!0,children:(0,s.jsx)(d.a,{ms:2,children:(0,s.jsxs)(e7.e,{w:"100%",children:[(0,s.jsx)(a.$,{variant:"solid",isLoading:j,isDisabled:E,onClick:R,children:(0,s.jsx)(m.x6,{id:"tfDRzk"})}),(0,s.jsx)(a.$,{onClick:I,children:(0,s.jsx)(m.x6,{id:"dEgA5A"})})]})})})]})}),k?(0,s.jsx)(n8.Wt,{justifyContent:"flex-end",alignItems:"flex-start",children:(0,s.jsx)(l.E,{fontSize:"xs",children:(0,s.jsx)(m.x6,{id:"DQaTdC",components:{0:(0,s.jsx)(iJ.N,{textDecoration:"underline",onClick:()=>t&&t(k.docId)})}})})}):(0,s.jsxs)(o.B,{spacing:2,children:[(0,s.jsx)(nu.eK,{fontSize:"sm",children:(0,s.jsx)(m.x6,{id:"ZMlbHK"})}),c&&(0,s.jsxs)(iP.F,{status:"warning",variant:"left-accent",fontSize:"sm",children:[(0,s.jsx)(iz._,{}),(0,s.jsx)(r_.T,{children:(0,s.jsx)(m.x6,{id:"ZyBxCy"})})]})]})]})})}),_&&(0,s.jsx)(ug,{onDiscard:()=>{O(),A.resolve(),T(new up.c)},onClose:()=>{O(),A.reject(),T(new up.c)},onSave:R})]}):(0,s.jsx)(s.Fragment,{})},uv=e=>{var t;let{inModal:i=!1,openOtherDocModal:n,setVerifyURLPathChangesDone:r}=e,{editor:l}=(0,tE.m)(),{isInOfflineMode:a}=(0,E.u)(),d=(0,b.useCallback)((e,t)=>{null==l||l.commands.updateNestedAttributesAtPos(0,{settings:{[e]:t}})},[l]),{metaDescription:c}=(0,eu.GV)(ex.Uu),u=(0,eu.GV)(e_.Jo),x=(0,eu.GV)((0,dk.Jn)(null==u?void 0:u.id)),h=(0,eu.GV)(dk.E5),[g,j]=(0,b.useState)(()=>(null==u?void 0:u.title)||""),[f,v]=(0,b.useState)(()=>c||""),y=u&&!!u.site&&(0,ta.dv)(u.site),[C]=(0,ik.cGn)(),w=(0,b.useCallback)(e=>{u&&C({variables:{id:u.id,title:e,titleEdited:!0}})},[u,C]),k=(0,t$.lW)(w,300),S=(0,b.useCallback)(e=>{j(e.target.value.substring(0,nM.tS)),k(e.target.value.substring(0,nM.tS))},[k]),I=(0,b.useCallback)(e=>{d("metaDescription",e)},[d]),A=(0,t$.lW)(I,300),T=null==u||null==(t=u.titleCard)?void 0:t.previewUrl,R=(0,eK.nk)(null==u?void 0:u.organization),_=(0,eO.E)(g||x,R),O=(0,eO.C)(f||h,R),D=(0,V.dU)("gray.200","gray.600");return(0,s.jsxs)(o.B,{spacing:4,children:[(0,s.jsxs)(nu.MJ,{children:[(0,s.jsxs)(e8.z,{justifyContent:"center",children:[(0,s.jsx)(nx.l,{flex:"1",children:(0,s.jsx)(m.x6,{id:"MHrjPM"})}),(0,s.jsx)(ux.H,{length:g.length||0,idealLength:nM.GF,maxLength:nM.tS})]}),(0,s.jsx)(iZ.p,{value:g,placeholder:x||p.Ru._({id:"bTzMt5"}),_placeholder:{opacity:1,color:"gray.500"},onKeyDown:e=>{"Enter"===e.key&&w(g)},onChange:S,isDisabled:a,"data-title-input":!0,borderColor:D})]}),(null==u?void 0:u.site)&&(0,s.jsx)(uf,{openOtherDocModal:n,registerDoneFn:r}),(0,s.jsxs)(nu.MJ,{children:[(0,s.jsxs)(e8.z,{justifyContent:"center",children:[(0,s.jsx)(nx.l,{flex:"1",pt:0,children:(0,s.jsx)(m.x6,{id:"Nu4oKW"})}),(0,s.jsx)(ux.H,{length:f.length||0,idealLength:nM.Od,maxLength:nM.Lj})]}),(0,s.jsx)(rz.T,{rows:i?2:4,value:f,placeholder:(null==h?void 0:h.trim())||p.Ru._({id:"2VBqT4"}),onChange:e=>{v(e.target.value.substring(0,nM.Lj)),A(e.target.value.substring(0,nM.Lj))},borderColor:D})]}),(0,s.jsx)(ub,{previewTitle:_,previewDescription:O,screenshotUrl:T,isInOfflineMode:a,isSiteOn:y,inModal:i}),!a&&(0,s.jsx)(nK.w,{label:(0,s.jsx)(m.x6,{id:"ebOoCq",values:{GAMMA_PROPER_NOUN:ej.On}}),segmentEvent:tq.VV.GAMMA_PRO_UPSELL_PAGE_SETUP_REMOVE_WATERMARK,targetWorkspace:null==u?void 0:u.organization})]})},ub=e=>{let{previewTitle:t,previewDescription:i,screenshotUrl:n,isInOfflineMode:r,isSiteOn:a,inModal:d}=e,c=(0,V.dU)("gray.50","gray.700"),u=(0,V.dU)("gray.200","gray.600");return(0,s.jsxs)(o.B,{p:4,pt:3,bg:c,borderRadius:"md",direction:d?"row":"column",spacing:3,children:[(0,s.jsxs)(o.B,{spacing:2,flex:1,children:[(0,s.jsx)(l.E,{size:"sm",children:(0,s.jsx)(m.x6,{id:"h8sMnd"})}),(0,s.jsx)(uy,{title:t,description:i,screenshotUrl:n,isOffline:r})]}),a&&(0,s.jsxs)(o.B,{spacing:2,flex:1,ps:d?3:void 0,pt:d?void 0:3,borderStart:d?"1px solid":void 0,borderTop:d?void 0:"1px solid",borderColor:u,children:[(0,s.jsx)(l.E,{size:"sm",children:(0,s.jsx)(m.x6,{id:"d3xOlk"})}),(0,s.jsx)(uC,{title:t,description:i,screenshotUrl:n,isOffline:r}),(0,s.jsx)(l.E,{fontSize:"sm",color:"gray.500",children:(0,s.jsx)(m.x6,{id:"Ubf8D8"})})]})]})},uy=e=>{let{title:t,description:i,screenshotUrl:n,isOffline:r}=e,a=(0,V.dU)("gray.200","gray.600");return(0,s.jsxs)(d.a,{cursor:"not-allowed",bg:"white",border:"1px solid",borderColor:a,borderRadius:"md",overflow:"hidden",children:[(0,s.jsx)(sE.g,{ratio:1200/630,bg:"gray.300",borderBottom:"1px solid",borderColor:"gray.200",children:(0,s.jsx)(d.a,{bgColor:"gray.200",bgImage:"url(".concat(n,")"),backgroundSize:"cover",position:"relative",children:r&&(0,s.jsx)(x.g,{icon:u.seF,size:"lg"})})}),(0,s.jsxs)(o.B,{px:4,py:3,spacing:1,children:[(0,s.jsx)(l.E,{color:"gray.700",fontSize:"md",fontWeight:"bold",noOfLines:2,children:t}),(0,s.jsx)(l.E,{color:"gray.700",fontSize:"xs",noOfLines:2,children:i})]})]})},uC=e=>{let{title:t,description:i}=e;return(0,s.jsxs)(o.B,{cursor:"not-allowed",bg:"white",border:"1px solid",borderColor:"gray.200",borderRadius:"md",overflow:"hidden",px:4,py:3,spacing:1,pos:"relative",children:[(0,s.jsx)(l.E,{color:"blue.600",fontSize:"lg",lineHeight:1.3,noOfLines:2,children:t}),(0,s.jsx)(l.E,{color:"gray.600",fontSize:"sm",noOfLines:3,children:i})]})},uw=e=>{let{onPageMetadataModalClose:t,isPageMetadataModalOpen:i,openOtherDocModal:n}=e,r=(0,ee.rd)(),{setDoneFn:o,doActionIfVerified:l}=uu({onSuccess:t});return(0,s.jsx)(q.L8,{isDark:r,children:(0,s.jsxs)(i1.aF,{onEsc:l,isOpen:i,onClose:l,size:"3xl",returnFocusOnClose:!1,children:[(0,s.jsx)(i6.m,{}),(0,s.jsxs)(i2.$,{mx:2,children:[(0,s.jsx)(iR.r,{children:(0,s.jsx)(m.x6,{id:"aBZSpm"})}),(0,s.jsx)(i_.s,{onClick:e=>{e.preventDefault(),l()}}),(0,s.jsx)(iD.c,{}),(0,s.jsx)(iO.c,{children:(0,s.jsx)(uv,{inModal:!0,openOtherDocModal:n,setVerifyURLPathChangesDone:o})}),(0,s.jsx)(iD.c,{}),(0,s.jsx)(i3.j,{children:(0,s.jsx)(a.$,{onClick:e=>{e.preventDefault(),l()},variant:"solid",children:(0,s.jsx)(m.x6,{id:"DPfwMq"})})})]})]})})},uk=e=>{let{children:t,currentEditorDocId:i}=e,[n,r]=(0,b.useState)({docId:null,pendingOpenFn:null}),{push:o}=(0,e9.useRouter)();(0,b.useEffect)(()=>{let{docId:e,pendingOpenFn:t}=n;e===i&&t&&(t(),r({docId:null,pendingOpenFn:null}))},[i,n]);let l=async(e,t)=>{if(e!==i){let i=(0,D.pF)({docId:e});await o(i),r({docId:e,pendingOpenFn:t})}else t()};return(0,s.jsx)(s.Fragment,{children:t(l)})},uE=e=>{let{isDisabled:t,onClick:i,isPublishing:n}=e;return(0,s.jsx)(q.Tz,{placement:"top",label:(0,s.jsx)(m.x6,{id:"Bq2yPr"}),shouldWrapChildren:!0,isDisabled:!t,children:(0,s.jsx)(nd.D,{icon:(0,s.jsx)(d.a,{children:(0,s.jsx)(x.g,{icon:u.OFY,fixedWidth:!0})}),onClick:i,closeOnSelect:!1,isDisabled:n||t,children:(0,s.jsxs)(r.s,{direction:"row",w:"100%",justify:"space-between",align:"center",children:[(0,s.jsx)(m.x6,{id:"jNnwuI"}),n&&(0,s.jsx)(t3.y,{size:"xs"})]})})})},uS=e=>{let{title:t,path:i}=e;return(0,s.jsxs)(s.Fragment,{children:[t?"".concat(t," "):"",i&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ne.C,{as:"span",fontFamily:"mono",children:i})," "]})]})},uI=e=>{let{onClose:t,doc:i,site:n,path:r}=e,{push:d}=(0,e9.useRouter)(),[c,{loading:u}]=(0,ik.QO)(),x=(0,iI.d)(),h=(0,eu.GV)(tr.le),p=null==i?void 0:i.title,g=(0,b.useCallback)(async()=>{if((null==i?void 0:i.id)&&n){if(await c({variables:{id:i.id},refetchQueries:["GetSite","GetDoc"]}),x({title:(0,s.jsx)(m.x6,{id:"oMgC5V"}),description:(0,s.jsx)(m.x6,{id:"gw6aHP",components:{0:(0,s.jsx)(uS,{title:p,path:r})}}),status:"success",duration:1e4,position:"top",isClosable:!0}),h===i.id){let e=(0,D.BV)({site:n,docId:i.id});e&&await d(e)}t()}},[null==i?void 0:i.id,p,n,h,c,x,r,t,d]);return(0,s.jsx)(q.L8,{isDark:!1,children:(0,s.jsxs)(i1.aF,{onClose:t,isOpen:!0,size:"xl",children:[(0,s.jsx)(i6.m,{}),(0,s.jsxs)(i2.$,{children:[(0,s.jsx)(iR.r,{children:(0,s.jsx)(m.x6,{id:"kbKU/5"})}),(0,s.jsx)(i_.s,{isDisabled:u}),(0,s.jsx)(iO.c,{children:(0,s.jsxs)(o.B,{spacing:4,children:[(0,s.jsx)(l.E,{children:r?(0,s.jsx)(m.x6,{id:"EzZlW2",values:{docTitle:p,path:r},components:{0:(0,s.jsx)(ne.C,{as:"span",fontFamily:"mono",colorScheme:"blackAlpha"})}}):(0,s.jsx)(m.x6,{id:"Ow0t6+",values:{docTitle:p}})}),(0,s.jsx)(l.E,{color:"red.500",children:(0,s.jsx)(m.x6,{id:"2xOCJW"})})]})}),(0,s.jsx)(i3.j,{children:(0,s.jsxs)(e7.e,{children:[(0,s.jsx)(a.$,{variant:"ghost",onClick:t,children:(0,s.jsx)(m.x6,{id:"dEgA5A"})}),(0,s.jsx)(a.$,{variant:"hazardous",onClick:g,isLoading:u,children:(0,s.jsx)(m.x6,{id:"O1M1zi"})})]})})]})]})})},uA=e=>{var t;let{site:i,doc:n,path:r}=e,{isOpen:o,onOpen:l,onClose:a}=(0,ez.j)({id:"confirm-remove-page-modal"}),c=(null==i?void 0:i.routes)&&(null==i||null==(t=i.routes)?void 0:t.length)>1;return(0,s.jsxs)(s.Fragment,{children:[o&&(0,s.jsx)(uI,{site:i,doc:n,path:r,onClose:a}),(0,s.jsx)(q.Tz,{placement:"top",isDisabled:c,label:(0,s.jsx)(m.x6,{id:"PBFhJK"}),shouldWrapChildren:!0,children:(0,s.jsx)(nd.D,{color:"red.500",isDisabled:!c,icon:(0,s.jsx)(d.a,{children:(0,s.jsx)(x.g,{icon:u.yLS,fixedWidth:!0})}),onClick:l,children:(0,s.jsx)(m.x6,{id:"cnGeoo"})})})]})},uT=e=>{let{site:t,doc:i,route:n,isTopToolbar:r=!1,hasChanges:o,onToggleOffline:l,...a}=e,c=(0,dr.U)(),{editor:h}=(0,tE.m)(),{replace:p}=(0,e9.useRouter)(),{isConnected:g}=(0,ik.utY)(),j=(null==i?void 0:i.id)&&(0,ta.OF)({site:t,docId:i.id}),{publishDoc:f,isPublishing:v}=iB({doc:i,site:t,path:j}),y=(0,ta.dv)(t),C=(0,eu.GV)(e_.Jo),w=(0,et.Iy)("edit",C),k=(0,et.Iy)("edit",C),E=(0,et.Iy)("manage",C),S=(0,iG.Gx)(),I=(0,eu.GV)(ex.nD),A=(0,b.useCallback)(()=>{(null==i?void 0:i.id)&&c({path:(0,ta.G9)({path:n.path,routes:t.routes}),siteId:t.id,routes:t.routes,sourceDocId:i.id})},[c,null==i?void 0:i.id,n.path,t.id,t.routes]),{isOpen:T,onClose:R,onOpen:_}=(0,iN.E)({id:"page-metadata-modal"});return g?(0,s.jsx)(L.Z,{children:i&&(0,s.jsx)(na.c,{...a,zIndex:"popover",maxH:"100vh",minW:"280px",maxW:"380px",overflow:"auto",children:(0,s.jsx)(uk,{currentEditorDocId:null==C?void 0:C.id,children:e=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c9,{doc:i,site:t,showCreatedInfo:!0}),(0,s.jsx)(sP.N,{}),k&&h&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:u.n2$,fixedWidth:!0}),onClick:()=>e(n.docId,_),children:(0,s.jsx)(m.x6,{id:"aBZSpm"})}),(0,s.jsx)(uw,{isPageMetadataModalOpen:T,onPageMetadataModalClose:R,openOtherDocModal:t=>e(t,_)})]}),k&&h&&(0,s.jsx)(ut,{onClick:()=>e(n.docId,()=>iY.R.emit("openPageSetup","cards"))})," ",(0,s.jsx)(sP.N,{}),S&&!n.offline&&(o||v)&&(0,s.jsx)(uE,{onClick:f,isDisabled:!y,isPublishing:v}),(0,s.jsx)(nd.D,{icon:(0,s.jsx)(d.a,{children:(0,s.jsx)(x.g,{icon:tT.qtl,fixedWidth:!0})}),onClick:()=>{p((0,D.pF)({docId:i.id,preview:!0}),void 0,{shallow:!0})},children:(0,s.jsx)(m.x6,{id:"rdUucN"})}),!!l&&(0,s.jsx)(nd.D,{onClick:l,icon:(0,s.jsx)(d.a,{children:(0,s.jsx)(x.g,{icon:n.offline?u.A4h:u.buE,fixedWidth:!0})}),children:n.offline?(0,s.jsx)(m.x6,{id:"i/zQgj"}):(0,s.jsx)(m.x6,{id:"ySCSAn"})}),(0,s.jsx)(sP.N,{}),k&&h&&(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:u.jPR,fixedWidth:!0}),onClick:A,children:(0,s.jsx)(m.x6,{id:"IVskn1"})}),I&&r&&(0,s.jsx)(ua,{editor:h}),w&&r&&(0,s.jsx)(ur,{doc:i}),E&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(sP.N,{}),(0,s.jsx)(uA,{site:t,doc:i,path:j})]})]})})})}):(0,s.jsx)(uc,{})},uR=e=>{if(!e)return{path:"untitled-page",title:p.Ru._({id:"kveQAJ"})};if(0===e.filter(e=>e.path.startsWith("/untitled-page")).length)return{title:p.Ru._({id:"kveQAJ"}),path:"untitled-page"};let t=Math.max(...e.map(e=>{let[t,i]=e.path.match(/^\/untitled-page-?(\d+)/)||["","1"];return Number(i)}));return{title:p.Ru._({id:"kveQAJ"})+" "+String(t+1),path:"untitled-page-".concat(t+1)}},u_=e=>{let{site:t}=e,i=(0,dr.U)(),{isOpen:n,onClose:r,onOpen:a}=(0,iN.E)({id:"add-page-ai-modal"}),[d,c]=(0,b.useState)(!1),h=(0,b.useCallback)(()=>{a()},[a]),g=(0,b.useCallback)(()=>{let{path:e}=uR(null==t?void 0:t.routes);c(!0),i({path:(0,ta.GM)(e),siteId:null==t?void 0:t.id,routes:null==t?void 0:t.routes}).then(()=>{c(!1)})},[i,null==t?void 0:t.id,null==t?void 0:t.routes]);return(0,s.jsxs)(no.W,{children:[(0,s.jsx)(q.Tz,{label:p.Ru._({id:"yLRlZm"}),placement:"bottom",children:(0,s.jsx)(nl.I,{as:H.K,isRound:!0,size:"xs",isLoading:d,onFocus:e=>e.preventDefault(),"data-testid":"add-page",icon:(0,s.jsx)(x.g,{icon:u.QLR}),sx:{span:{flexGrow:0}}})}),(0,s.jsx)(L.Z,{children:(0,s.jsx)(na.c,{maxW:"350px",zIndex:"tooltip",children:(0,s.jsxs)(aj.r,{title:p.Ru._({id:"yLRlZm"}),children:[(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:tT.p7g,fixedWidth:!0}),onClick:h,children:(0,s.jsxs)(e8.z,{align:"flex-start",children:[(0,s.jsxs)(o.B,{spacing:0,children:[(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"OppH33"})}),(0,s.jsx)(l.E,{fontSize:"xs",color:"gray.500",children:(0,s.jsx)(m.x6,{id:"P/o+t+"})})]}),(0,s.jsx)(tA.h,{}),(0,s.jsx)(i8.E,{h:"fit-content",colorScheme:"trueblue",ml:2,children:(0,s.jsx)(m.x6,{id:"jsQZMk"})})]})}),(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:u.QLR,fixedWidth:!0}),onClick:g,children:(0,s.jsxs)(o.B,{spacing:0,children:[(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"SSZKB9"})}),(0,s.jsx)(l.E,{fontSize:"xs",color:"gray.500",children:(0,s.jsx)(m.x6,{id:"S65lUr"})})]})})]})})}),(0,s.jsx)(lq,{isOpen:n,onClose:r})]})},uO=e=>{if(!e)return{path:"untitled-page",title:p.Ru._({id:"kveQAJ"})};if(0===e.filter(e=>e.path.startsWith("/untitled-page")).length)return{title:p.Ru._({id:"kveQAJ"}),path:"untitled-page"};let t=Math.max(...e.map(e=>{let[t,i]=e.path.match(/^\/untitled-page-?(\d+)/)||["","1"];return Number(i)}));return{title:p.Ru._({id:"kveQAJ"})+" "+String(t+1),path:"untitled-page-".concat(t+1)}},uD=e=>{let{isOpen:t,onClose:i,site:n}=e,r=(0,dr.U)(),[d,c]=(0,b.useState)(()=>uO(null==n?void 0:n.routes).title),[u,x]=(0,b.useState)(()=>uO(null==n?void 0:n.routes).path),h=(0,b.useRef)(null),[g,j]=(0,b.useState)(!1),f=((null==n?void 0:n.routes.map(e=>e.path))||[]).includes("/".concat(u)),v=(0,V.dU)("gray.800","gray.50"),y=(0,b.useCallback)(()=>{g||f||(j(!0),r({title:d,path:(0,ta.GM)(u),siteId:null==n?void 0:n.id,routes:null==n?void 0:n.routes}).then(()=>{j(!1),i()}))},[r,f,g,i,u,null==n?void 0:n.id,null==n?void 0:n.routes,d]);return((0,b.useEffect)(()=>{t&&setTimeout(()=>{h.current&&h.current.select()},50)},[t]),n)?(0,s.jsxs)(i1.aF,{isOpen:t,onClose:i,size:"xl",children:[(0,s.jsx)(i6.m,{}),(0,s.jsxs)(i2.$,{color:v,children:[(0,s.jsx)(iR.r,{children:(0,s.jsxs)(o.B,{children:[(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"yLRlZm"})}),(0,s.jsx)(l.E,{fontSize:"sm",color:"gray.500",fontWeight:"normal",letterSpacing:"normal",children:(0,s.jsx)(m.x6,{id:"7TUZvz"})})]})}),(0,s.jsx)(i_.s,{}),(0,s.jsx)(iO.c,{children:(0,s.jsxs)(o.B,{spacing:4,children:[(0,s.jsxs)(nu.MJ,{children:[(0,s.jsxs)(e8.z,{justifyContent:"center",children:[(0,s.jsx)(nx.l,{flex:"1",children:(0,s.jsx)(m.x6,{id:"MHrjPM"})}),(0,s.jsx)(ux.H,{length:d.length||0,idealLength:nM.GF,maxLength:nM.tS})]}),(0,s.jsx)(iZ.p,{ref:h,value:d,onChange:e=>{c(e.target.value),x((0,nh.Fw)(e.target.value))},_placeholder:{opacity:1,color:"gray.500"},onKeyDown:e=>{"Enter"===e.key&&y()}})]}),(0,s.jsxs)(nu.MJ,{isInvalid:f,children:[(0,s.jsx)(e8.z,{justifyContent:"center",children:(0,s.jsx)(nx.l,{flex:"1",children:(0,s.jsx)(m.x6,{id:"dq8+qI"})})}),(0,s.jsxs)(nX.M,{children:[(0,s.jsx)(uh.G6,{children:"/"}),(0,s.jsx)(iZ.p,{fontFamily:"mono",value:u,onKeyDown:e=>{"Enter"===e.key&&y()},onChange:e=>{x((0,nh.Fw)(e.target.value))},placeholder:p.Ru._({id:"bTzMt5"}),_placeholder:{opacity:1,color:"gray.500"}})]}),f&&!g&&(0,s.jsx)(n8.Wt,{children:(0,s.jsx)(m.x6,{id:"hw1fjn"})})]})]})}),(0,s.jsx)(i3.j,{children:(0,s.jsxs)(e7.e,{children:[(0,s.jsx)(a.$,{colorScheme:"gray",variant:"ghost",onClick:i,children:(0,s.jsx)(m.x6,{id:"dEgA5A"})}),(0,s.jsx)(a.$,{onClick:y,isDisabled:f,variant:"solid",isLoading:g,children:(0,s.jsx)(m.x6,{id:"yLRlZm"})})]})})]})]}):(0,s.jsx)(s.Fragment,{})},uP=e=>{let{site:t}=e,{isOpen:i,onClose:n,onOpen:r}=(0,ez.j)();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(d.a,{bgColor:"gray.50",textAlign:"center",p:4,m:2,children:[(0,s.jsx)(l.E,{fontSize:"sm",children:(0,s.jsx)(m.x6,{id:"6TCEnS"})}),(0,s.jsx)(l.E,{fontSize:"sm",mt:2,fontWeight:"bold",children:(0,s.jsx)(iJ.N,{color:"trueblue.600",href:"#",onClick:r,children:(0,s.jsx)(m.x6,{id:"S0WoXy"})})})]}),i&&(0,s.jsx)(uD,{isOpen:i,onClose:n,site:t})]})},uz=e=>{let{icon:t,isSelected:i,children:n,href:r}=e,l=(0,b.useRef)(null),c=(0,V.dU)("gray.600","gray.50"),u=(0,V.dU)("trueblue.50","whiteAlpha.100"),x=(0,V.dU)("gray.800","gray.50"),h=(0,V.dU)("blackAlpha.50","whiteAlpha.100"),m=(0,V.dU)("gray.600","gray.50"),p=(0,V.dU)("trueblue.400","trueblue.200");(0,b.useEffect)(()=>{if(!i||!(null==l?void 0:l.current))return;let{inView:e}=(0,Z.cH)(l.current)||{};e||l.current.scrollIntoView()},[i]);let g=(0,b.useCallback)(e=>{e.target.closest('[data-id="sidebar-item-menu-button"]')&&e.preventDefault(),e.target.closest('[data-id="sidebar-item-menu-list"]')&&e.stopPropagation()},[]);return(0,s.jsx)(v(),{href:r,passHref:!0,shallow:!0,children:(0,s.jsx)(a.$,{ref:l,onClick:g,variant:"secondary",justifyContent:"flex-start",fontWeight:"500",w:"100%",size:"sm",color:i?x:c,bgColor:i?u:"transparent",_hover:{bgColor:i?u:h,color:i?x:m},h:"auto",py:1.5,px:2,role:"group",children:(0,s.jsxs)(e8.z,{alignItems:"start",justify:"flex-start",w:"100%",spacing:2,children:[(0,s.jsx)(d.a,{color:i?p:c,mt:"0.2em",w:4,children:t}),(0,s.jsx)(o.B,{flex:1,direction:"row",minW:0,align:"start",justifyContent:"flex-start",children:n})]})})})},uM=e=>{let{title:t,children:i}=e;return(0,s.jsxs)(e8.z,{justify:"space-between",children:[(0,s.jsx)(l.E,{fontSize:"sm",fontWeight:"600",px:1,py:1.5,color:"gray.500",children:t}),i&&i]})},uL=(e,t,i)=>i?(0,s.jsx)(t3.y,{size:"xs"}):e?(0,s.jsx)(x.g,{icon:u.hLE,fixedWidth:!0}):t?(0,s.jsx)(x.g,{icon:u.Eur,fixedWidth:!0}):(0,s.jsx)(x.g,{icon:u.A4h,fixedWidth:!0}),uN=e=>{let{site:t,isSelected:i,doc:n,route:r,hasChanges:o,onToggleOffline:l}=e,a=(0,V.dU)("trueblue.50","whiteAlpha.200"),c=(0,V.dU)("trueblue.100","whiteAlpha.200");return(0,s.jsx)(no.W,{modifiers:[{name:"flip",enabled:!0,options:{fallbackPlacements:["right"]}}],children:e=>{let{isOpen:h}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(nl.I,{"data-id":"sidebar-item-menu-button",ml:3,as:H.K,isRound:!0,variant:"ghost",py:2,size:"xs",_hover:{bgColor:i?c:a},icon:(0,s.jsx)(d.a,{className:"ellipsis-icon",transitionProperty:"common",transitionDuration:"normal",_groupHover:{opacity:1},_hover:{opacity:1},_active:{opacity:1},opacity:+!!h,children:(0,s.jsx)(x.g,{icon:u.Dwc,fixedWidth:!0})})}),(0,s.jsx)(L.Z,{children:(0,s.jsx)(uT,{site:t,doc:n,route:r,hasChanges:o,"data-id":"sidebar-item-menu-list",onToggleOffline:l})})]})}})},uF=e=>{var t;let{route:i,isHome:n,isSelected:a}=e,{docId:d,doc:c}=i,u=(0,t$.En)(),x=(0,eu.GV)(tr.Gd),h=(0,eu.GV)((0,tr.B4)(d)),p=(0,b.useRef)(null),g=(0,eu.GV)(tr.le),[j,{loading:f}]=(0,ik.Imo)(),v=uL(n,h,f),y="currentColor",C=(0,V.dU)("gray.500","gray.400"),w=(0,V.dU)("trueblue.400","trueblue.200"),k=(0,b.useCallback)(async()=>{if(!(null==c?void 0:c.id)||!x)return;let e=!(null==i?void 0:i.offline);await j({variables:{input:{siteId:x.id,docId:c.id,offline:e,path:null==i?void 0:i.path}}})},[null==c?void 0:c.id,i,j,x]);(0,b.useEffect)(()=>{if(!p.current||g!==d)return;let{inView:e}=(0,Z.cH)(p.current)||{};e||p.current.scrollIntoView()},[g,d]);let E=(0,D.pF)({docId:d});return(0,s.jsxs)(uz,{icon:v,"data-sidebar-doc":d,isSelected:a,href:E,children:[(0,s.jsxs)(o.B,{flex:1,spacing:"3px",alignItems:"flex-start",justifyContent:"flex-start",w:"100%",minW:0,children:[(0,s.jsx)(l.E,{textAlign:"left",color:a?w:y,noOfLines:2,maxW:"100%",whiteSpace:"normal",children:(0,c6.B)(null==(t=i.doc)?void 0:t.title)}),(0,s.jsxs)(e8.z,{color:C,children:[h&&!i.offline?(0,s.jsx)(q.Tz,{label:(0,s.jsxs)(o.B,{spacing:1,children:[(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"cFW7WD"})}),(0,s.jsx)(l.E,{fontSize:"xs",color:"whiteAlpha.700",children:(0,s.jsx)(m.x6,{id:"qliBJ3"})})]}),placement:"top",children:(0,s.jsx)(r.s,{bg:a?w:y,minW:1.5,minH:1.5,borderRadius:"full"})}):null,(0,s.jsx)(l.E,{mt:"-1px",textAlign:"left",noOfLines:1,fontFamily:n?void 0:"mono",fontSize:"xs",whiteSpace:"normal",wordBreak:"break-all",dir:"ltr",children:n?(0,s.jsx)(m.x6,{id:"i0qMbr"}):i.path})]})]}),k&&u&&x&&(0,s.jsx)(uN,{site:x,doc:c,route:i,hasChanges:h,isSelected:a,onToggleOffline:k})]})},uV=()=>{let e=(0,eu.GV)(tr.Gd),t=(0,eu.GV)(tr.le),{onlineRoutes:i,offlineRoutes:n}=(0,b.useMemo)(()=>{let t=((null==e?void 0:e.routes)?[...e.routes]:[]).sort(function(e,t){return e.path<t.path?-1:+(e.path>t.path)}).sort((e,t)=>"/"===e.path?-1:+("/"===t.path));return{onlineRoutes:t.filter(e=>!e.offline),offlineRoutes:t.filter(e=>e.offline)}},[null==e?void 0:e.routes]);return e?(0,s.jsxs)(o.B,{spacing:2,w:"100%",p:0,children:[(0,s.jsxs)(uM,{title:(0,s.jsx)(m.x6,{id:"wRR604"}),children:[(0,s.jsx)(tA.h,{}),(0,s.jsx)(u_,{site:e})]}),(0,s.jsxs)(o.B,{spacing:1,px:0,children:[0===i.length&&(0,s.jsx)(uP,{site:e}),i.map(e=>{let i=e.docId===t;return(0,s.jsx)(uF,{route:e,isHome:"/"===e.path,isSelected:i},e.id)}),n.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(uM,{title:(0,s.jsx)(m.x6,{id:"1DdXjE"})}),n.map(e=>{let i=e.docId===t;return(0,s.jsx)(uF,{route:e,isHome:"/"===e.path,isSelected:i},e.id)})]})]})]}):(0,s.jsx)(s.Fragment,{})},uG=()=>{let e=(0,ee.rd)();return(0,s.jsx)(q.L8,{isDark:e,children:(0,s.jsx)(t_.Z,{bg:e?"gray.800":"white",borderRight:"1px solid",borderColor:e?"gray.700":"gray.200","data-panelid":"pages-panel",overflowX:"hidden",px:6,pt:4,children:(0,s.jsx)(uV,{})})})};uG.panelPosition="left",uG.panelName="pages";let uW=e=>{let t=(0,iG.Gx)(),{togglePanel:i,isPanelOpen:n}=(0,eY.ww)(uG,e&&t),s=(0,y.d4)(ex.wC),r=(0,eu.GV)(tr.Gd),{editor:o}=(0,t5.mi)(),l=(0,eu.GV)(te.og),a=!!(r&&null===l&&r.routes.length>1&&o);return(0,t$.Vg)(()=>{a&&i({override:"open",disableTransition:!1})},[i,a],[a]),(0,b.useEffect)(()=>{s!==tv.w.DOC_VIEW&&i({override:"closed",disableTransition:!0})},[s,i]),{toggleSitePagesPanel:i,isSitePagesPanelOpen:n}};var uB=i(89122),uU=i(50861),uH=i(21699),uK=i(26886),uq=i(69764),uY=i(80180),uJ=i(3083);let uX=e=>{let{isOpen:t,onClose:i,onSaveSuccess:n,docId:r}=e,l=(0,iI.d)(),d=(0,b.useRef)(null),[c,u]=(0,b.useState)(""),[x,{loading:h}]=(0,ik.cGn)(),p=()=>{x({variables:{id:r,title:c}}).then(()=>{u(()=>""),n()}).catch(e=>{console.error(e),l({title:(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(m.x6,{id:"AToAqe",values:{0:e.message}})}),position:"top",status:"error"})})};return(0,s.jsxs)(i1.aF,{returnFocusOnClose:!1,onClose:i,closeOnOverlayClick:!0,isOpen:t,initialFocusRef:d,children:[(0,s.jsx)(i6.m,{}),(0,s.jsxs)(i2.$,{children:[(0,s.jsx)(iR.r,{children:(0,s.jsx)(m.x6,{id:"kq/0Sg",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}})}),(0,s.jsx)(i_.s,{}),(0,s.jsx)(iO.c,{children:(0,s.jsx)(iZ.p,{ref:d,value:c,required:!0,placeholder:(0,c6.B)(),onChange:e=>u(e.target.value),onKeyDown:e=>{"Enter"===e.key&&p()}})}),(0,s.jsx)(i3.j,{children:(0,s.jsx)(o.B,{spacing:2,direction:"row",align:"center",children:(0,s.jsx)(a.$,{isLoading:h,isDisabled:h||!c||!c.length,onClick:()=>{p()},children:(0,s.jsx)(m.x6,{id:"tfDRzk"})})})})]})]})},u$=(0,b.memo)(e=>{let{doc:t,file:i}=e,n=(0,b.useCallback)(()=>iY.R.emit("openSharePanel",{view:"invite"}),[]),{isOpen:o,onClose:l,onOpen:a}=(0,iN.E)({id:"analyticsModalDisclosure"}),{isOpen:d,onOpen:c,onClose:h}=(0,iN.E)({id:"titleModalDisclosure"}),{isInOfflineMode:g}=(0,E.u)(),j=(0,Q.st)(),{user:f}=(0,et.ur)(),v=(0,et.Iy)("manage",t)&&!!f,y=(0,R.u)("editDocAI"),C=(0,b.useCallback)(()=>{t&&(t.title&&""!==t.title?n():c())},[t,n,c]),w=(0,b.useCallback)(e=>()=>{null==j||j.track(Q.VV.DOC_ANALYTICS_VIEWED,{docId:null==t?void 0:t.id,source:e,type:"full",device:(0,O.ZI)()}),a()},[j,null==t?void 0:t.id,a]);return v&&t&&!y?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.s,{children:(0,s.jsx)(q.Tz,{closeOnMouseDown:!1,closeOnClick:!1,label:(0,s.jsx)(m.x6,{id:"YaUqUV"}),children:(0,s.jsx)(uJ.f,{"data-guider-highlight":"view-analytics-button","aria-label":p.Ru._({id:"YaUqUV"}),isDisabled:g,onMouseDown:uY.Fw,onClick:w("toolbar_analytics_block"),icon:(0,s.jsx)(x.g,{icon:u.q9c})})})}),d&&(0,s.jsx)(uX,{onClose:h,isOpen:d,onSaveSuccess:()=>{h(),n()},docId:null==t?void 0:t.id}),o&&(0,s.jsx)(cY,{doc:t,file:i,onSharePanelOpen:C,onAnalyticsPanelClose:l,isAnalyticsPanelOpen:o,mode:"full"})]}):null});var uZ=i(13427),uQ=i(72104),u0=i(7312),u1=i(16842),u6=i(25273);let u2=()=>{let{user:e,anonymousUser:t}=(0,et.ur)(),i=(0,y.wA)(),n=(0,iI.d)(),{editor:o}=(0,t5.mi)(),{collaborators:d,followers:c}=(0,eu.GV)((0,ex.iH)((null==e?void 0:e.id)||t.id));aY({editor:o,collaborators:d,user:e});let u=(0,eu.GV)(ex.Kc),x=(0,eu.GV)(ex.ys),h=(0,eu.GV)(ex.kn),g=(0,eu.GV)(ex.Ji),j=(0,eu.GV)(ex.QF);(0,b.useEffect)(()=>{u.forEach(e=>{n({duration:2e3,position:"bottom",render:function(){return(0,s.jsxs)(r.s,{bg:"gray.50",p:3,px:6,align:"center",borderRadius:"md",shadow:"md",children:[(0,s.jsx)(aN.e,{size:"sm",src:e.profileImageUrl,border:"solid 2px ".concat(e.color),color:aU()(e.color).isDark()?"white":"black",bg:e.color,ignoreFallback:!0}),(0,s.jsx)(l.E,{ml:2,children:(0,s.jsx)(m.x6,{id:"DSaSKH",values:{0:e.name}})})]})}})})},[u,n]),(0,b.useEffect)(()=>{let e=!h&&g&&!j;if(!o||!e)return;n.closeAll();let t=n({id:"detached-toast",render:()=>(0,s.jsxs)(r.s,{bg:"gray.50",p:3,px:6,m:4,justify:"flex-end",align:"center",borderRadius:"md",shadow:"md",children:[(0,s.jsx)(l.E,{size:"sm",mr:6,children:(0,s.jsx)(m.x6,{id:"PjodLp"})}),(0,s.jsxs)(e7.e,{size:"sm",alignItems:"center",children:[(0,s.jsx)(a.$,{onClick:()=>{i((0,ex.mF)({attached:!0}))},variant:"solid",children:(0,s.jsx)(m.x6,{id:"f/C2ic"})}),(0,s.jsx)(q.Tz,{label:(0,s.jsx)(m.x6,{id:"5JWVnj"}),children:(0,s.jsx)(H.K,{isRound:!0,variant:"ghost",size:"xs","aria-label":p.Ru._({id:"5JWVnj"}),icon:(0,s.jsx)(uQ.U,{}),onClick:()=>{i((0,ex.mF)({attached:!1,following:null}))}})})]})]}),position:"bottom",duration:null});return()=>{n.close(t)}},[o,h,g,j,n,i]),(0,b.useEffect)(()=>{g||o&&!o.isDestroyed&&i((0,ex.mF)({following:null}))},[o,g,i]);let f=(0,eZ.h5)({base:4,md:6,xl:8})||6,v=f/(c.length?2:1),C=f/(d.length?2:1);return(0,s.jsx)(r.s,{children:(0,s.jsxs)(e8.z,{divider:(0,s.jsx)(u0.G,{borderColor:"gray.200"}),children:[c.length&&(0,s.jsx)(u3,{type:"FOLLOWERS",collaborators:c,max:C,isEveryone:0===d.length,localCollaborator:x,localIsAttached:h}),d.length&&(0,s.jsx)(u3,{type:"COLLABORATORS",collaborators:d,max:v,isEveryone:0===c.length,localCollaborator:x,localIsAttached:h})]})})};var u5=function(e){return e.FOLLOWERS="FOLLOWERS",e.COLLABORATORS="COLLABORATORS",e}(u5||{});let u3=e=>{let{collaborators:t,localCollaborator:i,localIsAttached:n,type:o,max:a,isEveryone:d}=e,c=aq(),u="FOLLOWERS"===o,x=t.length>a,h=x?t.slice(0,a-1):t,g=x?t.length-a+1:0,j=e=>{let{localIsFollowing:t,collaborator:i}=e;u||c({localIsFollowing:t,localIsAttached:n,collaborator:i})};return(0,s.jsx)(u6.o,{children:(0,s.jsxs)(u1.Z,{size:"sm",spacing:u?-2:0,children:[u&&(0,s.jsx)(u4,{isEveryone:d}),h.map((e,t)=>{var o;let a=(null==i||null==(o=i.memoState)?void 0:o.following)===e.sessionId,d=!!e.idleSince,c=!u&&(x||h.length-1!==t);return(0,s.jsx)(q.Vc,{ignoreFallback:!0,name:e.name,label:(0,s.jsxs)(r.s,{direction:"column",justify:"center",align:"center",children:[(0,s.jsx)(l.E,{children:e.name}),(0,s.jsx)(l.E,{fontSize:"xs",children:u?(0,s.jsx)(m.x6,{id:"iRohzP"}):a&&n?(0,s.jsx)(m.x6,{id:"1QTvS5"}):(0,s.jsx)(m.x6,{id:"2Ldadb"})})]}),pointerEvents:d?"none":"auto",opacity:d?.4:1,transitionProperty:"common",transitionDuration:"normal",src:e.profileImageUrl,border:"solid 2px ".concat(e.color),nubbin:a&&n,bg:e.color,shadow:"base",color:aU()(e.color).isDark()?"white":"black",cursor:u?"":"pointer",boxProps:c?{marginEnd:-2}:{},onClick:()=>j({localIsFollowing:a,collaborator:e})},e.sessionId)}),g>0&&(0,s.jsxs)(q.oQ,{tooltipLabel:p.Ru._({id:"25VyZX"}),onClick:e=>{var n;let s=t.find(t=>t.id===e.id);j({localIsFollowing:!!(s&&(null==i||null==(n=i.memoState)?void 0:n.following)===s.sessionId),collaborator:s})},avatars:t,count:g,disabled:u,children:[(0,s.jsx)(l.E,{px:2,children:u?(0,s.jsx)(m.x6,{id:"vliZud",values:{0:t.length}}):(0,s.jsx)(m.x6,{id:"sC4bhw",values:{0:t.length}})}),!u&&(0,s.jsx)(l.E,{px:2,fontSize:"sm",color:"gray.500",children:(0,s.jsx)(m.x6,{id:"miJbY4"})}),(0,s.jsx)(sP.N,{})]})]})})},u4=e=>{let{isEveryone:t}=e,[i,n]=(0,b.useState)(!1),[r,o]=(0,b.useState)(!1),[l,a]=(0,b.useState)(!1);return((0,b.useEffect)(()=>{!i&&t&&(o(!0),n(!0),setTimeout(()=>{o(!1)},3e3))},[t,i]),t)?(0,s.jsx)(d.a,{fontSize:"sm",color:"",px:2,mr:2,children:(0,s.jsx)(q.Tz,{label:(0,s.jsx)(m.x6,{id:"w7dTyp"}),isOpen:l||r,children:(0,s.jsx)(d.a,{mr:2,px:1,bg:"green.300",color:"green.900",borderRadius:"full",onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),children:(0,s.jsx)(x.g,{icon:u.pS3})})})}):(0,s.jsx)(d.a,{fontSize:"sm",color:"gray.600",pr:4,children:(0,s.jsx)(x.g,{icon:u.pS3})})};var u8=i(88136);let u7=(0,su.P)(d.a),u9=e=>{let{commentFeedItems:t,editor:i,doc:n,user:r}=e;return i&&r?(0,s.jsx)(o.B,{p:2,children:(0,s.jsx)(sx.N,{initial:!1,children:t.map(e=>(0,s.jsx)(u7,{layout:!0,initial:{opacity:0,scale:.85},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.85},bg:"gray.50",borderColor:"gray.200",borderWidth:"1px",borderRadius:"md",shadow:"sm",children:(0,s.jsx)(rh.h,{comment:e,editor:i,selfUser:r,docId:n.id,userCanComment:!1,instanceType:"notification"},e.id)},e.id))})}):null};var xe=i(88974);let xt=e=>!!e.comment&&null!==e.timeout,xi=e=>{let{user:t,docId:i,docComments:n=[],pauseExiration:s=!1,duration:r=5e3}=e,o=(0,iI.d)(),l=null==t?void 0:t.id,a=(0,b.useMemo)(()=>{if(!l)return null;let e=new xe.default(T.$.KNOCK_PUBLIC_KEY);return e.authenticate(l),e},[l]),[d,c]=(0,b.useState)({}),u=(0,b.useRef)(!0),x=(0,b.useRef)(s);x.current=s,(0,b.useEffect)(()=>()=>{u.current=!1},[]);let h=(0,b.useCallback)(()=>c({}),[]),m=(0,b.useCallback)(e=>{c(t=>Object.entries(t).reduce((t,i)=>{let[n,s]=i;return(!0===e?-1===s.timeout:n===e)||(t[n]=s),t},{}))},[]);(0,b.useEffect)(()=>{s||m(!0)},[m,s]),(0,b.useEffect)(()=>{Object.entries(d).forEach(e=>{let[t,{entry:i,timeout:s}]=e;if(null===s){let e=i.data.commentId,s=null==n?void 0:n.find(t=>t.id===e);if(s){let e=setTimeout(()=>{u.current&&(x.current?c(e=>{let i={...e};return i[t].timeout=-1,i}):m(t))},r);c(n=>({...n,[t]:{entry:i,comment:s,timeout:e}}))}}})},[d,n,r,m]),(0,b.useEffect)(()=>{if(!a||!i)return;let e=a.feeds.initialize(T.$.KNOCK_FEED_ID,{source:"new-comment",status:"unseen"}),t=e.listenForUpdates();return e.on("messages.new",t=>{let{entries:n}=t,[s]=n;s.data.docId===i&&(c(e=>({...e,[s.id]:{entry:s,timeout:null}})),e.markAsSeen(s).then(()=>{console.debug("New notification marked as seen")}).catch(e=>{console.error("Unable to mark notification as seen",e)}))}),()=>{t()}},[i,o,a]);let{isConnected:p}=(0,E.u)();return(0,b.useEffect)(()=>{if(!a||!i)return;let e=a.client();p?e.connectSocket():e.disconnectSocket()},[i,p,a]),{reset:h,comments:Object.values(d).filter(xt).map(e=>e.comment)}},xn=e=>{var t;let{toggleCommentsPanel:i,isCommentsPanelOpen:n,doc:r,mode:o}=e,{user:l}=(0,et.ur)(),{editor:a}=(0,t5.mi)(),d=(0,R.u)("editDocAI"),[c,h]=(0,t$.Mk)(),{comments:m,reset:p}=xi({user:l,docId:null==r?void 0:r.id,docComments:null==r?void 0:r.comments,pauseExiration:h}),g=!!(a&&r&&r.comments);(0,b.useEffect)(()=>{if(!g)return;let{commentId:e}=(0,D.$9)();e&&ru.LF.emit(ru.DN.OPEN_POPUP_COMMENT,{commentId:e,highlightComment:!0})},[g]),(0,b.useEffect)(()=>{(n||o===tv.w.SLIDE_VIEW)&&p()},[n,p,o]);let j=!!m.length&&!n&&o!==tv.w.SLIDE_VIEW,f=(null==r||null==(t=r.comments)?void 0:t.filter(e=>e.status===ik.EB6.Open).length)||0;return d&&0===f?null:(0,s.jsxs)(N.A,{isLazy:!0,lazyBehavior:"keepMounted",returnFocusOnClose:!1,isOpen:j,placement:"bottom",children:[(0,s.jsx)(ea.W,{children:(0,s.jsx)(uJ.I,{onMouseDown:uY.Fw,onClick:i,icon:(0,s.jsx)(x.g,{icon:u.DN2}),isActive:n,"aria-label":n?"Hide comments":"Show comments",children:f})}),(0,s.jsx)(L.Z,{children:r&&(0,s.jsxs)(G.h,{bg:"white",shadow:"lg",border:"none",ref:c,children:[(0,s.jsx)(u8.R,{bg:"white"}),(0,s.jsx)(u9,{editor:a,user:l,commentFeedItems:m,doc:r})]})})]})},xs=()=>{let{isInOfflineMode:e}=(0,E.u)();return(0,s.jsx)(r.s,{children:(0,s.jsx)(q.Tz,{closeOnMouseDown:!1,closeOnClick:!1,label:(0,s.jsx)(m.x6,{id:"EVnzPs"}),children:(0,s.jsx)(uJ.f,{"data-guider-highlight":"design-partner-button","aria-label":"Edit with AI",variant:"plain",isDisabled:e,onClick:()=>{rI.R.emit("toggle",{})},icon:(0,s.jsx)(x.g,{icon:u.p7g})})})})};var xr=i(51684),xo=i(65012),xl=i(65009);let xa=(e,t)=>{let i=e.querySelector(".chakra-progress__indicator");if(!i)return;let n=(null!=t?t:0)/100,s=(null!=n?n:0)*264,r="".concat(s," ").concat(264-s);i.setAttribute("stroke-dasharray",r)},xd=e=>{let{duration:t=10,onClose:i,onMouseEnter:n,enabled:r,...o}=e,l=(0,b.useRef)(null),a=(0,V.dU)("gray.200","gray.600"),c=(0,V.dU)("trueblue.400","trueblue.300"),h=(0,V.dU)("var(--chakra-colors-gray-600)","var(--chakra-colors-gray-300)");return(0,b.useEffect)(()=>{let e,n,s=l.current;if(!s||!r)return;xa(s,0);let o=r=>{e||(e=r);let l=Math.min(100,(r-e)/(10*t));xa(s,l),l<100?n=requestAnimationFrame(o):null==i||i()};return n=requestAnimationFrame(o),()=>{cancelAnimationFrame(n)}},[i,r,t]),(0,s.jsx)(d.a,{ref:l,onMouseEnter:n,cursor:"pointer",sx:{".chakra-progress__indicator":{transition:"none !important",opacity:1,display:r?"block":"none",stroke:c},".chakra-progress__track":{display:r?"block":"none",stroke:a}},...o,children:(0,s.jsx)(xo.P,{display:"block",size:"24px",thickness:"10px",onClick:i,children:(0,s.jsx)(xl.n,{children:(0,s.jsx)(x.g,{icon:u.Jyw,fontSize:"14px",style:{color:h,borderRadius:"6px"}})})})})};var xc=i(42926),xu=i(81807),xx=i(41),xh=i(87790),xm=i(13559),xp=i(11390),xg=i(40094),xj=i(89481);let xf=e=>{let{editor:t}=e,i=(0,eu.GV)(e_.Jo),n=(0,eu.CU)(),s=(0,eu.GV)(rt.xI),r=(0,r7.lI)(t);(0,r7.zK)(r);let{imageProvider:o,imageOptions:l}=(0,o4.V)(),a=(0,R.u)("buddyEdit"),d=(0,b.useCallback)(async e=>{let{instructions:s="",inputHtml:r,operation:a}=e;if(!i||!i.organization)throw Error("Doc or organization not found");let d=(0,tU.$F)(),c=performance.now(),u=(0,xm.h)(t,n),x={interface:"edit-card-parallel",interactionId:d,inputContent:r,inputMessage:s,inputData:{custom:!!a,operation:null==a?void 0:a.key,operationGroup:null==a?void 0:a.group,imageProvider:o,...u},product:(0,xp.A4)(i.organization),docId:i.id};try{let e=(null==a?void 0:a.key)==="edit.translate",t=await (0,tB.K8)({promptKey:"EditCardParallel",variables:{inputHtml:r,request:s,imageOptions:l,imageProvider:o,model:R.of.get("editCardModel"),reasoningEffort:R.of.get("editCardReasoningEffort"),basePromptKey:e?"TranslateCard":R.of.get("editCardParallelPrompt"),...u},interactionId:d,workspaceId:i.organization.id,opts:{maxRetries:0}});(0,tU.rl)(x),console.log("[EditCardParallel] Response",t);let n=(0,xu.dg)(t);return console.log("[EditCardParallel] Parsing HTML",n),{output:n.map(r8.dE),interactionId:d}}catch(e){throw(0,tU.tB)({...x,errorMessage:e.message,errorCode:e.code,errorName:e.name,outputMessage:"Error editing doc",latency:performance.now()-c}),e}},[i,n,o,l,t]),c=(0,b.useCallback)(async e=>{let{instructions:i,operation:s}=e,r=(0,tf.aJ)(t.state.doc);if(!r)return;if(a){var o;let e=i||(null==s||null==(o=s.instructionsTrans)?void 0:o.call(s));e?ru.LF.emit("queueBuddyEditMessage",{message:p.Ru._({id:"khFKeH",values:{userInstructions:e}})}):console.error("useEditDocWithAI: no instructions for buddy edit");return}let l=i||(null==s?void 0:s.instructions);if(l)try{n.dispatch((0,rt.Tn)(!0));let e=[];r.forEach(i=>{var r;n.dispatch((0,rt.Ic)({cardId:i.node.attrs.id,suggestions:{status:"loading",loadingMessage:null==s||null==(r=s.loadingMessage)?void 0:r.call(s),variants:[]}})),e.push((0,tW.KC)(t,i.node))});let i=e.join();console.log("[EditCardParallel] Input HTMLParts",e);let{output:o,interactionId:a}=await d({instructions:l,operation:s,inputHtml:i});if(console.log("[EditCardParallel] New cards",o),o.length!==r.length)throw Error("[EditCardParallel] Mismatch in number of cards");let c={};r.forEach((e,t)=>{var i;let r=o[t];r.attrs=(0,xj.p5)(e.node.attrs,r.attrs),c[e.node.attrs.id]=r,n.dispatch((0,rt.Ic)({cardId:e.node.attrs.id,suggestions:{status:"done",interactionId:a,selected:"v1",operation:s,instructions:l,variants:[{label:p.Ru._({id:"HxF6Fk"}),isOriginal:!0,id:"original",card:e.node.toJSON()},{label:(null==s||null==(i=s.variationName)?void 0:i.call(s))||p.Ru._({id:"YledUl"}),isOriginal:!1,id:"v1",card:r}]}}))}),xb(t,c,a)}catch(e){console.error("[EditCardParallel] Error regenerating card",e),r.forEach(e=>{n.dispatch((0,rt.Ic)({cardId:e.node.attrs.id,suggestions:{status:"error",variants:[]}}))})}finally{n.dispatch((0,rt.Tn)(!1))}},[t,d,n,a]),u=(0,b.useRef)();return(0,b.useEffect)(()=>xx.R.on("translate",async e=>{let{type:i,language:n}=e,s=xg.Jz.find(e=>"edit.translate"===e.key);if("doc"===i&&s){if(a){let e=n.displayNameLocalized();await c({instructions:p.Ru._({id:"BYaniG",values:{languageName:e}}),operation:s})}else await c({instructions:"".concat(n.englishName," (").concat(n.key,")"),operation:s});u.current=(0,r7.nM)(t.state.doc),(0,r7.lR)(t,n.key)}}),[c,t,a]),{editDoc:c,acceptAll:(0,b.useCallback)(()=>{n.dispatch((0,rt.YB)({})),u.current=void 0},[n]),rejectAll:(0,b.useCallback)(()=>{xv(t,n.getState(),!0),n.dispatch((0,rt.YB)({})),(0,r7.lR)(t,u.current),u.current=void 0},[t,n]),status:s}},xv=(e,t,i)=>{let n=(0,rt.yL)(t),s=e.chain();return Object.entries(n).forEach(t=>{let[n,r]=t,o=(0,tf.W0)(e,n),l=r.variants.find(e=>!!e.isOriginal===i);o&&l&&l.id!==r.selected&&s.command(t=>{let{tr:i}=t,n=sQ.bP.fromJSON(e.schema,l.card),s=i.mapping.map(o.pos);return i.replaceWith(s,s+o.node.nodeSize,n),!0})}),s.run()},xb=(e,t,i)=>{let n=(0,tf.aJ)(e.state.doc);if(!n)return;let s=n.map(n=>{let s=t[n.node.attrs.id];if(!s)return void console.warn("[useGenerateCard] Card not found. It may have been deleted while generating.");let r=(0,ex.SJ)((0,eu.KA)().getState());return(0,k.Sg)({editor:e,content:s,theme:r,interactionId:i}),s}).filter(e=>!!e);console.log("[replaceDocWithCardVariants] content",s),e.chain().setMeta("isEditCardVariant",!0).setMeta("cardNotesHandled",!0).insertContentAt({from:1,to:e.state.doc.nodeSize-2},s).run()},xy=()=>{let e=!!(0,eu.GV)(tr.Gd),{isOpen:t,onClose:i,onOpen:n}=(0,iN.E)({id:"TranslateDocDisclosure"}),r=(0,b.useCallback)(e=>{xx.R.emit("translate",{type:"doc",language:e}),i()},[i]);return{translateDocModal:t?(0,s.jsx)(xh.Q,{isSite:e,isFullDoc:!0,onClose:i,startTranslation:r}):null,onTranslateDocOpen:n}};var xC=i(85443);let xw=(0,su.P)(tI.T),xk=e=>{let{editor:t}=e,{isInOfflineMode:i}=(0,E.u)(),{openUpsellModal:n}=(0,dT.I)(),{editDoc:o,status:l,acceptAll:a,rejectAll:d}=xf({editor:t}),c=(0,ee.rd)(),u=(0,b.useRef)(null),h=(0,b.useRef)(null),g=(0,R.u)("editCard2"),[j,f]=(0,b.useState)(),v=(0,b.useCallback)(()=>f(void 0),[]),{isGammaAdminUser:y}=(0,xC.u)(),C=(0,eK.ez)("edit_doc_ai")||y,{translateDocModal:w,onTranslateDocOpen:k}=xy(),S=(0,R.u)("buddyEdit"),I="loading"===l,A=(0,b.useCallback)(e=>{var t;return C?(a(),f(e.operation||"Editing"),(null==(t=e.operation)?void 0:t.key)==="edit.translate")?void k():void o(e):void n({segmentEvent:Q.VV.GAMMA_PRO_UPSELL_CALLOUT_EDIT_DOC_AI})},[a,C,o,k,n]);return g?(0,s.jsxs)(q.L8,{isDark:c,children:[(0,s.jsx)(no.W,{placement:"bottom-end",isLazy:!0,initialFocusRef:h,onOpen:()=>{f(void 0)},children:e=>{let{onClose:n}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(r.s,{direction:"column",children:[(0,s.jsx)(q.Tz,{label:(0,s.jsx)(m.x6,{id:"nIHiKm"}),placement:"bottom",children:(0,s.jsx)(nl.I,{as:uJ.f,position:"relative","aria-label":p.Ru._({id:"nIHiKm"}),isDisabled:I||i,icon:I?(0,s.jsx)(t3.y,{size:"sm"}):(0,s.jsx)(x.g,{icon:xr.p7g})})}),(0,s.jsx)(xS,{currentOperation:j,onConfirm:a,onReject:d,onClose:v})]}),(0,s.jsx)(L.Z,{children:(0,s.jsxs)(na.c,{"data-doc-ai-menu":!0,minWidth:"320px",width:"fit-content",maxWidth:"min(360px, 80vw)",fontFamily:"body",fontSize:"md",border:"none",maxH:"90vh",overflowY:"auto",children:[(0,s.jsx)(xc.u,{firstItemRef:u,inputRef:h,editCardIfAllowed:A,onClose:n,isDisabled:I,opacityFadeUpsell:!C,groups:["writing"],showCreditCosts:!1,editor:t,title:p.Ru._({id:"nIHiKm"}),buddyEditEnabled:S}),!C&&(0,s.jsx)(iQ.c,{isNarrow:!0,mb:0,segmentEvent:Q.VV.GAMMA_PRO_UPSELL_CALLOUT_EDIT_DOC_AI,title:(0,s.jsx)(m.x6,{id:"mpbrVv",values:{GAMMA_PRO_PROPER_NOUN:ej.Ol}}),description:(0,s.jsx)(m.x6,{id:"gNaWbA",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}}),targetFeature:"edit_doc_ai"})]})})]})}}),w]}):null},xE={initial:{opacity:0,y:10},animate:{opacity:1,transition:{duration:.4,ease:[.21,1.02,.73,1]},y:0},exit:{opacity:0,scale:.9},transition:{duration:.4,ease:[.06,.71,.55,1]}},xS=e=>{var t,i,n;let{currentOperation:o,onConfirm:d,onReject:c,onClose:h}=e,g=(0,eu.GV)(rt.pw),[j,f]=(0,b.useState)(!0),v="Edited"===o?o:"object"==typeof o?null==(t=o.completionMessage)?void 0:t.call(o):(0,s.jsx)(m.x6,{id:"MRZxAn"}),y=null!=(i=g.done)?i:0,C=null!=(n=g.error)?n:0,w=!!((y||C)&&o);(0,b.useEffect)(()=>{w||f(!0)},[w]);let k={activeColor:(0,V.dU)("trueblue.500","trueblue.300"),hoverColorCloseButton:(0,V.dU)(C?"red.200":"gray.50","whiteAlpha.200"),bg:(0,V.dU)("white","gray.800"),bgError:(0,V.dU)("red.100","red.700"),textColor:(0,V.dU)("blackAlpha.800","whiteAlpha.900"),textErrorColor:(0,V.dU)("red.500","red.100"),iconColor:(0,V.dU)("blackAlpha.800","whiteAlpha.800")};return(0,s.jsx)(sx.N,{children:w&&(0,s.jsxs)(xw,{position:"absolute",bg:C?k.bgError:k.bg,borderRadius:"md",boxShadow:"md",overflow:"hidden",top:14,insetEnd:6,flexDirection:"row",spacing:2,p:2,onMouseEnter:()=>f(!1),...xE,children:[C>0?(0,s.jsxs)(e8.z,{spacing:0,children:[(0,s.jsx)(r.s,{mx:2,justifyContent:"center",alignItems:"center",color:k.textErrorColor,children:(0,s.jsx)(x.g,{icon:u.QJT,size:"lg"})}),(0,s.jsxs)(tI.T,{mx:2,spacing:0,alignItems:"flex-start",children:[(0,s.jsx)(l.E,{fontSize:"sm",color:k.textErrorColor,children:(0,s.jsx)(m.x6,{id:"nwtY4N"})}),(0,s.jsx)(l.E,{fontSize:"xs",color:k.textErrorColor,children:(0,s.jsx)(m.x6,{id:"xbrcey"})})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(tI.T,{spacing:0,alignItems:"flex-start",children:[(0,s.jsxs)(r.s,{mx:2,justifyContent:"center",alignItems:"center",children:[(0,s.jsx)(x.g,{icon:xr.p7g,color:"var(--chakra-colors-trueblue-400)"}),(0,s.jsx)(l.E,{fontSize:"sm",mx:2,color:k.textColor,children:v})]}),(0,s.jsx)(r.s,{mx:2,children:(0,s.jsx)(l.E,{fontSize:"sm",color:"gray.500",children:(0,s.jsx)(m.x6,{id:"Dj1qYd",values:{doneCount:y}})})})]}),(0,s.jsxs)(e7.e,{spacing:0,children:[(0,s.jsx)(q.Tz,{label:p.Ru._({id:"I1yW7+"}),placement:"top",children:(0,s.jsx)(H.K,{"aria-label":p.Ru._({id:"yWDjkv"}),variant:"ghost",colorScheme:"gray",size:"sm",mx:1,icon:(0,s.jsx)(x.g,{icon:u.U23}),onClick:c})}),(0,s.jsx)(q.Tz,{label:p.Ru._({id:"kOU1RP"}),placement:"top",children:(0,s.jsx)(a.$,{"aria-label":p.Ru._({id:"aIcRZZ"}),variant:"plain",size:"sm",mx:1,rightIcon:(0,s.jsx)(x.g,{icon:u.FK2}),onClick:d,children:(0,s.jsx)(m.x6,{id:"PHWHEO"})})})]})]}),(0,s.jsx)(r.s,{mt:-6,me:-1,children:(0,s.jsx)(q.Tz,{label:p.Ru._({id:"1QfxQT"}),placement:"top",shouldWrapChildren:!0,children:(0,s.jsx)(xd,{onClose:h,enabled:j&&!C,duration:30,borderRadius:"full",_hover:{bg:k.hoverColorCloseButton,color:k.textColor}})})})]},"confirm-edit-doc-toast")})};var xI=i(20746),xA=i(37869);let xT=e=>{let{file:t,currentPageId:i,showLongTitle:n,showTitleStack:r,currentPageTitle:o}=e,a=t.title||(0,s.jsx)(m.x6,{id:"wja8aL"}),c=r?o||(0,s.jsx)(m.x6,{id:"wja8aL"}):a,{textColor:u,secondaryTextColor:x}=(0,xA.l)(),h=(0,ir.A)({base:!1,sm:!0})&&r;return h?(0,s.jsxs)(dP,{flexGrow:0,flexShrink:1,maxWidth:n?500:300,as:uJ.I,leftIcon:null,textAlign:"start",file:t,matchWidth:!1,selectedPageId:null!=i?i:t.mainPageId,onPageSelected:()=>{},getMenuItemProps:e=>({as:v(),shallow:!0,href:(0,D.pF)({docId:e.id})}),children:[h&&(0,s.jsx)(l.E,{noOfLines:1,fontSize:"2xs",color:x,children:a}),(0,s.jsx)(l.E,{noOfLines:1,fontSize:h?"xs":["xs","sm"],color:u,children:c})]}):(0,s.jsxs)(d.a,{flexGrow:0,flexShrink:1,maxWidth:n?500:300,children:[h&&(0,s.jsx)(l.E,{noOfLines:1,fontSize:"2xs",color:x,children:a}),(0,s.jsx)(l.E,{noOfLines:1,fontSize:h?"xs":["xs","sm"],color:u,children:c})]})},xR=e=>{let{file:t,canEditFile:i,currentDocTitle:n,currentPageId:o,isPagesPanelOpen:l,togglePagesPanel:a}=e,c=(0,$.fW)(),[h]=(0,xI.F)(em.E.lastHomeUrl,"/"),{user:m}=(0,nv.ur)(),{confirmNavigation:g}=(0,t5.mi)(),{push:j}=(0,e9.useRouter)(),f={as:v(),href:h||"/",passHref:!0,"data-testid":"toolbar-home-link"},{separatorColor:b}=(0,xA.l)(),y=(0,eu.GV)(e_.d_);return(0,s.jsx)(r.s,{flex:1,h:8,children:(0,s.jsxs)(e8.z,{w:"100%",spacing:[1,2],px:[2,3],alignItems:"center",children:[m&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.a,{...f,onClick:e=>{!e.shiftKey&&(e.metaKey||e.ctrlKey)||(e.preventDefault(),g().then(()=>{j(f.href)}))},marginInlineStart:[-2,-3],children:(0,s.jsx)(xA.Z,{boxProps:{boxSize:[6,8],p:["0.2rem","0.3rem"]}})}),(0,s.jsx)(d.a,{as:x.g,icon:c?u.Wzs:u.XkK,color:b,fontSize:["xs","sm"],mt:["0.2rem","0.125rem"]})]}),(i||y)&&(0,s.jsx)(uJ.f,{"aria-label":p.Ru._({id:"NoSuez"}),onClick:()=>null==a?void 0:a(),isSelected:l,icon:(0,s.jsx)(x.g,{icon:u.aEb}),border:"none"}),(0,s.jsx)(xT,{file:t,currentPageId:o,showLongTitle:!i,showTitleStack:!l&&y,currentPageTitle:n})]})})},x_=(0,su.P)(d.a),xO=()=>{let e=(0,eu.GV)(ex.oz),t=(0,eu.GV)(ex.kn),i=e&&t;return(0,s.jsx)(sx.N,{initial:!1,children:i&&(0,s.jsx)(x_,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},position:"absolute",pointerEvents:"none",borderTop:"solid ".concat(4,"px ").concat(e.color),top:0,left:0,bottom:0,right:0,height:"var(--100vh)"})})},xD=e=>{let{doc:t,file:i,toggleCommentsPanel:n,editorWrapperEl:r,scrollingParentSelector:o}=e;return(0,s.jsxs)(no.W,{placement:"bottom-end","data-testid":"doc-toolbar-menu",modifiers:[{name:"flip",enabled:!0,options:{fallbackPlacements:["left"]}}],children:[(0,s.jsx)(nl.I,{as:uJ.f,icon:(0,s.jsx)(x.g,{icon:u.vHW}),onMouseDown:uY.Fw,"data-testid":"doc-toolbar-menu-button"}),(0,s.jsx)(L.Z,{children:t&&(0,s.jsx)(ud,{file:i,doc:t,toggleCommentsPanel:n,scrollingParentSelector:o,editorWrapperEl:r})})]})},xP=e=>{let{docId:t,enabled:i,enterSlideView:n}=e,s=(0,eu.GV)(ex.ys),r=(0,b.useRef)(null),o=(0,iI.d)();return(0,b.useEffect)(()=>{!i&&r.current&&r.current.close()},[i]),(0,b.useEffect)(()=>{let e=()=>{var e;null==(e=r.current)||e.close()};return window.addEventListener("beforeunload",e),()=>{var t;window.removeEventListener("beforeunload",e),null==(t=r.current)||t.close()}},[]),{handlePresentViewClick:(0,b.useCallback)(()=>{if(!t||!(null==s?void 0:s.sessionId))return;let e=(0,D.WC)({docId:t,sessionId:s.sessionId}),i=window.open(e,"present-view","popup,left=0,top=0,width=720,height=580");i?r.current=i:(o({title:"Failed to open presenter view.",description:"Please allow popups for this site and try again.",status:"error",position:"top",duration:5e3}),console.error("[usePresenterViewToggle] Failed to open presenter view")),n({fullscreen:!1})},[t,n,null==s?void 0:s.sessionId,o])}};var xz=i(9329),xM=i(2362);function xL(){let e=(0,xz._)(["\n    0% { transform: scale(1.0); filter: brightness(1.0);  }\n    3% { transform: scale(1.0); filter: brightness(1.0);  }\n    8% {  transform: scale(0.90); filter: brightness(1.30);  }\n    18% { transform: scale(1.05); filter: brightness(1.0); }\n    30% { transform: scale(1.0); filter: brightness(1.0); }\n  "]);return xL=function(){return e},e}let xN=e=>({followOnStart:!0,followingId:e}),xF=e=>{switch(e){case"edit":return p.Ru._({id:"UZN1cZ"});case"comment":return p.Ru._({id:"jFTs0A"});case"view":return p.Ru._({id:"Ya6CJ0"});default:return p.Ru._({id:"Txd1qM"})}},xV=e=>{var t,i;let{isOpen:n,onClose:r,accessLinkUrl:c,onPlayClick:u}=e,h=(0,$.fW)(),{user:g}=(0,et.ur)(),{replace:j}=(0,e9.useRouter)(),f=xN(null==g?void 0:g.id),[v]=(0,b.useState)(f),y=(0,D.an)(c,v),{user:C,color:w}=(0,et.ur)(),k=(0,eu.GV)(e_.Jo),E=null==k||null==(i=k.accessLinks)||null==(t=i[0])?void 0:t.permission,S=(0,K.i7)(xL());return(0,s.jsx)(q.L8,{isDark:!1,children:(0,s.jsxs)(i1.aF,{isOpen:n,onClose:r,size:"lg",children:[(0,s.jsx)(i6.m,{}),(0,s.jsxs)(i2.$,{children:[(0,s.jsx)(iR.r,{children:(0,s.jsx)(m.x6,{id:"88XnIQ"})}),(0,s.jsx)(i_.s,{}),(0,s.jsx)(iD.c,{}),(0,s.jsx)(iO.c,{pt:"6",children:(0,s.jsxs)(o.B,{spacing:"4",children:[(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"oYTLJe",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP,0:xF(E)},components:{0:(0,s.jsx)(l.E,{as:"span",fontWeight:"bold",borderBottom:"1px dashed",borderColor:"gray.400",display:"inline-block"}),1:(0,s.jsx)(q.Tz,{label:p.Ru._({id:"8LnpqL"}),placement:"top"})}})}),(0,s.jsx)(d.a,{mb:"2",children:(0,s.jsx)(xM.X,{url:y,variant:"solid",paddingLeft:h?20:void 0})}),(0,s.jsxs)(iP.F,{children:[(0,s.jsx)(iz._,{}),(0,s.jsxs)(e8.z,{flexBasis:"100%",alignItems:"top",children:[(0,s.jsx)(l.E,{fontSize:"sm",width:"100%",children:(0,s.jsx)(m.x6,{id:"EApNIe"})}),(0,s.jsxs)(d.a,{position:"relative",textShadow:"sm",children:[(0,s.jsx)(aN.e,{animation:"".concat(S," 2s infinite ease-out"),name:null==C?void 0:C.displayName,src:null==C?void 0:C.profileImageUrl,size:"md",border:"solid 3px ".concat(w.value),shadow:"lg"}),(0,s.jsx)(d.a,{position:"absolute",top:"1.75rem",left:"1.75rem",outline:"0 0 2px rgba(255,255,255,1.0)",sx:{path:{stroke:"white",strokeWidth:48}},color:"black",children:(0,s.jsx)(x.g,{icon:tT.eX_,fixedWidth:!0})})]})]})]})]})}),(0,s.jsx)(i3.j,{children:(0,s.jsxs)(e7.e,{children:[(0,s.jsx)(a.$,{variant:"ghost",colorScheme:"gray",onClick:()=>{r()},children:(0,s.jsx)(m.x6,{id:"DPfwMq"})}),(0,s.jsx)(a.$,{variant:"solid",onClick:()=>{r(),u(),j(y,y,{shallow:!0})},leftIcon:(0,s.jsx)(x.g,{icon:tT.ijD}),children:(0,s.jsx)(m.x6,{id:"tbDuNX"})})]})})]})]})})},xG=e=>{var t,i,n,a;let{doc:c,docEditorType:h,isCollaborativeEditor:g,enterSlideView:j,exitSlideView:f,setExitedFullscreenByClick:v,isFullscreen:y,enterFullscreen:C,exitFullscreen:w,shouldHide:k}=e,{onOpen:S,onClose:I,isOpen:A}=(0,iN.E)({id:"meetModal"}),{user:T}=(0,et.ur)(),_=(0,eu.GV)(ex.wC),O=(0,b.useRef)(_),{presentAction:D,secondaryPresentAction:P}=xW(h),z=(0,R.u)("docPreview");(0,b.useEffect)(()=>{O.current=_},[_]);let{shortcutLabel:M,shortcutIcon:N,shortcutKeys:F,buttonLabel:V}=dc(D)[_],G=null==c||null==(i=c.accessLinks)||null==(t=i[0])?void 0:t.url,W=!!(null==c||null==(a=c.accessLinks)||null==(n=a[0])?void 0:n.permission),B=(0,et.Iy)("comment",c||void 0),U=(0,et.Iy)("manage",c||void 0),H=g&&T&&G&&U,K=_===tv.w.SLIDE_VIEW,Y=_===tv.w.DOC_VIEW,J=B&&h!==t2.i.PUBLIC_STATIC,{isInOfflineMode:X}=(0,E.u)(),{handlePresentViewClick:$}=xP({docId:null==c?void 0:c.id,enabled:K,enterSlideView:j}),Z=(0,R.u)("presentFullScreen"),Q=["present"===P&&Y&&(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:u.vGi,fixedWidth:!0}),onClick:()=>j({fullscreen:Z,presentAction:"present"}),isDisabled:X,children:(0,s.jsxs)(o.B,{spacing:"0",children:[(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"hXFTMR"})}),(0,s.jsx)(l.E,{fontSize:"sm",color:"gray.600",children:(0,s.jsx)(m.x6,{id:"kNbT4w"})})]})},"other_ways_to_share_present"),"preview"===P&&Y&&z&&(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:u.hZM,fixedWidth:!0}),onClick:()=>j({fullscreen:Z,presentAction:"preview"}),children:(0,s.jsxs)(o.B,{spacing:"0",children:[(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"t7wjm2"})}),(0,s.jsx)(l.E,{fontSize:"sm",color:"gray.600",children:(0,s.jsx)(m.x6,{id:"oVzEKG"})})]})},"other_ways_to_share_preview"),H&&(0,s.jsxs)(b.Fragment,{children:[(0,s.jsx)(q.Tz,{isDisabled:W,label:(0,s.jsx)(m.x6,{id:"zk6wKo"}),children:(0,s.jsx)(d.a,{children:(0,s.jsx)(nd.D,{onClick:()=>{var e;(null==c||null==(e=c.accessLinks)?void 0:e[0].permission)&&S()},isDisabled:!W||X,icon:(0,s.jsx)(x.g,{icon:u.Gk0,fixedWidth:!0}),children:(0,s.jsxs)(o.B,{spacing:"0",children:[(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"myjBJy"})}),(0,s.jsx)(l.E,{fontSize:"sm",color:"gray.600",children:(0,s.jsx)(m.x6,{id:"svQKXy"})})]})})})}),(0,s.jsx)(xV,{isOpen:A,onClose:I,accessLinkUrl:G,onPlayClick:()=>{j({fullscreen:!1,presentAction:D})}})]},"other_ways_to_share_meet_link")].filter(Boolean);return(0,s.jsxs)(r.s,{display:k?"none":"flex",children:[(0,s.jsxs)(e7.e,{isAttached:!0,size:"sm","data-guider-highlight":"present-button-group","data-editor-mode":K?"slide":"doc",children:[(0,s.jsx)(q.Tz,{closeOnMouseDown:!1,closeOnClick:!1,label:M,shortcut:F,children:(0,s.jsx)(uJ.I,{fontWeight:"normal",size:"sm",variant:"solid",onClick:()=>{Y?j({fullscreen:Z,presentAction:D}):f()},onMouseDown:uY.Fw,icon:(0,s.jsx)(x.g,{icon:N}),"data-present-button":!0,children:V})}),(0,s.jsxs)(no.W,{children:[(0,s.jsx)(nl.I,{variant:"solid",as:uJ.f,icon:(0,s.jsx)(x.g,{icon:u.Jt$})}),(0,s.jsx)(L.Z,{children:(0,s.jsxs)(na.c,{zIndex:"popover",children:[Y&&(0,s.jsxs)(aj.r,{title:"present"===D?p.Ru._({id:"tbDuNX"}):p.Ru._({id:"Mn9aLv"}),children:[(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:u.u0F,fixedWidth:!0}),command:(0,q.lp)("Mod+Enter"),onClick:()=>j({fullscreen:!1,presentAction:D}),children:(0,s.jsx)(m.x6,{id:"LRFe2O"})}),(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:u.ArK,fixedWidth:!0}),command:(0,q.lp)("Mod+Shift+Enter"),onClick:()=>j({fullscreen:!0,presentAction:D}),children:(0,s.jsx)(m.x6,{id:"OwIqiD"})}),J&&(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:u.hZM,fixedWidth:!0}),onClick:$,isDisabled:X,children:(0,s.jsxs)(o.B,{spacing:"0",children:[(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"T+GUKl"})}),(0,s.jsx)(l.E,{fontSize:"sm",color:"gray.600",children:(0,s.jsx)(m.x6,{id:"ACelDx"})})]})})]}),K&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:tT.APi,fixedWidth:!0}),command:(0,q.lp)("Esc"),onClick:f,children:(0,s.jsx)(m.x6,{id:"5Rfo7J"})}),(J||H)&&(0,s.jsx)(sP.N,{}),J&&(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:u.hZM,fixedWidth:!0}),onClick:$,children:(0,s.jsxs)(o.B,{spacing:"0",children:[(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"T+GUKl"})}),(0,s.jsx)(l.E,{fontSize:"sm",color:"gray.600",children:(0,s.jsx)(m.x6,{id:"ACelDx"})})]})})]}),Q.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(sP.N,{}),(0,s.jsx)(aj.r,{title:p.Ru._({id:"+w9NSz"}),children:Q})]})]})})]})]}),K&&(0,s.jsx)(r.s,{ms:2,children:(0,s.jsx)(q.Tz,{label:y?(0,s.jsx)(m.x6,{id:"IkOhTI"}):(0,s.jsx)(m.x6,{id:"q8ARHN"}),children:(0,s.jsx)(uJ.f,{"aria-label":y?p.Ru._({id:"IkOhTI"}):p.Ru._({id:"q8ARHN"}),icon:(0,s.jsx)(x.g,{icon:y?u.gr3:u.oZK}),onClick:y?()=>{v(!0),w()}:C})})})]})},xW=e=>{let t=(0,R.u)("docPreview"),i=e===t2.i.COLLABORATIVE&&t,n=(0,eu.GV)(ex.sA).presentAction;i||"preview"!==n||(n="present");let s="present"===n?"preview":"present";return{presentAction:n,secondaryPresentAction:s}},xB=e=>{switch(e){case ik.mOX.Pending:return{icon:u.$Xz,label:p.Ru._({id:"JKsafh"})};case ik.mOX.Verified:return{icon:u.e68,label:p.Ru._({id:"DKrUGB"})};case ik.mOX.Failed:return{icon:u.S2b,label:p.Ru._({id:"ojSx8e"})}}},xU=e=>{let{domain:t,isLive:i,site:n,docId:r}=e,o=(0,ta.tO)({site:n,docId:r}),l=(0,b.useMemo)(()=>xB(t.status),[t.status]);return n&&r?(0,s.jsxs)(e8.z,{color:"gray.500",pointerEvents:"none",justifyContent:"flex-start",w:"full",children:[(0,s.jsx)(q.Tz,{label:l.label,placement:"left",children:(0,s.jsx)(H.K,{variant:"ghost",size:"xs",mx:-1,me:-2,color:"gray.500","aria-label":l.label,_hover:{bg:"transparent"},_active:{bg:"transparent"},children:(0,s.jsx)(x.g,{icon:l.icon,size:"xs",pointerEvents:"auto",fixedWidth:!0,spin:t.status===ik.mOX.Pending})})}),(0,s.jsx)(q.Tz,{label:t.name,placement:"top",openDelay:500,closeOnClick:!1,children:(0,s.jsx)(d.a,{fontSize:"xs",pointerEvents:"auto",children:xH(t.name,33)})}),i&&t.status===ik.mOX.Verified&&(0,s.jsx)(c7,{site:n,path:(0,ta.wK)(o),domain:t})]}):null},xH=(e,t)=>{if(e.length<=t)return e;let i=e.replace(/^https?:\/\//,"").split("."),n=i.slice(-2).join("."),s=i.slice(0,-2).join("."),r=t-n.length-3;if(r<=0)return n;let o=s.slice(0,r);return"".concat(o).concat("...").concat(n)},xK=e=>{let{onClick:t,doc:i,isLive:n}=e,r=null==i?void 0:i.site,o=(0,ta.H3)(null==r?void 0:r.domains),l=n?(0,s.jsx)(m.x6,{id:"3TQHDg",values:{0:o.length}}):(0,s.jsx)(m.x6,{id:"1EeNDU"});return(0,s.jsxs)(nd.D,{icon:(0,s.jsx)(x.g,{icon:u.MNJ,fixedWidth:!0}),onClick:t,alignItems:"baseline",children:[l,r&&(null==i?void 0:i.id)&&o.map(e=>(0,s.jsx)(xU,{domain:e,isLive:n,site:r,docId:i.id},e.id))]})},xq=e=>{let{doc:t}=e,{replace:i}=(0,e9.useRouter)(),{isInOfflineMode:n}=(0,ik.utY)(),a=(0,et.Iy)("manage",t),c=(0,eu.GV)(tr.Gd),h=null==t?void 0:t.id,g=(0,ta.tO)({site:c,docId:h}),{publishDoc:j,publishSite:f,isPublishing:v}=iB({doc:t,site:c,path:g}),{statusText:y,statusIcon:C,statusColor:w,lastPublishedTime:k,needsPublish:E,publishEnabled:S}=iK(v),I=c&&(0,ta.SG)(t,c),A=(0,b.useCallback)(()=>{h&&i((0,D.pF)({docId:h,preview:!0}),void 0,{shallow:!0})},[h,i]);if(!c)return null;let T=(0,eK.vT)("custom_domains");return(0,s.jsx)(r.s,{children:(0,s.jsxs)(e7.e,{isAttached:!0,size:"sm",children:[(0,s.jsx)(q.Tz,{closeOnMouseDown:!1,closeOnClick:!1,isDisabled:!S,label:E&&!v?(0,s.jsxs)(o.B,{children:[y,(0,s.jsx)(l.E,{color:"gray.400",children:(0,s.jsx)(m.x6,{id:"FmP7uY"})})]}):(0,s.jsx)(m.x6,{id:"o+bOqE"}),children:(0,s.jsx)(uJ.I,{fontWeight:"normal",size:"sm",variant:"solid",onClick:f,onMouseDown:uY.Fw,isDisabled:!S||n,isLoading:v,icon:E?(0,s.jsx)(x.g,{icon:u.MNJ}):(0,s.jsx)(x.g,{icon:u.e68}),"data-publish-button":!0,children:E?(0,s.jsx)(m.x6,{id:"EEYbdt"}):(0,s.jsx)(m.x6,{id:"u3wRF+"})})}),(0,s.jsxs)(no.W,{children:[(0,s.jsx)(nl.I,{variant:"solid",as:uJ.f,isDisabled:!S||n,icon:(0,s.jsx)(x.g,{icon:u.Jt$})}),(0,s.jsx)(L.Z,{children:(0,s.jsxs)(na.c,{zIndex:"popover",minW:"320px",maxW:"360px",children:[(0,s.jsx)(aj.r,{children:(0,s.jsxs)(tI.T,{alignItems:"flex-start",children:[(0,s.jsxs)(e8.z,{px:3,pt:2,alignItems:"center",color:w,children:[C&&(0,s.jsx)(d.a,{marginEnd:1.5,display:"inline-flex",children:C}),(0,s.jsx)(d.a,{children:(0,s.jsx)(l.E,{fontWeight:"semibold",children:y})})]}),k&&(null==t?void 0:t.site)&&(0,s.jsxs)(e8.z,{pb:2,mt:-1,children:[(0,s.jsx)(tA.h,{marginEnd:2,px:3,w:13}),(0,s.jsx)(l.E,{fontSize:"xs",color:"gray.500",children:I?k:(0,s.jsx)(m.x6,{id:"0bSVwO"})})]})]})}),a&&t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(sP.N,{}),(0,s.jsxs)(aj.r,{title:p.Ru._({id:"1EeNDU"}),children:[(0,s.jsx)(xK,{onClick:f,doc:t,isLive:!!I}),(0,s.jsx)(un,{label:(0,s.jsx)(m.x6,{id:"A/QS9E"}),showUpsellBadge:!T,settingsTab:"domains"})]})]}),(0,s.jsx)(sP.N,{}),(0,s.jsx)(aj.r,{title:p.Ru._({id:"Pf2dn/"}),children:(0,s.jsx)(nd.D,{icon:(0,s.jsx)(x.g,{icon:u.OFY,fixedWidth:!0}),onClick:j,alignItems:"baseline",children:(0,s.jsx)(m.x6,{id:"szmTdw"})})}),(0,s.jsx)(sP.N,{}),(0,s.jsx)(aj.r,{title:p.Ru._({id:"rdUucN"}),children:(0,s.jsx)(q.Tz,{label:(0,s.jsx)(m.x6,{id:"aChIoL"}),children:(0,s.jsx)(d.a,{children:(0,s.jsx)(nd.D,{onClick:A,icon:(0,s.jsx)(x.g,{icon:tT.qtl,fixedWidth:!0}),alignItems:"baseline",children:(0,s.jsx)(o.B,{spacing:"0",children:(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"Klm31l"})})})})})})})]})})]})]})})};var xY=i(49146),xJ=i(23908),xX=i(36693),x$=i(20061),xZ=i(3448);let xQ=e=>!!(null==e?void 0:e.workspaceAccess),x0=e=>{var t;return null==e||null==(t=e.accessLinks)?void 0:t[0]},x1=e=>{var t;return!!(null==(t=x0(e))?void 0:t.permission)},x6=e=>{var t;return(null==(t=x0(e))?void 0:t.type)==="password"},x2=(e,t)=>{var i;return(null==e||null==(i=e.workspace)?void 0:i.id)!==(null==t?void 0:t.id)};var x5=i(76983),x3=i(72737);let x4=()=>(0,s.jsx)(d.a,{children:"Settings"}),x8=[{key:"share",label:(0,s.jsx)(m.x6,{id:"Z8lGw6"}),icon:(0,s.jsx)(x.g,{icon:u.t5Z,fixedWidth:!0})},{key:"export",label:(0,s.jsx)(m.x6,{id:"GS+Mus"}),icon:(0,s.jsx)(x.g,{icon:u.a_I,fixedWidth:!0})},{key:"embed",label:(0,s.jsx)(m.x6,{id:"KKBlUU"}),icon:(0,s.jsx)(x.g,{icon:u.jTw,fixedWidth:!0})}],x7=e=>x8.filter(t=>{var i;return null==(i=e[t.key])||i});var x9=i(28847);let he=e=>{let{children:t}=e;return(0,s.jsx)(l.E,{fontSize:"sm",children:t})},ht=e=>{let{file:t,currentPage:i,onShareAndSettingsOpen:n,onShareAndSettingsClose:r}=e,l=(0,b.useMemo)(()=>(0,D.Wp)({docId:i.id,docTitle:i.title}),[i.id,i.title]);return(0,s.jsxs)(o.B,{children:[(0,s.jsx)(he,{children:(0,s.jsx)(m.x6,{id:"2QJhbq",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}})}),(0,s.jsx)(x9.h,{embedCode:l,docId:i.id,isDisabled:!1}),(0,s.jsx)(nK.w,{onClose:r,onOpen:n,segmentEvent:tq.VV.GAMMA_PRO_UPSELL_SHARE_SETTINGS_REMOVE_WATERMARK,targetWorkspace:i.organization})]})},hi=()=>(0,s.jsx)(he,{children:(0,s.jsx)(m.x6,{id:"qwhOQ/",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}})});var hn=i(38822),hs=i.n(hn),hr=i(2252),ho=i(86574),hl=i(8077),ha=(i(76733),i(24729));let hd=e=>{let{channel:t,file:i,isDisabled:n,showDisabledIcon:o=!1}=e,l=(0,b.useCallback)(()=>{if(!i)return},[i]),c=(0,D.gU)({slug:t.slug,id:t.id});return(0,s.jsxs)(e8.z,{py:2,w:"100%",justify:"space-between","data-testid":"workspace-row-".concat(t.id),children:[(0,s.jsx)(d.a,{children:(0,s.jsxs)(r.s,{alignItems:"center",children:[(0,s.jsx)(hl.$,{icon:ha.$Q,showDisabled:o}),(0,s.jsx)(d.a,{ms:3,opacity:o?.5:1,children:(0,s.jsx)(iJ.N,{href:c,target:"_blank",children:t.name})})]})}),(0,s.jsx)(a.$,{size:"sm",variant:"hazardous",onClick:l,isDisabled:n,children:(0,s.jsx)(m.x6,{id:"t/YqKh"})})]},t.id)},hc=e=>{let t=x6(e),i=x1(e),n=xQ(e);return i&&n?t?(0,s.jsx)(m.x6,{id:"VwUyn6"}):(0,s.jsx)(m.x6,{id:"6yx6yp"}):i&&!n?t?(0,s.jsx)(m.x6,{id:"3S234t"}):(0,s.jsx)(m.x6,{id:"4yEe3w"}):!i&&n?(0,s.jsx)(m.x6,{id:"k/3XD1"}):(0,s.jsx)(m.x6,{id:"Lkjre5"})},hu=(e,t)=>{let i="collaborator"===e.type?e.user.displayName||"":"invitation"===e.type?e.email:"",n="collaborator"===t.type?t.user.displayName||"":"invitation"===t.type?t.email:"";return i.localeCompare(n,void 0,{sensitivity:"base",numeric:!0})},hx=(e,t)=>{if(e.permission!==t.permission){if("manage"===e.permission)return -1;if("manage"===t.permission)return 1}return hu(e,t)},hh=e=>{var t,i,n;let{file:r}=e,{user:l}=(0,xC.u)(),a=xQ(r),d=(null==r?void 0:r.workspaceAccess)||hr.F$.NoAccess,{currentWorkspace:c}=(0,xC.u)(),h=!x2(r,c),g=!!(!a&&r.channels.length>0&&r.channels.every(e=>hs()(e.permission))),j=(0,b.useMemo)(()=>r.collaborators.map(e=>({type:"collaborator",...e})),[r.collaborators]),f=(0,b.useMemo)(()=>r.invitations.map(e=>({type:"invitation",...e})),[r.invitations]),v=(0,b.useMemo)(()=>[...j,...f].sort(hx),[j,f]),y=j.filter(e=>e.permission===ik.aXG.Manage).length,C=null==(t=r.workspace)?void 0:t.id;return l&&C?(0,s.jsxs)(o.B,{children:[(0,s.jsx)(he,{children:hc(r)}),(0,s.jsx)(ho._,{title:(0,s.jsx)(m.x6,{id:"wtxjAY"}),subtitle:a?hr.ef[d].longDescription(null==(i=r.workspace)?void 0:i.name):"",img:(0,s.jsx)(hl.$,{icon:u.URI,showDisabled:!a}),isDisabled:!0,disabledText:hr.ef[d].title(),permissionsControl:(0,s.jsx)(hr.qk,{isDisabled:!0,selected:d,options:[ik.aXG.Manage,ik.aXG.Edit,ik.aXG.Comment,ik.aXG.View,hr.F$.NoAccess],onClick:()=>{}})}),h&&(null==(n=r.channels)?void 0:n.map(e=>(0,s.jsx)(hd,{channel:e,file:r,isDisabled:!0,showDisabledIcon:g},e.id))),(0,s.jsx)(le.S,{in:h&&g,children:(0,s.jsxs)(iP.F,{status:"warning",children:[(0,s.jsx)(iz._,{}),(0,s.jsx)(m.x6,{id:"RZRM4l",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}})]})}),(0,s.jsx)(iD.c,{}),v.map(e=>{let t=e.permission===ik.aXG.Manage&&y<2?p.Ru._({id:"0q0LJR"}):void 0,i=hr.ef[e.permission].title();if("collaborator"===e.type){let n=e.user;return(0,s.jsx)(ho._,{testId:n.email,title:"".concat(n.displayName," ").concat(n.id===l.id?p.Ru._({id:"dDUgzP"}):""),img:(0,s.jsx)(aN.e,{name:n.displayName,src:n.profileImageUrl,size:"sm"}),subtitle:void 0,isDisabled:!0,disabledText:i,tooltipText:t,workspaceGuestInvite:void 0,permissionsControl:(0,s.jsx)(hr.qk,{isDisabled:!0,selected:e.permission,options:[ik.aXG.Manage,ik.aXG.Edit,ik.aXG.Comment,ik.aXG.View],disabledOptions:e.guest?[{permission:ik.aXG.Manage,reason:p.Ru._({id:"Rxin92"})}]:[],onClick:()=>{},onRemove:()=>{}})},n.id)}return"invitation"===e.type?(0,s.jsx)(ho._,{testId:e.email,title:e.email,subtitle:p.Ru._({id:"MActeE"}),img:(0,s.jsx)(sc.j,{bg:"deepocean.50",size:8,children:(0,s.jsx)(x.g,{icon:u.y_8,size:"sm"})}),isDisabled:!0,disabledText:i,permissionsControl:(0,s.jsx)(hr.qk,{selected:e.permission,options:[ik.aXG.Manage,ik.aXG.Edit,ik.aXG.Comment,ik.aXG.View],disabledOptions:[{permission:ik.aXG.Manage,reason:p.Ru._({id:"Rxin92"})}],onClick:()=>{},onRemove:()=>{}})},e.email):null})]}):null},hm=e=>{let{file:t,currentPage:i,onShareAndSettingsOpen:n,onShareAndSettingsClose:r}=e,o=x7({share:!0,export:!0,embed:(0,et.Iy)("manage",t)}),[l,a]=(0,b.useState)(0),c=(0,V.dU)("gray.100","titanium.700");return(0,s.jsx)(d.a,{children:(0,s.jsxs)(xY.t,{variant:"soft-rounded",index:l,onChange:a,orientation:"vertical",size:"sm",isLazy:!0,children:[(0,s.jsx)(xJ.w,{borderInlineEndWidth:"1px",borderColor:c,w:"2xs",pe:2,children:o.map(e=>(0,s.jsxs)(xX.o,{display:"flex",gap:2,alignItems:"center",justifyContent:"flex-start",textAlign:"start",children:[(0,s.jsx)(d.a,{as:"span",children:e.icon}),(0,s.jsx)(d.a,{as:"span",noOfLines:1,children:e.label})]},e.key))}),(0,s.jsx)(x$.T,{children:o.map(e=>(0,s.jsxs)(xZ.K,{pt:0,children:["share"===e.key&&(0,s.jsx)(hh,{file:t}),"export"===e.key&&(0,s.jsx)(hi,{}),"embed"===e.key&&(0,s.jsx)(ht,{file:t,currentPage:i,onShareAndSettingsOpen:n,onShareAndSettingsClose:r})]},e.key))})]})})},hp=e=>{let{isShareAndSettingsOpen:t,onShareAndSettingsOpen:i,onShareAndSettingsClose:n,onAnalyticsPanelOpen:l,file:c,currentPage:h,isDark:p=!1}=e,{isConnected:g}=(0,E.u)(),{user:j,currentWorkspace:f,isGammaAdminUser:v}=(0,nv.ur)(),y=(0,x3.ZP)(c,j),C=y?(0,x3.bC)()[y]:null,w=x2(c,f),k=(null==c?void 0:c.title)||(0,s.jsx)(m.x6,{id:"wja8aL"}),S=(0,nv.Iy)("manage",c)||v,I=c&&S&&l,A=x1(c),T=xQ(c),R=(0,b.useMemo)(()=>{var e,t;return(0,D.LN)({docTitle:null==h?void 0:h.title,docId:null==h?void 0:h.id,token:null==h||null==(t=h.accessLinks)||null==(e=t[0])?void 0:e.token,absolute:!0})},[h]),{hasCopied:_,onCopy:O}=(0,lL.i)(R),P=(0,iI.d)(),z="link-copied-toast",M=(0,b.useCallback)(()=>{n()},[n]),L=(0,b.useCallback)(()=>{l&&(n(),l())},[l,n]),[N,F]=(0,b.useState)(0),V=!c||!h;return(0,s.jsx)(q.L8,{isDark:p,children:(0,s.jsxs)(i1.aF,{onEsc:M,isOpen:t,onClose:n,trapFocus:!0,size:"4xl",returnFocusOnClose:!1,children:[(0,s.jsx)(i6.m,{}),(0,s.jsxs)(i2.$,{mx:2,children:[(0,s.jsxs)(iR.r,{children:[C&&(0,s.jsx)(d.a,{as:"span",me:3,children:(0,s.jsx)(x5.l,{visibility:C,isFromOtherOrg:w})}),k?(0,s.jsx)(m.x6,{id:"sit2to",values:{displayName:k}}):(0,s.jsx)(m.x6,{id:"Z8lGw6"})]}),(0,s.jsx)(i_.s,{onClick:M}),V&&(0,s.jsx)(iO.c,{pb:6,children:(0,s.jsxs)(o.B,{children:[(0,s.jsx)(dA.E,{height:14}),(0,s.jsx)(dA.E,{height:14}),(0,s.jsx)(dA.E,{height:14}),(0,s.jsx)(dA.E,{height:14})]})}),!V&&(0,s.jsx)(iO.c,{pb:6,children:(0,s.jsxs)(xY.t,{variant:"line",index:N,onChange:F,children:[(0,s.jsxs)(xJ.w,{children:[(0,s.jsx)(xX.o,{children:(0,s.jsx)(m.x6,{id:"QJX5AO"})}),(0,s.jsx)(xX.o,{children:(0,s.jsx)(m.x6,{id:"Tz0i8g"})})]}),(0,s.jsxs)(x$.T,{children:[(0,s.jsx)(xZ.K,{px:"0",children:(0,s.jsx)(hm,{file:c,currentPage:h,onShareAndSettingsOpen:i,onShareAndSettingsClose:n})}),(0,s.jsx)(xZ.K,{px:"0",children:(0,s.jsx)(x4,{})})]})]})}),0===N&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(iD.c,{}),(0,s.jsx)(i3.j,{children:(0,s.jsxs)(r.s,{justifyContent:"space-between",flex:1,children:[I&&(0,s.jsx)(a.$,{isDisabled:!g,leftIcon:(0,s.jsx)(x.g,{icon:u.q9c}),variant:"ghost",onClick:L,children:(0,s.jsx)(m.x6,{id:"YaUqUV"})}),(0,s.jsx)(tA.h,{}),(0,s.jsx)(a.$,{leftIcon:(0,s.jsx)(x.g,{icon:_?u.e68:u.KTq}),isDisabled:V,onClick:()=>{V||(O(),P.isActive(z)||P({id:z,title:(0,s.jsx)(m.x6,{id:"M9+w77"}),description:A?void 0:T?(0,s.jsx)(m.x6,{id:"k/3XD1"}):(0,s.jsx)(m.x6,{id:"Lkjre5"}),status:A?"success":"info",duration:5e3,position:"top"}),(0,lN.Jp)({fileId:c.id,source:"sharePanel"}))},variant:"ghost",children:(0,s.jsx)(m.x6,{id:"RGCCrg"})})]})})]})]})]})})};var hg=i(43787);let hj=e=>{var t,i;let{file:n,currentPage:r,showButton:o}=e,{isOpen:a,onClose:c,onOpen:u}=(0,iN.E)({id:"shareAndSettingsModalDisclosure"}),{isOpen:x,onClose:h,onOpen:p}=(0,iN.E)({id:"analyticsModalDisclosure"}),g=(0,nv.Iy)("view",n),j=(0,nv.Iy)("edit",n),f=(0,nv.Iy)("manage",n),{user:v,currentWorkspace:b}=(0,nv.ur)(),y=(0,ee.rd)();if(!g||!v||!n)return null;let C=(0,x3.ZP)(n,v),w=C?(0,x3.bC)()[C]:null,k=x2(n,b),E=n.collaborators,S=n.channels,I=(0,hg.e7)([...E].sort((e,t)=>e.user.id===v.id?-1:+(t.user.id===v.id)).map(e=>e.user.id===v.id?"You":e.user.displayName||"").concat(n.workspaceAccess?S.map(e=>{let{name:t}=e;return t||""}):[]));return null===w?(console.error("[ShareAndSettings] Unknown VisibilityValue for file",n),null):(0,s.jsxs)(s.Fragment,{children:[o&&(0,s.jsx)(q.Tz,{label:(0,s.jsxs)(s.Fragment,{children:[k&&(0,s.jsx)(l.E,{fontWeight:"bold",children:(0,s.jsx)(m.x6,{id:"OS9x6e",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}})}),w.title(null==n||null==(t=n.workspace)?void 0:t.name)?(0,s.jsx)(l.E,{children:w.title(null==n||null==(i=n.workspace)?void 0:i.name)}):null,(0,s.jsx)(l.E,{fontSize:"xs",children:w.subtitle?w.subtitle(I||""):""})]}),children:(0,s.jsx)(d.a,{children:(0,s.jsx)(uJ.I,{"data-guider-highlight":"share-button",onMouseDown:uY.Fw,icon:(0,s.jsx)(d.a,{children:(0,s.jsx)(x5.l,{visibility:w,isFromOtherOrg:k})}),isDisabled:!j,onClick:u,children:(0,s.jsx)(m.x6,{id:"Z8lGw6"})})})}),(0,s.jsx)(hp,{isShareAndSettingsOpen:a,onShareAndSettingsOpen:u,onShareAndSettingsClose:c,onAnalyticsPanelOpen:p,file:n,currentPage:r,isDark:y}),x&&r&&(0,s.jsx)(cY,{doc:r,file:n,onSharePanelOpen:u,onAnalyticsPanelClose:h,isAnalyticsPanelOpen:x,mode:f?"full":"personal"})]})};var hf=i(11525),hv=i(72480);let hb=e=>{var t,i;let{doc:n,file:r,showAnalytics:o=!0,showSharePublic:a=!0,showEmbed:c=!0,showButton:u=!0}=e,{isOpen:x,onClose:h,onOpen:p}=(0,iN.E)({id:"analyticsModalDisclosure"}),{isSharePanelOpen:g,onSharePanelOpen:j,onSharePanelClose:f,view:v,setView:y}=(0,hf.R)(),{isInOfflineMode:C}=(0,E.u)(),{user:w,currentWorkspace:k}=(0,et.ur)(),{editor:S}=(0,t5.mi)(),I=(0,et.Iy)("view",n),A=(0,et.Iy)("edit",n),T=(0,et.Iy)("manage",n),R=(0,Q.st)(),[D,P]=(0,b.useState)(""),{query:z}=(0,e9.useRouter)();(0,_.o)("showAnalytics"),(0,b.useEffect)(()=>iY.R.on("openSharePanel",e=>{let{view:t,options:i}=e;j(),y(t),(null==i?void 0:i.cardRangesInput)&&P(i.cardRangesInput)}),[j,y]);let M=(0,b.useCallback)(()=>{null==R||R.track(Q.VV.DOC_ANALYTICS_VIEWED,{docId:null==n?void 0:n.id,source:"true"===z.showAnalytics?"query_param":"share_panel",type:T?"full":"personal",device:(0,O.ZI)()}),p()},[R,z,T,null==n?void 0:n.id,p]),L=!!(null==n?void 0:n.site);if((0,b.useEffect)(()=>{L||"true"!==z.showAnalytics||M()},[z,L,M]),!I||!w||!n)return null;let N=n.collaborators||[],F=n.channels||[],V=(0,hg.e7)([...N].sort((e,t)=>e.user.id===w.id?-1:+(t.user.id===w.id)).map(e=>e.user.id===w.id?"You":e.user.displayName||"").concat(n.orgAccess?F.map(e=>{let{name:t}=e;return t||""}):[])),G=(0,x3.ZP)(n,w),W=G?(0,x3.bC)()[G]:null,B=(0,x3.D5)(n,k);return null===W?(console.error("[SharePanel] Unknown VisibilityValue for doc",n),null):(0,s.jsxs)(s.Fragment,{children:[u&&(0,s.jsx)(q.Tz,{label:(0,s.jsxs)(s.Fragment,{children:[B&&(0,s.jsx)(l.E,{fontWeight:"bold",children:(0,s.jsx)(m.x6,{id:"OS9x6e",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}})}),W.title(null==n||null==(t=n.organization)?void 0:t.name)?(0,s.jsx)(l.E,{children:W.title(null==n||null==(i=n.organization)?void 0:i.name)}):null,(0,s.jsx)(l.E,{fontSize:"xs",children:W.subtitle?W.subtitle(V||""):""})]}),children:(0,s.jsx)("span",{children:(0,s.jsx)(uJ.I,{"data-guider-highlight":"share-button",onMouseDown:uY.Fw,icon:(0,s.jsx)(d.a,{children:(0,s.jsx)(x5.l,{visibility:W,isFromOtherOrg:B})}),isDisabled:!A||C,onClick:j,children:(0,s.jsx)(m.x6,{id:"Z8lGw6"})})})}),(0,s.jsx)(hv._,{doc:n,editor:S,isSharePanelOpen:g,onSharePanelOpen:j,onSharePanelClose:f,onAnalyticsPanelOpen:M,view:v,setView:y,showAnalytics:o,showSharePublic:a,showEmbed:c,cardRangesInput:D,setCardRangesInput:P}),x&&(0,s.jsx)(cY,{doc:n,file:r,onSharePanelOpen:j,onAnalyticsPanelClose:h,isAnalyticsPanelOpen:x,mode:T?"full":"personal"})]})},hy=(0,b.memo)(e=>{let{doc:t,onClick:i}=e,{isConnected:n,isInOfflineMode:d}=(0,E.u)(),c=(null==t?void 0:t.title)||"";return(0,s.jsxs)(r.s,{flex:1,w:32,children:[(0,s.jsx)(q.Tz,{label:(0,s.jsxs)(o.B,{spacing:0,children:[(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"g/+TNk"})}),(0,s.jsx)(l.E,{color:"gray.500",children:(0,s.jsx)(m.x6,{id:"ZfQLKw"})})]}),isDisabled:d,"aria-label":p.Ru._({id:"g/+TNk"}),children:(0,s.jsx)(a.$,{size:"sm",variant:"ghost",fontWeight:"normal",ms:"-0.675rem",leftIcon:(0,s.jsx)(x.g,{icon:u.Nnc}),onClick:i,isDisabled:d,children:(0,s.jsx)(l.E,{isTruncated:!0,whiteSpace:"nowrap",textOverflow:"ellipsis",w:"100%",children:c})})}),!n&&(0,s.jsx)(q.Tz,{label:(0,s.jsxs)(o.B,{spacing:0,children:[(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"ysdDIA"})}),d&&(0,s.jsx)(l.E,{color:"gray.500",children:(0,s.jsx)(m.x6,{id:"+QNhGE"})})]}),"aria-label":p.Ru._({id:"IcHxhR"}),children:(0,s.jsx)(r.s,{color:"gray.500",alignItems:"center",me:2,children:(0,s.jsx)(x.g,{icon:u.seF})})})]})});hy.displayName="EditableDocTitle";let hC=e=>(0,s.jsx)(hw,{...e}),hw=(0,b.memo)(e=>{let{doc:t,togglePagesPanel:i}=e,n=(0,$.fW)(),[o]=(0,xI.F)(em.E.lastHomeUrl,"/"),a=(0,eu.GV)(tr.Gd),{confirmNavigation:c}=(0,t5.mi)(),{push:h}=(0,e9.useRouter)(),m={as:v(),passHref:!0,href:o||"/","data-testid":"toolbar-home-link"},{separatorColor:p,textColor:g}=(0,xA.l)();return(0,s.jsx)(e8.z,{flex:1,children:(0,s.jsxs)(e8.z,{spacing:3,divider:(0,s.jsx)(d.a,{border:"none",as:x.g,icon:n?u.Wzs:u.XkK,size:"sm",color:p}),w:"100%",children:[(0,s.jsx)(d.a,{...m,onClick:e=>{!e.shiftKey&&(e.metaKey||e.ctrlKey)||(e.preventDefault(),c().then(()=>{h(m.href)}))},children:(0,s.jsx)(xA.Z,{})}),a&&(null==a?void 0:a.routes.length)>1&&(0,s.jsx)(r.s,{flexGrow:0,flexShrink:1,textColor:g,children:(0,s.jsx)(l.E,{noOfLines:1,fontWeight:"normal",fontSize:"sm",children:null==a?void 0:a.name})}),(0,s.jsx)(hy,{doc:t,onClick:()=>{null==i||i()}})]})})});hw.displayName="SitesBreadcrumbGroup";let hk=e=>{let{spotlightingByBlock:t}=e,{editor:i}=(0,t5.mi)(),n=(0,b.useCallback)(()=>{t?null==i||i.commands.turnOffSpotlight():null==i||i.commands.spotlightNextBlock()},[i,t]);return(0,s.jsx)(r.s,{children:(0,s.jsx)(q.Tz,{closeOnMouseDown:!1,closeOnClick:!1,shortcut:"S",label:t?(0,s.jsx)(m.x6,{id:"CzYGrQ"}):(0,s.jsx)(m.x6,{id:"X1FNEK"}),children:(0,s.jsx)(uJ.I,{isSelected:t,onClick:e=>{n(),e.target.blur()},icon:(0,s.jsx)(x.g,{icon:u.lnn}),children:(0,s.jsx)(m.x6,{id:"k04a2t"})})})})};var hE=i(67310),hS=i(87291),hI=i(84646),hA=i(5747);let hT=(0,b.memo)(e=>{let{closePanel:t}=e,i=(0,hS.d)(),n=(0,eu.GV)(ex.SJ),o=(0,b.useCallback)(()=>{null==t||t(),ru.LF.emit(ru.DN.OPEN_PAGE_SETUP,"background")},[t]);return(0,s.jsx)(q.L8,{isDark:!1,children:(0,s.jsx)(t_.Z,{bgColor:"white",w:"100%","data-panelid":"doc-theme-drawer",pt:4,position:"relative","data-doc-theme-drawer":!0,children:(0,s.jsxs)(r.s,{direction:"column","data-testid":"doc-theme-drawer",overflowX:"hidden",w:"100%",children:[(0,s.jsx)(r.s,{px:6,children:(0,s.jsx)(hA.D,{title:(0,s.jsx)(m.x6,{id:"FEr96N"}),description:(0,s.jsx)(l.E,{fontSize:"sm",fontWeight:"500",mt:"-2",letterSpacing:0,color:"gray.600",children:(0,s.jsx)(m.x6,{id:"S9uQm/"})}),closePanel:t,currentTheme:n,usePanelHeading:!0})}),(0,s.jsx)(r.s,{overflowY:"auto",direction:"column",h:"100%",flex:1,"data-theme-picker-scroll-container":!0,px:6,mt:4,children:(0,s.jsx)(hI.oz,{currentTheme:n,openBackgroundPanel:o,setTheme:i})})]})})})});hT.displayName="DocThemePanelMemoized";let hR=e=>{let{closePanel:t}=e;return(0,s.jsx)(hT,{closePanel:t})};hR.displayName="DocThemePanel",hR.panelPosition="right",hR.panelName="doc-theme-drawer";let h_=()=>{let{togglePanel:e,isPanelOpen:t}=(0,eY.ww)(hR);return(0,b.useEffect)(()=>{let t=()=>{e({override:"open"})},i=iY.R.on("toggleThemeBlock",t),n=ru.LF.on(ru.DN.OPEN_THEME_DRAWER,t);return()=>{i(),n()}},[e]),{toggleDocThemePanel:e,isDocThemePanelOpen:t}},hO=(0,b.memo)(()=>{h_();let{getCollaborativeEditorInstance:e}=(0,tE.m)(),t=(0,hS.d)();return(0,s.jsx)(r.s,{children:(0,s.jsx)(hE.n,{onThemeCreated:t,getCollaborativeEditorInstance:e})})}),hD=(0,b.memo)(()=>{let{isConnected:e}=(0,ik.utY)();return(0,s.jsx)(q.Tz,{label:e?(0,s.jsx)(m.x6,{id:"JkEyR8"}):(0,s.jsxs)(o.B,{children:[(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"ysdDIA"})}),(0,s.jsx)(l.E,{color:"gray.300",children:(0,s.jsx)(m.x6,{id:"tyyf8W"})})]}),"aria-label":p.Ru._({id:"JkEyR8"}),children:(0,s.jsx)(d.a,{children:(0,s.jsx)(uJ.I,{"data-guider-highlight":"toolbar-theme-button",onClick:()=>{iY.R.emit("toggleThemeBlock",!0)},isDisabled:!e,icon:(0,s.jsx)(x.g,{icon:u.fyG}),"data-testid":"toolbar-theme-button",children:(0,s.jsx)(m.x6,{id:"FEr96N"})})})})});hD.displayName="ThemeToolbarButton";let hP=()=>{let{isConnected:e}=(0,ik.utY)();return(0,s.jsxs)(s.Fragment,{children:[e&&(0,s.jsx)(hO,{}),(0,s.jsx)(hD,{})]})};hO.displayName="ThemeDrawers";var hz=i(4007);let hM=[.5,.8,.9,1,1.1,1.2,1.5,2],hL=e=>"".concat((100*e).toFixed(0),"%"),hN=()=>{let e=(0,R.u)("presentZoom"),{editor:t}=(0,t5.mi)(),i=(0,Q.st)(),n=(0,y.wA)(),r=(0,eu.GV)(ex.eo),o=(0,b.useCallback)(e=>{n((0,ex.ed)({zoomLevel:e})),n((0,ex.i)({enabled:!1})),null==i||i.track(Q.VV.DOC_ZOOMED,{direction:"set",level:e})},[n,i]),d=(0,b.useCallback)(()=>{n((0,ex.i)({enabled:!0}))},[n]),c=(0,b.useCallback)(()=>{let e=Math.min(a5.ih,hF(r)+.1);n((0,ex.ed)({zoomLevel:e})),n((0,ex.i)({enabled:!1})),null==i||i.track(Q.VV.DOC_ZOOMED,{direction:"in",level:e})},[n,i,r]),h=(0,b.useCallback)(()=>{let e=Math.max(a5.At,hF(r)-.1);n((0,ex.ed)({zoomLevel:e})),n((0,ex.i)({enabled:!1})),null==i||i.track(Q.VV.DOC_ZOOMED,{direction:"in",level:e})},[n,i,r]),g=(0,b.useCallback)(()=>{let e=a5.vN;n((0,ex.ed)({zoomLevel:e})),n((0,ex.i)({enabled:!1})),null==i||i.track(Q.VV.DOC_ZOOMED,{direction:"reset",level:e})},[n,i]),j=(0,eu.GV)(hz.AO),f=(0,sB.Lt)();return((0,b.useEffect)(()=>{if(e)return eJ.WC.on("keydown","PRESENT_BLOCK",e=>{let i=e.target instanceof HTMLElement&&(0,ei.fg)(e.target);return!(j||!t||(0,sW.We)(t))&&!i&&((0,rS.Ay)("=")(e)?(c(),e.preventDefault(),!0):(0,rS.Ay)("-")(e)?(h(),e.preventDefault(),!0):(0,rS.Ay)("0")(e)?(g(),e.preventDefault(),!0):!!(0,rS.Ay)("9")(e)&&(d(),e.preventDefault(),!0))})},[j,e,t,c,h,g,d]),e)?(0,s.jsxs)(e7.e,{spacing:"0",size:"sm",variant:"ghost",isAttached:!0,borderWidth:"1px",borderRadius:"full",children:[(0,s.jsx)(q.Tz,{closeOnMouseDown:!1,closeOnClick:!1,shortcut:"-",label:p.Ru._({id:"FjkaiT"}),children:(0,s.jsx)(H.K,{"aria-label":p.Ru._({id:"FjkaiT"}),fontWeight:"normal",onClick:h,icon:(0,s.jsx)(x.g,{icon:u.EZy})})}),(0,s.jsxs)(no.W,{closeOnSelect:!0,children:[(0,s.jsx)(q.Tz,{label:p.Ru._({id:"VZ3UQG"}),children:(0,s.jsx)(nl.I,{minW:20,as:a.$,variant:"ghost",fontWeight:"400",size:"sm",rightIcon:(0,s.jsx)(x.g,{icon:u.Jt$}),children:f?(0,s.jsx)(m.x6,{id:"R9Khdg"}):hL(r)})}),(0,s.jsxs)(na.c,{maxW:"220px",children:[(0,s.jsx)(sO.i,{value:f?"auto":r.toString(),type:"radio",children:(0,s.jsx)(sD.k,{value:"auto",onClick:d,children:(0,s.jsxs)(e8.z,{children:[(0,s.jsxs)(l.E,{children:[(0,s.jsx)(m.x6,{id:"R9Khdg"})," ",(0,s.jsx)(l.E,{as:"span",color:"gray.500",children:(0,s.jsx)(m.x6,{id:"P9Cyl9"})})]}),(0,s.jsx)(tA.h,{}),(0,s.jsx)(l.E,{as:"span",opacity:"0.6",children:"9"})]})})}),(0,s.jsx)(sP.N,{}),(0,s.jsx)(sO.i,{value:f?"auto":r.toString(),type:"radio",children:hM.map(e=>(0,s.jsx)(sD.k,{value:(e/100).toString(),onClick:()=>{o(e)},children:(0,s.jsxs)(e8.z,{children:[(0,s.jsx)(l.E,{children:hL(e)}),(0,s.jsx)(tA.h,{}),e===a5.vN&&(0,s.jsx)(l.E,{as:"span",opacity:"0.6",children:"0"})]})},e))})]})]}),(0,s.jsx)(q.Tz,{closeOnMouseDown:!1,closeOnClick:!1,shortcut:"+",label:p.Ru._({id:"AWOSPo"}),children:(0,s.jsx)(H.K,{fontWeight:"normal","aria-label":p.Ru._({id:"AWOSPo"}),onClick:c,icon:(0,s.jsx)(x.g,{icon:u.QLR})})})]}):null},hF=e=>Math.round(10*e)/10,hV=(0,b.memo)(function(e){let{editor:t,scrollingParentSelector:n,toggleCommentsPanel:o,isCommentsPanelOpen:l,isSitePagesPanelOpen:a,toggleSitePagesPanel:d,isPagesPanelOpen:c,togglePagesPanel:u,editorWrapperEl:x,docEditorType:h,isDark:m}=e,[p]=(0,uK.U)(["(max-width: 840px)","(min-width: 841px)"]),g=(0,R.u)("editDocAI"),j=(0,eZ.h5)({base:!0,lg:!1}),f=(0,eu.GV)(ex.wC),v=(0,eu.GV)(e_.Jo),y=(0,eu.GV)(tr.Gd),{isGammaAdminUser:C}=(0,et.ur)(),w=(0,et.Iy)("comment",v),k=(0,iG.Gx)(),E=(0,iG.zm)(),{enabled:S}=(0,uq.k)(t),[I,T]=(0,b.useState)(void 0),_=(0,ta.dv)(y),D="SLIDE_VIEW"!==f,P="SLIDE_VIEW"===f,z=(0,eu.GV)(ex.nD),M=h===t2.i.COLLABORATIVE,L=(0,eu.GV)(ex.VJ),N=(0,eu.GV)((0,e1.DP)("left")),F=(0,eu.GV)((0,e1.DP)("right")),V=(0,R.u)("aiChat"),G=(0,eu.GV)(e_.nU),W=(0,R.u)("multipageEditor"),B=(0,et.Iy)("edit",G),{enterSlideView:U,exitSlideView:H,setExitedFullscreenByClick:K,isFullscreen:Y,enterFullscreen:J,exitFullscreen:X}=dy({editorWrapperEl:x,scrollingParentSelector:n,forceToolbarShownBecauseOnboarding:I});window.exportToPptx=async e=>{if(!t)return;let{exportToPptx:n}=await Promise.all([i.e(9685),i.e(6070),i.e(9935)]).then(i.bind(i,86897));return n(t,e)},(0,b.useEffect)(()=>A.R.on("isInOnboardingChecklist",e=>{T(e)}),[]);let $=(0,b.useRef)(null),Z=(0,b.useCallback)(()=>{var e;if(!$.current)return!1;let t=P&&(null==(e=$.current)?void 0:e.contains(document.activeElement));return!!($.current.querySelector("[data-active]")||$.current.querySelector('[aria-expanded="true"]')||N||F||t)},[$,N,F,P]),Q=eW(e=>Z()||e.clientY<100,!L,5e3);(0,uB.j)({ref:$,handler:()=>{setTimeout(()=>{var e;P&&(null==(e=$.current)?void 0:e.contains(document.activeElement))&&document.activeElement instanceof HTMLElement&&document.activeElement.blur()},10)}});let ee=!L||L&&(Z()||Q)||I,ei=!(0,O.Xb)(),en=!1===g&&!p&&j&&M&&z&&V;return(0,s.jsx)(q.L8,{isDark:m,children:(0,s.jsxs)(r.s,{"data-editor-toolbar":!0,ref:$,bg:m?"elevation.3":"white",borderBottomWidth:"1px",borderBottomColor:m?"gray.700":"blackAlpha.100",zIndex:e$.$.toolbar,insetStart:0,insetEnd:0,py:1.5,alignItems:"center",p:2,pe:6,gap:2,transform:ee?void 0:"translateY(-100%)",pointerEvents:"none",sx:{"&:focus-within":{marginTop:0},"> *":{pointerEvents:"auto"},"> #toolbar-spacer":{pointerEvents:"none"}},transitionProperty:"transform",transitionDuration:"normal",transitionTimingFunction:"ease-in-out","data-print-hidden":!0,children:[(0,s.jsx)(xO,{}),(0,s.jsx)(e8.z,{flex:1,children:W&&G?(0,s.jsx)(xR,{file:G,canEditFile:B,currentDocTitle:null==v?void 0:v.title,currentPageId:null==v?void 0:v.id,togglePagesPanel:u,isPagesPanelOpen:c}):y?(0,s.jsx)(hC,{doc:v,pagesPanelEnabled:k,isPagesPanelOpen:a,togglePagesPanel:d}):(0,s.jsx)(uZ.$x,{doc:v})}),(0,s.jsxs)(e8.z,{children:[!p&&(0,s.jsx)(u2,{}),!p&&!D&&(0,s.jsx)(hN,{}),!p&&!D&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(hk,{spotlightingByBlock:S})}),!p&&M&&z&&E&&(0,s.jsx)(hP,{}),(M||C)&&(W&&G?(0,s.jsx)(hj,{file:G,currentPage:v,showButton:!p}):(0,s.jsx)(hb,{doc:v,file:G,showButton:!p})),ei&&!_&&(0,s.jsx)(xG,{doc:v,isCollaborativeEditor:M,editorWrapperEl:x,scrollingParentSelector:n,enterSlideView:U,exitSlideView:H,setExitedFullscreenByClick:K,isFullscreen:Y,enterFullscreen:J,exitFullscreen:X,shouldHide:p,docEditorType:h}),ei&&_&&k&&(0,s.jsx)(xq,{doc:v}),M&&w&&(0,s.jsx)(xn,{doc:v,mode:f,isCommentsPanelOpen:l,toggleCommentsPanel:o}),g&&(z||C)?(0,s.jsx)(xk,{editor:t}):en?(0,s.jsx)(xs,{}):null,!p&&M&&!_&&(0,s.jsx)(u$,{doc:v,file:G}),!p&&(M||C)&&(0,s.jsx)(xD,{file:G,doc:v,toggleCommentsPanel:o,editorWrapperEl:x,scrollingParentSelector:n}),(0,s.jsx)(r.s,{children:(0,s.jsx)(iX.X,{showRing:!0})})]})]})})}),hG={src:"/_next/static/media/CustomCursorPointer.288ac219.svg"},hW=e=>!!(e.target&&e.target instanceof HTMLElement&&"IFRAME"===e.target.tagName),hB=(e,t)=>{var i;let n=Math.max((null==(i=t.posAtCoords(e))?void 0:i.inside)||-1);if(-1!=n)try{return t.state.doc.resolve(n)}catch(e){return}},hU=e=>"card"===e.type.name?!!(0,dx.Wq)(e.attrs.id):!!((0,ad.nf)(e)||["button","buttonGroup","tableOfContents","toggleSummary","docMention","cardMention"].includes(e.type.name)),hH=e=>!!(e.dataset.contentReference||e.dataset.zoomClickCapture),hK=(e,t)=>{if(!(null==t?void 0:t.nodeAfter))return!1;let i=t.nodeAfter;if("paragraph"===i.type.name)return!!(e.classList.contains("link")||e.closest(".link"));if(!(hU(i)||(0,tp.eL)(t,e=>hU(e))))return!1;if((0,uU.bi)(i.type)){let t=e.closest(".react-renderer");return!!t&&!!(hH(e)||(0,ei.xX)(e,t,hH))}return"gallery"!==i.type.name||!!e.closest(".gallery-content")},hq=(0,b.memo)(e=>{let{editor:t}=e,[i,n]=(0,b.useState)(!0),o=(0,b.useRef)({x:0,y:0}),l=(0,b.useRef)(null),a=(0,b.useRef)(null),c=(0,b.useRef)(null),u=(0,b.useRef)("none"),x=(0,eu.GV)(R.Gm),h=(0,eu.GV)(ex.uF),m=h[0],p=h[h.length-1],g=(0,eu.GV)(ex.$i),j=(0,b.useRef)("middle"),f=(0,eu.GV)(ex.eo),v=(0,eu.GV)(ex.G7),y=(0,eu.GV)(e=>{var t;return!!(null==(t=(0,ex.FI)(e))?void 0:t.pos)}),C=!1===v?Math.max(.75,f):1;j.current=g===m?"first":g===p?"last":"middle",(0,b.useEffect)(()=>{let e,i,s=e=>{l.current&&c.current&&(l.current.style.opacity=e?"1":"0",c.current.disabled=!e)},r=()=>{cancelAnimationFrame(e),e=requestAnimationFrame(()=>{if(!l.current||!a.current)return;let e=o.current.x-30*C/2,t=o.current.y-30*C/2;l.current.style.transform="translate(".concat(e,"px, ").concat(t,"px)"),"left"===u.current&&(l.current.style.transform+=" scaleX(-1)"),s("none"!==u.current)})},d=()=>{n(!0),clearTimeout(i),i=setTimeout(()=>{n(!1),r()},2e3)},x=e=>{d(),e&&(o.current={x:e.clientX,y:e.clientY});let i=o.current.x,n=o.current.y,s=null==e?void 0:e.target;if(!t||!l.current||!c.current||!s)return;if(e&&hW(e)){u.current="none",r();return}let a=i/window.innerWidth*100;if(a>20&&a<80||n<=51||!s.closest(".ProseMirror")||y||hK(s,hB({left:i,top:n},t.view))){u.current="none",r();return}u.current=a<=20?"left":"right",r()},h=()=>{u.current="none",r()},m=e=>{hW(e)&&(u.current="none",r())},p=e=>{if(d(),!t||e.button>1||(0,uH.Qj)(t.view))return;let i=(0,eu.KA)().getState(),n=!!(0,ex.YL)(i),s=(0,ex.nD)(i);n||s||["left","right"].includes(u.current)&&(e.preventDefault(),e.stopPropagation(),t.commands.spotlightNextCard("left"===u.current))};return x(),document.body.addEventListener("mousemove",x),document.body.addEventListener("mouseleave",h),document.body.addEventListener("mouseup",p),document.body.addEventListener("mouseover",m),()=>{document.body.removeEventListener("mousemove",x),document.body.removeEventListener("mouseleave",h),document.body.removeEventListener("mouseup",p),document.body.removeEventListener("mouseover",m),clearTimeout(i)}},[t,C,g,y]);let w="".concat(30*C,"px"),k="".concat(30*C,"px");return(0,s.jsxs)(L.Z,{children:[(0,s.jsx)("style",{ref:c,children:"html * { cursor: none!important}"}),(0,s.jsx)(hY,{position:"left",enabled:x}),(0,s.jsx)(hY,{position:"right",enabled:x}),(0,s.jsx)(r.s,{ref:l,position:"absolute",top:"0",left:"0",alignItems:"center",justifyContent:"center",className:"gamma-custom-cursor",width:w,height:k,pointerEvents:"none",willChange:"transform",verticalAlign:"middle",zIndex:"tooltip",filter:"drop-shadow(3px 1px 2px rgb(0 0 0 / 0.1))",outline:x?"2px solid pink":void 0,children:(0,s.jsx)(d.a,{ref:a,position:"absolute",width:w,height:k,sx:{"::before":{content:'""',opacity:+!!i,transition:"opacity 0.2s",display:"block",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundImage:"url(".concat(hG.src,")"),width:"100%",height:"100%"}}})})]})}),hY=e=>{let{position:t,enabled:i}=e;return i?(0,s.jsx)(d.a,{position:"absolute",top:"0",bottom:"0",left:"left"===t?"calc(".concat(20,"% - 1px)"):void 0,right:"right"===t?"calc(".concat(20,"% - 1px)"):void 0,width:"2px",height:"100%",zIndex:"tooltip",pointerEvents:"none",borderLeft:"2px dashed red"}):null};var hJ=i(32412);let hX=e=>{let t=(0,eu.GV)(ex.Er),i=(0,eu.GV)(ex.ys),{handlePresentNavigationEvent:n}=(0,hJ.e)(tq.Y2.PRESENTER_VIEW_POPUP);(0,b.useEffect)(()=>{if(!t)return;let s=t=>{let{payload:s}=t;if(e)try{let{payload:e}=JSON.parse(s),{action:t,eventKey:r,method:o,toSessionId:l,fromUserId:a}=e;if(l!==(null==i?void 0:i.sessionId)||a!==(null==i?void 0:i.id))return;switch(t){case"goToCard":{let{cardId:i}=e;if(!i)break;n({eventType:t,eventKey:r,method:o,payload:{cardId:i}});break}case"toggleSpotlight":case"arrowRight":case"arrowLeft":case"arrowDown":case"arrowUp":case"restart":case"toggleExpanded":case"cancelCurrentAction":n({eventType:t,eventKey:r,method:o});break;default:console.warn("[usePresenterViewMessages] Unknown message type",e)}}catch(e){console.error("[usePresenterViewMessages] Error parsing message",e)}};return t.on("stateless",s),()=>{t.off("stateless",s)}},[e,null==i?void 0:i.sessionId,null==i?void 0:i.id,n,t])},h$=e=>{let{editor:t,enabled:i}=e,n=(0,eu.jL)(),s=(0,b.useRef)(null),[r,o]=(0,b.useState)(!1),[l,a]=(0,b.useState)([0,0]),[d,c]=(0,b.useState)("bottom"),u=(0,eu.GV)(ex.YL),x=(0,b.useCallback)(()=>{o(!1)},[]),h=(0,b.useCallback)(()=>{a([0,0]),c("bottom")},[]),m=(0,b.useCallback)(e=>{o(!0),a(e)},[]),p=(0,b.useCallback)(e=>{var t;e.preventDefault(),m([e.clientX,e.clientY]);let i=null==(t=s.current)?void 0:t.offsetHeight;if(null==i)return;let n=window.innerHeight<e.clientY+i,r=e.clientY<i;n&&!r?c("top"):n&&r?c("center"):c("bottom")},[s,m]);(0,b.useEffect)(()=>{u||o(!1)},[u]),(0,b.useEffect)(()=>{if(t&&i)return ru.LF.on(ru.DN.OPEN_PRESENT_MODE_CONTEXT_MENU,e=>{let{e:t,pos:i,cardId:s}=e;p(t),n((0,ex.dd)({pos:i,cardId:s}))})},[t,i,p,n]);let g=(0,b.useMemo)(()=>{var e;let t=l[1],i=null==(e=s.current)?void 0:e.offsetHeight,n=i?window.innerHeight-(t+i+8):void 0,r="center"===d&&n?"translateY(".concat(n,"px)"):"top"===d?"translateY(-100%)":void 0;return{left:l[0],top:l[1],transform:r,transformOrigin:"top"}},[d,l]);return{menuRef:s,isPresentModeMenuOpen:r,onPresentModeMenuClose:x,handleContextMenu:p,menuRootStyles:g,clearPositioning:h}};var hZ=i(41876),hQ=i(40697),h0=i(4837);let h1=e=>{let{children:t,icon:i,onClick:n,shouldHide:r=!1,...o}=e;return r?null:(0,s.jsx)(nd.D,{icon:i,onClick:n,...o,children:t})},h6=(0,b.forwardRef)((e,t)=>{let{editor:i,isOpen:n,onClose:r,readOnly:o,clearPositioning:l,rootStyles:a}=e,[d,c]=(0,b.useState)(null),h=(0,hQ.SV)(t,c),{pos:p,cardId:g}=(0,eu.GV)(ex.P$),{enabled:j}=(0,ac.kY)(i),{editCardInPresentMode:f}=(0,h0.V)({editor:i}),v=(0,ee.rd)(),y=(0,b.useCallback)(()=>{j?null==i||i.commands.turnOffSpotlight():p?null==i||i.commands.spotlightNodeAtPos(p):g&&(null==i||i.commands.spotlightNextBlock()),r()},[j,p,g,r,null==i?void 0:i.commands]);return(0,b.useEffect)(()=>{var e;null==d||null==(e=d.parentElement)||e.addEventListener("contextmenu",e=>{e.preventDefault(),e.stopPropagation()})},[d]),(0,s.jsx)(L.Z,{children:(0,s.jsx)(q.L8,{isDark:v,children:(0,s.jsx)(no.W,{isOpen:n,closeOnBlur:!1,isLazy:!0,children:(0,s.jsxs)(na.c,{onContextMenu:e=>{e.preventDefault(),e.stopPropagation()},zIndex:"popover",ref:h,rootProps:{style:a},w:"260px",overflowY:"auto",onTransitionEnd:()=>{n||l()},children:[(0,s.jsx)(h1,{"data-testid":"present-mode-menu-item-edit",command:(0,q.lp)("E"),shouldHide:o,icon:(0,s.jsx)(x.g,{fixedWidth:!0,icon:u.zLW}),onClick:f,children:(0,s.jsx)(m.x6,{id:"IkOuqb"})}),(0,s.jsx)(h1,{"data-testid":"present-mode-menu-item-spotlight",command:(0,q.lp)("S"),icon:(0,s.jsx)(x.g,{fixedWidth:!0,icon:u.lnn}),onClick:y,children:j?(0,s.jsx)(m.x6,{id:"CzYGrQ"}):p?(0,s.jsx)(m.x6,{id:"LoLA00"}):g?(0,s.jsx)(m.x6,{id:"X1FNEK"}):null})]})})})})});h6.displayName="PresentModeContextMenuComponent";let h2=(0,b.memo)(h6);var h5=i(84718),h3=i(26604),h4=i.n(h3),h8=i(1252),h7=i(33750),h9=i.n(h7);let me={easeOutLinear:dV.GA,easeOutSine:dV.ED,easeOutCubic:dV.p_,easeOutCirc:dV.cY,easeOutQuad:dV.WD,easeOutQuart:dV.Mj,easeOutExpo:dV.lu,bezierCustom1:h4()(.13,.97,.035,.73),bezierCustom2:h4()(.105,1.15,.15,.355)},mt={UP:"up",DOWN:"down"},mi=e=>e?new Date-new Date(e):1/0,mn=(e,t)=>{let i=(0,b.useMemo)(()=>new h8.Lethargy(6,120,.3,150),[]),{easing:n="easeOutCubic",touchpadFactor:s=1.5,triggerThreshold:r=1200}=t||{},o=(0,Z.O2)("editor"),l=(0,eu.GV)(ex.$i),a=(0,b.useRef)(null),d=(0,b.useRef)(null),c=(0,b.useRef)(null),u=(0,b.useRef)(!1),x=(0,b.useRef)(null),h=(0,b.useRef)(null),[m,p]=(0,b.useState)(!1),[g,j]=(0,b.useState)(!1),f=(0,b.useRef)({counterTarget:0,counterCurrent:0,direction:mt.DOWN}),v=(0,b.useCallback)(()=>{var e;if(!a.current)return;let{counterTarget:t}=f.current,i=t/r*100,n=(null!=i?i:0)*2.64,s="".concat(n," ").concat(264-n),o=null==(e=a.current.querySelector(".chakra-progress"))?void 0:e.lastElementChild,l=a.current.querySelector(".chakra-progress__indicator");l&&l.setAttribute("stroke-dasharray",s),o&&(o.innerHTML="".concat(i.toFixed(0),"%"))},[r]),y=(0,b.useCallback)(()=>{let e=c.current,t=d.current;if(!t||!e)return;let i=e.querySelector(".chakra-progress__indicator"),s=t.querySelector(".chakra-progress__indicator");if(!i||!s)return;let o=f.current.counterCurrent/r,l=(550>mi(h.current)?1:null!=o?o:0)*264,a="".concat(l," ").concat(264-l),u=Math.max(56-56*me[n](Math.min(o,1)),0);e.style.transform="translateY(".concat(u,"px)"),t.style.transform="translateY(-".concat(u,"px)"),s.setAttribute("stroke-dasharray",a),i.setAttribute("stroke-dasharray",a)},[n,r]),C=(0,b.useCallback)(()=>{let e;if(u.current)return;let t=i=>{let n=e?i-e:0;if(e=i,.1>Math.abs(f.current.counterTarget-f.current.counterCurrent)){f.current.counterCurrent=f.current.counterTarget,y(),u.current=!1;return}f.current.counterCurrent=(0,dV.Cc)(f.current.counterCurrent,f.current.counterTarget,h9()(60/(n?1e3/n:60)*.3,.3,1)),y(),requestAnimationFrame(t)};requestAnimationFrame(t)},[y]),w=(0,b.useCallback)(()=>{f.current.counterTarget=0,p(!1),j(!1),v(),C()},[C,v]);return(0,b.useEffect)(()=>{let t,n;if(!l||!e)return w();let a=document.querySelector((0,a5.OB)(l));if(!a)return w();let u=t=>{if(t.target.closest("[data-comments-wrapper]"))return;let l=i.check(t);if(null===c.current||null===d.current)return;let a=mi(x.current);if(a<500||a<1e3&&!1===l)return;let u=mi(h.current);if(u<500||u<1e3&&!1===l)return;let m=0===Math.abs(t.deltaY)?f.current.direction:t.deltaY>0?mt.DOWN:mt.UP;if(!("down"===m?o.isAtBottom():o.isAtTop()))return;clearTimeout(n);let g=t.wheelDeltaY?t.wheelDeltaY===-3*t.deltaY:0===t.deltaMode,b=Math.abs(void 0!==t.deltaY?t.deltaY:40)*(g?s:1);if(m!==f.current.direction){f.current.direction=m,w();return}j(m===mt.DOWN),p(m===mt.UP),f.current.counterTarget+=b,f.current.direction=m,f.current.counterTarget/r>=1?(e.commands.spotlightNextCard(m===mt.UP,m===mt.UP?"bottom":"top"),h.current=+new Date,setTimeout(()=>{w(),v()},250),setTimeout(()=>{h.current=null},1e3)):n=setTimeout(w,500),C(),v()},m=()=>{x.current=+new Date,clearTimeout(t),w(),t=setTimeout(()=>{x.current=null},1e3)};return a.addEventListener("scroll",m),a.addEventListener("wheel",u,{passive:!0}),v(),()=>{a.removeEventListener("scroll",m),a.removeEventListener("wheel",u)}},[e,i,C,n,s,r,o,v,y,w,l]),{debugRef:a,nextCardRef:c,prevCardRef:d,showNextCard:g,showPrevCard:m}},ms=e=>{let{editor:t}=e,i=(0,R.u)("debugLogging"),[n,r]=(0,b.useState)("easeOutExpo"),[o,l]=(0,b.useState)(1.5),[a,d]=(0,b.useState)(1200),{debugRef:c,nextCardRef:u,prevCardRef:x,showNextCard:h,showPrevCard:m}=mn(t,{easing:n,touchpadFactor:o,triggerThreshold:a}),{prevCard:p,nextCard:g}=(0,eu.GV)(e=>{let t=(0,ex.$i)(e)||"",i=(0,ex.Ev)(e),n=Object.keys((i.parents[t]||[]).reduce((e,t)=>e[t],i.tree)),s=null,r=null;return n.forEach((e,o)=>{if(e!==t)return;let l=i.parents[t];0===o?l.length&&(s={cardId:l[l.length-1],isSibling:!1}):s={cardId:n[o-1],isSibling:!0},o===n.length-1?l.length&&(r={cardId:l[l.length-1],isSibling:!1}):r={cardId:n[o+1],isSibling:!0}}),{prevCard:s,nextCard:r}},tz()),j=null==g?void 0:g.cardId,f=null==p?void 0:p.cardId,v=(0,b.useMemo)(()=>{let e=null,i=null;return t&&t.state.doc.descendants(t=>!(0,tf.jg)(t)||(t.attrs.id===f?e=t:t.attrs.id===j&&(i=t),!!(!e&&f)||!!(!i&&j))),{prev:e,next:i}},[t,j,f]);return(0,s.jsxs)(s.Fragment,{children:[i&&(0,s.jsx)(mr,{ref:c,setEasing:r,setTouchpadFactor:l,setTriggerThreshold:d}),(0,s.jsx)(mo,{ref:x,direction:"up",node:v.prev,enabled:m,offset:16}),(0,s.jsx)(mo,{ref:u,direction:"down",node:v.next,enabled:h,offset:24})]})},mr=b.forwardRef((e,t)=>{let{setEasing:i,setTouchpadFactor:n,setTriggerThreshold:o}=e;return(0,s.jsxs)(r.s,{position:"absolute",alignItems:"center",bg:"gray.50",left:2,bottom:16,zIndex:"overlay",borderRadius:"md",border:"solid 2px var(--chakra-colors-trueblue-300)",p:1,children:[(0,s.jsxs)(no.W,{closeOnSelect:!1,children:[(0,s.jsx)(nl.I,{as:a.$,colorScheme:"trueblue",children:"Options"}),(0,s.jsxs)(na.c,{minWidth:"240px",children:[(0,s.jsx)(q.Tz,{label:"How much total scrolling work do we need to do to trigger next/prev card?",placement:"right",children:(0,s.jsxs)(l.E,{color:"gray",fontSize:"sm",fontWeight:"600",ml:2,pb:2,children:["Scroll Threshold"," ",(0,s.jsxs)("i",{children:["(default=",1200,")"]})]})}),(0,s.jsxs)(h5.Q7,{defaultValue:1200,min:100,max:1e4,precision:0,step:100,onChange:(e,t)=>o(t),children:[(0,s.jsx)(h5.OO,{}),(0,s.jsxs)(h5.lw,{children:[(0,s.jsx)(h5.Q0,{}),(0,s.jsx)(h5.Sh,{})]})]}),(0,s.jsx)(sP.N,{}),(0,s.jsx)(q.Tz,{label:"How much extra weight do we give to touchpad scroll events?",placement:"right",children:(0,s.jsxs)(l.E,{color:"gray",fontSize:"sm",fontWeight:"600",ml:2,pb:2,children:["Touchpad Multiplier"," ",(0,s.jsxs)("i",{children:["(default=",1.5,")"]})]})}),(0,s.jsxs)(h5.Q7,{defaultValue:1.5,min:1,max:10,precision:1,step:.1,onChange:(e,t)=>n(t),children:[(0,s.jsx)(h5.OO,{}),(0,s.jsxs)(h5.lw,{children:[(0,s.jsx)(h5.Q0,{}),(0,s.jsx)(h5.Sh,{})]})]}),(0,s.jsx)(sP.N,{}),(0,s.jsxs)(sO.i,{defaultValue:"easeOutExpo",title:"Easing (of peek element)",type:"radio",onChange:e=>i(e),children:[(0,s.jsx)(sD.k,{value:"easeOutLinear",children:"easeOutLinear"}),(0,s.jsx)(sD.k,{value:"easeOutSine",children:"easeOutSine"}),(0,s.jsx)(sD.k,{value:"easeOutCubic",children:"easeOutCubic"}),(0,s.jsx)(sD.k,{value:"easeOutCirc",children:"easeOutCirc"}),(0,s.jsx)(sD.k,{value:"easeOutQuad",children:"easeOutQuad"}),(0,s.jsx)(sD.k,{value:"easeOutQuart",children:"easeOutQuart"}),(0,s.jsx)(sD.k,{value:"easeOutExpo",children:"easeOutExpo"}),(0,s.jsx)(sD.k,{value:"bezierCustom1",children:"bezierCustom1"}),(0,s.jsx)(sD.k,{value:"bezierCustom2",children:"bezierCustom2"})]})]})]}),(0,s.jsx)(r.s,{ref:t,direction:"column",alignItems:"center",width:"85px",ml:1,sx:{".chakra-progress__indicator":{transition:"none !important",opacity:1}},children:(0,s.jsx)(xo.P,{value:40,color:"trueblue.500",children:(0,s.jsx)(xl.n,{})})})]})});mr.displayName="PeekDebugger";let mo=b.forwardRef((e,t)=>{let{direction:i,enabled:n,node:o,offset:a}=e,[d,c]=(0,b.useState)(!1),[h,m]=(0,b.useState)(o);(0,b.useEffect)(()=>{c(!0);let e=setTimeout(()=>{c(!1),m(o)},550);return()=>{clearTimeout(e)}},[o]);let p=(0,b.useMemo)(()=>h?(0,s1.getCardTitle)(h.toJSON()):"",[h]),g=!!h;return(0,s.jsx)(r.s,{ref:t,pointerEvents:"none",position:"absolute",justifyContent:"center",width:"100%",zIndex:"overlay",top:"up"===i?"".concat(a,"px"):"inherit",bottom:"down"===i?"".concat(a,"px"):"inherit",children:(0,s.jsxs)(r.s,{bg:"gray.50",borderRadius:"md",boxShadow:"md",h:"".concat(40,"px"),maxWidth:"450px",justifyContent:"center",opacity:+!!n,transition:"opacity ".concat(300,"ms ease-out"),textAlign:"center",alignItems:"center",direction:"row",px:2,sx:{".chakra-progress__indicator":{transition:"none !important",opacity:1}},children:[(0,s.jsx)(xo.P,{display:g?"block":"none",color:"trueblue.500",size:"20px",thickness:"16px",children:(0,s.jsx)(xl.n,{visibility:d?"visible":"hidden",children:(0,s.jsx)(x.g,{icon:u.QRE,fontSize:"14px",style:{color:"var(--chakra-colors-gray-50)",backgroundColor:"var(--chakra-colors-trueblue-500)",borderRadius:"10px"}})})}),g||"up"!==i?g||"down"!==i?null:(0,s.jsx)(x.g,{icon:u.uZL,size:"xs",color:"var(--chakra-colors-gray-600)"}):(0,s.jsx)(x.g,{icon:u.o9H,size:"xs",color:"var(--chakra-colors-gray-600)"}),(0,s.jsx)(r.s,{width:1}),(0,s.jsx)(l.E,{noOfLines:1,textOverflow:"ellipsis",overflowX:"hidden",fontSize:"md",color:g?"gray.700":"gray.600",px:2,children:g?p:"down"===i?"End of presentation":"Start of presentation"})]})})});mo.displayName="PeekCardTab";var ml=i(56760),ma=i(55670),md=i(33201),mc=i(86034);let mu=()=>{let[e,t]=(0,b.useState)(["",[],{}]),i=(0,eu.CU)();return(0,b.useEffect)(()=>i.subscribe(()=>{let e=i.getState(),n=(0,ex.Ev)(e),s=(0,ex.$i)(e)||"",r=n.parents[s]||[],o={};Object.keys(n.tree).forEach(e=>{let t=[],i=e=>{Object.keys(e).forEach(n=>{t.push(n),i(e[n])})};i(n.tree[e]),o[e]=t}),t([s,r,o])}),[i]),e},mx=e=>{let{editor:t,isEditing:i}=e,[n,r,o]=mu(),l=(0,eu.GV)(dk.ow),a=Object.keys(o).filter(e=>{var t;return!(null==l||null==(t=l[e])?void 0:t.hidden)}),[c,u]=(0,b.useState)(null),[x,h]=(0,b.useState)(!1),m=(0,eu.GV)(ex.SJ),{content:p}=(0,mc.S)(t),g=(0,b.useRef)(null),j=eW(e=>window.innerHeight-e.clientY<50),f=(0,b.useRef)({}),{handlePresentNavigationEvent:v}=(0,hJ.e)(),y=b.useMemo(()=>{let e=e=>{let{renderers:t}=e;return(0,s.jsx)(mm,{renderers:t,cardPreviewRefMap:f.current})};return e.displayName="PortalComponentWithRef",e},[]);return(0,b.useEffect)(()=>()=>{g.current&&clearTimeout(g.current)},[]),(0,s.jsxs)(e8.z,{position:"fixed",bottom:0,w:"100vw",zIndex:10,background:"blackAlpha.200",px:"6px",py:"2px",align:"end",spacing:"2px",opacity:+!!n,transitionProperty:"opacity, height",transitionDuration:"normal",h:j?"12px":"6px",children:[a.map((e,t)=>{let l=[...r,n][0],p=a.indexOf(l),b=o[l],y=0,C=100;return n&&b&&-1===a.indexOf(n)&&(y=(b.indexOf(n)+1)/b.length*100,C=1/b.length*100),(0,s.jsx)(mj,{cardId:e,state:t===p?"current":t<=p?"prev":"next",percent:y,unit:C,isMagnetized:j,isHovered:c===e,onHoverStart:()=>{u(e),g.current&&clearTimeout(g.current),g.current=setTimeout(()=>{h(!0)},200)},onHoverEnd:()=>{u(null),h(!1),g.current&&(clearTimeout(g.current),g.current=null)},onCardClick:()=>{e&&!i&&v({eventType:"goToCard",method:"buttonClick",payload:{cardId:e}})},children:(0,s.jsx)(d.a,{position:"absolute",transform:"translateY(calc(-100% - 6px))",w:"250px",h:"150px",bg:"white",borderRadius:"md",shadow:"lg",border:"1px solid",borderColor:"gray.200",pointerEvents:"none",overflow:"hidden",zIndex:11,display:c===e&&x?"block":"none",transitionProperty:"common",transitionDuration:"normal",transitionTimingFunction:"ease-in-out",children:(0,s.jsx)(mh,{cardId:e,cardPreviewRefMap:f.current,theme:m})},e)},e)}),(0,s.jsx)(s4.s,{}),(0,s.jsx)(d.a,{w:"0",h:"0",position:"absolute",pointerEvents:"none",children:(0,s.jsx)(s3.S,{theme:m,content:p,isThumbnail:!0,portalComponent:y})})]})},mh=(0,b.memo)(e=>{let{cardId:t,cardPreviewRefMap:i,theme:n}=e,o=(0,ma.S)(n,!1);return(0,s.jsx)(r.s,{className:"progress-bar-card-preview",sx:s3.o,css:{"--editor-width":"".concat(250,"px"),"--editor-font-size":"calc(var(--editor-width) / ".concat(ix.s5,")"),"--thumbnail-min-height":"".concat(150,"px")},justifyContent:"center",overflow:"hidden",bg:"gray.50",w:"100%",h:"100%",userSelect:"none",children:(0,s.jsx)("div",{className:"ProseMirror",children:(0,s.jsx)(r.s,{className:"doc-content-wrapper",direction:"column",align:"center",sx:o,children:(0,s.jsx)("div",{style:{width:"100%"},ref:e=>{e&&(i[t]=e)}})})})})});mh.displayName="CardPreview";let mm=e=>{let{renderers:t,cardPreviewRefMap:i}=e;return(0,s.jsx)(s.Fragment,{children:Object.entries(t).map(e=>{let[t,n]=e,s=n.props.node;if("document"===s.type.name)return null;let r=(0,md.jg)(s)?i[s.attrs.id]:null;return ml.createPortal(n.reactElement,r||n.element,t)})})},mp="var(--chakra-colors-deepocean-300)",mg="var(--chakra-colors-deepocean-100)",mj=e=>{let{children:t,cardId:i,state:n,percent:o,unit:l,isMagnetized:a,isHovered:d,onHoverStart:c,onHoverEnd:u,onCardClick:x}=e,h="linear-gradient(to right, ".concat(mp," 0% ").concat(o,"%, ").concat("var(--chakra-colors-deepocean-400)"," ").concat(o,"% ").concat(o+l,"%, ").concat(mg," ").concat(o+l,"% 100%)");return(0,s.jsx)(r.s,{flex:1,minW:0,borderRadius:"2px",h:a?"16px":"4px",transitionProperty:"all",transitionDuration:"normal",transitionTimingFunction:"ease-in-out",borderWidth:"1px",borderColor:d?"var(--chakra-colors-deepocean-400)":"transparent",onMouseEnter:e=>c(e.currentTarget),onMouseLeave:u,onClick:x,cursor:"pointer",bg:"current"===n?h:"prev"===n?mp:mg,justifyContent:"center",alignItems:"flex-start",children:t},i)},mf=(0,rS.Ay)("Esc"),mv=e=>{let{editor:t,showNavigationControls:i}=e,[n,o]=(0,b.useState)(null),d=(0,y.d4)(ex.QF),c=(0,b.useRef)(d),u=(0,y.wA)(),x=(0,im.UT)("edit"),h=(0,eR.u)("presentModeCursor"),p=(0,hZ.SQ)({enabled:!d,setActiveKey:o});hX(t);let{menuRef:g,isPresentModeMenuOpen:j,onPresentModeMenuClose:f,menuRootStyles:v,clearPositioning:C}=h$({editor:t,enabled:!0});return(0,b.useEffect)(()=>(u((0,ex._b)({isEditingInSlideView:!1})),()=>{u((0,ex._b)({isEditingInSlideView:!1}))}),[u]),c.current=d,(0,b.useEffect)(()=>eJ.WC.on("keydown","SLIDE_VIEW",e=>!!(c.current&&mf(e))&&(u((0,ex._b)({isEditingInSlideView:!1})),e.preventDefault(),!0)),[u]),(0,sB.FM)(),(0,uB.j)({ref:g,enabled:j,handler(e){e instanceof MouseEvent&&2!==e.button&&f()}}),(0,s.jsxs)(s.Fragment,{children:[t&&(0,s.jsx)(h2,{ref:g,editor:t,readOnly:!x,isOpen:j,onClose:f,clearPositioning:C,rootStyles:v}),(0,s.jsx)(ms,{editor:t}),(0,s.jsx)(mx,{editor:t,isEditing:d}),(0,s.jsx)(r.s,{position:"absolute",inset:0,width:"100%",height:"100%",pointerEvents:"none",justify:"flex-end",children:(0,s.jsxs)(r.s,{bg:"gray.50",position:"fixed",bottom:6,right:6,p:3,px:6,justify:"flex-end",align:"center",opacity:+!!d,pointerEvents:d?"auto":"none",transitionProperty:"opacity, transform",transitionDuration:"normal",transitionTimingFunction:"ease",transform:d?"translate(0,0)":"translate(0,100%)",borderRadius:"md",shadow:"md",zIndex:"overlay",children:[(0,s.jsx)(l.E,{size:"sm",marginEnd:3,children:(0,s.jsx)(m.x6,{id:"DjD/sG"})}),(0,s.jsx)(a.$,{size:"sm",variant:"solid",onClick:()=>u((0,ex._b)({isEditingInSlideView:!1})),children:(0,s.jsx)(m.x6,{id:"DPfwMq"})})]})}),h&&!d&&(0,s.jsx)(hq,{editor:t}),i&&(0,s.jsx)(hZ.Lh,{activeKey:n,spotlightingByBlock:p})]})};var mb=i(65016),my=i(39072),mC=i(94920);let mw=e$.$.filmstrip,mk=e$.$.filmstrip-1,mE={duration:.25,delay:.75},mS={duration:.25},mI="filmstrip-root",mA=".".concat(mI),mT="filmstrip-scroller",mR=".".concat(mT);var m_=i(41270),mO=i(23751);let mD=e=>{let{content:t,selection:i}=(0,mc.S)(e),n=!!(null==t?void 0:t.content),s=(0,b.useMemo)(()=>{var e;if(!n)return[];let i=t.content,s=(null==i?void 0:i[0].content)||[],r=null==(e=t.content)?void 0:e[0].attrs;return s.map(e=>{var t;return r&&(null==(t=e.attrs)?void 0:t.id)?{cardId:e.attrs.id,isDragging:!1,displayBehavior:"normal"}:null}).filter(e=>null!==e)},[t,n]),r=(0,eu.GV)(mO.j2,(e,t)=>tz()(e,t)).map(e=>s.find(t=>t.cardId===e.cardId)?{...e}:null).filter(e=>null!==e),o=(0,eu.GV)(mO.u9);return{isDragging:o,cards:o?r:s,editorContent:t,selection:i,isLoaded:n}};var mP=i(22115),mz=i(81946),mM=i(60122),mL=i(32380),mN=i(34034),mF=i(65280),mV=i(69460),mG=i(69872),mW=i(43182),mB=i(17226),mU=i(60277);let mH=(e,t)=>{let i=mM.Mj.getState(e.state).undoManager,n=i.undoStack[i.undoStack.length-1];n&&n.meta.set("filmstripState",t)},mK=e=>{let t=(0,eu.GV)(il.Mj),i=(0,eu.GV)(il.Nx),n=(0,eu.jL)(),r=(0,eu.CU)(),o=(0,iI.d)(),a=(0,mF.T)(),d=(0,b.useCallback)(i=>{if(!e)return;let n=(0,tf.V4)(e,t);if(!n.length)return;let r=sQ.FK.from(n);if(!(0,mB.E)(r,e,i))return void o({title:i?(0,s.jsx)(m.x6,{id:"33a+2Q"}):(0,s.jsx)(m.x6,{id:"FntfNT"}),status:"error",duration:3e3,position:"top"});o({title:i?(0,s.jsx)(m.x6,{id:"VG4BD6",values:{0:n.length,1:n.length}}):(0,s.jsx)(m.x6,{id:"GtH+14",values:{0:n.length,1:n.length}}),status:"success",duration:3e3,position:"top"})},[e,t,o]),c=(0,b.useCallback)(()=>{d(!1)},[d]),u=(0,b.useCallback)(()=>{if(!e)return;let i=(0,tf.V4)(e,t);i.length&&a(i)},[e,a,t]),x=(0,b.useCallback)(function(){let i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!e)return;let s=(0,il.zT)((0,eu.KA)().getState());n((0,il.Cj)()),e.commands.deleteCardsById(t,i),mH(e,s)},[n,e,t]),h=(0,b.useCallback)(()=>{if(!e||0===t.length)return;let i="";if(1===t.length){let n=(0,tf.W0)(e,t[0]);n&&(i=(0,mN.getCardTitle)(n.node.toJSON())||"")}x();let n=i?'"'.concat(i,'"'):p.Ru._({id:"FyJPFh"}),r=o({title:(0,s.jsxs)(e8.z,{children:[(0,s.jsx)(l.E,{noOfLines:1,children:(0,s.jsx)(m.x6,{id:"OJTPnC",values:{displayTitle:n,0:t.length,1:t.length}})}),(0,s.jsx)(iJ.N,{textDecoration:"underline",onClick:()=>{(0,mL.tN)(e.state),o.close(r)},children:(0,s.jsx)(m.x6,{id:"9uI/rE"})})]}),status:"info",duration:3e3,position:"top"})},[x,e,t,o]),g=(0,b.useCallback)(()=>{0!==t.length&&(d(!0),x(!0))},[x,d,t]),j=(0,b.useCallback)(()=>{if(!e||0===t.length)return;let r=(0,tf.V4)(e,t);if(r.length){let t=(0,tf.W0)(e,i),l=t?t.pos+t.node.nodeSize:e.state.doc.content.size-1,a=r.map(e=>(0,to.RE)(oe()(e.toJSON()))).map(e=>(0,mW.iM)(e)),d=(0,il.zT)((0,eu.KA)().getState());e.chain().insertContentAt(l,a,{updateSelection:!1}).command(e=>{let{tr:t}=e,i=(0,ot.s)(t.doc.resolve(l));return i&&(t=t.setSelection(i)),t.setMeta(mU._,!0),t.setMeta(mV.G,!0),!0}).scrollIntoView().run(),mH(e,d),n((0,il.B6)({beforeCardId:null==t?void 0:t.node.attrs.id,cardCount:a.length})),o({title:(0,s.jsx)(m.x6,{id:"ClnFsQ",values:{0:r.length,1:r.length}}),status:"success",duration:3e3,position:"top"})}},[n,e,i,o,t]);return{handleAddCard:(0,b.useCallback)(t=>{if(!e)return;let i=(0,il.Nx)((0,eu.KA)().getState());i||(i=(0,il.gM)((0,eu.KA)().getState()));let s=(0,tf.W0)(e,i);if(!s)return;let{pos:r}=s,o=e.view.state.doc.nodeAt(r);if(!o)return void console.error("[Filmstrip] Cannot append card. Node unknown");let l=r+o.nodeSize,{cardToAdd:a,command:d}=(0,mG.j)(t);(0,rG.Jb)(d,tq.oU.FILMSTRIP_CARD_MENU);let c=(0,il.zT)((0,eu.KA)().getState());e.chain().insertContentAt(l,(0,mW.iM)(a),{updateSelection:!1}).command(e=>{let{tr:t}=e,i=(0,ot.s)(t.doc.resolve(l));return i&&(t=t.setSelection(i)),t.setMeta(mU._,!0),t.setMeta(mV.G,!0),!0}).scrollIntoView().run(),e.commands.focus(),mH(e,c),n((0,il.B6)({beforeCardId:null==s?void 0:s.node.attrs.id,cardCount:1}))},[n,e]),handleCopy:c,handleCopyCardsToDeck:u,handleCut:g,handleDelete:h,handleDuplicate:j,handleExport:(0,b.useCallback)(()=>{if(!e||0===t.length)return;let i=(0,ex.uF)(r.getState()),n=t.map(e=>(i.indexOf(e)+1).toString());iY.R.emit("openSharePanel",{view:"export",options:{cardRangesInput:n.join(",")}})},[e,t,r])}},mq=e=>({backgroundColor:e?"gray.600":"gray.200",activeButtonColor:e?"gray.50":"trueblue.500",inactiveButtonColor:e?"gray.50":"gray.800",closeButtonColorScheme:e?"gray":"blackAlpha"}),mY=e=>{let{onClose:t,isDark:i,viewPreference:n,setViewPreference:o,editor:l,readOnly:c}=e,h="list"===n,{activeButtonColor:g,inactiveButtonColor:j,backgroundColor:f,closeButtonColorScheme:v}=mq(i),y=(0,Q.st)(),C=(0,b.useCallback)(e=>()=>{o(e),null==y||y.track(Q.VV.FILMSTRIP_TOGGLE_VIEW,{view:e})},[y,o]),{handleAddCard:w}=mK(l),{onContextMenu:k,menuProps:E}=(0,mP.EF)(),S=(0,b.useMemo)(()=>[{label:p.Ru._({id:"wTR0O5"}),icon:(0,s.jsx)(x.g,{icon:u.p7g}),key:"add-card-with-ai",onClick:()=>{E.onClose(),setTimeout(()=>{w("aiCardAfter")},100)}},{label:p.Ru._({id:"TL4TtA"}),icon:(0,s.jsx)(x.g,{icon:u.swh}),key:"add-card-from-template",items:[{key:"add-card-from-template-inner-menu",element:e=>(0,s.jsx)(d.a,{maxH:"50vh",overflowY:"scroll",w:"400px",p:0,borderRadius:"md","data-testid":"add-card-from-template-inner-menu",children:(0,s.jsx)(mz.R,{editor:l,appendCard:t=>{null==e||e(),setTimeout(()=>{w(t)},100)}})})}]}],[w,E,l]),I=(0,b.useCallback)(e=>{e.stopPropagation(),e.preventDefault(),E.isOpen?E.onClose():(e.nativeEvent.stopImmediatePropagation(),k(e))},[E,k]);return(0,s.jsxs)(r.s,{flexDirection:"column",children:[(0,s.jsxs)(r.s,{p:"8px",pb:"2px",children:[(0,s.jsxs)(e8.z,{spacing:0,bg:f,p:.5,borderRadius:"3xl",children:[(0,s.jsx)(q.Tz,{label:(0,s.jsx)(m.x6,{id:"Rv+zkJ"}),children:(0,s.jsx)(a.$,{size:"xs",variant:h?"ghost":"plain",color:h?j:g,onClick:C("film"),"data-testid":"filmstrip-view-button",children:(0,s.jsx)(e8.z,{children:(0,s.jsx)(x.g,{icon:u.OxR})})})}),(0,s.jsx)(q.Tz,{label:(0,s.jsx)(m.x6,{id:"5NZpX8"}),children:(0,s.jsx)(a.$,{size:"xs",variant:h?"plain":"ghost",color:h?g:j,onClick:C("list"),"data-testid":"list-view-button",children:(0,s.jsx)(e8.z,{children:(0,s.jsx)(x.g,{icon:u.ITF})})})})]}),(0,s.jsx)(q.Tz,{label:(0,s.jsx)(m.x6,{id:"C8DFL7"}),shortcut:"Mod+\\",children:(0,s.jsx)(H.K,{variant:"ghost","aria-label":p.Ru._({id:"C8DFL7"}),"data-testid":"close-filmstrip-button",colorScheme:v,isRound:!0,size:"xs",icon:(0,s.jsx)(x.g,{icon:u.Jyw}),outlineOffset:"0px",marginInlineStart:"auto",onClick:e=>{e.stopPropagation(),t()},onMouseDown:uY.Fw})})]}),!c&&(0,s.jsxs)(r.s,{px:2,my:2,justify:"center",children:[(0,s.jsxs)(e7.e,{spacing:0,isAttached:!0,variant:"plain",size:"sm",flex:1,children:[(0,s.jsx)(q.Tz,{label:(0,s.jsx)(m.x6,{id:"bgN454"}),children:(0,s.jsx)(a.$,{fontSize:"xs",px:2,flex:1,leftIcon:(0,s.jsx)(x.g,{fixedWidth:!0,icon:u.QLR}),onClick:()=>w(),children:(0,s.jsx)(m.x6,{id:"isRobC"})})}),(0,s.jsx)(H.K,{"aria-label":p.Ru._({id:"xi7ic1"}),borderInlineStart:"none",onClick:I,width:"20px",icon:(0,s.jsx)(x.g,{fixedWidth:!0,icon:u.Jt$,size:"xs"})})]}),(0,s.jsx)(mP.tz,{menuItems:S,isOpen:E.isOpen,position:E.position,onClose:E.onClose,size:"small"})]})]})};var mJ=i(48094),mX=i(11618),m$=i(95465);let mZ=e=>{let{children:t,icon:i,onClick:n,shouldHide:r=!1,isDisabled:o=!1,...l}=e;return r?null:(0,s.jsx)(nd.D,{icon:i,onClick:n,isDisabled:o,...l,children:t})},mQ=(0,b.memo)(e=>{let{isDark:t}=e;return(0,s.jsxs)(d.a,{as:"span",className:"fa-layers fa-fw",children:[(0,s.jsx)(x.g,{fixedWidth:!0,icon:u.vti}),(0,s.jsx)(x.g,{icon:tT.GEE,transform:"shrink-4 right-6 down-4",color:"var(--menu-bg, white)"}),(0,s.jsx)(x.g,{icon:tT.GEE,transform:"shrink-7 right-6 down-4"}),(0,s.jsx)(x.g,{icon:tT.QLR,color:t?"var(--chakra-colors-gray-700)":"var(--chakra-colors-gray-50)",transform:"shrink-10 right-6 down-4"})]})});mQ.displayName="AddCardIcon";let m0=(e,t)=>{if(0===e.length||!t)return null;if(1===e.length){let i=(0,tf.W0)(t,e[0]);return i?(0,s1.getCardTitle)(i.node.toJSON())||"Untitled card":null}return"Multiple cards selected"},m1=(0,b.forwardRef)((e,t)=>{let{editor:i,isOpen:n,onClose:r,readOnly:o,clearPositioning:a,rootStyles:d,isDark:c}=e,h=(0,eu.GV)(e_.Jo),g=(0,iI.d)(),j=(0,mJ.rY)(i),f=(0,R.u)("copyCardsToDeck"),{handleCopy:v,handleDelete:y,handleCut:C,handleDuplicate:w,handleAddCard:k,handleExport:E,handleCopyCardsToDeck:S}=mK(i),I=(0,eu.GV)(il.Mj),A=(0,eu.GV)(il.R8),T=(0,eu.GV)(dk.NG),_=1===I.length,O=(0,b.useMemo)(()=>_?(0,D.Io)({cardId:I[0],docId:null==h?void 0:h.id,isPresentMode:!1}):"",[null==h?void 0:h.id,_,I]),{onCopy:P}=(0,lL.i)(O),z=(0,b.useCallback)(()=>{P(),g({title:(0,s.jsx)(m.x6,{id:"h5GS+N"}),status:"success",duration:3e3,position:"top"})},[P,g]),M=(0,m$.K)(),L=(0,b.useMemo)(()=>m0(I,i),[i,I]),N=(0,b.useMemo)(()=>c?{"--menu-bg":"var(--chakra-colors-gray-800)","&:focus":{"--menu-bg":"var(--chakra-colors-gray-700)"}}:{},[c]),F=(0,im.UT)("edit"),V=I.every(e=>null==T?void 0:T[e]),G=A.every(e=>null==T?void 0:T[e]),W=V&&G,B=(0,b.useCallback)(()=>{let e=!V;I.forEach(t=>{let n=(0,tf.W0)(i,t);n&&i.commands.updateAttributesAtPos(n.pos,{hidden:e})}),j()},[V,j,i,I]);return(0,s.jsx)(no.W,{isOpen:n,onClose:r,children:(0,s.jsxs)(na.c,{className:"filmstrip-card-menu",onContextMenu:e=>{e.preventDefault()},zIndex:"popover",ref:t,rootProps:{style:d},w:"260px",overflowY:"auto",onTransitionEnd:()=>{n||a()},children:[L&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.E,{ps:3,color:c?"gray.400":"gray.600",noOfLines:1,"data-testid":"filmstrip-card-menu-card-title",children:L}),(0,s.jsx)(sP.N,{})]}),(0,s.jsx)(mZ,{"data-testid":"filmstrip-card-menu-item-cut",shouldHide:o,command:(0,q.lp)("Mod+X"),icon:(0,s.jsx)(x.g,{fixedWidth:!0,icon:u.XGd}),onClick:C,children:(0,s.jsx)(m.x6,{id:"cCd8Bs"})}),(0,s.jsx)(mZ,{"data-testid":"filmstrip-card-menu-item-copy",shouldHide:o,command:(0,q.lp)("Mod+C"),icon:(0,s.jsx)(x.g,{fixedWidth:!0,icon:u.jPR}),onClick:v,children:(0,s.jsx)(m.x6,{id:"he3ygx"})}),(0,s.jsx)(mZ,{"data-testid":"filmstrip-card-menu-item-duplicate",shouldHide:o,command:(0,q.lp)("Mod+D"),icon:(0,s.jsx)(x.g,{fixedWidth:!0,icon:u.$3n}),onClick:w,children:(0,s.jsx)(m.x6,{id:"euc6Ns"})}),f&&(0,s.jsx)(mZ,{"data-testid":"filmstrip-card-menu-item-copy-to-deck",shouldHide:o,icon:(0,s.jsx)(x.g,{fixedWidth:!0,icon:u.Rvk,flip:"horizontal"}),onClick:S,children:(0,s.jsx)(m.x6,{id:"Ur0Ose",values:{0:I.length}})}),(0,s.jsx)(mZ,{"data-testid":"filmstrip-card-menu-item-add-card",shouldHide:o,icon:(0,s.jsx)(mQ,{isDark:c}),onClick:()=>{r(),setTimeout(()=>{k()},150)},sx:N,children:(0,s.jsx)(m.x6,{id:"90n2YU"})}),(0,s.jsx)(mZ,{"data-testid":"filmstrip-card-menu-item-export-card",shouldHide:o,icon:(0,s.jsx)(x.g,{fixedWidth:!0,icon:u.mHA}),onClick:E,sx:N,children:1===I.length?p.Ru._({id:"xRJ+bN"}):p.Ru._({id:"eMDlJX",values:{0:I.length}})}),!o&&(0,s.jsx)(sP.N,{}),(0,s.jsx)(mZ,{"data-testid":"filmstrip-card-menu-item-copy-link",shouldHide:!_,icon:(0,s.jsx)(mX.E,{isLocked:!M,isDark:c}),onClick:z,children:(0,s.jsx)(m.x6,{id:"F0YmUY"})}),(0,s.jsx)(mZ,{"data-testid":"filmstrip-card-menu-item-hide-card",isDisabled:!(F&&(!G||W)),icon:(0,s.jsx)(x.g,{fixedWidth:!0,icon:V?u.pS3:u.k6j}),onClick:B,children:V?(0,s.jsx)(m.x6,{id:"lpNzZq",values:{0:I.length}}):(0,s.jsx)(m.x6,{id:"KflWc8",values:{0:I.length}})}),!o&&(0,s.jsx)(sP.N,{}),(0,s.jsx)(mZ,{"data-testid":"filmstrip-card-menu-item-delete",color:"red.500",icon:(0,s.jsx)(x.g,{icon:u.yLS,fixedWidth:!0}),onClick:y,shouldHide:o,children:(0,s.jsx)(m.x6,{id:"cnGeoo"})})]})})});m1.displayName="FilmstripCardMenuComponent";let m6=(0,b.memo)(m1);var m2=i(65950),m5=i(59824);let m3=(0,su.P)(d.a),m4=e=>{let{isEditorFocused:t,isFilmstripSelected:i,shouldHide:n,cardId:o,isDraggingCard:a,isDragInProgress:d,index:c,hidden:u}=e,x=(0,eu.GV)(ex.Uu),h=(0,m5.iI)(x.cardDimensions).aspectRatio;return(0,s.jsxs)(r.s,{boxShadow:i?"var(--fs-item-selected-box-shadow)":t?"var(--fs-item-focused-box-shadow)":"var(--fs-item-box-shadow)",transitionProperty:"common",transitionDuration:"normal",borderRadius:"sm",overflow:"hidden",display:n?"none":void 0,css:h?{aspectRatio:"".concat(h," / 1"),overflow:"hidden"}:void 0,children:[(0,s.jsx)(m2.N,{shouldFixHeight:!n&&d,cardId:o,hidden:u}),(0,s.jsx)(sx.N,{children:!n&&!a&&(0,s.jsx)(m3,{position:"absolute",exit:{opacity:0},transition:{duration:.2},bottom:1,insetStart:1,px:1.5,borderRadius:"md",boxShadow:"base",borderWidth:"1px",borderColor:"var(--fs-item-card-number-border-color)",bg:"var(--fs-item-card-number-background-color)",color:"var(--fs-item-card-number-color)",fontWeight:600,fontSize:"xs",children:(0,s.jsx)(l.E,{children:c})},c)})]})},m8=e=>{let{cardId:t,index:i,isEditorFocused:n,isFilmstripSelected:o,editor:a,readOnly:c,hidden:h=!1}=e,{title:p}=(0,tM.d)({cardId:t,editor:a});return(0,s.jsxs)(r.s,{className:"filmstrip-nav-item-wrapper",w:"var(--editor-width)",justifyContent:"flex-start",fontSize:"xs",borderRadius:"sm",boxShadow:o?"var(--fs-text-item-selected-box-shadow)":n?"var(--fs-item-focused-box-shadow)":"var(--fs-item-box-shadow)",color:o?"trueblue.500":void 0,transitionProperty:"common",transitionDuration:"normal",_hover:{".filmstrip-text-item-number":{display:c?void 0:"none"},".filmstrip-text-drag-handle":{display:c?void 0:"block"}},children:[(0,s.jsxs)(r.s,{alignItems:"center",bg:o?"trueblue.100":"var(--fs-text-item-card-number-bg-color)",transitionProperty:"common",transitionDuration:"normal",children:[(0,s.jsx)(d.a,{className:"filmstrip-text-item-number",w:6,fontSize:i>=1e3?"0.6rem":void 0,textAlign:"center",overflow:"hidden",whiteSpace:"nowrap",children:i}),(0,s.jsx)(d.a,{className:"filmstrip-text-drag-handle",display:"none",textAlign:"center",w:6,fontSize:"md",_hover:{cursor:c?"default":"grab"},children:(0,s.jsx)(x.g,{icon:u.IMq})})]}),(0,s.jsx)(r.s,{"data-testid":"filmstrip-text-item-title",p:2,ps:"4px",flex:1,bg:o?"trueblue.50":"var(--fs-text-item-bg-color)",alignItems:"center",overflow:"hidden",transitionProperty:"common",transitionDuration:"normal",inert:"true",opacity:h?"0.4":"1.0",children:(0,s.jsx)(l.E,{noOfLines:1,children:p||(0,s.jsx)(m.x6,{id:"wja8aL"})})})]})},m7=e=>{let{filmstripItemRef:t,cardId:i,isFilmstripSelected:n,currentFocusedCard:s,isAnimating:r}=e,{editor:o}=(0,tE.m)(),l=(0,Z.O2)("filmstrip"),a=(0,eu.GV)(il.x7);(0,b.useEffect)(()=>{t.current&&i===s&&((null==o?void 0:o.isFocused)&&!r?l.scrollElementIntoView({element:t.current,offsetFromTop:120}):n&&i===a&&requestAnimationFrame(()=>{if(!t.current||!l.scroller)return;let e=l.scroller.getBoundingClientRect(),i=t.current.getBoundingClientRect(),n=i.top,s=i.bottom,r=i.height,o=0,a=t.current.closest(".reorder-item");if(a instanceof HTMLElement&&(o=a.offsetTop),s>=e.bottom){let e=l.scroller,t=Math.max(0,o+r-e.clientHeight+4);l.scrollTo({top:t})}else n<=e.top&&l.scrollTo({top:o})}))},[i,s,o,a,n,l,t,r])},m9=(0,su.P)(r.s),pe=e=>{let{card:t,index:i,isFirst:n,isEditorFocused:r,currentFocusedCard:o,isFilmstripSelected:a,readOnly:c,shouldHide:h,isDragInProgress:m,numberOfCardsDragging:p,onContextClick:g,editor:j,isAnimating:f,showTextOnly:v}=e,{cardId:y,isDragging:C}=t,w=(0,b.useRef)(null);m7({filmstripItemRef:w,cardId:y,isFilmstripSelected:a,currentFocusedCard:o,isAnimating:f});let k=(0,eu.jL)(),{previewWidth:E}=ih(),S=(0,$.fW)()?"50%":"-50%",I=(0,b.useCallback)(e=>{if(!y)return;let t=e.shiftKey,i=!t&&(e.metaKey||e.ctrlKey);if(t&&!c)k((0,il.cb)({id:y,currentFocusedCard:o}));else if(i&&!c)k((0,il.aw)({id:y}));else{if(m)return;k((0,il.o5)({id:y})),k((0,ex.mF)({attached:!1})),j&&(0,tV.OM)({cardId:y,editor:j})}},[y,c,k,o,m,j]),A=(0,eu.GV)(dk.NG),T=null==A?void 0:A[t.cardId];return(0,s.jsxs)(d.a,{className:"filmstrip-item","data-guider-highlight":"filmstrip-item",ref:w,pos:"relative",pt:v?void 0:1,mt:v?1.5:n?void 0:1,onClick:I,onContextMenu:g,cursor:"pointer",userSelect:"none",transitionProperty:"common",transitionDuration:"normal",display:h?"none":void 0,"data-filmstrip-selected":a,"data-filmstrip-view":v?"list":"filmstrip",css:{"--editor-width":"".concat(E,"px")},children:[T&&(0,s.jsx)(d.a,{pos:"absolute",top:"50%",insetInlineStart:v?"calc(100% - 1rem)":"50%",transform:"translate(".concat(S,", -50%)"),zIndex:"1",children:(0,s.jsx)(x.g,{opacity:.8,icon:u.k6j})}),(0,s.jsxs)(d.a,{children:[v&&(0,s.jsx)(m8,{cardId:y,index:i,isFilmstripSelected:a,isEditorFocused:r,editor:j,hidden:T,readOnly:c}),(0,s.jsx)(m4,{shouldHide:h||v,cardId:y,index:i,isDraggingCard:C,isDragInProgress:m,isFilmstripSelected:a,isEditorFocused:r,hidden:T}),(0,s.jsx)(sx.N,{children:p&&(0,s.jsx)(d.a,{position:"absolute",bottom:0,insetInlineStart:0,transform:"translate(".concat(S,", 50%)"),children:(0,s.jsx)(m9,{initial:{scale:.5,opacity:0},exit:{scale:.5,opacity:0},animate:{scale:1,opacity:1},h:5,minW:5,px:1,borderRadius:"full",bg:"trueblue.300",color:"white",fontSize:"xs",fontWeight:600,boxShadow:"sm",justify:"center",align:"center",children:(0,s.jsx)(l.E,{children:p})},"badge-number")})})]})]})};var pt=i(12596),pi=i(87930),pn=i(95081),ps=i(41896),pr=i(20011);let po=(0,b.forwardRef)(function(e,t){let{reduxData:i,...n}=e,r=(0,pr.F)(i);return(0,s.jsx)(y.Kq,{store:r,children:(0,s.jsx)(pl,{ref:t,...n})})}),pl=(0,b.forwardRef)(function(e,t){let{parent:i,theme:n,portalComponent:r,parentIsStreaming:o}=e,l=(0,b.useMemo)(()=>(0,t7.C)(),[]),a=(0,eu.jL)();(0,b.useEffect)(()=>{a((0,ex.Yl)({theme:n||null})),a((0,ex.kd)({isAllowedToEdit:!1})),a((0,ex.$j)({animationsEnabled:!1}))},[n,a]);let c=(0,ps.hG)({extensions:l,content:i.getJSON(),editable:!1});return c.isThumbnail=!0,(0,b.useImperativeHandle)(t,()=>c,[c]),(0,b.useEffect)(()=>{var e,t,n;let s=i.getJSON();if(!s||!c)return;let r=null==(t=i.state.selection)||null==(e=t.ranges)?void 0:e[0];c.commands.setContent(s),r&&c.commands.setTextSelection({from:r.$from.pos,to:r.$to.pos}),c.commands.command(()=>((0,dx.jL)(c.state.doc,a),!0)),null==(n=pi.U.getState(c.state))||n.compute(c.state.doc).processChanges(a)},[i,c,a]),(0,mV.J)({sourceEditor:i,targetEditor:c,isStreaming:o}),(0,s.jsx)(d.a,{className:"editor-preview-root","data-variation-preview":!0,"data-testid":"editor-preview-root",width:"100px",position:"relative",sx:pn.q,children:(0,s.jsx)(ps.$Z,{editor:c,portalComponent:r,style:{width:"100%",height:"100%"},className:"highlight-mask"})})}),pa=(0,b.memo)((0,b.forwardRef)((e,t)=>{let[i,n]=(0,b.useState)(!1),r=(0,eu.GV)(e_.Jo);return((0,b.useEffect)(()=>{requestAnimationFrame(()=>{n(!0)})},[]),i)?(0,s.jsx)(po,{...e,portalComponent:pt.m,ref:t,reduxData:{doc:r}}):null}));pa.displayName="TransactionalFilmstripPreviewEditor";let pd=(0,b.memo)(e=>{let{onClose:t,isDark:i,isResizing:n,setIsResizing:o,side:l}=e,{previewWidth:a}=ih(),c=(0,b.useRef)(null),u=(0,b.useRef)(a),x=(0,b.useRef)(null),h=(0,eu.jL)(),m=(0,b.useCallback)(e=>{if(e.preventDefault(),!c.current||!u.current||!x.current)return;let{width:i,x:n}=c.current,s=(e.clientX-n)*("left"===l?1:-1);if(i+s<=30)return void t();let r=h9()(i+s,90,200);r!==u.current&&(u.current=r,x.current.innerHTML="\n          .filmstrip-nav-item-wrapper {\n            --editor-width: ".concat(r,"px;\n          }"))},[t,l]),p=(0,en.wb)(m,30),g=(0,b.useCallback)(e=>{e.preventDefault(),c.current={x:e.clientX,width:u.current},o(!0);let t=()=>{c.current=null,x.current&&(x.current.innerHTML=""),h((0,il.TN)({width:u.current})),document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",t),requestAnimationFrame(()=>{o(!1)})};document.addEventListener("mousemove",p),document.addEventListener("mouseup",t)},[h,o,p]);return(0,s.jsxs)(r.s,{className:"filmstrip-resizer",css:{"--resizer-width":"24px","--resizer-offset":"4px","--drag-handle-width":"4px"},pos:"absolute",top:0,bottom:0,insetInlineEnd:"calc(var(--resizer-width) * -1 + var(--resizer-offset))",opacity:0,w:"var(--resizer-width)",bg:i?"whiteAlpha.200":"blackAlpha.200",h:"100%",transitionProperty:"common",transitionDuration:"normal",transitionTimingFunction:"ease",justify:"center",alignItems:"center",borderTopEndRadius:"md",borderBottomEndRadius:"md",boxShadow:"md",_hover:{cursor:"ew-resize"},onMouseDown:g,zIndex:mk,children:[(0,s.jsx)("style",{ref:x}),(0,s.jsx)(d.a,{position:"relative",insetInlineStart:"calc(var(--resizer-offset) - (var(--drag-handle-width) / 2))",bg:"white",borderRadius:"full",w:"var(--drag-handle-width)",h:"40px",opacity:n?1:.6,transitionProperty:"common",transitionDuration:"normal"})]})});pd.displayName="FilmstripResizer";let pc=e=>({"--fs-item-border-color":e?"var(--chakra-colors-whiteAlpha-300)":"var(--chakra-colors-gray-200)","--fs-text-item-selected-border-color":"var(--chakra-colors-trueblue-100)","--fs-item-box-shadow":"0 0 0 1px var(--fs-item-border-color)","--fs-item-focused-box-shadow":"0 0 0 2px var(--chakra-ring-color)","--fs-item-selected-box-shadow":"0 0 0 2px var(--chakra-colors-trueblue-300)","--fs-text-item-selected-box-shadow":"0 0 0 1px var(--fs-text-item-selected-border-color)","--fs-item-card-number-border-color":e?"var(--chakra-colors-gray-700)":"var(--chakra-colors-gray-200)","--fs-item-selected-text-color":e?"var(--chakra-colors-trueblue-200)":"var(--chakra-colors-trueblue-500)","--fs-item-card-number-color":e?"var(--chakra-colors-gray-50)":"var(--chakra-colors-gray-700)","--fs-item-card-number-background-color":e?"var(--chakra-colors-gradient-dark)":"var(--chakra-colors-gradient-light)","--fs-text-item-bg-color":e?"var(--chakra-colors-gray-700)":"var(--chakra-colors-gray-50)","--fs-text-item-card-number-bg-color":e?"var(--chakra-colors-gray-600)":"var(--chakra-colors-gray-200)"}),pu=(e,t)=>{if(!e||!t)return{id:null,pos:null};let{$from:i,from:n,to:s}=e,r=null,o=null;return i.doc.nodesBetween(n,s,(e,t)=>{let n=i.doc.resolve(t).depth;return!(!r&&(0,tf.jg)(e))||1!==n||(r=e.attrs.id,o=t,!1)}),{id:r,pos:o}},px=()=>{var e;return!!(null==(e=document.activeElement)?void 0:e.closest(mA))},ph=()=>{let e=(0,$.fW)(),t=(0,b.useRef)(null),[i,n]=(0,b.useState)(!1),[s,r]=(0,b.useState)([0,0]),[o,l]=(0,b.useState)("bottom"),a=(0,eu.jL)(),d=(0,b.useCallback)(()=>{n(!1)},[]),c=(0,b.useCallback)(()=>{r([0,0]),l("bottom")},[]),u=(0,b.useCallback)(e=>{n(!0),r(e)},[]),x=(0,b.useCallback)(e=>i=>{var n;i.preventDefault(),a((0,il.dW)({id:e})),u([i.clientX,i.clientY]);let s=null==(n=t.current)?void 0:n.offsetHeight;if(null==s)return;let r=window.innerHeight<i.clientY+s,o=i.clientY<s;r&&!o?l("top"):r&&o?l("center"):l("bottom")},[a,t,u]),h=(0,b.useMemo)(()=>{var i;let n=s[1],r=null==(i=t.current)?void 0:i.offsetHeight,l=r?window.innerHeight-(n+r+8):void 0,a="center"===o&&l?"translateY(".concat(l,"px)"):"top"===o?"translateY(-100%)":void 0;return{insetInlineStart:e?window.innerWidth-s[0]:s[0],top:s[1],transform:a,transformOrigin:"top"}},[o,s,e]);return{menuRef:t,isFilmstripCardMenuOpen:i,onFilmstripCardMenuClose:d,handleContextMenu:x,menuRootStyles:h,clearPositioning:c}},pm=ts()(tV.OM,200),pp=e=>{let{isFocused:t,readOnly:i,firstFocusedCardId:n,editor:s,isDragging:r}=e,{handleCopy:o,handleDelete:l,handleCut:a,handleDuplicate:d}=mK(s),c=(0,eu.jL)(),u=(0,eu.CU)();(0,b.useEffect)(()=>my.WC.on("keydown","FILMSTRIP",e=>{if(!t)return!1;switch(e.key){case"Escape":if(r)return c((0,mO.O)()),!0;return!1;case"Backspace":case"Delete":if(!i)return l(),!0;return!1;case"a":case"A":if(!i&&(e.ctrlKey||e.metaKey))return e.preventDefault(),c((0,il.Ub)({currentFocusedCard:n})),!0;return!1;case"c":case"C":if(!i&&(e.ctrlKey||e.metaKey))return o(),!0;return!1;case"d":case"D":if(!i&&(e.ctrlKey||e.metaKey))return e.preventDefault(),d(),!0;return!1;case"x":case"X":if(!i&&(e.ctrlKey||e.metaKey))return a(),!0;return!1;case"ArrowDown":{c((0,il.G2)({direction:"down",withShift:!i&&e.shiftKey,currentFocusedCard:n}));let t=(0,il.Mj)(u.getState())[0];return!e.shiftKey&&s&&t&&(pm({cardId:t,editor:s}),c((0,ex.mF)({attached:!1}))),!0}case"ArrowUp":{c((0,il.G2)({direction:"up",withShift:!i&&e.shiftKey,currentFocusedCard:n}));let t=(0,il.Mj)(u.getState())[0];return!e.shiftKey&&s&&t&&(pm({cardId:t,editor:s}),c((0,ex.mF)({attached:!1}))),!0}default:return!1}}),[c,n,t,r,l,o,d,a,i,s,u])};var pg=i(66607);let pj=e=>{let t=(0,eu.CU)(),i=(0,iI.d)(),n=(0,eu.jL)();(0,b.useEffect)(()=>{let r=r=>{let o=t.getState();if(!e||!px()||!(0,ex.nD)(o))return;let l=(0,pg.B)(r,e);if(!l)return;let a=(l.content.content||[]).filter(e=>(0,md.jg)(e)).map(e=>oe()(e.toJSON()));if(a.length){let t=(0,tf.W0)(e,(0,il.Nx)(o)),l=t?t.pos+t.node.nodeSize:e.state.doc.content.size-1,d=(0,il.zT)((0,eu.KA)().getState());e.chain().insertContentAt(l,a,{updateSelection:!1}).command(e=>{let{tr:t}=e;t.setMeta("annotationEvent",{type:"filmstrip-paste",insertPos:l});let i=(0,ot.s)(t.doc.resolve(l));return i&&(t=t.setSelection(i)),!0}).scrollIntoView().run(),r.preventDefault(),mH(e,d),n((0,il.B6)({beforeCardId:null==t?void 0:t.node.attrs.id,cardCount:a.length})),i({title:(0,s.jsx)(m.x6,{id:"3viq5b",values:{0:a.length,1:a.length}}),status:"success",duration:3e3,position:"top"})}};return document.addEventListener("paste",r),()=>{document.removeEventListener("paste",r)}},[n,e,t,i])};var pf=i(67686);let pv=()=>{let e=(0,pf.m)(),t=(0,b.useRef)(null),i=(0,b.useRef)(),n=(0,b.useRef)(),s=(0,b.useRef)(),r=(0,b.useCallback)(e=>{if(!s.current)return;let t=py(s.current),r=e.target;if(!t||!r||void 0===i.current||void 0===n.current)return;let o=r.scrollTop-i.current.top;t.y=n.current-o},[]),o=(0,b.useCallback)((e,n)=>{var s,r;let o=t.current;if(!o)return;let l=o.getBoundingClientRect(),a=n.point.y,d=e.target;if(!(d instanceof Element))return;let c=d.closest("[draggable]"),u=null==c?void 0:c.parentElement;u&&(a<l.top+25&&(c!==u.firstElementChild||o.scrollTop>0)?o.scrollTop-=5:a>l.bottom-25&&o.scrollTop+l.height<(null!=(r=null==(s=i.current)?void 0:s.height)?r:o.scrollHeight)&&(o.scrollTop+=5))},[]),l=(0,b.useCallback)(()=>{let r=t.current,o=pb(e);if(!r||!o)return;s.current=o,i.current={top:r.scrollTop,height:r.scrollHeight};let l=py(o);l&&(n.current=l.y)},[e]);return{scrollerRef:t,onScroll:r,dragControls:e,onDrag:o,onDragStart:l,onDragEnd:(0,b.useCallback)(()=>{i.current=void 0,n.current=void 0,s.current=void 0},[])}},pb=e=>{try{return Array.from(e.componentControls).find(e=>e.isDragging)}catch(e){console.error("[caught] findDraggingElementControls",e);return}},py=e=>{try{return e.panSession.history[0]}catch(e){console.error("[caught] getDraggingElementStartPoint",e);return}},pC=(0,su.P)(r.s),pw=(0,su.P)(d.a),pk="data-".concat(im.rc),pE=(e,t)=>({initial:{x:e*("left"===t?-1:1)+("left"===t?-16:16)},animate:{x:0,transition:mE},exit:{x:e*("left"===t?-1:1),transition:mS}}),pS=e=>{let{onClose:t,editor:i,readOnly:n,side:o}=e,[l,a]=(0,b.useState)(null),[c,u]=(0,b.useState)(!1),[x,h]=(0,eh.M)(em.E.filmstripViewPreference,"film"),m=(0,b.useRef)(null),p=(0,eu.GV)((0,ec.pn)(null==i?void 0:i.gammaDocId)),{cards:g,isDragging:j,selection:f,isLoaded:v}=mD(null!=l?l:i),y=(0,im.UT)("comment"),C=(0,im.UT)("edit"),w=y&&!C,k=(0,eu.GV)(dk.ow),E=(0,b.useMemo)(()=>g.filter(e=>{var t;return!((null==k||null==(t=k[e.cardId])?void 0:t.hidden)&&w)}),[g,w,k]),{id:S}=(0,b.useMemo)(()=>pu(f,i),[i,f]),I=(0,eu.jL)(),A=(0,eu.GV)(il.Mj),T=(0,eu.GV)(mO.Kp),R=(0,eu.GV)(mO.eH),_=(0,eu.GV)(mO.$S),[O,D]=(0,b.useState)(!1),{menuRef:P,isFilmstripCardMenuOpen:z,onFilmstripCardMenuClose:M,clearPositioning:L,handleContextMenu:N,menuRootStyles:F}=ph(),G=(0,b.useCallback)(()=>{if(M(),c){var e;null==(e=m.current)||e.focus()}},[c,M]),{scrollerRef:W,onScroll:B,dragControls:U,onDrag:H,onDragStart:K,onDragEnd:q}=pv(),Y=(0,b.useCallback)(e=>()=>{if(D(!0),K(),W.current){let e=W.current.getBoundingClientRect().height;W.current.style.height="".concat(e,"px")}let t=A.includes(e)?A:[e];I((0,il.IE)({selectedCardIdsToDrag:t})),I((0,mO.Em)({cardIds:E.map(e=>e.cardId),leaderCardId:e,selectedCardIds:t}))},[E,I,A,K,W]),J=(0,b.useCallback)(()=>{i&&setTimeout(()=>{i.commands.rearrangeCardsById(E.map(e=>e.cardId),R,{viewPreference:x}),requestAnimationFrame(()=>{requestAnimationFrame(()=>{I((0,mO.O)()),q()})})},100)},[i,E,R,x,I,q]),X=(0,b.useCallback)(()=>{W.current&&(W.current.style.height=""),D(!1)},[W]);pj(i),pp({isFocused:c,readOnly:n,firstFocusedCardId:S,editor:i,isDragging:j}),(0,uB.j)({ref:m,handler(e){var t,i,n,s;P.current&&P.current.contains(e.target)||(null==(i=e.target)||null==(t=i.closest)?void 0:t.call(i,"[data-menu-item-key]"))||(null==(s=e.target)||null==(n=s.closest)?void 0:n.call(s,'[data-testid="add-card-from-template-inner-menu"]'))||(z&&M(),I((0,il.gE)()))}});let $=(0,eu.GV)(ex.SJ),Q=(0,V.dU)("whiteAlpha.600","whiteAlpha.100"),ee=(0,V.dU)("#F9FAFBDD","gray.800"),et=(0,V.dU)("gray.700","gray.200"),ei=(0,V.dU)("blackAlpha.400","whiteAlpha.500"),{colorMode:en}=(0,V.G6)(),es="dark"===en,er=(0,b.useMemo)(()=>pc(es),[es]),[eo,el]=(0,b.useState)(!1),{width:ea}=ih(),ed=pE(ea,o),ep=(0,b.useMemo)(()=>{let e=R.length;return j&&e>1?e:null},[j,R.length]),[eg,ej]=(0,b.useState)(!1),ef=(0,Z.O2)("filmstrip");(0,b.useEffect)(()=>{ef.setScrollSelector(mR)},[ef]);let ev=(0,iu.Tq)(),eb=(0,io.U)(),ey=!!ev.src&&!eb;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(r.s,{pointerEvents:"none",position:"absolute","data-guider-highlight":"filmstrip",direction:"column",top:14,bottom:ey?"".concat(ev.height+2*ev.paddingY,"px"):2,justifyContent:"center",color:et,insetInlineStart:2,children:[i&&(0,s.jsx)(pa,{parent:i,theme:$,parentIsStreaming:p,ref:a}),(0,s.jsxs)(d.a,{pos:"relative",pointerEvents:"auto",_hover:{".filmstrip-resizer":{opacity:+!eg}},maxHeight:"100%",children:[(0,s.jsxs)(pC,{ref:m,"data-guider-highlight":"filmstrip",className:mI,[pk]:!0,pos:"relative",direction:"column",zIndex:mw,...ed,onAnimationStart:()=>{ej(!0)},onAnimationComplete:()=>{ej(!1)},tabIndex:0,_focus:{outline:"none"},onFocus:()=>{u(!0),null==i||i.commands.blur()},onBlur:e=>{var t,i;m.current&&(null==(t=m.current)?void 0:t.contains(e.relatedTarget))||(null==(i=P.current)?void 0:i.contains(e.relatedTarget))||u(!1)},borderRadius:"md",bg:ee,borderWidth:"1px",borderColor:Q,shadow:"lg",backdropFilter:"blur(20px)",maxHeight:"100%",alignSelf:"flex-start",children:[(0,s.jsx)(mY,{isDark:es,onClose:t,viewPreference:x,setViewPreference:h,editor:i,readOnly:n}),(0,s.jsx)(pw,{className:mT,"data-guider-highlight":"filmstrip-scroller",layoutScroll:!0,overflowY:"auto",position:"relative",sx:{"&::-webkit-scrollbar":{opacity:1,width:"5px"},"&::-webkit-scrollbar-track":{opacity:0,width:"5px"},"&::-webkit-scrollbar-thumb":{background:ei,borderRadius:"full"},...er},ref:W,onScroll:B,p:"8px",pt:0,children:(0,s.jsx)(m_._.Group,{onReorder:e=>{let t=e.map(e=>e.cardId);I((0,mO.je)({reorderedCardIds:t}))},values:E,axis:"y",children:l&&i&&v&&E.map((e,t)=>{let{cardId:r,displayBehavior:o}=e,a=A.includes(r),d=_===r;return(0,s.jsx)(m_._.Item,{drag:!n&&"y",value:e,onDragStart:Y(r),onDragEnd:J,onDragTransitionEnd:X,className:"reorder-item",dragControls:U,transition:{duration:0,ease:"linear"},onDrag:H,dragTransition:{bounceStiffness:2e3,bounceDamping:1e4},style:{position:"relative",listStyle:"none"},children:(0,s.jsx)(pe,{readOnly:n,editor:l,card:e,index:j&&void 0!==T[r]?T[r]:t+1,isFirst:0===t,shouldHide:"hidden"===o,isDragInProgress:O,isEditorFocused:S===r&&i.isFocused,isFilmstripSelected:!!a,currentFocusedCard:S,numberOfCardsDragging:d?ep:null,onContextClick:N(r),isAnimating:eg,showTextOnly:"list"===x})},r)})})})]}),(0,s.jsx)(pd,{onClose:t,isDark:es,isResizing:eo,setIsResizing:el,side:o})]})]}),i&&(0,s.jsx)(m6,{ref:P,editor:i,readOnly:n,isOpen:z,onClose:G,clearPositioning:L,rootStyles:F,isDark:es})]})},pI=()=>{let e=(0,eu.jL)(),t=(0,eu.GV)(il.lh),i=(0,eY.t3)(),n=(0,eY.Wm)(),s=(0,eZ.h5)(i>0||n>0?{base:!1,xl:!0}:{base:!1,lg:!0})||!1,[r,o]=(0,b.useState)(!1),[l,a]=(0,b.useState)(!1),d=(0,b.useCallback)(()=>{e((0,il.$B)({isOpen:!1})),e((0,il.gE)()),a(!0)},[e]),c=(0,b.useCallback)(()=>{s||o(!0),e((0,il.$B)({isOpen:!0}))},[s,e]),u=!s&&r;return(0,b.useEffect)(()=>{let t=!s&&!r,i=s&&!l;t?e((0,il.$B)({isOpen:!1})):i&&e((0,il.$B)({isOpen:!0}))},[e,s,r,l]),{onClose:d,onOpen:c,isOpen:t&&(s||!s&&u)}},pA=(0,su.P)(a.$),pT=(0,b.memo)(()=>{let e=(0,$.fW)(),{editor:t}=(0,t5.mi)(),{isOpen:i,onClose:n,onOpen:o}=pI(),{isGammaAdminUser:l}=(0,xC.u)(),a=(0,im.UT)("edit"),d=(0,eu.GV)(ex.nD),c=(0,ee.rd)(),[h,p]=(0,b.useState)(!1),g=(0,b.useCallback)(()=>{p(!0),setTimeout(()=>{o()}),setTimeout(()=>{p(!1)},750)},[o]);return(0,b.useEffect)(()=>A.R.on("openFilmStrip",()=>{o()}),[o]),(0,b.useEffect)(()=>my.WC.on("keydown","FILMSTRIP",e=>!!(0,rS.Ay)("Mod+\\")(e)&&(i?n():g(),!0)),[i,n,g]),(0,s.jsx)(mC.h,{children:(0,s.jsx)(q.L8,{isDark:c,children:(0,s.jsx)(sx.N,{children:i?(0,s.jsx)(pS,{onClose:n,editor:t,readOnly:!l&&(!a||!d),side:e?"right":"left"},"filmstrip"):(0,s.jsx)(q.Tz,{placement:"top-end",label:(0,s.jsx)(m.x6,{id:"7ShgZt"}),isDisabled:h,shortcut:"Mod+\\",children:(0,s.jsxs)(pA,{initial:{opacity:0},animate:{opacity:1,transition:mS},exit:{opacity:0,transition:mE},zIndex:mw,css:{"--trigger-height":"var(--chakra-sizes-14)"},tabIndex:-1,position:"fixed",insetInlineStart:2,top:"calc(50% - (var(--trigger-height) / 2) + var(--chakra-sizes-5))",borderRadius:"xl","data-guider-highlight":"filmstrip",h:"var(--trigger-height)",w:8,onClick:g,children:[(0,s.jsx)(mb.s,{children:(0,s.jsx)(m.x6,{id:"7ShgZt"})}),h?(0,s.jsx)(r.s,{children:(0,s.jsx)(t3.y,{size:"sm"})}):(0,s.jsx)(x.g,{icon:u.OxR})]},"filmstrip-opener")})})})})});pT.displayName="Filmstrip";var pR=i(36835),p_=i(36433),pO=i(84929),pD=i(97256),pP=i(51312),pz=i(88720),pM=i(95197);let pL=e=>{let{editor:t}=e,{cardMarginSettings:i}=(0,eu.GV)(ex.Uu),{hideFromFirst:n,hideFromLast:r,...a}=i,d=(0,pM.Nk)(i),{isCardMarginsModalOpen:c,onOpenCardMarginsModal:u,onCloseCardMarginsModal:x,positionToHighlight:h,setPositionToHighlight:p}=(0,pD.g)(),g=(0,b.useCallback)(e=>()=>{p(e),u()},[p,u]);return(0,s.jsxs)(o.B,{dir:"ltr",minH:40,justifyContent:"space-between",p:2,bg:"gray.50",borderRadius:"md",cursor:"pointer",role:"group",_hover:{bg:"gray.200",color:"gray.800"},transitionProperty:"all",transitionDuration:"normal",color:"gray.600",onClick:g(void 0),children:[(0,s.jsx)(e8.z,{justifyContent:"space-between",h:8,children:["topLeft","topCenter","topRight"].map(e=>(0,s.jsx)(pN,{position:e,element:a[e],handleClick:g(e),hideFromFirst:!!n},e))}),(0,s.jsx)(l.E,{textAlign:"center",color:"gray.600",_groupHover:{color:"gray.700"},children:d?(0,s.jsx)(m.x6,{id:"Rl2UTZ"}):(0,s.jsx)(m.x6,{id:"ePK91l"})}),(0,s.jsx)(e8.z,{justifyContent:"space-between",h:8,children:["bottomLeft","bottomCenter","bottomRight"].map(e=>(0,s.jsx)(pN,{position:e,element:a[e],handleClick:g(e),hideFromFirst:!!n},e))}),c&&(0,s.jsx)(pO.v,{editor:t,isOpen:c,onClose:x,highlightPosition:h})]})},pN=e=>{var t,i;let{element:n,position:r,handleClick:o,hideFromFirst:a}=e,{logoSrc:c}=(0,p_.G)(),{flex:h,text:m}=(0,pM.o)(r),g=(null==n?void 0:n.type)==="image"&&(null==(t=n.imageAttrs)?void 0:t.uploadStatus)===nU.A.Error,j=!n||"text"===n.type&&!n.content||"image"===n.type&&!g&&!(null==(i=n.imageAttrs)?void 0:i.src),f=(0,$.fW)(),v=(0,pM._V)(n);return(0,s.jsx)(e8.z,{justifyContent:h,w:"100%",children:(0,s.jsx)(d.a,{borderRadius:"sm",children:j?(0,s.jsx)(H.K,{"aria-label":p.Ru._({id:"dBX3xu"}),icon:(0,s.jsx)(x.g,{icon:u.QLR,fontSize:"md"}),variant:"ghost",size:"sm",bg:"transparent",color:"gray.500",_hover:{bg:"blackAlpha.100",color:"black"},_groupHover:{color:"gray.600"},onClick:e=>{e.stopPropagation(),o()}}):(0,s.jsxs)(d.a,{px:2,py:1,children:["text"===n.type&&(0,s.jsx)(l.E,{color:"gray.800",fontSize:"xs",noOfLines:1,textAlign:m,dir:f?"rtl":void 0,children:n.content}),"cardNumbers"===n.type&&(0,s.jsx)(l.E,{color:"gray.800",fontSize:"xs",dir:f?"rtl":void 0,children:(0,pM.M0)(n.startIndex,n.startNumber,a)}),"image"===n.type&&(v?(0,s.jsx)(nV._,{src:v,h:4,maxW:"100%",objectFit:"contain"}):(0,s.jsx)(pP.d,{imageElement:n,isLoading:!1,isError:g,isCompact:!0})),"themeLogo"===n.type&&(c?(0,s.jsx)(nV._,{src:c,h:4,maxW:"100%",objectFit:"contain"}):(0,s.jsx)(pz.V,{isCompact:!0}))]})})})};var pF=i(46875),pV=i(17192),pG=i(84655);let pW=[{key:"sm",name:()=>p.Ru._({id:"4Revpc"}),buttonText:()=>p.Ru._({id:"ZQA8ce"}),description:()=>p.Ru._({id:"N0rIpR"})},{key:"md",name:()=>p.Ru._({id:"agPptk"}),buttonText:()=>p.Ru._({id:"Tmu3kA"}),description:()=>p.Ru._({id:"3JV7Yt"})},{key:"lg",name:()=>p.Ru._({id:"k7rCa/"}),buttonText:()=>p.Ru._({id:"SMwD6s"}),description:()=>p.Ru._({id:"edeEjW"})}],pB=e=>{let{fontSize:t,setFontSize:i}=e;return(0,s.jsx)(e7.e,{isAttached:!0,size:"sm",display:"flex",children:pW.map(e=>{let n=e.key===t?"trueblue.100":void 0;return(0,s.jsx)(q.Tz,{label:(0,s.jsx)(q.c8,{label:e.name(),description:e.description()}),placement:"top",children:(0,s.jsx)(a.$,{"aria-label":e.name(),px:"2.5",boxShadow:"none",variant:"plain",bg:n,onClick:()=>{i(e.key)},children:e.buttonText()})},e.key)})})};var pU=i(51808);let pH=e=>{let{hideExtraLines:t}=e;return(0,s.jsxs)(o.B,{w:"100%",py:2,px:2.5,children:[(0,s.jsx)(d.a,{w:20,h:1.5,bg:"gray.200"}),(0,s.jsxs)(e8.z,{flex:"1",alignItems:"flex-start",children:[(0,s.jsx)(sE.g,{ratio:4/3,color:"gray.600",w:12,bg:"gray.200",children:(0,s.jsx)(d.a,{fontSize:"lg",children:(0,s.jsx)(x.g,{icon:u.Cyq})})}),(0,s.jsxs)(o.B,{flex:"1",spacing:"1",children:[(0,s.jsx)(d.a,{h:1,bg:"gray.200"}),(0,s.jsx)(d.a,{h:1,bg:"gray.200"}),(0,s.jsx)(d.a,{h:1,bg:"gray.200"}),(0,s.jsx)(d.a,{w:t?"80%":"100%",h:1,bg:"gray.200"}),!t&&(0,s.jsx)(d.a,{w:"80%",h:1,bg:"gray.200"})]})]})]})},pK=e=>{let{cardDimensions:t,showBackdrop:i,isWide:n,label:a,scaleCardUp:c,alignment:u}=e,x={boxShadow:"".concat(i?"sm":""),w:"".concat(n?"85%":"65%"),mx:"auto",borderRadius:"sm",bg:"white",transform:"".concat(c?"scale(1.15)":"none")};return(0,s.jsxs)(o.B,{flex:"1",alignItems:"center",sx:{"*":{transition:"all 0.2s ease"}},spacing:1.5,maxW:"50%",mx:"auto",children:[(0,s.jsx)(r.s,{bg:i?"gray.200":"white",borderWidth:"1px",borderColor:"gray.200",width:"100%",minH:32,borderRadius:"sm",alignItems:"center",py:2,overflow:"hidden",children:t.aspectRatio?(0,s.jsx)(sE.g,{...x,ratio:t.aspectRatio,children:(0,s.jsx)(d.a,{display:"flex",alignItems:u,style:{alignItems:u},children:(0,s.jsx)(pH,{hideExtraLines:n})})}):(0,s.jsx)(o.B,{...x,children:(0,s.jsx)(pH,{hideExtraLines:n})})}),(0,s.jsx)(l.E,{fontSize:"xs",color:"gray.600",children:a})]})};var pq=i(8099);let pY=e=>{let{onClick:t,isSelected:i,icon:n,label:r,description:a,tooltip:c}=e,u=(0,s.jsxs)(o.B,{cursor:"pointer",onClick:t,p:"1.5",px:"2",alignItems:"center",spacing:"0",bg:i?"trueblue.50":"gray.50",borderWidth:"1px",borderColor:i?"trueblue.500":"gray.200",color:i?"trueblue.500":"black",borderRadius:"md",minW:"100px",justifyContent:"center",children:[(0,s.jsx)(d.a,{pb:"0",fontSize:"md",children:(0,s.jsx)(x.g,{icon:n})}),(0,s.jsx)(l.E,{fontSize:"xs",w:"100%",textAlign:"center",noOfLines:1,children:r}),a&&(0,s.jsx)(l.E,{fontSize:"xs",color:"blackAlpha.600",children:a})]});return c?(0,s.jsx)(pq.m,{label:c,placement:"top",children:u}):(0,s.jsx)(s.Fragment,{children:u})},pJ=e=>{let{styleTemplateKeys:t,selectedStyleTemplateKey:i,onSelectNewStyle:n,onSelectCustomStyle:r}=e;return(0,s.jsxs)(s.Fragment,{children:[t.map(e=>{let t=av.S9[e];return(0,s.jsx)(pY,{label:t.label(),icon:t.icon,isSelected:i===e,description:t.cardDimensionsDesc(),tooltip:t.recommendedFor(),onClick:()=>n(e)},e)}),(0,s.jsx)(pY,{label:p.Ru._({id:"8Tg/JR"}),icon:u._$s,isSelected:"custom"===i,onClick:r})]})},pX=e=>{let{title:t,description:i,icon:n,customIcon:r,children:o,value:a,onChange:d,stackProps:c}=e;return(0,s.jsxs)(e8.z,{pb:5,...c,children:[n&&(0,s.jsx)(x.g,{icon:n,fixedWidth:!0}),r&&r,(0,s.jsx)(l.E,{ms:1,children:t}),i&&(0,s.jsx)(q.qT,{label:i}),(0,s.jsx)(tA.h,{}),o,d&&(0,s.jsx)(nW.d,{isChecked:a,onChange:e=>d(e.target.checked)})]})},p$=e=>{let{selectedStyleTemplateKey:t,newTemplateKey:i,savedVerticalAlign:n,savedDefaultContentWidth:s,savedFontSize:r,savedScaleContentToFit:o}=e,l="custom"===t?{}:av.S9[t].docSettings(),a="custom"===i?{}:av.S9[i].docSettings(),d="fluid"===l.cardDimensions;return{...a,verticalAlign:d?a.verticalAlign:n,defaultContentWidth:d&&"custom"!==t?s:a.defaultContentWidth,fontSize:null!=r?r:a.fontSize,scaleContentToFit:d||"fluid"===a.cardDimensions?a.scaleContentToFit:o}},pZ=e=>{let{editor:t}=e,i=(0,b.useCallback)((e,i)=>{null==t||t.commands.updateNestedAttributesAtPos(0,{format:e,settings:i})},[t]),n=(0,b.useCallback)(e=>{null==t||t.commands.updateNestedAttributesAtPos(0,{settings:e})},[t]),r=(0,eu.GV)(ex.Uu),{animationsEnabled:c,defaultContentWidth:h,verticalAlign:g,presentBackdrop:j,fontSize:f,cardDimensions:v,defaultFullBleed:y,scaleContentToFit:C}=r,{format:w}=(0,eu.GV)(ex.zu),k=(0,R.u)("cardMarginElements")&&"webpage"!==w,E=(0,r7.Bi)(),S=w||"deck",I=(0,r7.zY)(S),A=(0,r7.Wu)(r,S)||"custom",T="fluid"===v,_="custom"===A;function O(e){e||t.commands.resetCardSettings({fontScale:void 0}),C!==e&&setTimeout(()=>{n({scaleContentToFit:e})})}let D=(0,pF.R)(),P="full"!==y||j;return(0,s.jsxs)(o.B,{spacing:5,divider:(0,s.jsx)(iD.c,{}),children:[(0,s.jsxs)(d.a,{w:"100%",children:[(0,s.jsx)(nx.l,{children:(0,s.jsx)(m.x6,{id:"kI1qVD"})}),(0,s.jsxs)(o.B,{spacing:4,children:[(0,s.jsxs)(no.W,{children:[(0,s.jsx)(nl.I,{textAlign:"start",as:a.$,variant:"plain",size:"md",boxShadow:"none",minW:"120px",rightIcon:(0,s.jsx)(x.g,{icon:u.tdl}),leftIcon:(0,s.jsx)(x.g,{icon:I.icon}),w:"100%",children:I.name()}),(0,s.jsx)(na.c,{children:(0,s.jsx)(sO.i,{title:"Format",children:E.map(e=>(0,s.jsxs)(nd.D,{onClick:()=>{let t=e.styleTemplates[0],n=av.S9[t].docSettings();i(e.formatType,n),O(n.scaleContentToFit)},children:[(0,s.jsx)(x.g,{icon:e.icon,fixedWidth:!0}),(0,s.jsx)(d.a,{flex:1,ms:2,children:(0,s.jsx)(l.E,{children:e.name()})}),e.formatType===S&&(0,s.jsx)(x.g,{icon:u.e68})]},e.formatType))})})]}),(0,s.jsx)(dO.B,{children:(0,s.jsx)(pJ,{styleTemplateKeys:I.styleTemplates,onSelectNewStyle:function(e){let{scaleContentToFit:t,...i}=p$({selectedStyleTemplateKey:A,newTemplateKey:e,savedVerticalAlign:g,savedDefaultContentWidth:h,savedFontSize:f,savedScaleContentToFit:C});n(i),O(t)},onSelectCustomStyle:function(){n({stylesDerivedFrom:"custom"})},selectedStyleTemplateKey:A})})]}),(0,s.jsxs)(d.a,{mt:5,children:[(0,s.jsx)(le.S,{in:_,children:(0,s.jsx)(pX,{title:p.Ru._({id:"iKM2jY"}),description:p.Ru._({id:"Q3Qdcd"}),icon:u.V4x,children:(0,s.jsx)(m5.uK,{cardDimensions:v,updateCardDimensions:e=>{let i="fluid"===e;n({cardDimensions:e,...i?{scaleContentToFit:!1}:{}}),i&&t.commands.resetCardSettings({fontScale:void 0})}})})}),(0,s.jsx)(le.S,{in:_,children:(0,s.jsx)(pX,{title:p.Ru._({id:"lsVq2Z"}),description:p.Ru._({id:"a1DIUk"}),icon:u.Cpz,value:"full"===y,onChange:e=>{n({defaultFullBleed:e?"full":void 0}),t.commands.resetCardSettings({cardSize:"default"})}})}),(0,s.jsx)(le.S,{in:T||_,children:(0,s.jsx)(pX,{title:p.Ru._({id:"cPp+Ef"}),icon:u.So7,children:(0,s.jsx)(pU.z,{contentWidth:h,setWidth:e=>{n({defaultContentWidth:e})},allowedWidths:"social"===w?["sm","md","lg"]:["md","lg"]})})}),(0,s.jsx)(pX,{title:p.Ru._({id:"vUBA/H"}),description:p.Ru._({id:"n68eVZ"}),icon:u.ecg,children:(0,s.jsx)(pG.c,{alignment:g,setAlignment:e=>{n({verticalAlign:e})}})}),(0,s.jsx)(pX,{title:(0,s.jsx)(s.Fragment,{children:C?(0,s.jsx)(m.x6,{id:"heqtbT"}):(0,s.jsx)(m.x6,{id:"q3il6U"})}),icon:u.ACh,children:(0,s.jsx)(pB,{fontSize:f,setFontSize:e=>{n({fontSize:e})}})}),(0,s.jsx)(le.S,{in:!T,children:(0,s.jsx)(pX,{title:(0,s.jsx)(m.x6,{id:"+BgJPb"}),description:p.Ru._({id:"8uFsVy"}),icon:u.hLQ,children:(0,s.jsx)(nW.d,{isChecked:C,onChange:e=>{n({scaleContentToFit:e.target.checked}),e.target.checked||t.commands.resetCardSettings({fontScale:void 0})}})})}),P&&(0,s.jsx)(pX,{title:p.Ru._({id:"7VfbQM"}),description:p.Ru._({id:"XZHPlI"}),icon:u.pt,children:(0,s.jsxs)(N.A,{placement:"top",trigger:"hover",openDelay:200,children:[(0,s.jsx)(ea.W,{children:(0,s.jsx)(nW.d,{isChecked:j,onChange:e=>n({presentBackdrop:e.target.checked})})}),(0,s.jsx)(G.h,{w:"260px",borderRadius:"md",boxShadow:"lg",children:(0,s.jsx)(W.e,{p:1,children:(0,s.jsxs)(e8.z,{alignItems:"flex-start",spacing:"2",children:[(0,s.jsx)(pK,{label:p.Ru._({id:"wl99H6"}),alignment:g,cardDimensions:m5.xs[v],isWide:"lg"===h,showBackdrop:"full"!==y,scaleCardUp:!1}),(0,s.jsx)(pK,{label:p.Ru._({id:"GWjDlt"}),alignment:g,cardDimensions:m5.xs[v],isWide:"lg"===h,showBackdrop:j&&"full"!==y,scaleCardUp:!j||"full"===y})]})})})]})}),(0,s.jsxs)(pX,{title:p.Ru._({id:"HgWdP3"}),description:p.Ru._({id:"fkIS5+",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}}),icon:u.xQp,stackProps:{pb:0},children:[(0,s.jsx)(nW.d,{isChecked:(0,pV.h)({animationsEnabled:c}),onChange:e=>n({animationsEnabled:e.target.checked})}),"value="]})]})]}),k&&(0,s.jsxs)(o.B,{spacing:4,pb:5,children:[(0,s.jsx)(pX,{title:(0,s.jsxs)(e8.z,{spacing:"3",children:[(0,s.jsx)(m.x6,{id:"JQFgkZ"}),(0,s.jsx)(nH.Ch,{canUseFeature:D,productFeature:"card_margin_elements"})]}),description:(0,s.jsx)(m.x6,{id:"Lkq14t"}),customIcon:(0,s.jsx)(pR.m,{}),stackProps:{pb:0}}),(0,s.jsx)(pL,{editor:t})]})]})};var pQ=i(75984),p0=i(52762);let p1=e=>{let{editor:t}=e,i=(0,eu.GV)(ex.SJ),n=(0,eu.GV)(ex.rv),r=(0,b.useCallback)(e=>{null==t||t.commands.updateNestedAttributesAtPos(0,e)},[t]);return(0,s.jsx)(pQ.A,{editor:t,background:n,updateNestedAttributes:r,defaultMessage:(0,s.jsxs)(iP.F,{children:[(0,s.jsx)(iz._,{}),(0,s.jsx)(m.x6,{id:"dyXYfJ"})]}),defaultToNoBackgroundSource:n.type===p0.h.NONE,isDark:(0,s6.Mw)(i)})},p6=e=>{let{closePanel:t}=e,[i,n]=(0,b.useState)(0),{editor:o}=(0,tE.m)(),l=(0,eu.GV)(ex.sX),a=(0,c$.N)(o),c=(0,b.useCallback)((e,t)=>{null==o||o.commands.updateNestedAttributesAtPos(0,{settings:{[e]:t}})},[o]),h=(0,ir.A)({base:"calc(100% - 1rem)",lg:"auto"}),{setDoneFn:p,doActionIfVerified:g}=uu({onSuccess:t});return o?(0,s.jsx)(q.L8,{isDark:!1,children:(0,s.jsx)(t_.Z,{bgColor:"white",w:"100%","data-panelid":"page-setup",pt:4,"data-page-setup":!0,children:(0,s.jsxs)(r.s,{direction:"column","data-testid":"page-setup-drawer",onKeyDown:a,h:h,overflowX:"hidden",w:"100%",children:[(0,s.jsxs)(r.s,{position:"relative",pb:4,px:6,children:[(0,s.jsx)(r.s,{flex:1,children:(0,s.jsx)(tO.N,{children:(0,s.jsx)(m.x6,{id:"fvaOtb"})})}),(0,s.jsx)(tS.J,{onClick:g})]}),(0,s.jsx)(r.s,{overflowY:"auto",direction:"column",h:"100%",flex:1,pt:5,children:(0,s.jsxs)(xY.t,{variant:"soft-rounded",size:"sm",isFitted:!0,isLazy:!0,index:i,onChange:n,px:4,children:[(0,s.jsxs)(xJ.w,{children:[(0,s.jsxs)(xX.o,{children:[(0,s.jsx)(d.a,{marginInlineEnd:2,children:(0,s.jsx)(x.g,{icon:u.vGi})}),(0,s.jsx)(m.x6,{id:"Ccpbzh"})]}),(0,s.jsxs)(xX.o,{children:[(0,s.jsx)(d.a,{marginInlineEnd:2,children:(0,s.jsx)(x.g,{icon:u.pt})}),(0,s.jsx)(m.x6,{id:"GtJbUa"})]}),(0,s.jsxs)(xX.o,{children:[(0,s.jsx)(d.a,{marginInlineEnd:2,children:(0,s.jsx)(x.g,{icon:u.Bwz})}),(0,s.jsx)(m.x6,{id:"rdUucN"})]})]}),(0,s.jsxs)(x$.T,{children:[(0,s.jsx)(xZ.K,{p:2,mt:4,children:(0,s.jsx)(pZ,{editor:o},l)}),(0,s.jsx)(xZ.K,{p:2,mt:4,children:(0,s.jsx)(p1,{editor:o,updateDocSetting:c},l)}),(0,s.jsx)(xZ.K,{p:2,mt:4,children:(0,s.jsx)(uv,{setVerifyURLPathChangesDone:p},l)})]})]})})]})})}):null};p6.panelPosition="right",p6.panelName="page-setup",p6.minWidth=400;let p2=()=>{let{togglePanel:e,isPanelOpen:t}=(0,eY.ww)(p6);return(0,b.useEffect)(()=>{let t=()=>{e({override:"open"})},i=iY.R.on("openPageSetup",t),n=ru.LF.on(ru.DN.OPEN_PAGE_SETUP,t);return()=>{i(),n()}},[e]),{togglePageSetupPanel:e,isPageSetupPanelOpen:t}};var p5=i(19297),p3=i(56124);let p4=(0,rS.Ay)("mod+S"),p8=(0,rS.Ay)("mod+shift+O"),p7=()=>{let e=(0,iI.d)();(0,b.useEffect)(()=>{let t=t=>{p4(t)&&(t.preventDefault(),e.isActive("save_toast")||e({id:"save_toast",title:(0,s.jsx)(m.x6,{id:"w0nuvK",values:{GAMMA_PROPER_NOUN:ej.On}}),status:"success",duration:5e3,isClosable:!0}))},i=(0,ei.Ei)({requiredCookie:"cardCollapseDebug=true"});return window.addEventListener("keydown",t),()=>{null==i||i(),window.removeEventListener("keydown",t)}},[e])},p9=()=>{let e=(0,eu.CU)(),t=(0,eu.jL)(),{editor:i}=(0,t5.mi)();(0,b.useEffect)(()=>{if(!i)return;let n=n=>{if(!p8(n))return;n.preventDefault();let s=e.getState(),{cardIdMap:r,cardIds:o,memoState:{expandedCards:l}}=s.TipTap,a=(0,ex.$i)(s),{total:d,expanded:c,cardIds:u}=o.reduce((e,t)=>{let i=!0===l[t],n=r.parents[t]||[],s=n.length>0,o=!a||n.includes(a);return s&&o&&(e.cardIds.push(t),e.total++,e.expanded+=+!!i),e},{total:0,expanded:0,cardIds:[]});t((0,ex.VO)({disable:!0})),setTimeout(()=>{t((0,ex.VO)({disable:!1}))},100);let x=d===c;ge(i,100,!x),(0,dx.wE)(u,x)};return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n)}},[t,e,i])},ge=(e,t,i)=>{let n,s=(0,Z.H1)("editor");for(let t=200;t>0;t-=25){var r;let i,o=(0,sW.ls)(e,s.scrollSelector,t);(null==(r=o.pos)?void 0:r.pos)&&(e.state.doc.nodeAt(o.pos.pos)?i=o.pos.pos:e.state.doc.nodeAt(o.pos.inside)&&(i=o.pos.inside),i&&(!n||i>n)&&(n=i))}if(!n)return void console.warn("[pinPageDuringAnimation] No result for getTopCenterIshNode");let o=gt(e,n,i);if(!o)return void console.warn("[pinPageDuringAnimation] No element for getElementToPin");(0,ei.BX)({element:o,requiredCookie:"cardCollapseDebug=true"});let l=+new Date,a=s.scroller.scrollTop,d=(0,ei.sR)(o,s.scrollSelector),c=a-d,u=c<0?0:Math.max(c+200,0),x=()=>{if(!o)return;let e=(0,ei.sR)(o,s.scrollSelector);s.scroller.scroll({top:a+(e-d-u)}),new Date-l<t&&requestAnimationFrame(x)};x()},gt=(e,t,i)=>{let n=e.state.doc.resolve(t),s=e.state.doc.nodeAt(t),r=(0,sW.jB)(e,t);if(!s)return void console.warn("[getElementToPin] nodeAt null for $pos",n);let o=(0,sW.TK)(n,()=>!0).reverse();for(o.push({start:n.start(n.depth+1),pos:t,depth:n.depth,node:s});o.length;){let t=o.shift();if(!t)continue;let n=(0,tf.jg)(t.node),s=(0,p5.X6)(t.node),l=(0,p3.hj)(t.node),a=n||t.node.isAtom?t.pos:t.start;if(r=(0,sW.jB)(e,a),!i&&n&&t.depth>2||s||l)break}for(;(null==r?void 0:r.offsetParent)===null&&r.parentElement;)r=r.parentElement;return r};var gi=i(91285),gn=i(73549),gs=i(12419),gr=i(74553),go=i(34630),gl=i(85448),ga=i(95011),gd=i(63792);class gc extends gi.Rv{processAsyncNode(e){let{jsonNode:t,prosemirrorNode:i,processor:n,context:s,editor:r}=e;if(!n.detectNode(i))return!1;let o=n.getNodeId(i);return!!o&&(this.processedAttrs[o]?t.attrs=this.processedAttrs[o]:(this.originalAttrs[o]||(this.originalAttrs[o]={...t.attrs}),this.generatePromises[o]||(this.generatePromises[o]=this.processNode({nodeId:o,prosemirrorNode:i,processor:n,context:s,editor:r}))),!0)}async processNode(e){let t,{nodeId:i,prosemirrorNode:n,processor:s,context:r,editor:o}=e;try{t=await s.processNode(n,r)}catch(e){console.error("[AsyncNodeGenerator] Error processing ".concat(s.nodeType,".  This should not happen, AsyncNodeProcessors should handle error cases, reverting to originalAttrs"),e),t=this.originalAttrs[i]}this.streamingCardIndex===r.cardIndex?this.processedAttrs[i]=t:this.updateAsyncNodeAttrs(o,i,s,t)}updateAsyncNodeAttrs(e,t,i,n){requestAnimationFrame(()=>{let s=(0,tp.xe)(e.state.doc,e=>i.getNodeId(e)===t)[0];if(!s)return void console.error("[AsyncNodeGenerator] Could not find node with id=".concat(t));e.commands.updateAttributesAtPos(s.pos,n)})}constructor({editor:e,interactionId:t,docId:i,workspaceId:n,theme:s}){let r=new ga.t;super({transform:async(o,l)=>{if("data"!==o.event)return void l.enqueue(o);let{index:a,id:d}=o.data;this.streamingCardIndex=a,(0,gl.LS)(o.data.content,l=>{if("text"!==l.type)try{let o=sQ.bP.fromJSON(e.schema,l);for(let c of this.processors)if(this.processAsyncNode({jsonNode:l,processor:c,prosemirrorNode:o,context:{docId:i,workspaceId:n,interactionId:t,cardIndex:a,cardId:d,theme:s,imageStore:r},editor:e}))break}catch(e){o.data.cardComplete&&console.error("[AsyncNodeGenerator] Error creating prosemirror node from jsonNode:",l,e)}}),o.data.cardComplete&&this.streamingCardIndex++,l.enqueue(o)}}),this.streamingCardIndex=0,this.generatePromises={},this.originalAttrs={},this.processedAttrs={},this.processors=(0,gd.i)()}}var gu=i(1057);class gx extends gi.Rv{constructor(e){super({transform:async(t,i)=>{if("data"!==t.event)return void i.enqueue(t);let{content:n}=t.data,s=n.attrs.id,r=n.content.find(e=>"cardAccentLayoutItem"===e.type);r&&!r.attrs.background&&(r.attrs.background=(0,gu.gN)(e,s),(0,r8.wJ)(n)),i.enqueue(t)}})}}var gh=i(57067);let gm=function(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(0===t.length)throw Error("Cannot have empty path");let s=[...t],r={...e},o=r,l=0;for(;t.length>0;){if(!o.content)throw Error("Can't surround a node with children");let e=s.shift();if(0===s.length){let t=o.content.slice(0,e);t.push(i),o.content=t;break}if(l<n){let t=o.content.slice(0);t.splice(e,1,{...t[e]}),o.content=t,o=o.content[e]}else{let t=o.content.slice(0,e+1);t.splice(e,1,{...t[e]}),o.content=t,o=o.content[e]}l++}return r};class gp extends gi.Rv{constructor(e){super({transform:async(t,i)=>{if("done"===t.event||"cancel"===t.event)return void i.enqueue(t);let n=(0,eu.KA)(),s=null;for(let r of function* e(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if("text"===t.type){if(!t.text)return;let e=t.text.startsWith(" "),r=t.text.split(" ").filter(e=>e.length>0);if(0===r.length)return;for(let t=0;t<r.length;t++){let o=r.slice(0,t+1).join(" ");e&&(o=" "+o);let l={type:"text",text:o};yield gm(n,s,l,i)}return}if(!t.content)return void(yield gm(n,s,t,i));let r=0;for(let o of t.content){for(let t of e(o,i,n,[...s,r]))yield t;r++}}(t.data.content,1)){if(!r)continue;s&&i.enqueue(s),s={id:t.id,event:"data",data:{...t.data,content:r,cardComplete:!1}};let o=(0,ec.qy)(e)(n.getState());await gg(o)}s&&i.enqueue({...s,data:{...s.data,cardComplete:!0}})}}),this.index=0,this.startTime=performance.now()}}let gg=e=>new Promise(t=>gh.wg(t,e));var gj=i(42673);let gf=e=>{let{enabled:t,type:i}=e,n=(0,aT.O2)(i),s=(0,b.useRef)(!0);(0,b.useEffect)(()=>{if(!t)return;let e=n.scroller;if(!e)return;let i=()=>{n.isAtBottom(40)?s.current=!0:s.current=!1},r=()=>{s.current=!1};return e.addEventListener("wheel",i,{passive:!0}),e.addEventListener("touchend",i,{passive:!0}),e.addEventListener("touchstart",r,{passive:!0}),e.addEventListener("touchmove",r,{passive:!0}),()=>{e.removeEventListener("wheel",i),e.removeEventListener("touchend",i),e.removeEventListener("touchstart",r),e.removeEventListener("touchmove",r)}},[n,t]);let r=(0,b.useCallback)(()=>{s.current&&(null==n||n.scrollToBottom({behavior:"auto"}))},[n]);return(0,en.wb)(r,100)};var gv=i(30188);let gb="[CONTENT_FILTER]",gy=()=>(0,s.jsxs)(iP.F,{status:"error",variant:"solid",children:[(0,s.jsx)(iz._,{}),(0,s.jsx)(r_.T,{children:(0,s.jsxs)(o.B,{children:[(0,s.jsx)("strong",{children:(0,s.jsx)(m.x6,{id:"7g5s/N"})}),(0,s.jsx)(l.E,{children:(0,s.jsx)(m.x6,{id:"Xp43Ei"})})]})})]}),gC=()=>(0,s.jsxs)(iP.F,{status:"loading",colorScheme:"gray",children:[(0,s.jsx)(t3.y,{size:"sm",me:2}),(0,s.jsxs)(r_.T,{children:[(0,s.jsx)("strong",{children:(0,s.jsx)(m.x6,{id:"n2cF1o"})})," ",(0,s.jsx)(m.x6,{id:"BFGwQA"})]})]}),gw=e=>{let{editor:t,content:i,cardId:n,cardIndex:s,cardComplete:r}=e,o=(0,tp.xe)(t.state.doc,e=>(0,md.jg)(e))[0],l=(0,tp.xe)(t.state.doc,e=>(0,md.jg)(e)&&e.attrs.id===n)[0];if(!o)throw Error("Doc does not have a first card");let a=l?{from:l.pos,to:l.pos+l.node.nodeSize}:0===s?{from:o.pos,to:o.pos+o.node.nodeSize}:t.state.doc.nodeSize-3;l&&(null==l?void 0:l.node.attrs.fontScale)&&(null==i?void 0:i.attrs)&&(i.attrs.fontScale=l.node.attrs.fontScale);try{if(t.commands.insertContentAt(a,i,{updateSelection:0===s}),r&&0===s){let e=(0,ot.s)(t.state.doc.resolve(o.pos));e&&t.commands.command(t=>{let{tr:i}=t;return i.setSelection(e),!0})}}catch(e){console.warn("[useCreateFromStream] ERROR updating card"),console.warn(e)}},gk=e=>{let{docId:t,aiOptions:i,store:n,generateInfo:s,editor:r}=e;if(!s.lastEventId||!s.streamId||!s.interactionId)return void console.error("Trying to resume stream for doc (id=".concat(t,") without lastEventId or streamId or interactionId"),{lastEventId:s.lastEventId,streamId:s.streamId,interactionId:s.interactionId});gr.B.trackRequestSent(n,{interface:"wizard",streaming:!0,interactionId:s.interactionId,isResuming:!0});let{stream:o}=(0,gs.yf)({interactionId:s.interactionId,lastEventId:s.lastEventId,streamId:s.streamId,retries:3}),l={preserveLayouts:!!i.preserveLayouts,imageOptions:i.imageOptions||{},docFormatKey:(0,r7.IZ)((0,r7.lI)(r)).formatType,theme:(0,ex.SJ)(n.getState())};return(0,gn.f6)({stream:o,docId:t,interactionId:s.interactionId,lastCompletedCardId:s.lastCompletedCardId,lastCompletedCardIndex:s.lastCompletedCardIndex,options:l,store:n})},gE=(e,t)=>{let i=(0,eu.GV)(ex.SJ),n=(0,eu.CU)(),s=(0,eu.jL)(),r=(0,eu.GV)(ex.aQ),o=(0,R.u)("streamResumingEnabled"),l=(0,b.useRef)(!1),{isStreaming:a,onStreamData:d,onStreamDone:c,onStreamError:u,onStreamStart:x,onAbortStream:h}=gS({docId:e}),m=gf({enabled:a,type:"editor"}),p=(0,b.useCallback)(async s=>{let o,a;if(!t)return;x({editor:t});let h=gI({streamResponse:s,editor:t,store:n,theme:i,docId:e,workspaceId:r}).getReader();try{for(;!(o=await h.read()).done;)if(o.value){if(l.current){console.log("[AIStream] has aborted -- no longer reading stream");break}a=o.value,"data"===a.event&&(d({value:a.data,editor:t,streamResponse:s}),m())}}catch(e){u({err:e,streamResponse:s,editor:t});return}l.current||(a&&"done"!==a.event&&console.error('[AIStream] incomplete stream: last message received is not `event="done"`',{lastMessage:a}),c({editor:t,streamResponse:s}))},[e,r,t,d,c,u,x,m,n,i]);(0,ag.V)(()=>{if(!t||!r||a||!e)return;let s=new URLSearchParams(window.location.search);if(s.get("mockStream"))return void p(function(e){let t,{docId:i,theme:n,store:s,editor:r}=e;console.log("[createMockStreamResponse] Creating mock visualization stream"),r.commands.setContent("");let o=(0,tU.$F)(),{stream:l,cancel:a}=(t=!1,{cancel:()=>{t=!0},stream:new gi.ZY({start(e){let i='\n<section>\n<custom-code>\n<h1>The Psychology of Decision-Making</h1>\n<p>\n\uD83E\uDD14 The psychology of decision-making is the study of how people make\ndecisions.\n</p>\n<img prompt="A beautiful sunset over a calm ocean" />\n</custom-code>\n</section>\n'.split("<section>").filter(e=>e.trim()).map(e=>"<section>"+e),n=1;(async()=>{for(let s of i){if(t)break;await new Promise(e=>setTimeout(e,800)),e.enqueue({id:n.toString(),event:"content",data:s.trim()}),n++}t||(await new Promise(e=>setTimeout(e,300)),e.enqueue({id:n.toString(),event:"done",data:"stop"})),e.close()})().catch(t=>{e.error(t)})}})});(0,gn.Ct)({stream:l,onCancel:a,interactionId:o,options:{preserveLayouts:!1,imageOptions:{provider:"aiGenerated",model:"flux-1-schnell",license:"All"},docFormatKey:"deck",theme:n,promptKey:"GenerateDeckWithLayout"},bufferCards:1,docId:i,store:s});let d=s.getState().AIStream.streams[o];if(!d)throw Error("Expected StreamResponse to be created by createWizardStream");return d}({docId:e,theme:i,store:n,editor:t}));let l=(0,ec.A0)(e)(n.getState()),d=(0,ec.kg)(n.getState());if(l){"running"===l.status&&p(l);return}if(!o||d)return;let{generateInfo:c,generateStatus:u,aiOptions:x}=(0,r7.lI)(t);if("streaming"!==u){if(s.get("restream")){let i=gk({docId:e,aiOptions:x,generateInfo:{...{interactionId:c.interactionId,streamId:c.streamId},lastEventId:"0",lastCompletedCardId:null,lastCompletedCardIndex:null},editor:t,store:n});i&&p(i)}return}let h=(0,e_.Jo)(n.getState());if((null==h?void 0:h.createdTime)&&Date.now()-new Date(h.createdTime).getTime()>36e5)return void t.commands.updateAttributesAtPos(0,{generateStatus:"done"});let m=gk({docId:e,generateInfo:c,editor:t,store:n,aiOptions:x});m&&p(m)},[e,t,n,r,x,u,d,c,o,p,a,s,i],[t,r]),(0,b.useEffect)(()=>()=>{let i=(0,ec.A0)(e)(n.getState());t&&i&&"running"===i.status&&(l.current=!0,h({editor:t,streamResponse:i}))},[s,e,h,t,n])},gS=e=>{let{docId:t}=e,i=(0,iI.d)(),n=(0,eu.jL)(),r=(0,eu.CU)(),[o,l]=(0,b.useState)(!1),a=(0,R.u)("debugLogging"),d=(0,b.useRef)(null);(0,b.useEffect)(()=>()=>{d.current&&(i.close(d.current),d.current=null)},[i]);let c=(0,b.useCallback)(()=>{d.current||(d.current=i({id:"ai-generating-toast",isClosable:!1,render:()=>gC(),position:"top",duration:null,onCloseComplete:()=>{d.current=null}}))},[i]),u=(0,b.useCallback)(e=>{let{editor:t}=e;t&&(l(!0),t.commands.setAIGenerationRunning(!0),c())},[c]),x=(0,b.useCallback)(e=>{let{editor:t,value:i,streamResponse:n}=e;if(!n||!t)return;let{id:s,cardComplete:r,index:o,content:l}=i;gw({editor:t,content:l,cardId:s,cardIndex:o,cardComplete:r})},[]),h=(0,b.useCallback)(e=>{var t,o,a;let{editor:c,streamResponse:u}=e;if(!c||!u)return;let x=u.id,{aiOptions:h}=(0,r7.lI)(c);l(!1),c.commands.setAIGenerationRunning(!1),c.commands.updateAttributesAtPos(0,{generateStatus:"done"}),n((0,ec.m7)({id:x,status:"complete"}));let p=(0,gv.b)(c),g=new TextEncoder().encode(JSON.stringify(c.state.doc.toJSON())),j=p?p/g.byteLength:void 0;gr.B.trackStreamComplete(r,x,{imageProvider:null==(t=h.imageOptions)?void 0:t.provider,ydocToJsonRatio:j});let f=(0,e_.Jo)(r.getState());f&&(null==(o=f.docGenerateInput)?void 0:o.id)?(0,tK.w)((null==(a=h.imageOptions)?void 0:a.provider)==="aiGenerated"?"generateV2WithImages":"generateV2",f.organization,x):(0,tK.w)("wizardCreation",null==f?void 0:f.organization,x),d.current&&i.update(d.current,{title:(0,s.jsx)(m.x6,{id:"nm7VEQ",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}}),status:"success",position:"top",duration:3e3,isClosable:!0})},[n,r,i]);return{isStreaming:o,onStreamStart:u,onStreamData:x,onStreamError:(0,b.useCallback)(e=>{let{err:o,editor:c,streamResponse:u}=e,x=u.id,{errorMessage:h,errorCode:p}=(0,go._D)(o);console.error("StreamError: ",{interactionId:x,errorMessage:h,errorCode:p,stack:o.stack}),a&&console.log("StreamError: (".concat(p,") - ").concat(h),o.stack),l(!1),c.commands.setAIGenerationRunning(!1),c.commands.updateAttributesAtPos(0,{generateStatus:"done"}),n((0,ec.m7)({id:x,status:"error"}));let g=(0,ec.U7)(x)(r.getState());if(g){let{latency:e,...i}=g;(0,tU.tB)({...i,errorName:"StreamError",errorMessage:h,errorCode:p,outputMessage:"",latency:e||performance.now()-i.startTime,isResuming:u.isResuming,docId:t})}d.current&&(h===gb?i.update(d.current,{render:gy,position:"top",duration:null,isClosable:!0}):(i.update(d.current,{title:(0,s.jsx)(m.x6,{id:"sbsGk/"}),status:"error",position:"top",duration:null,isClosable:!0}),(0,gj.EJ)(o,{customErrorType:"useCreateFromStream"})))},[n,t,a,r,i]),onStreamDone:h,onAbortStream:(0,b.useCallback)(e=>{let{editor:t,streamResponse:i}=e,s=i.id;l(!1),t.commands.setAIGenerationRunning(!1),gr.B.trackStreamAbort(r,{interactionId:s,abortReason:"leave-editor"}),n((0,ec.l0)({id:s}))},[n,r])}},gI=e=>{let{streamResponse:t,editor:i,store:n,docId:s,workspaceId:r,theme:o}=e,{id:l,stream:a}=t,d=!0;return a.pipeThrough(new gx(o)).pipeThrough(new gp(t.id)).pipeThrough(new gc({editor:i,interactionId:l,docId:s,workspaceId:r,theme:o})).pipeThrough(new gi.Rv({transform(e,t){if("done"===e.event&&"content_filter"===e.finishReason)return void t.error(Error(gb));t.enqueue(e)}})).pipeThrough((0,gn.po)(e=>{d&&"data"===e.event&&(gr.B.trackStreamStart(n,{interactionId:l,docId:s}),t.isResuming&&(i.commands.deleteCardsAfter(t.lastCompletedCardId||null),t.lastCompletedCardId&&(console.log("[AIStream] resumeIncompleteAsyncNodes",t.lastCompletedCardId),(0,k.FN)({editor:i,lastCompletedCardId:t.lastCompletedCardId,theme:o,interactionId:l}))),d=!1),"data"===e.event&&e.data.cardComplete&&i.commands.updateNestedAttributesAtPos(0,{generateInfo:{lastEventId:e.id,lastCompletedCardId:e.data.id,lastCompletedCardIndex:e.data.index}})}))},gA="doc_archived_warning",gT=(e,t)=>{let i=(0,iI.d)(),[n]=(0,ik.u6W)(),[r]=(0,ik.BL9)(),o=null==e?void 0:e.site;(0,b.useEffect)(()=>()=>{i.close(gA)},[]),(0,b.useEffect)(()=>{if(o&&!o.archived)return void i.close(gA);!e||e.site||e.archived||i.close(gA)});let a=(0,b.useCallback)(async()=>{if((null==o?void 0:o.id)&&await r({variables:{id:o.id},optimisticResponse:{unarchiveSite:{id:o.id,__typename:"Site"}}}),!(null==e?void 0:e.id))return;let t={id:e.id};await n({variables:t,optimisticResponse:{unarchiveDoc:{...t,archived:!1,__typename:"Doc"}}}),i({title:(0,s.jsx)(m.x6,{id:"o8va6N"}),status:"success",position:"top",isClosable:!0,duration:5e3})},[null==e?void 0:e.id,i,null==o?void 0:o.id,n,r]);(0,b.useEffect)(()=>{e&&t===t2.i.COLLABORATIVE&&((null==o?void 0:o.archived)||(null==e?void 0:e.archived))&&!i.isActive(gA)&&i({id:gA,title:(0,s.jsxs)(l.E,{"data-testid":"trash-confirmation-toast",children:[(0,s.jsx)(m.x6,{id:"fkHPZu"})," ",(0,s.jsx)(iJ.N,{textDecoration:"underline",onClick:a,children:(0,s.jsx)(m.x6,{id:"7wfwc0"})})]}),status:"warning",position:"top",isClosable:!1,duration:null})},[e,t,a,o,i,n])};var gR=i(70744);let g_=e=>{let{togglePagesPanel:t,isPagesPanelOpen:i}=e,n=(0,eu.jL)(),s=(0,eu.CU)(),{asPath:r}=(0,e9.useRouter)(),o=(0,eu.GV)(te.og),l=(0,b.useRef)(i),a=(0,ta.jv)(r),d=(0,b.useRef)(t);d.current=t,(0,aZ.w)(()=>{let e=(0,e1.iZ)("pages")(s.getState()),t=d.current;a&&e?(t({override:"closed",disableTransition:!1}),l.current=!0):a||t({override:l.current?"open":"closed",disableTransition:!1})},[a]),(0,b.useEffect)(()=>{let e=a?(0,O.Xb)()?"mobile":o||"desktop":null;n((0,te.ey)({previewSize:e}))},[n,a,o])};var gO=i(10945);let gD=e=>{let t=(0,gO.m)(),i=(0,eu.GV)((0,dk.Jn)(e));(0,b.useEffect)(()=>{i&&t.cache.updateQuery({query:iV.iVk,variables:{id:e}},e=>{if(!(null==e?void 0:e.doc))return e;let t=e.doc;return t.titleEdited?e:{doc:{...t,title:i}}})},[i,t,e])},gP=e=>{let{onDuplicateClick:t,loading:i}=e;return(0,s.jsxs)(iP.F,{status:"error",children:[(0,s.jsx)(iz._,{}),(0,s.jsxs)(o.B,{spacing:"0.5",children:[(0,s.jsxs)(rR.X,{fontSize:"md",children:["This ",(0,s.jsx)(m.x6,{id:"fqi2wk",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}})]}),(0,s.jsx)(r_.T,{children:(0,s.jsxs)(tI.T,{align:"start",children:[(0,s.jsx)(m.x6,{id:"8NNo+O",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP},components:{0:(0,s.jsx)("br",{})}}),(0,s.jsx)(a.$,{size:"sm",mt:2,alignSelf:"flex-end",onClick:t,isLoading:i,rightIcon:(0,s.jsx)(x.g,{icon:u.Ju_}),children:(0,s.jsx)(m.x6,{id:"euc6Ns"})})]})})]})]})},gz=e=>{let t=(0,iI.d)(),i=(0,eu.jL)(),[n,r]=(0,b.useState)(!1),[o,l]=(0,b.useState)(!1),a=(0,b.useRef)(null),d=(0,ao.Z)(),c=(0,b.useCallback)(()=>{l(!0),d({docId:e,source:"editor_y_doc_too_large_duplicate",newWindow:!0}).finally(()=>{l(!1)})},[d,e]);(0,b.useEffect)(()=>ru.LF.on(ru.DN.Y_DOC_IS_TOO_LARGE,()=>{r(!0)}),[]),(0,b.useEffect)(()=>{if(!n)return;i((0,ig.wm)({docEditorType:t2.i.PUBLIC_STATIC}));let e=()=>(0,s.jsx)(gP,{onDuplicateClick:c,loading:o});a.current?t.update(a.current,{render:e}):a.current=t({render:e,position:"top",duration:null})},[n,t,i,c,o])};var gM=i(2031);let gL=(e,t)=>{let{isUnauthorized:i}=(0,tE.m)();(0,Q.JQ)(n=>{!0!==i&&void 0!==i&&(n.track(Q.VV.DOC_VIEWED,{doc_id:e}),t===t2.i.EXAMPLE_STATIC&&n.track(Q.VV.EXAMPLE_VIEWED,{doc_id:e}))},[e,t,i]),(0,gM.t)();let n=(0,R.u)("realUserMetrics"),s=t===t2.i.COLLABORATIVE&&n,r=(0,R.u)("rumKeystrokeSampleRate");(0,du.Br)(s,r)},gN=e=>{let t=(0,y.wA)(),i=(0,Q.st)();(0,b.useEffect)(()=>{let n,s=()=>{let s=(0,eu.KA)().getState();n=(0,ex.vy)(s),(0,dx.nO)(e),t((0,ex.B6)({isEditingDisabled:!0})),null==i||i.trackDocEvent(Q.VV.DOC_PRINTED)},r=()=>{t((0,ex.B6)({isEditingDisabled:!1})),t((0,ex.x0)({expandedCardsMap:n}))};return window.addEventListener("beforeprint",s),window.addEventListener("afterprint",r),()=>{window.removeEventListener("beforeprint",s),window.removeEventListener("afterprint",r)}},[t,e,i])},gF="doc-root",gV=(0,b.memo)(function(e){let{isConnected:t}=e;return(0,s.jsx)(r.s,{flex:1,alignItems:"center",justifyContent:"center",color:"gray.500",children:t?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(o.B,{spacing:"4",children:[(0,s.jsx)(l.E,{fontSize:"2xl",children:(0,s.jsx)(m.x6,{id:"svObPT",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}})}),(0,s.jsx)(a.$,{as:v(),href:"/",variant:"plain",alignSelf:"center",size:"lg",leftIcon:(0,s.jsx)(x.g,{icon:u.v02}),children:(0,s.jsx)(m.x6,{id:"RWLG6K"})})]}),(0,s.jsx)(eD.x,{children:(0,s.jsx)(eP.P,{showShortcuts:!1})})]}):(0,s.jsx)(eq.r,{isConnected:!1,description:(0,s.jsx)(m.x6,{id:"BBDdvg",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}}),size:"lg",bg:"none"})})}),gG=e=>{let{doc:t,user:i,docEditorType:n,editor:r,editorWrapperDiv:o,aspectRatioValue:l}=e,[a,d]=(0,b.useState)(!1),c=(0,S.h6)(t,i),u=(0,y.d4)(ex.wC),x=n===t2.i.COLLABORATIVE&&!c,h=x&&u===tv.w.SLIDE_VIEW,m=n===t2.i.COLLABORATIVE&&(!i||u===tv.w.DOC_PREVIEW);return(0,b.useEffect)(()=>A.R.on("isInOnboardingChecklist",e=>{d(e)}),[]),m?(0,s.jsx)(au.d,{docWorkspace:null==t?void 0:t.organization}):h?(0,s.jsx)(eH,{forceShow:a}):x?(0,s.jsx)(s$,{editor:r,editorWrapperDiv:o,aspectRatioValue:l}):null},gW=(0,t5.VL)(e=>{var t;let{docEditorType:i}=e,n=(0,eu.jL)(),{docId:o,isUnauthorized:l,passwordRequired:a,setCollaborativeEditorInstance:u,editor:x}=(0,t5.mi)(),m=(0,eu.GV)(e_.Jo),g=(0,eu.GV)(ex.Uu),f="fluid"!==g.cardDimensions?h.EXPORT_ASPECT_RATIOS[g.cardDimensions]:void 0,v=(0,eu.GV)(tr.Gd),y=(0,eu.GV)(tr.df),{isConnected:A}=(0,E.u)(),T=(0,iS.mm)(null==m?void 0:m.id),[R,_]=(0,b.useState)(null),O=(0,eu.GV)(te.og),P=null!==O,z=(0,eu.GV)(ex.wC),M=(0,eu.GV)(ex.nD),L=(0,et.Iy)("manage",m),{user:N}=(0,et.ur)();gT(m,i),gE(o,R===o?x:void 0),gD(o),gL(o,i),tl(x,i===t2.i.COLLABORATIVE),(0,gR.K)(),p7();let{editorAnimationsClass:F,editorAnimationsCSSVars:V}=(0,tc.O)({editor:x,scrollingParentSelector:".".concat(gF),disabledOverride:P});p9(),aK(x,".".concat(gF)),a1(x),t6(),gN(x),(0,S.tr)(m,i===t2.i.COLLABORATIVE);let G=(0,b.useRef)(null),W=(0,ee.rd)(),B=(0,b.useMemo)(()=>(0,tu.Vx)(W),[W]),U=ij();console.debug("%c[DocEditorComponent] RENDER - ".concat(o),"background-color: gold");let H=(0,eR.u)("multipageEditor"),{toggleSitePagesPanel:K,isSitePagesPanelOpen:q}=uW(!H),{togglePagesPanel:Y,isPagesPanelOpen:J}=aL(H),{toggleCommentsPanel:X,isCommentsPanelOpen:$}=rE(),{isDesignPartnerPanelOpen:Z}=lD();p2(),t0(),gz(o),(0,b.useEffect)(()=>()=>{n((0,e1.fi)()),n((0,tr.cL)())},[n]),g_({togglePagesPanel:K,isPagesPanelOpen:q});let Q=(0,ta.dv)(v)&&(null==v?void 0:v.navEnabled)&&!P&&z!==tv.w.SLIDE_VIEW,ei=(0,b.useCallback)(()=>!!(x&&x.state.selection.empty),[x]),{leftPanelLifecycle:en,rightPanelLifecycle:es,globalPanelLifecycle:er}=(0,eY.uR)(),eo=(0,eK.nk)(null==m?void 0:m.organization),el=(0,eO.E)(null==m?void 0:m.title,eo),ea=p.Ru._({id:"X6YCwz"}),ed=p.Ru._({id:"abr3hR"}),ec=iv(),eh=(0,b.useMemo)(()=>{let e=Q?{"--doc-padding-top":tx.D0}:void 0;return{...B,...ec,...e}},[B,ec,Q]),em=(null==m?void 0:m.disabled)||(null==m?void 0:m.archived)||(null==v?void 0:v.archived)||P,ep=!(0,D.fS)(window.location.href),eg=P&&y?(0,s.jsx)(tt,{docId:o}):ep&&x?(0,s.jsx)(hV,{isDark:W,editor:x,scrollingParentSelector:".".concat(gF),editorWrapperEl:G.current,docEditorType:i,isSitePagesPanelOpen:q,toggleSitePagesPanel:K,isPagesPanelOpen:J,togglePagesPanel:Y,isCommentsPanelOpen:$,toggleCommentsPanel:X}):null,ej=49*!!eg+63*(null!=m&&!!m.disabled),ef=null==N||null==(t=N.settings)?void 0:t.needsEditorOnboarding;return(0,s.jsx)(iS.Z0.Provider,{value:T,children:(0,s.jsx)(C.UU,{children:(0,s.jsxs)(r.s,{direction:"column",h:"100%",children:[(0,s.jsx)(lz,{disabled:null==m?void 0:m.disabled,docId:o}),(0,s.jsx)("style",{id:"editorStyleOverride",children:"body {overflow: hidden;}"}),(0,s.jsx)(j(),{children:(0,s.jsx)("title",{children:el})}),M&&(0,s.jsx)(de,{editor:x}),(0,s.jsx)(ti.X2,{isEnabledFn:ei}),eg,a?(0,s.jsx)(aW,{docId:o}):l?(0,s.jsx)(gV,{isConnected:A}):(0,s.jsxs)(r.s,{id:"doc-main",direction:"row",w:"100%",h:"calc(100% - ".concat(ej,"px)"),sx:{"--editor-padding-top":"".concat(ej,"px")},"data-testid":"doc-editor-root",ref:G,children:[ef&&M&&(0,s.jsx)(eA,{editor:x}),(0,s.jsx)(e4,{panelLifecycle:en,editor:x}),(0,s.jsx)(r.s,{flex:"1",direction:"column",position:"relative",minWidth:"0",h:"100%",children:(0,s.jsxs)(d.a,{flex:"1",overflowY:"auto",overflowX:"hidden",pos:"relative",minWidth:"0",h:"100%",className:(0,c.cx)(gF,F,Z&&"design-partner-panel-open"),style:{"--ai-editing-label":"'".concat(ea,"'"),"--ai-generating-label":"'".concat(ed,"'"),...V},sx:eh,children:[P&&(0,s.jsx)(iC,{loading:o!==R,docId:o,editor:x,previewSize:O},"".concat(o,"__preview-editor")),i===t2.i.PUBLIC_STATIC?(0,s.jsx)(a$,{docId:o,snapshotId:null==m?void 0:m.currentSnapshotId,scrollingParentSelector:".".concat(gF),onCreate:u}):i===t2.i.EXAMPLE_STATIC?(0,s.jsx)(am,{docId:o,snapshotId:null==m?void 0:m.currentSnapshotId,scrollingParentSelector:".".concat(gF),onCreate:u}):(0,s.jsxs)(eQ.Y.Provider,{value:er,children:[(0,s.jsx)(td.H2,{doc:m,docId:o,readOnly:em,hideForPreview:P,onCreate:e=>{if(u(e),n((0,I.mO)({editor:e})),_(e.gammaDocId),L){let t=(0,ex.SJ)((0,eu.KA)().getState());(0,k.CP)({editor:e,rootNode:e.state.doc,theme:t,interactionId:(0,w.$)()})}e.on("destroy",()=>{_(null),n((0,I.ZQ)({isUnloading:!0}))})},scrollingParentSelector:".".concat(gF),animationsExtensionEnabled:!0},"".concat(o,"__collaborative-editor")),x&&(0,s.jsx)(tC,{editor:x})]}),Q&&(0,s.jsx)(iE,{}),!P&&(0,s.jsx)(ar,{editor:x},o)]})}),z===tv.w.SLIDE_VIEW&&(0,s.jsx)(mv,{editor:x}),(0,s.jsx)(e3,{panelLifecycle:es,editor:x}),(0,s.jsx)(th.A,{editorId:"main",children:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(gG,{doc:m,user:N,docEditorType:i,editor:x,editorWrapperDiv:G.current,aspectRatioValue:f}),U&&(0,s.jsx)(pT,{})]})})]}),(0,s.jsx)(rd,{doc:m,editor:x}),L&&m&&i===t2.i.COLLABORATIVE&&(0,s.jsx)(sy,{doc:m})]})})})});var gB=i(56570),gU=i(36062);let gH=e=>{let{theme:t,onClick:i,isChecked:n,index:r,startIndex:a}=e;return(0,s.jsxs)(d.a,{gridColumnStart:r+1-a,display:a>r?"none":"block",gridRow:1,as:gU.Q,p:2,transition:"all 0.2s ease-in-out",bgColor:n?"deepocean.100":"white",textAlign:"left",tabIndex:0,borderRadius:"md",transitionProperty:"common",transitionDuration:"normal",_focus:{boxShadow:n?void 0:"outline"},outline:"none",onClick:i,_hover:{bgColor:n?"deepocean.100":"deepocean.50"},onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&i()},"data-theme-id":t.id,"data-testid":n?"current-theme-preview":void 0,cursor:"pointer",children:[(0,s.jsx)(lC.q,{theme:t}),(0,s.jsxs)(o.B,{direction:"row",spacing:1,pt:1,children:[n&&(0,s.jsx)(rn.S,{w:3,h:"auto",mr:1,color:"deepocean.700"}),(0,s.jsx)(l.E,{fontSize:"sm",noOfLines:1,"data-testid":"theme-name",color:n?"deepocean.700":void 0,children:t.name})]})]})};gH.displayName="DemoDocThemePreview";let gK="white",gq=e=>{let{templateTheme:t,setTheme:n,currentThemeId:l}=e,d=(0,y.d4)(ex.wC)===tv.w.SLIDE_VIEW,[c,h]=(0,b.useState)([]),[p,g]=(0,b.useState)(!1),[j,f]=(0,b.useState)(0),v=(0,eZ.h5)({base:3,md:4,lg:5})||3;(0,b.useEffect)(()=>{i.e(1147).then(i.bind(i,71147)).then(e=>{h(e.GLOBAL_THEMES)})},[]);let C=[...t?[t]:[],...c.filter(e=>e.id!==(null==t?void 0:t.id))],w=(0,b.useCallback)(e=>{1===e?f(e=>e+1):f(e=>e-1)},[]);return d?(0,s.jsx)(s.Fragment,{}):(0,s.jsx)(L.Z,{children:(0,s.jsxs)(r.s,{w:"100%",position:"absolute",bottom:0,left:0,bgColor:gK,zIndex:"sticky",direction:"column",borderTop:"3px solid var(--chakra-colors-trueblue-500)",minH:12,p:2,justifyContent:"center",children:[(0,s.jsx)(r.s,{alignItems:"flex-end",justify:"flex-end",children:(0,s.jsx)(a.$,{variant:"ghost",size:"sm",rightIcon:(0,s.jsx)(x.g,{icon:p?u.tdl:u.GF6}),onClick:()=>g(e=>!e),children:p?(0,s.jsx)(m.x6,{id:"yz7wBu"}):(0,s.jsx)(m.x6,{id:"x6tIe+"})})}),(0,s.jsx)(r.s,{justify:"flex-start",align:"flex-start",bgColor:gK,w:"100%",children:p&&(0,s.jsxs)(o.B,{direction:"row",align:"center",justify:"center",w:"100%",children:[(0,s.jsx)(H.K,{"aria-label":"Left",onClick:()=>w(-1),variant:"ghost",isDisabled:0===j,icon:(0,s.jsx)(x.g,{icon:u.Uec})}),(0,s.jsx)(gB.x,{w:"100%",flex:1,overflow:"hidden",padding:2,transition:"all 0.2s ease-in-out",templateColumns:["repeat(".concat(v,", calc(100% / ").concat(v," - 1em))")],gap:"0 1em",bgColor:gK,children:C.map((e,t)=>(0,s.jsx)(gH,{index:t,startIndex:j,isChecked:e.id===l,theme:e,onClick:()=>{n(e)}},e.id))}),(0,s.jsx)(H.K,{"aria-label":"Right",variant:"ghost",isDisabled:j+v>C.length,onClick:()=>w(1),icon:(0,s.jsx)(x.g,{icon:u.vmR})})]})})]})})};var gY=i(20591);let gJ=[{description:(0,s.jsx)(m.x6,{id:"gtWy3j"}),shortcut:["",""]},{description:(0,s.jsx)(m.x6,{id:"UCxK2S"}),shortcut:["",""]},{description:(0,s.jsx)(m.x6,{id:"IkakN2"}),shortcut:"Esc"},{description:(0,s.jsx)(m.x6,{id:"CgmvBu"}),shortcut:"S"},{description:(0,s.jsx)(m.x6,{id:"rEj/lx"}),shortcut:"Enter"},{description:(0,s.jsx)(m.x6,{id:"dQU33K"}),shortcut:"Mod+Shift+O"},{description:(0,s.jsx)(m.x6,{id:"K0Oq/D"}),shortcut:"R"}],gX=e=>{let{editorWrapperEl:t,scrollingParentSelector:i}=e,{enterSlideView:n,exitSlideView:r,setExitedFullscreenByClick:o,isFullscreen:l,enterFullscreen:d,exitFullscreen:c}=dy({editorWrapperEl:t,scrollingParentSelector:i}),h=(0,eu.GV)(ex.wC),g=(0,b.useRef)(h);return(0,b.useEffect)(()=>{g.current=h},[h]),(0,s.jsxs)(e8.z,{children:[(0,s.jsxs)(e7.e,{isAttached:!0,size:"sm",children:[(0,s.jsx)(q.Tz,{label:h===tv.w.DOC_VIEW?(0,s.jsx)(m.x6,{id:"ek5OwP",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}}):(0,s.jsx)(m.x6,{id:"43JI0J",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}}),children:(0,s.jsx)(a.$,{variant:h===tv.w.DOC_VIEW?"solid":"plain",cursor:h===tv.w.SLIDE_VIEW?"pointer":"auto",onClick:()=>{h===tv.w.SLIDE_VIEW&&r()},leftIcon:(0,s.jsx)(x.g,{icon:u.h8M}),children:(0,s.jsx)(m.x6,{id:"7Zdnlq"})})}),(0,s.jsx)(q.Tz,{label:h===tv.w.SLIDE_VIEW?(0,s.jsx)(m.x6,{id:"Zfr5aa",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}}):(0,s.jsx)(m.x6,{id:"rK6Cev",values:{GAMMA_ARTIFACT_PROPER_NOUN:ej.TP}}),children:(0,s.jsx)(a.$,{variant:h===tv.w.SLIDE_VIEW?"solid":"plain",cursor:h===tv.w.DOC_VIEW?"pointer":"auto",onClick:()=>{h===tv.w.DOC_VIEW&&n({fullscreen:!1})},leftIcon:(0,s.jsx)(x.g,{icon:u.UoT}),children:(0,s.jsx)(m.x6,{id:"FOoDGS"})})})]}),h===tv.w.SLIDE_VIEW&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(iD.c,{orientation:"vertical"}),(0,s.jsx)(q.Tz,{label:l?(0,s.jsx)(m.x6,{id:"IkOhTI"}):(0,s.jsx)(m.x6,{id:"q8ARHN"}),children:(0,s.jsx)(H.K,{size:"sm","aria-label":l?p.Ru._({id:"IkOhTI"}):p.Ru._({id:"q8ARHN"}),borderRadius:"md",icon:(0,s.jsx)(x.g,{icon:l?u.gr3:u.oZK}),onClick:l?()=>{o(!0),c()}:d})}),(0,s.jsxs)(N.A,{children:[(0,s.jsx)(ea.W,{children:(0,s.jsx)(a.$,{size:"sm",variant:"plain",fontWeight:"normal",children:(0,s.jsx)(m.x6,{id:"77Emn0"})})}),(0,s.jsxs)(G.h,{border:"1px solid #eee !important",children:[(0,s.jsx)(u8.R,{}),(0,s.jsx)(sC.q,{}),(0,s.jsx)(W.e,{children:(0,s.jsx)(gY.c,{list:gJ})})]})]})]})]})},g$=(0,b.memo)(function(e){let{scrollingParentSelector:t,editorWrapperEl:i}=e;(0,eu.GV)(e_.Jo);let n=(0,b.useRef)(null);return(0,s.jsx)(r.s,{ref:n,bg:"white",borderBottom:"3px solid var(--chakra-colors-trueblue-600)",position:"absolute",zIndex:"overlay",top:0,left:0,right:0,p:2,alignItems:"flex-start",justifyContent:"flex-start",pr:6,children:(0,s.jsx)(r.s,{direction:"column",w:"100%",children:(0,s.jsx)(gX,{editorWrapperEl:i,scrollingParentSelector:t})})})});var gZ=i(90610),gQ=i(16446);let g0=e=>{let{toggleToCPanel:t,initializeToCPanel:i,isToCPanelOpen:n}=e,{breakpoints:{xl:s}}=(0,gQ.D)(),r=(0,eu.GV)(ex.wC),[o,l]=(0,b.useState)(r!==tv.w.SLIDE_VIEW),[a,d]=(0,b.useState)(!1),c=(0,y.wA)();(0,t$.Vg)(()=>{i()},[s,t,i,c],[]),(0,t$.Vg)(()=>{r===tv.w.SLIDE_VIEW?(l(n),t({disableTransition:!1,override:"closed"})):a&&r===tv.w.DOC_VIEW&&t({disableTransition:!1,override:o?"open":"closed"})},[t,n,o,r,a],[r])},g1="doc-root",g6=(0,t5.VL)(e=>{var t;let{docEditorType:i=t2.i.COLLABORATIVE}=e,{docId:n,setCollaborativeEditorInstance:o,editor:l}=(0,t5.mi)(),a=(0,eu.GV)(e_.Jo);gL(n,i),(0,gR.K)(),p7(),p9(),aK(l,".".concat(g1)),a1(l),t6(),gN(l),(0,S.tr)(a,i===t2.i.COLLABORATIVE);let c=(0,b.useRef)(null),u=null==a?void 0:a.theme,[x,h]=(0,b.useState)(()=>u),m=(0,eu.jL)(),p=(0,b.useRef)(!1),{data:g}=(0,ik.YDl)({variables:{docId:n,snapshotId:null==a?void 0:a.currentSnapshotId},skip:!(null==a?void 0:a.currentSnapshotId)}),f=null==g||null==(t=g.snapshot)?void 0:t.content.default;console.debug("%c[DemoDocEditorComponent] RENDER - ".concat(n),"background-color: gold"),(0,b.useEffect)(()=>{u&&!p.current&&(h(u),p.current=!0)},[u]),(0,b.useEffect)(()=>{if(!l)return;let e=null==x?void 0:x.config.accentBackgrounds;if(!e||0===e.length){f&&l.commands.setContent(f);return}l.commands.updateThemeAccentImages(e)},[l,x,f]);let{togglePanel:v,isPanelOpen:y,initPanel:C}=(0,eY.ww)(gZ.g);g0({toggleToCPanel:v,isToCPanelOpen:y,initializeToCPanel:C}),(0,b.useEffect)(()=>()=>{m((0,e1.fi)())},[m]);let{leftPanelLifecycle:w}=(0,eY.uR)();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("style",{id:"editorStyleOverride",children:"body {overflow: hidden;}"}),(0,s.jsx)(j(),{children:(0,s.jsxs)("title",{children:["".concat(a?(0,c6.B)(a.title)+" | ":""),"Gamma"]})}),(0,s.jsxs)(r.s,{id:"doc-main",direction:"row",w:"100%",h:"100%","data-testid":"doc-editor-root",ref:c,children:[(0,s.jsx)(e4,{panelLifecycle:w}),(0,s.jsxs)(r.s,{flex:"1",direction:"column",position:"relative",minWidth:"0",h:"100%",children:[l&&(0,s.jsx)(g$,{scrollingParentSelector:".".concat(g1),editorWrapperEl:c.current,setTheme:h,currentThemeId:(null==x?void 0:x.id)||(null==u?void 0:u.id),templateTheme:u}),(0,s.jsxs)(d.a,{flex:"1",overflowY:"auto",overflowX:"hidden",minWidth:"0",h:"100%",className:g1,children:[(0,s.jsx)(a$,{docId:n,snapshotId:null==a?void 0:a.currentSnapshotId,scrollingParentSelector:".".concat(g1),onCreate:o,theme:x,hideMadeWithGammaBadge:!0}),(0,s.jsx)(mv,{editor:l,showNavigationControls:!0})]})]}),(0,s.jsx)(gq,{setTheme:h,currentThemeId:(null==x?void 0:x.id)||(null==u?void 0:u.id),templateTheme:u})]})]})}),g2="body",g5=e=>{let t=(0,eu.GV)((0,ec.A0)(e)),[i,n]=(0,b.useState)(!1),s=(0,b.useCallback)(()=>{0===window.scrollY&&n(!0)},[]),r=(0,t$.wb)(s,100);return(0,b.useEffect)(()=>{if(!(0,O.Xb)()||(null==t?void 0:t.status)!=="complete"||i)return;let e=setTimeout(async()=>{window.scrollTo({top:0,behavior:"smooth"}),window.addEventListener("scroll",r)},1200);return()=>{clearTimeout(e),window.removeEventListener("scroll",r)}},[null==t?void 0:t.status,i,r]),i};var g3=i(93587);let g4=()=>{let[e,t]=(0,b.useState)("up");return(0,b.useEffect)(()=>{if(!window)return;let e=window.scrollY||0,i=t=>Math.abs(t-e)>0,n=t=>t>e&&!(e>0&&0===t)&&!(t>0&&0===e),s=()=>{let s=window.scrollY||0;i(s)&&(t(n(s)?"down":"up"),e=s>0?s:0)},r=eF()(()=>window.requestAnimationFrame(s),500,{leading:!0});return window.addEventListener("scroll",r),()=>window.removeEventListener("scroll",r)},[]),e};var g8=i(11818);let g7=(0,b.memo)(()=>(0,s.jsx)(d.a,{w:"100%",h:"1px",bg:"gray.200",my:2,mx:-2,_first:{display:"none"},_last:{display:"none"}}));g7.displayName="MenuDivider";let g9=(0,b.memo)(e=>{let{icon:t,children:i,...n}=e;return(0,s.jsx)(d.a,{as:"button",w:"100%",textAlign:"start",px:2,py:2,fontWeight:"500",color:"gray.600",transition:"all 0.2s",_hover:{bg:"gray.50"},_focus:{outline:"none"},_active:{bg:"gray.200"},borderRadius:"md",...n,children:(0,s.jsxs)(e8.z,{children:[t&&(0,s.jsx)(d.a,{children:t}),(0,s.jsx)(d.a,{children:i})]})})});g9.displayName="MenuItem";let je=e=>{var t,i,n;let{isOpen:a,onClose:d,doc:c,file:h,editingEnabled:p,commentsEnabled:g,onCommentFeedOpen:j}=e,{user:f}=(0,et.ur)(),{isConnected:v}=(0,ik.utY)(),y=(0,ao.Z)(),{editor:C}=(0,t5.mi)(),w=(0,c6.B)(null==c?void 0:c.title),k=(null==c?void 0:c.createdTime)&&(0,c1.A)((0,ni.A)(c.createdTime),"PPP"),E=null==c?void 0:c.id,{isOpen:S,onClose:I,onOpen:A}=(0,iN.E)({id:"analyticsPanelDisclosure"}),[T]=(0,ik.fQ5)(),[_]=(0,ik.u6W)(),D=(0,Q.st)(),P=(0,et.Iy)("manage",c)&&!!f,z=(0,et.Iy)("manage",c)&&!!f,M=!!(f&&0!==f.workspaceMemberships.length),L=(0,R.u)("mobileSharePanel"),N=(null==c||null==(t=c.comments)?void 0:t.filter(e=>e.status===ik.EB6.Open).length)||0,F=!!f&&z,V=(0,b.useCallback)(async()=>{if(!C)return;let e=C.getJSON();await y({docId:E,initialContent:e,source:"editor_toolbar_doc_menu_duplicate",newWindow:!1}),d()},[E,y,C,d]),G=(0,b.useCallback)(()=>{null==D||D.track(Q.VV.DOC_ANALYTICS_VIEWED,{docId:E,source:"toolbar_doc_menu",type:"personal",device:(0,O.ZI)()}),A()},[D,E,A]),W=(0,b.useCallback)(e=>()=>{if(!E)return;let t={id:E};e?T({variables:t,optimisticResponse:{archiveDoc:{...t,archived:e,__typename:"Doc"}}}):_({variables:t,optimisticResponse:{unarchiveDoc:{...t,archived:e,__typename:"Doc"}}})},[T,E,_]),B=null==c||null==(i=c.createdBy)?void 0:i.displayName;return(0,s.jsxs)(s.Fragment,{children:[c&&(0,s.jsx)(q.mr,{isOpen:a,onClose:d,children:(0,s.jsxs)(r.s,{w:"100%",h:a?"100%":void 0,direction:"column",children:[(0,s.jsxs)(e8.z,{align:"flex-start",p:6,children:[(0,s.jsxs)(o.B,{spacing:0,children:[(0,s.jsx)(l.E,{fontSize:"2xl",fontWeight:"bold",letterSpacing:"tight",noOfLines:6,children:w}),(0,s.jsx)(l.E,{fontSize:"sm",color:"gray.500",noOfLines:1,children:(0,s.jsx)(m.x6,{id:"jlWdji",values:{createdTime:k}})}),(0,s.jsx)(q.Tz,{label:null==c||null==(n=c.createdBy)?void 0:n.email,children:(0,s.jsx)(l.E,{display:"inline-block",fontSize:"sm",color:"gray.500",noOfLines:1,children:(0,s.jsx)(m.x6,{id:"X5XWlK",values:{createdByDisplayName:B}})})})]}),(0,s.jsx)(tA.h,{}),(0,s.jsx)(tS.J,{mt:-2,onClick:e=>{e.stopPropagation(),d()}})]}),(0,s.jsxs)(o.B,{p:3,pt:0,children:[(0,s.jsx)(g7,{}),z&&!L&&(0,s.jsx)(g9,{icon:(0,s.jsx)(x.g,{icon:u.t5Z,fixedWidth:!0}),onClick:()=>{d(),iY.R.emit("openSharePanel",{view:"invite"})},children:(0,s.jsx)(m.x6,{id:"iyga2M"})}),g&&(0,s.jsx)(g9,{icon:(0,s.jsx)(x.g,{icon:u.DN2,fixedWidth:!0}),onClick:()=>{d(),j()},children:(0,s.jsxs)(e8.z,{spacing:2,children:[(0,s.jsx)(m.x6,{id:"VbyRUy"}),(0,s.jsx)(i8.E,{colorScheme:"gray",variant:"solid",borderRadius:"full",lineHeight:1,children:N})]})}),p&&(0,s.jsx)(g9,{icon:(0,s.jsx)(x.g,{icon:u.fyG,fixedWidth:!0}),onClick:()=>{d(),iY.R.emit("toggleThemeBlock",!0)},"data-testid":"mobile-theme-button",children:(0,s.jsx)(m.x6,{id:"W15e8B"})}),(0,s.jsx)(g7,{}),v&&(0,s.jsxs)(s.Fragment,{children:[F&&(0,s.jsx)(g9,{icon:(0,s.jsx)(x.g,{icon:u.q9c,fixedWidth:!0}),onClick:()=>{d(),G()},children:(0,s.jsx)(m.x6,{id:"qcxxQS"})}),M&&(0,s.jsx)(g9,{icon:(0,s.jsx)(x.g,{icon:u.jPR,fixedWidth:!0}),onClick:V,children:(0,s.jsx)(m.x6,{id:"euc6Ns"})}),P&&(0,s.jsx)(g9,{icon:(0,s.jsx)(x.g,{icon:u.mHA,fixedWidth:!0}),onClick:()=>{d(),iY.R.emit("openSharePanel",{view:"export"})},children:(0,s.jsx)(m.x6,{id:"U8WPSi"})}),z&&(0,s.jsx)(g7,{}),z?c.archived?(0,s.jsx)(g9,{icon:(0,s.jsx)(x.g,{icon:u.IbX,fixedWidth:!0}),onClick:W(!1),children:(0,s.jsx)(m.x6,{id:"yKu/3Y"})}):(0,s.jsx)(g9,{"data-testid":"doc-menu-trash-button",color:"red.500",icon:(0,s.jsx)(x.g,{icon:u.yLS,fixedWidth:!0}),onClick:W(!0),children:(0,s.jsx)(m.x6,{id:"1C/Yjq"})}):null]})]})]})}),c&&S&&(0,s.jsx)(cY,{doc:c,file:h,isAnalyticsPanelOpen:S,onAnalyticsPanelClose:I,mode:"full"}),p&&(0,s.jsx)(hO,{})]})},jt=e=>{let{doc:t,file:i,editor:n,commentsEnabled:r,editingEnabled:o,onCommentFeedOpen:a,onTocOpen:d,onEditClick:c}=e,[h]=(0,xI.F)(em.E.lastHomeUrl,"/"),{user:m}=(0,et.ur)(),p=(0,et.Iy)("manage",t),g=p||o,j=g4(),f=(0,y.d4)(ex.SJ),C=(0,g8.mm)(f),w=(0,s6.Mw)(f),k=w?"white":"gray.700",E=w?"deepocean.300":"deepocean.700",S=(0,b.useCallback)(()=>{n&&n.commands.undo()},[n]),{isOpen:I,onOpen:A,onClose:T}=(0,ez.j)();if(!t)return null;let R={color:k,_hover:{bg:"transparent",color:E},_active:{bg:"transparent",color:E}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(je,{doc:t,file:i,isOpen:I,onClose:T,editingEnabled:o,commentsEnabled:r,onCommentFeedOpen:a}),(0,s.jsxs)(e8.z,{p:1,px:2,bg:"gray.50",shadow:"lg",w:"100%",position:"fixed",top:0,transitionProperty:"common",transitionDuration:"normal",transform:"up"==j?"translate(0px,0px)":"translate(0px,-100%)",opacity:+("up"==j),zIndex:"sticky",sx:{...(0,g8.wL)(C,f,!0),border:"none",filter:"none",borderRadius:0},color:k,children:[m&&(0,s.jsx)(v(),{href:h,passHref:!0,children:(0,s.jsx)(xA.Z,{isDark:w,iconButtonProps:R})}),(0,s.jsx)(l.E,{flex:1,fontSize:"sm",noOfLines:1,ms:2,color:k,children:null==t?void 0:t.title}),(0,s.jsxs)(e7.e,{variant:"ghost",spacing:0,children:[p&&(0,s.jsx)(H.K,{...R,fontSize:"sm",onClick:c,icon:(0,s.jsx)(x.g,{icon:u.zLW}),"aria-label":"Edit"}),p&&m&&(0,s.jsx)(H.K,{...R,"aria-label":"Share",icon:(0,s.jsx)(x.g,{icon:u.t5Z}),onClick:()=>{iY.R.emit("openSharePanel",{view:"invite"})}}),o&&(0,s.jsx)(H.K,{...R,"aria-label":"Undo",onClick:S,icon:(0,s.jsx)(x.g,{icon:u.U23})}),!o&&(0,s.jsx)(H.K,{...R,"aria-label":"Open table of contents",onClick:d,icon:(0,s.jsx)(x.g,{icon:u.ITF})}),g&&(0,s.jsx)(H.K,{...R,"aria-label":"Open toolbar",onClick:A,icon:(0,s.jsx)(x.g,{icon:u.Dwc})})]})]})]})},ji="undefined"!=typeof navigator&&navigator.share,jn={logo:(0,s.jsx)(q.Fu,{w:"120px"}),title:(0,s.jsx)(m.x6,{id:"ytdpwT"}),image:{src:"/_next/static/media/open-on-desktop.c247900d.png",height:515,width:673,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAGCAMAAADJ2y/JAAAAbFBMVEVhkK+AmLjE1eZ7hscqesDOxspOiLhxg8WbosXldY+lpcfEzNbfg6g/aqoMgcrNtqwAar88e7e6scLY19fTxc1ghdB8kb/LobvycKTvdabga5/OjbDccKLh8PDTysqWo8CmwtdylNzdwM7kkbYLGm3dAAAAIHRSTlMBZ+H6Pvz8/vwd/X/1GPRmGPP+9+T9kf47/oWvnSOSPaadVQ4AAAAJcEhZcwAACxMAAAsTAQCanBgAAAA7SURBVHicBcGHAYAgEACxQ4EHxd4rqPvvaAKUs4oXoLNnEnPT1ikXsYqqS4VzVuPD2y/fttKYYTzO3f9BTgLGLDtB5QAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:6},body:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.x6,{id:"w+pzcB",values:{GAMMA_PROPER_NOUN:ej.On}})," ",(0,s.jsx)("span",{role:"img","aria-label":"magic wand",children:"\uD83E\uDE84"})]}),helpText:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.x6,{id:"6Y8GST"})," ",(0,s.jsx)("span",{role:"img","aria-label":"email",children:""})]})},js={edit:jn,editFromToolbar:{...jn,helpText:(0,s.jsx)(m.x6,{id:"b0JDPO"})}},jr=e=>{let{variant:t,onClose:i}=e,n=(0,$.fW)()?u.CeG:u.dmS,r=(0,eu.GV)(e_.Jo)||null,c=(0,Q.st)(),h=(0,b.useCallback)(async()=>{if(r)try{null==c||c.track(Q.VV.MOBILE_EDITOR_SWITCH_TO_DESKTOP_DRAWER_SHARE_BUTTON_TAPPED,{doc_id:r.id,doc_title:r.title,source:t});let e=(0,D.LN)({docId:r.id,docTitle:r.title,absolute:!0});await navigator.share({title:r.title,url:"".concat(T.$.FRONTEND_URL,"/signin?redirect_to=").concat(encodeURIComponent(e))})}catch(e){console.error("Error sharing doc",e)}},[r,t,c]);(0,b.useEffect)(()=>{null==c||c.track(Q.VV.MOBILE_EDITOR_SWITCH_TO_DESKTOP_DRAWER_VIEWED,{doc_id:null==r?void 0:r.id,doc_title:null==r?void 0:r.title,source:t})},[r,t,c]);let p=js[t];return(0,s.jsxs)(o.B,{children:[(0,s.jsxs)(o.B,{spacing:2,alignItems:"center",children:[(0,s.jsxs)(o.B,{spacing:4,children:[p.logo&&p.logo,p.image&&(0,s.jsx)(d.a,{w:"100%",p:6,children:(0,s.jsx)(nV._,{src:p.image.src,alt:"Open on desktop"})})]}),(0,s.jsx)(B.D,{size:"md",variant:"fancy",textAlign:"center",children:p.title})]}),(0,s.jsx)(l.E,{textAlign:"center",children:p.body}),(0,s.jsxs)(o.B,{spacing:6,alignItems:"center",children:[p.helpText&&(0,s.jsx)(l.E,{fontSize:"sm",color:"gray.500",children:p.helpText}),(0,s.jsxs)(o.B,{spacing:2,w:"100%",children:[ji&&(0,s.jsx)(a.$,{width:"100%",onClick:h,size:"md",variant:"plain",leftIcon:(0,s.jsx)(x.g,{icon:u.Exz}),children:(0,s.jsx)(m.x6,{id:"Z8lGw6"})}),(0,s.jsx)(a.$,{width:"100%",onClick:i,size:"sm",variant:"ghost",colorScheme:"gray",rightIcon:(0,s.jsx)(x.g,{icon:n}),children:(0,s.jsx)(m.x6,{id:"xGe7OC"})})]})]})]})},jo=(0,b.memo)(e=>{let{isOpen:t,onClose:i,variant:n}=e;return(0,s.jsxs)(q.mr,{isOpen:t,onClose:i,drawerProps:{placement:"bottom",isFullHeight:!1},drawerContentProps:{h:"auto",w:"100%",p:6},children:[(0,s.jsx)(jr,{variant:n,onClose:i}),(0,s.jsx)(tS.J,{position:"absolute",insetEnd:3,top:3,onClick:i,"aria-label":"Close"})]})});jo.displayName="SwitchToDesktopDrawer";let jl=e=>{let{openDrawer:t,docId:i,hasScrolledToTop:n=!1}=e,{isFirstMobileDocGeneration:s}=(0,e9.useRouter)().query,r=(0,b.useRef)(!1),o=(0,eu.GV)((0,ec.A0)(i)),l=!s||(null==o?void 0:o.status)!=="complete"||!n||r.current,a=(0,b.useCallback)(()=>{window.scrollY/(document.documentElement.scrollHeight-window.innerHeight)*100>20&&(t(),r.current=!0)},[t]),d=(0,t$.wb)(a,100);(0,b.useEffect)(()=>{if(!l)return window.addEventListener("scroll",d),()=>{window.removeEventListener("scroll",d)}},[d,l])},ja=e=>{let{doc:t,file:i,docEditorType:n,commentsEnabled:o=!0}=e,[l,a]=(0,b.useState)(null),{docId:d,setCollaborativeEditorInstance:c,editor:u}=(0,t5.mi)(),{isOpen:x,onOpen:h,onClose:m}=(0,ez.j)({id:"mobile-comment-feed-panel-drawer"}),{isOpen:p,onOpen:g,onClose:j}=(0,ez.j)({id:"mobile-toc-drawer"}),[f,v]=(0,b.useState)(null),y=g5(d),{isOpen:w,onOpen:k,onClose:E}=(0,ez.j)({id:"switch-to-desktop-drawer"});jl({docId:d,openDrawer:k,hasScrolledToTop:y});let S=(0,b.useCallback)(()=>{k(),a("editFromToolbar")},[k]);console.debug("%c[MobileEditorWrapper] RENDER - ".concat(d),"background-color: gold");let I=(0,R.u)("mobileEditing"),A=(0,et.Iy)("edit",t),T=I&&A;return(0,s.jsx)(C.UU,{children:(0,s.jsxs)(r.s,{ref:(0,b.useCallback)(e=>v(e),[]),direction:"column",flex:1,mt:"48px",children:[(0,s.jsx)(jt,{doc:t,file:i,editor:u,onCommentFeedOpen:h,commentsEnabled:!T&&o,editingEnabled:T,onTocOpen:g,onEditClick:S}),n===t2.i.PUBLIC_STATIC?(0,s.jsx)(a$,{docId:d,snapshotId:null==t?void 0:t.currentSnapshotId,scrollingParentSelector:g2,onCreate:c}):n===t2.i.EXAMPLE_STATIC?(0,s.jsx)(am,{docId:d,snapshotId:null==t?void 0:t.currentSnapshotId,scrollingParentSelector:g2,onCreate:c}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(td.H2,{doc:t,docId:d,readOnly:!T,onCreate:c,scrollingParentSelector:g2}),u&&(0,s.jsx)(tC,{editor:u})]}),w&&(0,s.jsx)(jo,{isOpen:w,onClose:E,variant:null!=l?l:"edit"}),o&&x&&(0,s.jsx)(q.mr,{isOpen:x,onClose:m,drawerProps:{autoFocus:!1,returnFocusOnClose:!1},children:(0,s.jsx)(rw,{onClose:m,editor:u})}),p&&(0,s.jsx)(q.mr,{isOpen:p,onClose:j,drawerProps:{returnFocusOnClose:!1},children:(0,s.jsx)(g3.M,{rootElement:f,handleClose:j})}),(0,s.jsx)(hb,{doc:t,file:i,showButton:!1}),(0,s.jsx)(th.A,{children:(0,s.jsx)(ar,{editor:u})})]})})},jd=(0,t5.VL)(e=>{let{docEditorType:t}=e,{docId:i,isUnauthorized:n,passwordRequired:o,editor:l}=(0,t5.mi)();gL(i,t);let{editorAnimationsClass:a,editorAnimationsCSSVars:d}=(0,tc.O)({editor:l,scrollingParentSelector:g2});gE(i,l),(0,gR.K)();let c=(0,b.useRef)(null),u=(0,eu.GV)(e_.Jo);console.debug("%c[MobileDocViewerComponent] RENDER - ".concat(i),"background-color: gold");let x=t===t2.i.COLLABORATIVE;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(j(),{children:[(0,s.jsxs)("title",{children:["".concat(u?(0,c6.B)(u.title)+" | ":""),"Gamma"]}),(0,s.jsx)("meta",{name:"viewport",content:"width=device-width, user-scalable=no"})]}),(0,s.jsx)(K.mL,{styles:{html:{overflowX:"hidden"},body:{overflow:"hidden scroll",WebkitOverflowScrolling:"touch"}}}),o?(0,s.jsx)(aW,{docId:i}):n?(0,s.jsxs)(r.s,{flex:1,alignItems:"center",justifyContent:"center",color:"gray.500",fontSize:"2xl",p:6,textAlign:"center",children:["It looks like you don't have access to this"," ",ej.TP,"."]}):(0,s.jsx)(r.s,{id:"doc-main",direction:"column",w:"100%",h:"100%","data-testid":"doc-editor-root",ref:c,flex:"1",className:a,style:{...d},children:(0,s.jsx)(ja,{doc:u,docEditorType:t,commentsEnabled:x})})]})})},2543:(e,t,i)=>{"use strict";i.d(t,{m:()=>q});var n=i(6029),s=i(27828),r=i(26385),o=i(56570),l=i(69388),a=i(80314),d=i(55597),c=i(19564),u=i(81278),x=i(55729),h=i(36062),m=i(26420),p=i(49611),g=i(74676),j=i(40452),f=i(33787),v=i(23293),b=i(99492),y=i(48621),C=i(82203),w=i.n(C),k=i(29608);let E=e=>{let{children:t,href:i,onClick:s,as:r=w()}=e;return i?(0,n.jsx)(h.Q,{as:m.a,role:"group",onClick:s,children:(0,n.jsx)(h.r,{href:i,as:r,_focusVisible:{boxShadow:"none",outline:"0 none !important"},_hover:{textDecoration:"none !important"},children:t})}):(0,n.jsx)(m.a,{as:p.$,w:"100%",variant:"unstyled",display:"flex",alignItems:"stretch",justifyContent:"stretch",h:"auto",role:"group",onClick:s,maxW:{base:"none",md:"18em"},tabIndex:0,_focusVisible:{boxShadow:"none",outline:"0 none !important"},children:t})},S=e=>{let{badge:t}=e,i={fontSize:"sm",display:"inline-flex"};return"recommended"===t?(0,n.jsxs)(g.E,{colorScheme:"pink",...i,children:[(0,n.jsx)(m.a,{me:1,children:(0,n.jsx)(y.g,{icon:d.yy})}),(0,n.jsx)(c.x6,{id:"hXb7ZT"})]}):(0,n.jsxs)(g.E,{colorScheme:"gray",...i,children:[(0,n.jsx)(m.a,{me:1,children:(0,n.jsx)(y.g,{icon:b.a$})}),(0,n.jsx)(c.x6,{id:"L4VvTF"})]})},I=e=>{let{label:t,description:i,badge:s,isBeta:o,imageUrl:l,imageComponent:a,href:d,onClick:u,as:x}=e;return(0,n.jsx)(E,{href:d,onClick:e=>{null==u||u(e)},as:x||w(),children:(0,n.jsxs)(r.B,{cursor:"pointer",direction:{base:"row",md:"column"},flex:"1",whiteSpace:"normal",textAlign:"start",spacing:4,bg:"white",borderRadius:"lg",p:6,boxShadow:{base:"sm",md:"md"},transitionDuration:"normal",transitionProperty:"common",_groupHover:(0,k.Xb)()?{}:{boxShadow:"xl",transform:"scale(1.03)"},position:"relative",_groupFocusWithin:{shadow:"outline"},children:[(0,n.jsxs)(j.s,{flex:"1",children:[a,l&&(0,n.jsx)(f._,{src:l,objectFit:"cover"})]}),(0,n.jsx)(r.B,{spacing:"1.5",maxW:"100%",minH:{base:"100px",md:"none"},flex:"1.5",direction:{base:"row",md:"column"},children:(0,n.jsxs)(r.B,{align:"flex-start",children:[(0,n.jsx)(v.D,{size:"md",children:t}),(0,n.jsx)(m.a,{fontSize:{base:"sm",md:"md"},fontWeight:"500",lineHeight:"1.4",color:"gray.600",children:i}),s&&(0,n.jsx)(S,{badge:s}),o&&(0,n.jsx)(g.E,{fontSize:"md",colorScheme:"pink",children:(0,n.jsx)(c.x6,{id:"YBt9YP"})})]})})]})})};var A=i(87461),T=i(88586),R=i(68301),_=i(15342),O=i(95889),D=i(82927);let P={src:"/_next/static/media/generate-big-button-rebrand.b74a0218.svg"},z={src:"/_next/static/media/import-big-button-rebrand.b67764ff.svg"},M={src:"/_next/static/media/paste-in-big-butotn-rebrand.1eab7a2f.svg"};var L=i(83370),N=i(13429),F=i(88240);let V=e=>{let{needsEditorOnboarding:t,userGoals:i,lastGenerationType:n,lastGenerationTypeLoading:s,userLoading:r,personalizedCreateWithAi:o,featureFlagsInitialized:l}=e;if(s||r||!l||null===o);else if(t&&!n)if(!o)return{flow:"generate",badge:"recommended"};else if(i[F.w.PresentationsFromNotes])return{flow:"paste",badge:"recommended"};else if(i[F.w.EnhancePptOrPdf])return{flow:"import",badge:"recommended"};else return{flow:"generate",badge:"recommended"};else if(!n)return{flow:"generate",badge:"recommended"};else if(n===T.xbH.Generate)return{flow:"generate",badge:"last-used"};else if(n===T.xbH.PasteText)return{flow:"paste",badge:"last-used"};else if(n===T.xbH.ImportGoogleDoc||n===T.xbH.ImportGoogleSlides||n===T.xbH.UploadWordFile||n===T.xbH.UploadPpt||n===T.xbH.UploadPptV2||n===T.xbH.ImportWebpage||n===T.xbH.ImportPdf)return{flow:"import",badge:"last-used"}};var G=i(19513),W=i(37471),B=i(26662);let U=e=>{var t;let{lastGenerationType:i,lastGenerationTypeLoading:n}=e,{user:s}=(0,D.ur)(),{hasInitialized:r}=(0,R.FY)(),[o,l]=(0,x.useState)(null);return(0,x.useEffect)(()=>{var e;if(i&&!n)return void l(!1);(null==s||null==(e=s.settings)?void 0:e.goals)&&r&&l(R.of.get("personalizedCreateWithAi"))},[null==s||null==(t=s.settings)?void 0:t.goals,r,i,n]),o},H=e=>{let{needsEditorOnboarding:t,userGoals:i,lastGenerationType:n,lastGenerationTypeLoading:s,userLoading:r,featureFlagsInitialized:o}=e,l=U({lastGenerationType:n,lastGenerationTypeLoading:s});return(0,x.useMemo)(()=>V({needsEditorOnboarding:t,userGoals:i,lastGenerationType:n,lastGenerationTypeLoading:s,userLoading:r,personalizedCreateWithAi:l,featureFlagsInitialized:o}),[t,i,n,s,r,l,o])},K=()=>{var e,t,i;let{hasInitialized:s}=(0,R.FY)(),r=R.of.get("importUrl"),{user:o,isUserLoading:l}=(0,D.ur)(),a=(0,D.gx)(),{data:u,loading:x}=(0,T.vCR)({variables:{workspaceId:a,first:5},fetchPolicy:"cache-and-network"}),h=H({needsEditorOnboarding:null==o||null==(e=o.settings)?void 0:e.needsEditorOnboarding,userGoals:null==o||null==(t=o.settings)?void 0:t.goals,lastGenerationType:null==u||null==(i=u.docGenerations.edges[0])?void 0:i.node.generationType,lastGenerationTypeLoading:x,userLoading:l,featureFlagsInitialized:s});return{paste:{label:(0,n.jsx)(c.x6,{id:"Q4xH1Z"}),description:(0,n.jsx)(c.x6,{id:"MxbdK6"}),icon:d.bLf,colorScheme:"pink",imageUrl:M.src,transform:"rotate(-1.5deg) scale(0.84)",badge:(null==h?void 0:h.flow)==="paste"?h.badge:void 0,screen:"createPaste"},generate:{label:(0,n.jsx)(c.x6,{id:"ziAjHi"}),description:(0,n.jsx)(c.x6,{id:"anOFr5"}),icon:d.p7g,colorScheme:"trueblue",imageUrl:P.src,badge:(null==h?void 0:h.flow)==="generate"?h.badge:void 0,screen:"createGenerate"},import:{label:r?(0,n.jsx)(c.x6,{id:"krF+YI"}):(0,n.jsx)(c.x6,{id:"2xoyqj"}),description:r?(0,n.jsx)(c.x6,{id:"fG2B2z"}):(0,n.jsx)(c.x6,{id:"5c5WYH"}),icon:d.$MS,colorScheme:"purple",imageUrl:z.src,transform:"rotate(1.5deg) scale(0.84)",badge:(null==h?void 0:h.flow)==="import"?h.badge:void 0,screen:"createImport"}}},q=(0,x.memo)(()=>{let e=(0,_.jL)(),{goToScreen:t,navEnabled:i}=(0,W._2)(),d=K(),x=(0,O.st)(),{query:h}=(0,u.useRouter)(),m=h.channelId;return(0,n.jsxs)(A.d,{children:[i&&(0,n.jsx)(B.V,{}),(0,n.jsx)(G.I,{title:(0,n.jsx)(c.x6,{id:"1zuBj5"}),subtitle:(0,n.jsx)(c.x6,{id:"h0sjMM"}),children:(0,n.jsx)(s.m,{maxW:"4xl",children:(0,n.jsx)(r.B,{spacing:12,align:"center",children:(0,n.jsx)(o.x,{gap:6,alignItems:"center",gridTemplateAreas:{base:'"generate" "paste" "import"',md:'"paste generate import"'},gridTemplateColumns:{base:"1fr",md:"1fr 1fr 1fr"},width:"100%",children:Object.entries(d).map(i=>{let[s,{label:r,description:o,badge:d,colorScheme:c,imageUrl:u,screen:h}]=i;return(0,n.jsx)(l.E,{area:s,children:(0,n.jsx)(I,{as:a.N,label:r,description:o,badge:d,colorScheme:c,imageUrl:u,onClick:i=>{null==x||x.track(O.VV.AI_DOC_CREATION_GENERATION_TYPE_CLICKED,{generationType:s,device:(0,k.ZI)()}),e((0,L.s)()),i.preventDefault(),i.stopPropagation(),t(h,{ref:"createWithAI",channelId:m})}})},s)})})})})}),(0,n.jsx)(s.m,{maxW:"2xl",pb:"10vw",children:(0,n.jsx)(N.r,{})})]})});q.displayName="CreatePage"},3819:(e,t,i)=>{"use strict";i.d(t,{V:()=>r});var n=i(79555),s=i(17789);let r=new n.F({systemPromptOperation:s.mc.GenerateImagePromptSystem,userPromptOperation:s.mc.GenerateImagePromptUser,variables:["input","html"],params:{temperature:.7,maxTokens:50}})},4837:(e,t,i)=>{"use strict";i.d(t,{V:()=>o});var n=i(55729),s=i(15342),r=i(43634);let o=e=>{let{editor:t}=e,i=(0,s.jL)(),o=(0,s.CU)();return{editCardInPresentMode:(0,n.useCallback)(()=>{(0,r.Ik)(o.getState())&&(i((0,r._b)({isEditingInSlideView:!0})),i((0,r.mF)({attached:!1})),i((0,r.tB)()),null==t||t.commands.turnOffSpotlight())},[t,i,o])}}},10995:(e,t,i)=>{"use strict";i.d(t,{x:()=>r});var n=i(4007),s=i(15342);let r=()=>{let e=(0,s.GV)(n.AO);return t=>{var i,n,s,r;if(e)return!0;if(document.activeElement&&document.activeElement!==document.body&&document.activeElement!==document.documentElement){let e=document.activeElement;if(["input","select","textarea","button"].includes(e.tagName.toLowerCase()))return!0;let t=e.getAttribute("role");if(t&&["menuitem","menu","listbox","combobox","dialog","button"].includes(t)||e.hasAttribute("data-focus-visible-added"))return!0}if(!(t.target instanceof HTMLElement))return!1;let o=t.target;return!!((null==o||null==(i=o.closest)?void 0:i.call(o,"[data-gamma-child-tiptap-editor]"))||(null==o||null==(n=o.closest)?void 0:n.call(o,"input, select, textarea, button"))||(null==o||null==(s=o.closest)?void 0:s.call(o,'[role="menuitem"], [role="menu"], [role="listbox"], [role="combobox"], [role="dialog"], [role="button"]'))||(null==o||null==(r=o.closest)?void 0:r.call(o,"[data-focus-visible-added]")))}}},13427:(e,t,i)=>{"use strict";i.d(t,{$x:()=>q});var n=i(6029),s=i(40452),r=i(46898),o=i(56151),l=i(30709),a=i(85813),d=i(26420),c=i(48810),u=i(58959),x=i(65372),h=i(64575),m=i(17403),p=i(99492),g=i(48621),j=i(47412),f=i(87386),v=i(19564),b=i(77650),y=i(37243),C=i(18833),w=i(42328),k=i(97139),E=i.n(k),S=i(82203),I=i.n(S),A=i(81278),T=i(55729),R=i(88586),_=i(82328),O=i(39247),D=i(68301),P=i(5061),z=i(15342),M=i(47665),L=i(43634),N=i(85235),F=i(53957),V=i(82927),G=i(85607),W=i(45143),B=i(20746),U=i(65148),H=i(37869);let K=(0,C.P)(s.s),q=e=>{let{doc:t}=e;return(0,n.jsx)(K,{initial:{opacity:1},animate:{opacity:1},exit:{opacity:0},children:(0,n.jsx)(w.N,{initial:!1,children:(0,n.jsx)(Z,{doc:t})})})},Y=(0,T.memo)(e=>{let{doc:t}=e,{editor:i}=(0,G.mi)(),{isConnected:s}=(0,_.u)(),c=(0,r.d)(),u=(0,T.useRef)(null),x=(0,T.useRef)(null),[h,{loading:m}]=(0,R.cGn)(),[p,g]=(0,T.useState)(null),[C,w]=(0,T.useState)(!1),[k,S]=(0,T.useState)(!1),I=(0,V.Iy)("edit",t),A=I?300:500,{editedTextColor:O}=(0,H.l)(),D=(0,T.useCallback)(()=>{if(!i)return"";let[e]=(0,y.xe)(i.state.doc,M.jg);return e&&(0,f.getCardTitle)(e.node.toJSON())||""},[i]);(0,T.useEffect)(()=>{!t||C||m||(g(t.title||""),S(!!t.titleEdited))},[t,C,m]);let P=()=>{u.current.style.width=x.current.offsetWidth+0+"px"};return(0,n.jsx)(j.Tz,{label:I?s?(0,n.jsx)(v.x6,{id:"2wxgft"}):(0,n.jsx)(v.x6,{id:"Cb+Bgk"}):null,"aria-label":b.Ru._({id:"2wxgft"}),children:(0,n.jsxs)(o.F,{value:p||"",placeholder:p||D(),isDisabled:m||!I||!s,isPreviewFocusable:I,maxW:A,width:"100%",fontWeight:"normal",onCancel:()=>{P(),w(!1)},onFocus:()=>{P(),t&&!m&&w(!0)},onChange:e=>{P(),C&&(g(e),S(!!e))},onSubmit:()=>{if(!t||m)return;w(!1);let e=p||D();h({variables:{id:t.id,title:e,titleEdited:k}}).catch(e=>{console.error(e),c({title:(0,n.jsx)(v.x6,{id:"AToAqe",values:{0:e.message}}),position:"top",status:"error"})})},children:[(0,n.jsx)(l.l,{ms:["-0.25rem","-0.5rem"],px:1,py:.5,display:C?"inline":"block",overflowX:"hidden",textOverflow:"ellipsis",color:k?O:"inherit"}),(0,n.jsx)(a.j,{ms:["-0.25rem","-0.5rem"],ref:u,px:1,py:.5,color:k?O:"inherit",maxW:A,_focus:{outline:"none",shadow:"0 0 0 2px rgb(66 153 225 / 60%)"}}),(0,n.jsx)(d.a,{ref:x,as:"span",display:"inline-block",position:"absolute",left:"-9999px",opacity:0,zIndex:-1,minW:"180px",px:1,dangerouslySetInnerHTML:{__html:E().sanitize((p||"").replace(/\s/g,"&nbsp;"))}})]})})});Y.displayName="EditableDocTitle";let J=e=>{let{cardId:t,isEllipsis:i,value:s,onClick:r}=e,o=(0,z.GV)((0,O.F1)(t||""));return i?(0,n.jsx)(g.g,{icon:p.vHW}):t||s?(0,n.jsx)(c.E,{noOfLines:1,onClick:r,maxW:180,fontWeight:"normal",children:s||o||""}):null},X=e=>{let{isPresentModeFlat:t}=e;return e=>{let i=(0,L.wC)(e),n=(0,L.$i)(e)||"",s=(0,L.Ev)(e).parents[n]||[];if(i!==N.w.SLIDE_VIEW||t)return[{isHome:!0},{isDocTitle:!0}];let r=s[0],o=s[s.length-1];return[{isHome:!0},s.length>1?{cardId:r}:null,s.length>2?{isEllipsis:!0}:null,s.length>0?{cardId:o}:null,{cardId:n}]}},$=()=>{let e=(0,D.u)("presentModeFlat");return(0,z.GV)(X({isPresentModeFlat:e}),(e,t)=>JSON.stringify(e)===JSON.stringify(t))},Z=(0,T.memo)(e=>{let{doc:t}=e,i=(0,P.fW)(),r=$(),[o]=(0,B.F)(U.E.lastHomeUrl,"/"),{user:l}=(0,V.ur)(),{isConnected:a,isInOfflineMode:f}=(0,_.u)(),{confirmNavigation:y}=(0,G.mi)(),{push:C}=(0,A.useRouter)(),w=(0,W.h5)({base:"xs",sm:"sm"}),{textColor:k,lastItemColor:E,separatorColor:S}=(0,H.l)();return(0,n.jsxs)(u.z,{spacing:0,textAlign:"start",px:0,h:8,children:[(0,n.jsx)(x.Q,{display:"flex",alignItems:"center",whiteSpace:"nowrap",size:w,spacing:["4px",4],separator:(0,n.jsx)(d.a,{color:S,mt:["0.2rem","0.125rem"],children:(0,n.jsx)(g.g,{icon:i?p.Wzs:p.XkK})}),children:r.map((e,i)=>{if(!e)return null;let s=i===r.length-1,{cardId:a,isEllipsis:c,isDocTitle:u,isHome:x,value:p}=e,g=x?"home":c?"ellipsis":a||p||i;if(x&&!l)return null;let j={as:I(),passHref:!0,href:o||"/","data-testid":"toolbar-home-link"};return(0,n.jsx)(h.J,{children:(0,n.jsx)(K,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},exit:{opacity:0,scale:0},children:(0,n.jsx)(m.w,{isCurrentPage:s,pointerEvents:s&&!u?"none":"inherit",color:s?E:k,children:u?(0,n.jsx)(Y,{doc:t}):x?(0,n.jsx)(d.a,{marginInlineStart:-3,...j,onClick:e=>{!e.shiftKey&&(e.metaKey||e.ctrlKey)||(e.preventDefault(),y().then(()=>{C(j.href)}))},marginInlineEnd:-1,children:(0,n.jsx)(H.Z,{boxProps:{boxSize:[6,8],p:["0.2rem","0.3rem"]}})}):(0,n.jsx)(J,{cardId:a,value:p,isEllipsis:c,onClick:()=>{a&&(0,F.o)({cardId:a,method:"push"})}})})},g)},g)})}),!a&&(0,n.jsx)(j.Tz,{label:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.E,{marginInlineEnd:2,children:(0,n.jsx)(v.x6,{id:"ysdDIA"})}),f&&(0,n.jsx)(c.E,{color:"gray.300",children:(0,n.jsx)(v.x6,{id:"+QNhGE"})})]}),"aria-label":b.Ru._({id:"IcHxhR"}),children:(0,n.jsx)(s.s,{color:"gray.500",alignItems:"center",pe:3,children:(0,n.jsx)(g.g,{icon:p.seF})})})]})});Z.displayName="BreadcrumbGroup"},14509:(e,t,i)=>{"use strict";i.d(t,{l:()=>p});var n=i(46887),s=i(55729),r=i(91938),o=i(17789),l=i(68301),a=i(58809),d=i(15342),c=i(42721),u=i(22529),x=i(53381),h=i(44630),m=i(55276);let p=e=>{let t=(0,d.GV)(a.Jo),i=(0,s.useMemo)(()=>!!n.A.get(x.oH),[]),p=(0,d.GV)(u.iG),g=(0,c.IM)(),j=(0,d.jL)(),f=(0,d.GV)(m.wt),v=(0,l.u)("docEditorForcePublicStatic"),b=window!==window.top,y=(0,s.useMemo)(()=>{var e,n;if(p||b)return!1;let s=new URLSearchParams(window.location.search);if(s.get("following_id")&&s.get("follow_on_start"))return!0;if(!t)return i;let l=null==(n=t.accessLinks)||null==(e=n.find(e=>e.token===r.$.SHARE_TOKEN))?void 0:e.permission;return l&&[o.aXG.Edit,o.aXG.Comment].includes(l)||g.can(o.aXG.Comment,t)||g.can(o.aXG.Edit,t)||g.can(o.aXG.Manage,t)},[g,t,i,b,p]);(0,s.useEffect)(()=>{let t=v?h.i.PUBLIC_STATIC:e||(y?h.i.COLLABORATIVE:h.i.PUBLIC_STATIC);j((0,m.wm)({docEditorType:t}))},[j,e,v,y]);let C=e||(y?h.i.COLLABORATIVE:h.i.PUBLIC_STATIC);return f||C}},16306:(e,t,i)=>{"use strict";i.d(t,{q:()=>u});var n=i(6029),s=i(40452),r=i(24302),o=i(64268),l=i(51504),a=i(41974),d=i(76461);let c=(0,i(18833).P)(s.s),u=e=>{let{children:t,from:i="Designer",warning:s=!1,cardStyleOverrides:u,error:x=!1,...h}=e,m=(0,r.dU)("deepocean.400","deepocean.700"),p=(0,r.dU)("deepocean.50","yellow.700"),g=(0,r.dU)("red.100","red.500"),j="User"===i,f=j?{bg:m,borderBottomRightRadius:0,color:"white",...u}:{bg:s?void 0:x?g:p,borderBottomLeftRadius:0,...u};return(0,n.jsx)(c,{justify:j?"flex-end":"flex-start",initial:{opacity:0,translateX:-20},animate:{opacity:1,translateX:0},...h,children:s?(0,n.jsxs)(o.F,{status:"warning",borderColor:"orange.200",borderWidth:"1px",fontSize:"inherit",...f,children:[(0,n.jsx)(l._,{}),t]}):(0,n.jsx)(a.Z,{size:"sm",shadow:"sm",borderRadius:"xl",variant:"filled",minH:0,borderColor:x?"red.200":"blackAlpha.200",...f,children:(0,n.jsx)(d.b,{py:2,px:2,children:t})})})}},30615:(e,t,i)=>{"use strict";i.d(t,{u:()=>f});var n=i(6029),s=i(58959),r=i(26476),o=i(48810),l=i(26420),a=i(26385),d=i(23293),c=i(83743),u=i(96500),x=i(49611),h=i(99492),m=i(55597),p=i(48621),g=i(19564);i(55729);let j=e=>{let{label:t,shortcuts:i}=e;return(0,n.jsxs)(s.z,{children:[i.map((e,t)=>(0,n.jsx)(r.u,{padding:1,children:e},t)),(0,n.jsx)(o.E,{fontSize:"sm",fontWeight:"medium",whiteSpace:"nowrap",children:t})]})},f=e=>{let{onClose:t,showExitPresentMode:i=!0}=e;return(0,n.jsx)(l.a,{children:(0,n.jsxs)(a.B,{spacing:6,children:[(0,n.jsxs)(a.B,{spacing:1,children:[(0,n.jsxs)(s.z,{color:"gray.500",children:[(0,n.jsx)(p.g,{icon:h.Lhe})," ",(0,n.jsx)(d.D,{size:"xs",fontWeight:"normal",children:(0,n.jsx)(g.x6,{id:"h7MgpO"})})]}),(0,n.jsx)(d.D,{size:"md",children:(0,n.jsx)(g.x6,{id:"UodEcE"})})]}),(0,n.jsxs)(c.r,{spacing:3,columns:1,children:[(0,n.jsx)(j,{label:(0,n.jsx)(g.x6,{id:"9xCxY6"}),shortcuts:[(0,n.jsx)(p.g,{icon:m.CeG},"left"),(0,n.jsx)(p.g,{icon:m.dmS},"right")]}),(0,n.jsx)(j,{label:(0,n.jsx)(g.x6,{id:"K0Oq/D"}),shortcuts:["R"]}),(0,n.jsx)(u.c,{borderColor:"gray.300"}),(0,n.jsx)(j,{label:(0,n.jsx)(g.x6,{id:"CgmvBu"}),shortcuts:["S"]}),(0,n.jsx)(j,{label:(0,n.jsx)(g.x6,{id:"/5i2oX"}),shortcuts:[(0,n.jsx)(p.g,{icon:m.INu},"up"),(0,n.jsx)(p.g,{icon:m.B0C},"down")]}),(0,n.jsx)(j,{label:(0,n.jsx)(g.x6,{id:"rEj/lx"}),shortcuts:["Enter"]}),(0,n.jsx)(u.c,{borderColor:"gray.300"}),i&&(0,n.jsx)(j,{label:(0,n.jsx)(g.x6,{id:"IkakN2"}),shortcuts:["Esc"]})]}),(0,n.jsx)(x.$,{size:"sm",variant:"solid",onClick:t,children:(0,n.jsx)(g.x6,{id:"76gPWk"})})]})},"coach-bar")}},31312:()=>{},32412:(e,t,i)=>{"use strict";i.d(t,{e:()=>p});var n=i(55729),s=i(26312),r=i(15342),o=i(85011),l=i(95889),a=i(86932),d=i(27196),c=i(60300),u=i(53891),x=i(43634),h=i(39162);let m=function(e,t){let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],n=(0,o.H1)("editor"),s=n.scroller;if(!s)return;e.commands.turnOffSpotlight();let r=s.scrollHeight-s.offsetHeight;if("down"===t){if(!(n.isAtBottom(90)&&i&&e.commands.spotlightNextCard(!1,"top"))){let e=s.scrollTop+.5*s.offsetHeight;e>r-150&&(e=r),n.scrollTo({top:e})}}else if(!(n.isAtTop(90)&&i&&e.commands.spotlightNextCard(!0,"bottom"))){let e=s.scrollTop-.5*s.offsetHeight;e<150&&(e=0),n.scrollTo({top:e})}},p=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.Y2.MAIN_PRESENT_VIEW,{editor:t}=(0,h.m)(),i=(0,l.st)(),{enabled:o}=(0,d.kY)(t),p=(0,r.CU)();return{handlePresentNavigationEvent:(0,n.useCallback)(n=>{let{eventType:r,eventKey:o,method:d="keyboard",payload:h={}}=n;if(!t)return!1;let g=p.getState(),j=(0,x.FI)(g),f=null==j?void 0:j.pos,v=!!(t&&j&&(0,c.UE)(t,j)),b=Object.keys((0,x.Ev)(g).tree);switch(r){case"toggleSpotlight":return v?null==t||t.commands.turnOffSpotlight():null==t||t.commands.spotlightNextBlock(),p.dispatch((0,x.tB)()),!0;case"goToCard":{let{cardId:e}=h;if(!e)return!1;return t.commands.spotlightCardById(e,v),p.dispatch((0,x.mF)({attached:!1})),!0}case"arrowRight":if((0,s.up)(),p.dispatch((0,x.mF)({attached:!1})),null==i||i.trackDocEvent(l.VV.PRESENT_MODE_NAVIGATED,{direction:l.Fk.CARD_NEXT,method:"keyboard"===d?l.fG.KEYBOARD:l.fG.BUTTON_CLICK,source:e,...void 0!==o&&{key:o}}),v)return t.commands.spotlightNextBlock();return t.commands.spotlightNextCard();case"arrowLeft":if((0,s.up)(),p.dispatch((0,x.mF)({attached:!1})),null==i||i.trackDocEvent(l.VV.PRESENT_MODE_NAVIGATED,{direction:l.Fk.CARD_PREV,method:"keyboard"===d?l.fG.KEYBOARD:l.fG.BUTTON_CLICK,source:e,...void 0!==o&&{key:o}}),v)return t.commands.spotlightNextBlock(!0);return t.commands.spotlightNextCard(!0);case"arrowDown":if((0,s.up)(),p.dispatch((0,x.mF)({attached:!1})),!v){let e=(0,a.TX)(t.state.selection);return t.commands.goToNextExpandableNode()||m(t,"down",!e),!0}return null==i||i.trackDocEvent(l.VV.PRESENT_MODE_NAVIGATED,{direction:l.Fk.TELEPROMPTER_DOWN,method:"keyboard"===d?l.fG.KEYBOARD:l.fG.BUTTON_CLICK,source:e,...void 0!==o&&{key:o}}),t.commands.spotlightNextBlock();case"arrowUp":if((0,s.up)(),p.dispatch((0,x.mF)({attached:!1})),!v){let e=(0,a.TX)(t.state.selection);return t.commands.goToNextExpandableNode(!0)||m(t,"up",!e),!0}return null==i||i.trackDocEvent(l.VV.PRESENT_MODE_NAVIGATED,{direction:l.Fk.TELEPROMPTER_UP,method:"keyboard"===d?l.fG.KEYBOARD:l.fG.BUTTON_CLICK,source:e,...void 0!==o&&{key:o}}),t.commands.spotlightNextBlock(!0);case"restart":if(b[0])return(0,s.up)(),t.commands.spotlightCardById(b[0]),p.dispatch((0,x.mF)({attached:!1})),!0;return!1;case"cancelCurrentAction":{let e=v&&f;if(t.commands.spotlightCollapseNearestExpandableNode(e?f:null))return t.commands.reHighlightExpandableNode(),!0;if(v)return t.commands.turnOffSpotlight(),!0;return p.dispatch((0,x.mF)({attached:!1})),null==i||i.track(l.VV.CARD_COLLAPSED,{is_present_mode:!0,method:"escape_key"}),t.commands.ascendUpToParentCard(!1)}case"toggleExpanded":{let e=v&&f;if(t.commands.expandOrCollapseExpandableNode(e?f:null))return!0;if(e){let e=t.state.doc.resolve(f).parent;if(e&&(0,u.p8)(e))return(0,u.bG)(e.attrs.id,!1),t.commands.spotlightNextBlock(!0),!0;return t.commands.spotlightCollapseNearestExpandableNode(f)}return!1}default:return!1}},[i,t,e,p]),spotlightingByBlock:o}}},36679:(e,t,i)=>{"use strict";i.d(t,{FM:()=>h,Lt:()=>x,Ur:()=>u,Yi:()=>m});var n=i(33750),s=i.n(n),r=i(55729),o=i(68301),l=i(15342),a=i(61385),d=i(43634),c=i(28615);let u="disable-card-size-animations",x=()=>{let e=(0,o.u)("autoZoomToFit"),t=(0,l.GV)(d.G7);return(0,r.useEffect)(()=>{t||g()},[t]),null!=t?t:e},h=()=>{let e=(0,l.GV)(d.$i),t=(0,r.useRef)(),i=x(),n=!c.rS&&!c.GC&&i;(0,r.useEffect)(()=>{let i=!t.current;t.current=e,e&&n&&(document.body.classList.add(u),m(),requestAnimationFrame(()=>{document.body.classList.remove(u)}),i&&setTimeout(()=>{document.body.classList.add(u),m(),requestAnimationFrame(()=>{document.body.classList.remove(u)})},a.M2))},[e,n])},m=()=>{let e=document.documentElement.clientHeight,t=document.querySelector('[data-animate-value="presentCurrent"][data-card-scroll-element]');if(!t)return;let i=p(t,e,1);if(i<.9){let n=(1-i)/3;i=p(t,e,i+n)}(0,l.KA)().dispatch((0,d.ed)({zoomLevel:i}))},p=(e,t,i)=>{e.style.setProperty("--zoom-level",i.toString());let n=e.scrollHeight,r=s()(i*t/n,c.hQ?.5:a.bq,1);return e.style.setProperty("--zoom-level",r.toString()),r},g=()=>{document.querySelectorAll("[data-card-scroll-element]").forEach(e=>{e.style.removeProperty("--zoom-level")})}},37869:(e,t,i)=>{"use strict";i.d(t,{Z:()=>u,l:()=>c});var n=i(6029),s=i(24302),r=i(26420),o=i(77650),l=i(55729);let a=()=>(0,n.jsxs)("svg",{width:"100%",height:"100%",fill:"none",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 40 40",children:[(0,n.jsx)("g",{clipPath:"url(#a)",fill:"currentColor",children:(0,n.jsx)("path",{d:"M12.277 4.575a14.16 14.16 0 0 0-4.297 5.769c-.93 2.281-1.195 4.683-.809 7.145a13.256 13.256 0 0 0 2.97 6.542 14.11 14.11 0 0 0 5.866 4.165c2.317.88 4.791 1.122 7.338.712l10.308-1.63-2.631-16.62-11.962 1.895.918 5.77 5.636-.894.749 4.695-3.79.604a7.214 7.214 0 0 1-3.887-.423 7.673 7.673 0 0 1-3.126-2.293 7.383 7.383 0 0 1-1.581-3.585 7.492 7.492 0 0 1 .398-3.898 7.744 7.744 0 0 1 2.27-3.15c1.025-.858 2.22-1.389 3.56-1.606l10.115-1.605L29.344 0 19.036 1.63c-2.547.398-4.828 1.4-6.759 2.945ZM29.85 36.608c-.639-.519-1.448-.796-2.232-1.026-1.907-.53-3.887-.736-5.866-.748-1.98 0-3.96.217-5.866.748-.785.23-1.593.507-2.233 1.026-1.183 1.05.277 1.968 1.231 2.306 2.185.808 4.55 1.074 6.868 1.086 2.317 0 4.683-.278 6.868-1.086.953-.338 2.414-1.256 1.23-2.306Z"})}),(0,n.jsx)("defs",{children:(0,n.jsx)("clipPath",{id:"a",children:(0,n.jsx)("path",{fill:"#fff",d:"M0 0h40v40H0z"})})})]});var d=i(3083);let c=e=>({separatorColor:(0,s.dU)(e?"whiteAlpha.600":"gray.200","whiteAlpha.600"),borderHoverColor:(0,s.dU)(e?void 0:"deepocean.200",void 0),textColor:(0,s.dU)(e?"gray.50":"gray.800","gray.50"),secondaryTextColor:(0,s.dU)(e?"gray.400":"gray.600","gray.400"),editedTextColor:(0,s.dU)(e?"gray.200":"gray.950","gray.200"),lastItemColor:(0,s.dU)(e?"gray.500":"gray.400","gray.500")}),u=(0,l.memo)(e=>{let{isDark:t,iconButtonProps:i,boxProps:s}=e,{separatorColor:l,borderHoverColor:u}=c(t);return(0,n.jsx)(d.f,{"aria-label":o.Ru._({id:"i0qMbr"}),role:"group",borderRadius:"md",border:"none",icon:(0,n.jsx)(r.a,{boxSize:8,border:"1px solid",borderColor:l,p:"0.3rem",transitionProperty:"border-color",transitionDuration:"normal",_groupHover:{borderColor:u},borderRadius:"md",...s,children:(0,n.jsx)(a,{})}),...i})});u.displayName="GammaHomeButton"},39099:(e,t,i)=>{"use strict";i.d(t,{z:()=>v});var n=i(6029),s=i(40452),r=i(26420),o=i(77650),l=i(55729),a=i(75074),d=i(15342),c=i(45373),u=i(6046),x=i(23664),h=i(63255),m=i(39659);let p={fontFamily:"var(--chakra-fonts-body) !important",fontWeight:"500",lineHeight:"1.5 !important",textTransform:"none",letterSpacing:"normal !important",textAlign:"start !important",margin:"0 !important",color:"gray.700 !important",background:"none !important",border:"0 none !important",padding:"0 !important",content:'""'},g={".block-paragraph,.block-heading,.block-title,.block-todo,.block-numbered,.block-bullet":{...p,margin:0,my:"0.75em",":first-child":{mt:"0px !important"},":last-child":{mb:"0px !important"}},".block-paragraph":{fontSize:"1em"},".block-heading,.block-title":{fontWeight:"bold",lineHeight:{fontSize:"1.25"},'.heading[level="1"]':{fontSize:"1.5em"},'.heading[level="2"]':{fontSize:"1.25em"},'.heading[level="3"]':{fontSize:"1.125em"},'.heading[level="4"]':{fontSize:"1em"}},".block-title":{".title":{fontSize:"1.75em"},'.title[level="1"]':{fontSize:"1.75em"},'.title[level="2"]':{fontSize:"2em"},'.title[level="3"]':{fontSize:"2.25em"}},a:{...p,color:"var(--chakra-colors-blue-500) !important","&:hover":{textDecoration:"underline"},'&[href=""]':{textDecorationStyle:"dashed"},cursor:"pointer"},".mention":{bgColor:"trueblue.50",whiteSpace:"break-spaces"},code:{backgroundColor:"var(--chakra-colors-trueblue-50)",color:"var(--body-color)",...m.w}},j={".block-paragraph,.block-heading,.block-title,.block-todo,.block-numbered,.block-bullet":{...p,margin:0,my:"0.75em",":first-child":{mt:"0px !important"},":last-child":{mb:"0px !important"},color:"white"},code:{backgroundColor:"var(--chakra-colors-whiteAlpha-100)",color:"var(--chakra-colors-gray-200)",...m.w},".block-todo label.chakra-checkbox .chakra-checkbox__control[data-checked]":{backgroundColor:"var(--chakra-colors-whiteAlpha-100)",color:"var(--chakra-colors-white)"}},f=e=>{let{isDark:t=!1}=e;return{".ProseMirror":{height:"100%"},...g,...h.X0,"--box-border-radius":"var(--chakra-radii-sm)","--link-color":t?"var(--chakra-colors-trueblue-100)":"var(--chakra-colors-trueblue-500)",".block-todo label.chakra-checkbox .chakra-checkbox__control:not([data-checked])":{borderColor:t?"whiteAlpha.300":"gray.200"},"--body-color-inverted":t?"black":"white",...t?j:{},".is-selecting-node":{"[data-selection-ring]":{_before:{content:'""',position:"absolute",inset:0,borderRadius:"inherit",outline:"2px solid",outlineColor:t?"trueblue.100":"trueblue.300",pointerEvents:"none",zIndex:1}},'[data-selection-ring="padded"]':{_before:{outlineOffset:"0.25em"}}}}},v=(0,l.memo)(e=>{var t;let{isEditable:i,notesSx:h,canShowEditHint:m=!1,isDark:p=!1}=e,[g,j]=(0,l.useState)(null),{destroyEditor:v,mountEditor:b}=(0,d.GV)(a.rd),y=(0,l.useRef)(!1);(0,l.useEffect)(()=>(b&&j(b()),()=>{null==v||v(),j(null)}),[v,b]),(0,l.useEffect)(()=>{g&&i&&!y.current&&(g.commands.focus("end"),y.current=!0)},[i,g]),(0,l.useEffect)(()=>{if(g){if(g.shouldUseLiteMenus=!0,i&&!g.isEditable)return void g.setEditable(!0);if(!i&&g.isEditable)return void g.setEditable(!1)}},[i,g]);let C=i?o.Ru._({id:"fnNtuR"}):"Double click to edit",w=m&&(null==(t=null==g?void 0:g.isEmpty)||t),k=f({isDark:p});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.s,{className:"card-notes-editor",overflowY:"auto",border:"1px solid",borderColor:p?"gray.600":"gray.200",borderRadius:"md",flex:1,p:4,wordBreak:"break-word",sx:{".block.block-paragraph.first-block.last-block.is-empty::before":{...x.sx,content:'"'.concat(C,'"')},...k,...h,_before:w?{...x.sx,top:4,left:4,height:"auto",width:"auto",content:'"'.concat(o.Ru._({id:"CvH5f/"}),'"')}:{}},pos:"relative",children:(0,n.jsx)(s.s,{flex:1,flexDirection:"column",children:g&&(0,n.jsx)(u.$,{editor:g,className:"highlight-mask",style:{height:"100%"}})})}),g&&i&&(0,n.jsx)(r.a,{children:(0,n.jsx)(c.Ht,{editor:g,appendToSelector:"[data-card-notes-bubble-menu-target]"})})]})});v.displayName="CardNotesEditor"},41876:(e,t,i)=>{"use strict";i.d(t,{JW:()=>E,Lh:()=>R,SQ:()=>S});var n=i(6029),s=i(48810),r=i(12514),o=i(26420),l=i(56570),a=i(69388),d=i(8099),c=i(16936),u=i(55597),x=i(48621),h=i(19564),m=i(77650),p=i(70315),g=i(55729),j=i(3247),f=i(4007),v=i(15342),b=i(39162),y=i(10995),C=i(4837),w=i(32412);let k=(0,p.Ay)("mod+Escape"),E=new Set(["h","j","k","l","s","PageUp","PageDown","ArrowRight","ArrowLeft","ArrowDown","ArrowUp","Enter","Escape"]),S=e=>{let{enabled:t,setActiveKey:i}=e,{editor:n}=(0,b.m)(),{editCardInPresentMode:s}=(0,C.V)({editor:n}),r=(0,v.GV)(f.AO),o=(0,y.x)(),{handlePresentNavigationEvent:l,spotlightingByBlock:a}=(0,w.e)();return(0,g.useEffect)(function(){if(t)return j.WC.on("keydown","NAVIGATION_CONTROLS",e=>{if((null==e?void 0:e.metaKey)||o(e))return!1;let t=e.key;if(E.has(t)&&("s"!==t&&(i(e.key),setTimeout(()=>{i(null)},100)),e.preventDefault())," "===t&&e.shiftKey)return l({eventType:"arrowLeft",eventKey:t});switch(e.key){case"e":return s(),!0;case"s":return l({eventType:"toggleSpotlight",eventKey:t});case" ":case"l":case"ArrowRight":return l({eventType:"arrowRight",eventKey:t});case"h":case"ArrowLeft":return l({eventType:"arrowLeft",eventKey:t});case"j":case"ArrowDown":case"PageDown":return l({eventType:"arrowDown",eventKey:t});case"k":case"ArrowUp":case"PageUp":return l({eventType:"arrowUp",eventKey:t});case"r":return l({eventType:"restart",eventKey:t});case"Escape":if(k(e))return!1;return l({eventType:"cancelCurrentAction",eventKey:t});case"Enter":return l({eventType:"toggleExpanded",eventKey:t});default:return!1}})},[s,t,l,r,o,i]),a},I=e=>{let t=new KeyboardEvent("keydown",{key:e});i.g.dispatchEvent(t)},A={ArrowUp:{icon:u.INu,label:(0,n.jsx)(h.x6,{id:"VbggDE"}),ariaLabel:()=>m.Ru._({id:"VbggDE"}),shortcuts:["","K"],key:"ArrowUp",onClick:()=>{I("ArrowUp")},gridPos:[1,2]},ArrowLeft:{icon:u.CeG,label:(0,n.jsx)(h.x6,{id:"4jciC3"}),ariaLabel:()=>m.Ru._({id:"4jciC3"}),shortcuts:["","H"],key:"ArrowLeft",onClick:()=>{I("ArrowLeft")},gridPos:[2,1]},ArrowDown:{icon:u.B0C,label:(0,n.jsx)(h.x6,{id:"e3GOIZ"}),ariaLabel:()=>m.Ru._({id:"e3GOIZ"}),shortcuts:["","J"],key:"ArrowDown",onClick:()=>{I("ArrowDown")},gridPos:[2,2]},ArrowRight:{icon:u.dmS,label:(0,n.jsx)(h.x6,{id:"ZjQRVw"}),ariaLabel:()=>m.Ru._({id:"ZjQRVw"}),shortcuts:["","L"],key:"ArrowRight",onClick:()=>{I("ArrowRight")},gridPos:[2,3]},Spotlight:{icon:u.Jq7,label:(0,n.jsx)(h.x6,{id:"Xon9jp"}),ariaLabel:()=>m.Ru._({id:"Xon9jp"}),shortcuts:["S"],key:"S",onClick:()=>{I("s")},gridPos:[1,3]}},T=e=>{let{shortcuts:t}=e;return(0,n.jsx)(s.E,{as:"span",color:"gray.400",ml:2,children:t.map((e,i)=>(0,n.jsxs)(g.Fragment,{children:[e,i===t.length-1?null:(0,n.jsx)(s.E,{fontSize:"11px",as:"span",color:"gray.500",mx:1,children:"or"})]},e))})},R=e=>{let{activeKey:t,spotlightingByBlock:i}=e;return(0,n.jsx)(r.Z,{children:(0,n.jsx)(o.a,{position:"absolute",bottom:4,insetEnd:6,zIndex:"sticky",children:(0,n.jsx)(l.x,{gridTemplateColumns:"repeat(3, 1fr)",gridTemplateRows:"repeat(2, 1fr)",children:Object.values(A).map(e=>{let{gridPos:r,icon:o,label:l,ariaLabel:u,shortcuts:h,key:m,onClick:p}=e;return(0,n.jsx)(a.E,{gridColumn:r[1],gridRow:r[0],children:(0,n.jsx)(d.m,{hasArrow:!0,placement:"top",label:(0,n.jsxs)(s.E,{whiteSpace:"nowrap",children:[l,(0,n.jsx)(T,{shortcuts:h})]}),children:(0,n.jsx)(c.K,{m:1,shadow:"base",size:"md",variant:"S"==m&&i?"solid":"plain",isActive:t===m||"S"===m&&i,onClick:p,onMouseDown:e=>e.preventDefault(),"aria-label":u(),icon:(0,n.jsx)(x.g,{icon:o})})})},m)})})})})}},51407:()=>{},53984:(e,t,i)=>{"use strict";i.d(t,{d:()=>et});var n=i(6029),s=i(26385),r=i(41781),o=i(36693),l=i(40452),a=i(48810),d=i(74676),c=i(26420),u=i(23908),x=i(49611),h=i(23293),m=i(46898),p=i(34807),g=i(68068),j=i(36071),f=i(60628),v=i(3674),b=i(17920),y=i(40691),C=i(49146),w=i(16426),k=i(61204),E=i(47412),S=i(19564),I=i(77650),A=i(21157),T=i.n(A),R=i(55729),_=i(96441),O=i(88586),D=i(99038),P=i(14900),z=i(20845),M=i(95889),L=i(95695),N=i(20925),F=i(30034),V=i(85607),G=i(26449),W=i(11403),B=i(85448),U=i(79958);let H=()=>({today:I.Ru._({id:"ecUA8p"}),thisWeek:I.Ru._({id:"yByRxz"}),earlier:I.Ru._({id:"HGg4T/"})}),K=()=>(0,n.jsxs)(s.B,{children:[(0,n.jsx)(r.E,{w:"max(350px, 30%)",h:10}),(0,n.jsx)(r.E,{w:"max(320px, 22%)",h:5})]}),q=e=>{let{createdTime:t,editors:i,isLatest:s,onClick:r,showPaywall:u,paywallCount:x}=e;if(!i||!i.length)return(0,n.jsx)(n.Fragment,{});let h=u?"linear-gradient(rgb(0, 0, 0) 15%, transparent 100%)":"",m=(0,n.jsxs)(o.o,{flexDirection:"row",borderRadius:"base",style:{WebkitMaskImage:h,maskImage:h},border:"none",isDisabled:u,opacity:"1 !important",onClick:r,alignItems:"flex-start",width:"100%",textAlign:"left",children:[(0,n.jsxs)(l.s,{w:"100%",direction:"column",children:[(0,n.jsx)(a.E,{fontSize:"sm",children:T()((0,G.OG)(t))}),(0,n.jsx)(a.E,{fontSize:"xs",flex:1,children:i[0].displayName})]}),s&&(0,n.jsx)(d.E,{colorScheme:"green",fontSize:"0.65em",children:(0,n.jsx)(S.x6,{id:"wL3cK8"})})]});return u?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(E.Tz,{placement:"top",isDisabled:!u,label:u?(0,n.jsx)(S.x6,{id:"PYTBm5",values:{paywallCount:x}}):void 0,children:(0,n.jsx)(c.a,{mb:4,children:m})}),(0,n.jsx)(z.c,{isNarrow:!0,segmentEvent:M.VV.GAMMA_PRO_UPSELL_CALLOUT_CHANGE_HISTORY,description:(0,n.jsx)(S.x6,{id:"mVKYtH"}),targetFeature:"change_history_unlimited"})]}):m},Y=e=>{var t;let i=[];return{groupedSnapshots:(0,R.useMemo)(()=>(0,G.WP)({items:e,sortBy:"createdTime"}),[e]),paywalledSnapshotId:null==(t=i[0])?void 0:t.id,paywallCount:i.length}},J=e=>{let{groupedSnapshots:t,paywalledSnapshotId:i,paywallCount:s,onClick:r,showFetchMore:o,onFetchMoreClick:l,isFetchingMore:a}=e;return(0,n.jsxs)(u.w,{w:"100%",children:[Object.entries(t).filter(e=>{let[,t]=e;return t.length}).map((e,t)=>{let[o,l]=e;return(0,n.jsxs)(R.Fragment,{children:[(0,n.jsx)(E._x,{px:4,py:2,mx:0,mt:2,children:H()[o]}),l.map((e,o)=>{let{createdTime:l,editors:a,id:d}=e;return(0,n.jsx)(q,{onClick:()=>r(d),isLatest:0===t&&0===o,createdTime:l,editors:a,showPaywall:i===d,paywallCount:s},d)})]},o)}),o&&(0,n.jsx)(x.$,{isLoading:a,onClick:l,children:(0,n.jsx)(S.x6,{id:"yQ2kGp"})})]})},X=()=>(0,n.jsxs)(u.w,{w:"100%",children:[(0,n.jsx)(r.E,{h:16}),(0,n.jsx)(r.E,{h:16,mt:2}),(0,n.jsx)(r.E,{h:16,mt:2}),(0,n.jsx)(r.E,{h:16,mt:2}),(0,n.jsx)(r.E,{h:16,mt:2}),(0,n.jsx)(r.E,{h:16,mt:2}),(0,n.jsx)(r.E,{h:16,mt:2}),(0,n.jsx)(r.E,{h:16,mt:2})]}),$=e=>{let{title:t,createdBy:i,createdTime:s,numSnapshots:r}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(h.D,{size:"md",children:(0,n.jsx)(S.x6,{id:"yf//Op",values:{numSnapshots:r,0:(0,P.Bo)(s),1:(0,P.Bo)(s)}})}),(0,n.jsx)(a.E,{color:"gray.500",fontSize:"sm",fontWeight:"normal",letterSpacing:"normal",children:(0,n.jsx)(S.x6,{id:"JVHTIo",values:{title:t,0:(null==i?void 0:i.displayName)?null==i?void 0:i.displayName:"Unknown",1:(0,P.Yq)(s,"PPp")}})})]})},Z="snapshot-editor-root",Q=e=>{let{id:t,doc:i,content:s}=e;return(0,n.jsx)(N.u5,{reduxData:{doc:i},initialContent:s,doc:i,docId:i.id,scrollingParentSelector:".".concat(Z),isInsideDrawer:!0},t)},ee=e=>{let{content:t}=e;if(!t)return null;let i=(0,B.Rb)(t);return(0,n.jsxs)(c.a,{p:6,h:"100%",overflowY:"auto",bg:"white",children:[(0,n.jsx)(a.E,{as:"h2",fontSize:"md",fontWeight:"bold",mb:2,children:"Text-only preview (safe mode)"}),(0,n.jsx)(a.E,{fontSize:"md",lineHeight:"1.6",whiteSpace:"pre-wrap",children:i||"(empty)"})]})},et=e=>{var t;let{isOpen:i,onClose:s,doc:r,safeMode:o=!1}=e,a=(0,m.d)(),{getCollaborativeEditorInstance:d}=(0,V.mi)(),[u,h]=(0,R.useState)(!1),[I,{data:A}]=(0,O.qob)();(0,W.Vg)(()=>{I({variables:{id:r.id}})},[r.id,I,i],[i]);let T=null==A||null==(t=A.doc)?void 0:t.currentSnapshotId,{loading:z,data:M,called:N,fetchMore:G}=(0,O.XSN)({variables:{docId:r.id,first:25},skip:!r||!i,fetchPolicy:"network-only",nextFetchPolicy:"network-only"}),[B,{loading:H,data:q}]=(0,O.Wzf)({nextFetchPolicy:"cache-only"}),et=(null==M?void 0:M.snapshots.edges.map(e=>e.node))||[],{groupedSnapshots:ei,paywalledSnapshotId:en,paywallCount:es}=Y(et),er=null==M?void 0:M.snapshots.pageInfo,eo=!!(!en&&N&&(null==er?void 0:er.hasNextPage)&&(null==er?void 0:er.endCursor)),el=(0,R.useCallback)(()=>{(null==er?void 0:er.hasNextPage)&&(null==er?void 0:er.endCursor)&&(h(!0),G({variables:{after:er.endCursor}}).finally(()=>{h(!1)}))},[G,null==er?void 0:er.endCursor,null==er?void 0:er.hasNextPage]),ea=et[0];(0,R.useEffect)(()=>{(null==ea?void 0:ea.id)&&B({variables:{snapshotId:ea.id,docId:r.id}})},[r.id,B,null==ea?void 0:ea.id]);let ed=(0,U.B)(null==r?void 0:r.title),ec="createdBy"in r?r.createdBy:void 0,eu=null==r?void 0:r.createdTime,ex=null==q?void 0:q.snapshot,eh=ex&&ex.id===T,em=(0,p.A)(L.H4);return(0,n.jsx)(E.L8,{isDark:!1,children:(0,n.jsxs)(g._s,{placement:"bottom",onClose:s,isOpen:i,trapFocus:!0,isFullHeight:!0,blockScrollOnMount:!1,children:[(0,n.jsx)(j.m,{}),(0,n.jsxs)(f.z,{borderTopRadius:"xl",h:"calc(var(--100vh) - 24px)",transform:"none !important",children:[(0,n.jsx)(v.s,{}),(0,n.jsxs)(b.r,{borderBottom:"1px solid #000",borderColor:"gray.200",children:[z&&(0,n.jsx)(K,{}),!z&&r&&et&&(0,n.jsx)($,{numSnapshots:(null==et?void 0:et.length)||0,createdBy:ec,createdTime:eu,title:ed})]}),(0,n.jsx)(y.c,{p:0,h:"100%",children:(0,n.jsxs)(l.s,{direction:"row",h:"100%",children:[(0,n.jsx)(c.a,{p:2,w:"17rem",overflowY:"auto",bg:"gray.50",children:(0,n.jsxs)(C.t,{variant:"soft-rounded",orientation:"vertical",size:"md",children:[z&&(0,n.jsx)(X,{}),!z&&et&&(0,n.jsx)(J,{onClick:e=>{B({variables:{snapshotId:e,docId:r.id}})},groupedSnapshots:ei,paywalledSnapshotId:en,paywallCount:es,showFetchMore:eo,onFetchMoreClick:el,isFetchingMore:u})]})}),(0,n.jsx)(l.s,{flex:1,bg:"gray.50",overflowY:"scroll",justifyContent:"center",alignContent:"center",alignItems:"flex-start",width:"100%",height:"100%",className:Z,css:{"--editor-width":"100%","--editor-font-size":em},children:(0,n.jsxs)(l.s,{direction:"column",position:"relative",width:"100%",height:"100%",children:[(0,n.jsx)(F.s,{}),(!ex||H)&&(0,n.jsx)(_.Y,{}),ex&&!H&&(o?(0,n.jsx)(ee,{content:null==ex?void 0:ex.content.default}):(0,n.jsx)(Q,{id:ex.id,doc:r,content:null==ex?void 0:ex.content.default}))]})})]})}),(0,n.jsx)(w.j,{borderTop:"1px solid #000",borderColor:"gray.200",bg:"var(--drawer-bg)",zIndex:1,children:(0,n.jsxs)(k.e,{spacing:4,children:[(0,n.jsx)(x.$,{variant:"ghost",onClick:s,children:(0,n.jsx)(S.x6,{id:"dEgA5A"})}),(0,n.jsx)(E.Tz,{label:eh?(0,n.jsx)(S.x6,{id:"HJo72u"}):(0,n.jsx)(S.x6,{id:"sonTm1"}),shouldWrapChildren:!0,children:(0,n.jsx)(x.$,{variant:"solid",isDisabled:!ex||eh,onClick:()=>{var e;if(!ex)return;let t=null==et||null==(e=et.find(e=>e.id===ex.id))?void 0:e.createdTime,i=d();if(!i)return;i.commands.setContent(ex.content.default,!0);let{annotationsAbsolute:r}=ex.content;r?i.commands.restoreAnnotations(r):i.commands.clearAnnotations(),s(),a({title:(0,n.jsx)(S.x6,{id:"7ovf4C"}),description:(0,n.jsx)(S.x6,{id:"DTim6X",values:{GAMMA_ARTIFACT_PROPER_NOUN:D.TP,0:t?(0,P.Yq)(t,"PPp"):"selected snapshot"}}),status:"success",duration:5e3,isClosable:!0})},children:(0,n.jsx)(S.x6,{id:"yKu/3Y"})})})]})})]})]})})}},57690:()=>{},64206:(e,t,i)=>{"use strict";i.d(t,{b:()=>U});var n=i(6029),s=i(56570),r=i(69388),o=i(57405),l=i(23293),a=i(53996),d=i(26420),c=i(49611),u=i(48810),x=i(80314),h=i(99492),m=i(48621),p=i(47412),g=i(19564),j=i(77650),f=i(55729),v=i(87461),b=i(70027),y=i(33619),C=i(88586),w=i(5061),k=i(15342),E=i(82927),S=i(61216),I=i(70557),A=i(88490),T=i(83370),R=i(81807),_=i(75610),O=i(39049),D=i(19513),P=i(37471),z=i(31090),M=i(67446);let L=(0,f.memo)(()=>{let e=(0,n.jsx)(g.x6,{id:"WRqpdB"}),t=(0,n.jsx)(g.x6,{id:"CQqaDT"}),i=(0,n.jsx)(g.x6,{id:"BFXmWv"});return(0,n.jsx)(M.$,{title:(0,n.jsx)(g.x6,{id:"Z+WuT1"}),icon:h.i7d,children:(0,n.jsxs)(o.T,{alignItems:"flex-start",spacing:3,children:[(0,n.jsx)(u.E,{color:"gray.600",children:(0,n.jsx)(g.x6,{id:"DdJx17",components:{0:(0,n.jsx)(d.a,{as:"span",fontWeight:"bold",mx:"1"})}})}),(0,n.jsx)(u.E,{color:"gray.600",children:(0,n.jsx)(g.x6,{id:"frYjym"})}),(0,n.jsxs)(d.a,{bg:"white",p:3,borderRadius:"md",borderWidth:"1px",borderColor:"gray.200",w:"100%",fontSize:"xs",color:"gray.600",children:[(0,n.jsx)(u.E,{fontWeight:"medium",mb:1,children:(0,n.jsx)(g.x6,{id:"tbbSnu"})}),(0,n.jsxs)(z.B8,{styleType:"disc",ps:5,mb:2,children:[(0,n.jsx)(z.ck,{children:e}),(0,n.jsx)(z.ck,{children:t}),(0,n.jsx)(z.ck,{children:i})]}),(0,n.jsx)(u.E,{color:"gray.400",fontWeight:"bold",children:"---"}),(0,n.jsx)(u.E,{fontWeight:"medium",mt:2,mb:1,children:(0,n.jsx)(g.x6,{id:"Dqr964"})}),(0,n.jsxs)(z.B8,{styleType:"disc",ps:5,mb:2,children:[(0,n.jsx)(z.ck,{children:e}),(0,n.jsx)(z.ck,{children:t}),(0,n.jsx)(z.ck,{children:i})]}),(0,n.jsx)(u.E,{color:"gray.400",fontWeight:"bold",children:"---"}),(0,n.jsx)(u.E,{fontWeight:"medium",mt:2,mb:1,children:(0,n.jsx)(g.x6,{id:"4V7Mjx"})}),(0,n.jsxs)(z.B8,{styleType:"disc",ps:5,children:[(0,n.jsx)(z.ck,{children:e}),(0,n.jsx)(z.ck,{children:"..."})]})]})]})})});L.displayName="SectionDividerTip";var N=i(13366),F=i(98164),V=i(40452);let G=(0,f.memo)(e=>{let{value:t,icon:i,title:s,description:r,isSelected:l,onClick:a}=e;return(0,n.jsx)(d.a,{p:{base:2.5,sm:3},borderWidth:"1px",borderRadius:"lg",cursor:"pointer",onClick:a,borderColor:l?"trueblue.500":"gray.200",bg:l?"trueblue.50":"white",transition:"all 0.2s",_hover:{borderColor:l?"trueblue.500":"gray.300",bg:l?"trueblue.50":"gray.50"},children:(0,n.jsx)(F.s,{value:t,pointerEvents:"none",children:(0,n.jsxs)(V.s,{align:"center",gap:{base:2,sm:3},children:[(0,n.jsx)(d.a,{color:l?"trueblue.600":"gray.400",flexShrink:0,w:{base:4,sm:5},display:"flex",alignItems:"center",justifyContent:"center",children:(0,n.jsx)(m.g,{icon:i,fixedWidth:!0})}),(0,n.jsxs)(o.T,{align:"start",spacing:.5,flex:1,children:[(0,n.jsx)(u.E,{fontWeight:"medium",color:"gray.800",lineHeight:"short",fontSize:{base:"xs",sm:"sm"},children:s}),(0,n.jsx)(u.E,{fontSize:{base:"2xs",sm:"xs"},color:"gray.600",lineHeight:"short",display:{base:"none",sm:"block"},children:r})]})]})})})});G.displayName="TextModeRadioButton";let W=(0,f.memo)(e=>{let{textMode:t,onTextModeChange:i}=e;return(0,n.jsx)(N.z,{onChange:e=>i(e),value:t||"",w:"100%",children:(0,n.jsxs)(o.T,{spacing:{base:1.5,sm:2},align:"stretch",children:[(0,n.jsx)(G,{value:"generate",icon:h.ITF,title:(0,n.jsx)(g.x6,{id:"4B9QIY"}),description:(0,n.jsx)(g.x6,{id:"AYV6LC"}),isSelected:"generate"===t,onClick:()=>i("generate")}),(0,n.jsx)(G,{value:"condense",icon:h.bLf,title:(0,n.jsx)(g.x6,{id:"XWlhPt"}),description:(0,n.jsx)(g.x6,{id:"/SXv2t"}),isSelected:"condense"===t,onClick:()=>i("condense")}),(0,n.jsx)(G,{value:"preserve",icon:h.DW4,title:(0,n.jsx)(g.x6,{id:"p9MF67"}),description:(0,n.jsx)(g.x6,{id:"R3L5wN"}),isSelected:"preserve"===t,onClick:()=>i("preserve")})]})})});W.displayName="TextModeSelector";var B=i(26662);let U=(0,f.memo)(()=>{let{guessSettings:e,isLoading:t}=(0,A.D)({ref:"createPaste"}),i=(0,k.GV)(T.qT),{format:z,setFormat:M}=(0,I.pm)(),{styleTemplate:N,setStyleTemplate:F}=(0,I.pm)(),[V,G]=(0,f.useState)(null),[U]=(0,y.L)(),H=(0,k.jL)(),K=(0,f.useRef)(!0),{user:q}=(0,E.ur)();(0,f.useEffect)(()=>{if(q&&K.current){var e;K.current=!1,(null==q||null==(e=q.settings)?void 0:e.generationPreferredFormat)&&M(q.settings.generationPreferredFormat)}},[q,M]);let{goToScreen:Y}=(0,P._2)(),J=(0,f.useCallback)(async()=>{let t=(0,R.QA)(i),n=(0,R.M$)(i)-1;if(!V)return void console.warn("Attempted to navigate without selecting a text processing option.");"preserve"===V&&H((0,T.gy)(!0)),await e(C.xbH.PasteText,{format:z,content:i,settings:{locale:U.key,textMode:V,editorMode:n>0&&t>5?"structured":"freeform",styleTemplate:N}})},[i,N,e,z,V,U.key,H]),X=(0,w.fW)()?h.CeG:h.dmS,$={fontWeight:"500",color:"blackAlpha.700",size:{base:"sm",md:"md"},px:{base:2,sm:4},my:1,w:"100%",textAlign:"center"};return(0,n.jsx)(b.pY,{children:(0,n.jsxs)(v.d,{children:[(0,n.jsx)(B.V,{}),(0,n.jsx)(D.I,{title:(0,n.jsx)(g.x6,{id:"Q4xH1Z"}),icon:(0,n.jsx)(m.g,{icon:h.vZS}),iconBoxProps:{color:"deepocean.300"},children:(0,n.jsxs)(s.x,{templateColumns:{base:"1fr",xl:"1fr 2.5fr 1fr"},templateRows:"auto 1fr",templateAreas:{base:'\n                "format"\n                "content-and-ctas"\n              ',xl:'\n                ". format ."\n                ". content-and-ctas tips"\n              '},gap:4,px:{base:4,sm:4},w:"100%",maxW:"90rem",mx:"auto",children:[(0,n.jsx)(r.E,{area:"format",children:(0,n.jsxs)(o.T,{spacing:{base:2,sm:5},children:[(0,n.jsx)(l.D,{...$,children:(0,n.jsx)(g.x6,{id:"6h4zVU"})}),(0,n.jsxs)(o.T,{spacing:0,alignItems:{base:"stretch",md:"center"},w:{base:"100%",md:"auto"},children:[(0,n.jsx)(a.o,{children:(0,n.jsx)(O.Qz,{})}),N&&(0,n.jsx)(d.a,{w:"100%",children:(0,n.jsx)(_.k,{docFormatType:z,onSelectStyleTemplate:F,selectedStyleTemplate:N})})]}),(0,n.jsx)(l.D,{...$,children:(0,n.jsx)(g.x6,{id:"FFcD8+"})})]})}),(0,n.jsx)(r.E,{area:"content-and-ctas",children:(0,n.jsxs)(o.T,{spacing:{base:2,sm:5},align:"stretch",children:[(0,n.jsx)(S.N,{containerProps:{minH:{base:"300px",sm:"350px",md:"400px"},maxH:{base:"50vh",sm:"55vh",md:"60vh"},overflow:"auto",fontSize:{base:"14px",sm:"16px"},w:"100%"},hideFooter:!0}),(0,n.jsx)(l.D,{...$,children:(0,n.jsx)(g.x6,{id:"hvwlrC"})}),(0,n.jsx)(W,{textMode:V,onTextModeChange:G}),(0,n.jsx)(p.Tz,{label:i?V?"":(0,n.jsx)(g.x6,{id:"59szYn"}):(0,n.jsx)(g.x6,{id:"9IxKHJ"}),isDisabled:!!i&&!!V,placement:"top",children:(0,n.jsx)(c.$,{size:{base:"md",sm:"lg"},width:"100%",onClick:J,variant:"solid",rightIcon:(0,n.jsx)(m.g,{icon:X}),isLoading:t,isDisabled:!i||!V,loadingText:j.Ru._({id:"qgUvjm"}),children:(0,n.jsx)(g.x6,{id:"eMrl1e"})})}),(0,n.jsx)(u.E,{textAlign:"center",color:"blackAlpha.800",fontSize:{base:"sm",sm:"md"},children:(0,n.jsx)(g.x6,{id:"LVQnRo",components:{0:(0,n.jsx)(x.N,{onClick:e=>{e.preventDefault(),Y("createImport",{ref:"createPaste"})},textDecoration:"underline",fontWeight:"600"})}})})]})}),(0,n.jsx)(r.E,{area:"tips",display:{base:"none",xl:"block"},children:(0,n.jsx)(L,{})})]})})]})})});U.displayName="CreatePastePage"}}]);
//# sourceMappingURL=5539-2d75601c7b29dfe7.js.map